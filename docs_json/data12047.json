{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.15867"}, {"@name": "filename", "#text": "22365_Dissertacao_Jefferson_Serafim_Ascaneo.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Processamento de imagens de holografia\ndigital para o estudo de organismos\n\nplanct\u00f4nicos\n\nJefferson Serafim Ascaneo\n\nDisserta\u00e7\u00e3o apresentada\nao\n\nInstituto de Matem\u00e1tica e Estat\u00edstica\nda\n\nUniversidade de S\u00e3o Paulo\npara\n\nobten\u00e7\u00e3o do t\u00edtulo\nde\n\nMestre em Ci\u00eancias\n\nPrograma: Ci\u00eancia da Computa\u00e7\u00e3o\nOrientador: Prof. Dr. Roberto Hirata Jr.\n\nDurante o desenvolvimento deste trabalho o autor recebeu aux\u00edlio financeiro da CAPES\n\nS\u00e3o Paulo, mar\u00e7o de 2017\n\n\n\nProcessamento de imagens de holografia\ndigital para o estudo de organismos\n\nplanct\u00f4nicos\n\nEsta vers\u00e3o da disserta\u00e7\u00e3o cont\u00e9m as corre\u00e7\u00f5es e altera\u00e7\u00f5es sugeridas\npela Comiss\u00e3o Julgadora durante a defesa da vers\u00e3o original do trabalho,\nrealizada em 15/03/2017. Uma c\u00f3pia da vers\u00e3o original est\u00e1 dispon\u00edvel no\n\nInstituto de Matem\u00e1tica e Estat\u00edstica da Universidade de S\u00e3o Paulo.\n\nComiss\u00e3o Julgadora:\n\n\u2022 Prof. Dr. Roberto Hirata Junior (orientador) - IME-USP\n\n\u2022 Prof. Dr. Rubens Mendes Lopes - IO-USP\n\n\u2022 Prof. Dr. Jo\u00e3o Eduardo Kogler Junior - EP-USP\n\n\n\nResumo\n\nASCANEO, J. S. Processamento de imagens de holografia digital para o estudo de orga-\nnismos planct\u00f4nicos. 2017. 110 pp. Disserta\u00e7\u00e3o (Mestrado) - Instituto de Matem\u00e1tica e Estat\u00eds-\ntica, Universidade de S\u00e3o Paulo, S\u00e3o Paulo, 2017.\n\nO estudo de pl\u00e2ncton \u00e9 importante para estimar a biodiversidade em ambientes marinhos, auxili-\nando na compreens\u00e3o de sua din\u00e2mica e do impacto da atividade humana. Neste trabalho, estudamos\nas etapas necess\u00e1rias para a observa\u00e7\u00e3o de organismos planct\u00f4nicos utilizando um sistema hologr\u00e1-\nfico digital em linha. A holografia digital permite que as imagens sejam numericamente focalizadas\nap\u00f3s sua aquisi\u00e7\u00e3o atrav\u00e9s de algoritmos de reconstru\u00e7\u00e3o hologr\u00e1fica, o que remove a limita\u00e7\u00e3o da\nbaixa profundidade de foco presente em m\u00e9todos mais tradicionais, e permite a observa\u00e7\u00e3o de um\nvolume maior de \u00e1gua. \u00c9 feita uma an\u00e1lise das limita\u00e7\u00f5es te\u00f3ricas deste sistema hologr\u00e1fico em ter-\nmos das frequ\u00eancias presentes no holograma e na sua reconstru\u00e7\u00e3o, observando-se as consequ\u00eancias\npara a escolha e implementa\u00e7\u00e3o dos algoritmos de reconstru\u00e7\u00e3o. Tamb\u00e9m s\u00e3o considerados alguns\ndetalhes de implementa\u00e7\u00e3o que decorrem da natureza finita e discreta dos algoritmos. No proces-\nsamento dos hologramas, os organismos s\u00e3o automaticamente localizados segmentando-se regi\u00f5es\nde interesse por meio de uma reconstru\u00e7\u00e3o volum\u00e9trica. Estas regi\u00f5es s\u00e3o reconstru\u00eddas a diversas\ndist\u00e2ncias e \u00e9 feita a escolha de um plano focal utilizando uma medida de foco. Diversas medidas\ns\u00e3o comparadas em imagens obtidas experimentalmente para determinar a mais adequada na fo-\ncaliza\u00e7\u00e3o de organismos planct\u00f4nicos. Por fim, descrevemos a aplica\u00e7\u00e3o web desenvolvida para o\nprocessamento distribu\u00eddo de imagens hologr\u00e1ficas digitais de pl\u00e2ncton.\n\nPalavras-chave: processamento de imagens, holografia, pl\u00e2ncton, vis\u00e3o computacional, processa-\nmento digital de sinais.\n\ni\n\n\n\nii\n\n\n\nAbstract\n\nASCANEO, J. S. Processing of digital holography images for the study of planktonic or-\nganisms. 2017. 110 pp. Masters dissertation - Instituto de Matem\u00e1tica e Estat\u00edstica, Universidade\nde S\u00e3o Paulo, S\u00e3o Paulo, 2017.\n\nThe study of plankton is important for estimating biodiversity in marine environments, helping\nin the understanding of its dynamics and the impact of human activity. In this work, we study\nthe necessary steps for the observation of planktonic organisms using an inline digital holographic\nsystem. Digital holography allows images to be numerically focused after its acquisition through\nholographic reconstruction algorithms, which removes the limitation of low depth of focus present\nin more traditional methods, and allows the observation of a bigger volume of water. We present an\nanalysis of the theoretical limitations of this holographic system concerning the frequencies present\nin the hologram and its reconstruction, noting the consequences for the choice and implementation\nof reconstruction algorithms. Also considered are some implementation details that stem from the\nfinite and discrete nature of the algorithms. In the processing of holograms, organisms are automa-\ntically located by segmenting regions of interest in a volumetric reconstruction. These regions are\nreconstructed at numerous distances and the choice of a focal plane is made using the values of a\nfocus measure. Various measures are compared in experimentally obtained images to determine the\nmost adequate for focusing planktonic organisms. Finally, we describe a web application developed\nfor distributed processing of digital holographic images of plankton.\n\nKeywords: image processing, holography, plankton, computer vision, digital signal processing.\n\niii\n\n\n\niv\n\n\n\nSum\u00e1rio\n\nLista de Abreviaturas vii\n\nLista de S\u00edmbolos ix\n\nLista de Figuras xi\n\nLista de Tabelas xiii\n\n1 Introdu\u00e7\u00e3o 1\n1.1 Considera\u00e7\u00f5es Preliminares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n1.3 Contribui\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n1.4 Organiza\u00e7\u00e3o do Trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n2 Conceitos 5\n2.1 Fundamentos de Processamento Digital de Sinais . . . . . . . . . . . . . . . . . . . . 5\n2.2 Fundamentos de \u00d3ptica de Fourier . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2.2.1 Equa\u00e7\u00f5es de Maxwell e de Helmholtz . . . . . . . . . . . . . . . . . . . . . . . 7\n2.2.2 M\u00e9todo do espectro angular . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n2.2.3 Aproxima\u00e7\u00e3o de Fresnel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n3 Processamento de hologramas de pl\u00e2ncton 11\n3.1 Holografia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n3.1.1 Remo\u00e7\u00e3o de fundo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n3.1.2 Algoritmos de reconstru\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n3.1.3 Captura e propaga\u00e7\u00e3o das frequ\u00eancias em holografia digital . . . . . . . . . . 18\n\n3.2 Detalhes de implementa\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n3.2.1 FFT real e fun\u00e7\u00f5es de transfer\u00eancia . . . . . . . . . . . . . . . . . . . . . . . . 22\n3.2.2 Sobreposi\u00e7\u00e3o espacial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n3.2.3 Efeito de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n3.2.4 Amostragem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\n3.3 Segmenta\u00e7\u00e3o de regi\u00e3o de interesse . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n3.3.1 Reconstru\u00e7\u00e3o volum\u00e9trica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n3.3.2 Focaliza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\n3.4 Segmenta\u00e7\u00e3o Final . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n3.5 Outras considera\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nv\n\n\n\nvi SUM\u00c1RIO\n\n3.5.1 Custo computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.5.2 Processamentos adicionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\n4 Efeito de borda 33\n4.1 Introdu\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n4.2 M\u00e9todos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n\n4.2.1 Zeros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.2 M\u00e9dia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.3 C\u00f3pia da borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.4 Mediana da borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.5 Reflex\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.6 Rampa linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.7 Rampa linear circular . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.8 Filtro gaussiano . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.9 Filtro gaussiano iterativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.2.10 Rampa linear com janela de Tukey . . . . . . . . . . . . . . . . . . . . . . . . 39\n4.2.11 C\u00f3pia da borda com janela Spline . . . . . . . . . . . . . . . . . . . . . . . . . 39\n4.2.12 Mediana com janela de cosseno . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n4.2.13 Minimiza\u00e7\u00e3o de frequ\u00eancias altas . . . . . . . . . . . . . . . . . . . . . . . . . 40\n4.2.14 Minimiza\u00e7\u00e3o do Laplaciano . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n\n4.3 Complexidade computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n4.4 Resultados experimentais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n4.4.1 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n\n5 Focaliza\u00e7\u00e3o 55\n5.1 Medidas de foco . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n5.1.1 Medidas estat\u00edsticas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n5.1.2 Medidas com filtro espacial . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n5.1.3 Medidas com janelas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\n5.2 Complexidade computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64\n5.3 Resultados experimentais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64\n\n5.3.1 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65\n\n6 Sistema web 77\n6.1 Arquitetura . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n6.2 Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n\n7 Conclus\u00e3o 85\n7.1 Contribui\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\n7.2 Trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86\n\nA Imagens utilizadas no experimento de extens\u00f5es de borda 89\n\nB Imagens utilizadas no experimento de focaliza\u00e7\u00e3o 95\n\nRefer\u00eancias Bibliogr\u00e1ficas 105\n\n\n\nLista de Abreviaturas\n\nFFT Transformada R\u00e1pida de Fourier\nIFFT Transformada R\u00e1pida de Fourier Inversa\nFFTreal Transformada R\u00e1pida de Fourier de uma sequ\u00eancia de n\u00fameros reais\nIFFTreal Transformada R\u00e1pida de Fourier Inversa de uma sequ\u00eancia de n\u00fameros reais\nRMSE Raiz do Erro Quadr\u00e1tico M\u00e9dio\nACM Momento Central Absoluto (Image Absolute Central Moment)\nHPACM Momento Central Absoluto com Filtro Passa-altas (High-pass filter image absolute\n\ncentral moment)\nTV Varia\u00e7\u00e3o Total (Total Variation)\nGGMSUM Somat\u00f3rio da Magnitude do Gradiente Gaussiano\nGGMVAR Vari\u00e2ncia da Magnitude do Gradiente Gaussiano\nSIM Somat\u00f3rio do M\u00e1ximo Orientado da Intensidade (Steerable Intensity Maximum)\nSIMVAR Vari\u00e2ncia do M\u00e1ximo Orientado da Intensidade\nSDC Correla\u00e7\u00e3o do Desvio Padr\u00e3o\nSML Soma do Laplaciano Modificado\nXSML Soma Cruzada do Laplaciano Modificado\nPK Medida de Pieper e Korpel\nEOL Energia do Laplaciano\nEOGS Energia Quadr\u00e1tica do Gradiente\nSOBVAR Vari\u00e2ncia de Sobel\nLAPVAR Vari\u00e2ncia do Laplaciano\nGBLVAR Vari\u00e2ncia Global\nGBLVARGG Vari\u00e2ncia Global do Gradiente Gaussiano\nTOTVAR Vari\u00e2ncia Total do Gradiente Gaussiano\nGBLVARLoG Vari\u00e2ncia Global do Laplaciano do Gaussiano\n\nvii\n\n\n\nviii LISTA DE ABREVIATURAS\n\n\n\nLista de S\u00edmbolos\n\ncirc(r) Fun\u00e7\u00e3o circular\nsinc(x) Fun\u00e7\u00e3o seno cardinal\nrect(x) Fun\u00e7\u00e3o retangular\nF {f} Transformada Cont\u00ednua de Fourier da fun\u00e7\u00e3o f\nF?1 {F} Transformada Cont\u00ednua de Fourier Inversa da fun\u00e7\u00e3o F\nFFT Algoritmo que calcula a Transformada Discreta de Fourier\nIFFT Algoritmo que calcula a Transformada Discreta de Fourier Inversa\nFFTreal Algoritmo que calcula a Transformada Discreta de Fourier de n\u00fameros reais\nIFFTreal Algoritmo que calcula a Transformada Discreta de Fourier Inversa de n\u00fameros reais\nRe Parte real de um n\u00famero complexo\nIm Parte imagin\u00e1ria de um n\u00famero complexo\nE(I) Esperan\u00e7a de I\nVar(I) Vari\u00e2ncia de I\nc Velocidade da luz no v\u00e1cuo\n? Comprimento de onda\nk N\u00famero de onda\n? Frequ\u00eancia \u00f3ptica\n\nix\n\n\n\nx LISTA DE S\u00cdMBOLOS\n\n\n\nLista de Figuras\n\n3.1 Grava\u00e7\u00e3o e reconstru\u00e7\u00e3o de holograma . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n3.2 Sistema hologr\u00e1fico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n3.3 Exemplo de remo\u00e7\u00e3o de fundo de um holograma . . . . . . . . . . . . . . . . . . . . 14\n3.4 Reconstru\u00e7\u00e3o de um organismo de amplitude . . . . . . . . . . . . . . . . . . . . . . 15\n3.5 Reconstru\u00e7\u00e3o de um organismo de fase . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n3.6 Reconstru\u00e7\u00e3o hologr\u00e1fica pelo algoritmo da Integra\u00e7\u00e3o de Fresnel . . . . . . . . . . . 17\n3.7 Exemplo num\u00e9rico da propaga\u00e7\u00e3o das frequ\u00eancias . . . . . . . . . . . . . . . . . . . . 19\n3.8 Exemplo num\u00e9rico da propaga\u00e7\u00e3o de uma frequ\u00eancia . . . . . . . . . . . . . . . . . . 20\n3.9 Exemplo num\u00e9rico da propaga\u00e7\u00e3o de uma frequ\u00eancia . . . . . . . . . . . . . . . . . . 21\n3.10 Exemplo num\u00e9rico das frequ\u00eancias presentes em um holograma . . . . . . . . . . . . 23\n3.11 Reconstru\u00e7\u00e3o hologr\u00e1fica com sobreposi\u00e7\u00e3o espacial . . . . . . . . . . . . . . . . . . . 24\n3.12 Exemplo num\u00e9rico da propaga\u00e7\u00e3o e supress\u00e3o de frequ\u00eancias em um holograma . . . 25\n3.13 Efeito da borda na reconstru\u00e7\u00e3o hologr\u00e1fica . . . . . . . . . . . . . . . . . . . . . . . 26\n3.14 Segmenta\u00e7\u00e3o de um holograma em regi\u00f5es de interesse . . . . . . . . . . . . . . . . . 29\n3.15 Focaliza\u00e7\u00e3o de um holograma segundo a medida de entropia . . . . . . . . . . . . . . 29\n3.16 Segmenta\u00e7\u00e3o final de uma regi\u00e3o de interesse focalizada. . . . . . . . . . . . . . . . . 30\n3.17 Ilustra\u00e7\u00e3o do efeito da imagem g\u00eamea . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n4.1 Efeito da borda na reconstru\u00e7\u00e3o hologr\u00e1fica . . . . . . . . . . . . . . . . . . . . . . . 34\n4.2 Apodiza\u00e7\u00e3o do holograma para evitar efeito da borda . . . . . . . . . . . . . . . . . . 34\n4.3 Extens\u00e3o de holograma para evitar efeito da borda . . . . . . . . . . . . . . . . . . . 35\n4.4 M\u00e9todos de extens\u00e3o de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n4.5 M\u00e9todos de extens\u00e3o de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n4.6 Janela de Tukey . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n4.7 Janela de spline c\u00fabica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n4.8 Janela de cosseno . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n4.9 Minimiza\u00e7\u00e3o do Laplaciano . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n4.10 Tempo de execu\u00e7\u00e3o dos algoritmos de extens\u00e3o de borda . . . . . . . . . . . . . . . . 46\n4.11 Tempo de execu\u00e7\u00e3o dos algoritmos de extens\u00e3o de borda (detalhe) . . . . . . . . . . 47\n4.12 C\u00e1lculo do erro dos m\u00e9todos de extens\u00e3o de borda . . . . . . . . . . . . . . . . . . . 48\n4.13 Holograma utilizado nos gr\u00e1ficos de erro por dist\u00e2ncia e erro por tamanho da recons-\n\ntru\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n4.14 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o . . . 50\n\nxi\n\n\n\nxii LISTA DE FIGURAS\n\n4.15 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o\n(detalhe) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\n4.16 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o\n(detalhe) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n\n4.17 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem . . . . . 51\n4.18 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem (detalhe) 52\n4.19 Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem (detalhe\n\n2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n\n5.1 Focaliza\u00e7\u00e3o de um holograma segundo a medida de entropia . . . . . . . . . . . . . . 55\n5.2 Exemplo de organismo sendo focalizado . . . . . . . . . . . . . . . . . . . . . . . . . 66\n5.3 Valores de medidas de foco para um organismo . . . . . . . . . . . . . . . . . . . . . 67\n5.4 Exemplo de organismo sendo focalizado . . . . . . . . . . . . . . . . . . . . . . . . . 68\n5.5 Valores de medidas de foco para um organismo . . . . . . . . . . . . . . . . . . . . . 69\n5.6 Distribui\u00e7\u00e3o dos erros de focaliza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n5.7 Exemplo de execu\u00e7\u00e3o do algoritmo de autofoco . . . . . . . . . . . . . . . . . . . . . 72\n5.8 Exemplo de execu\u00e7\u00e3o do algoritmo de autofoco . . . . . . . . . . . . . . . . . . . . . 73\n\n6.1 Arquitetura do sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n6.2 Tela inicial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n6.3 Par\u00e2metros de um experimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n6.4 Tela para upload de hologramas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n6.5 Visualiza\u00e7\u00e3o dos hologramas enviados . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n6.6 Visualiza\u00e7\u00e3o de um holograma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n6.7 Visualiza\u00e7\u00e3o dos organismos segmentados . . . . . . . . . . . . . . . . . . . . . . . . 82\n6.8 Focaliza\u00e7\u00e3o manual de um organismo . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n\nA.1 Hologramas utilizados no experimento de extens\u00e3o de borda . . . . . . . . . . . . . . 89\nA.2 Hologramas utilizados no experimento de extens\u00e3o de borda . . . . . . . . . . . . . . 90\nA.3 Hologramas utilizados no experimento de extens\u00e3o de borda . . . . . . . . . . . . . . 91\nA.4 Hologramas utilizados no experimento de extens\u00e3o de borda . . . . . . . . . . . . . . 92\nA.5 Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda . . . 92\nA.6 Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda . . . 93\nA.7 Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda . . . 94\n\nB.1 Reconstru\u00e7\u00f5es do conjunto A utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 96\nB.2 Reconstru\u00e7\u00f5es do conjunto A utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 97\nB.3 Reconstru\u00e7\u00f5es do conjunto B utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 98\nB.4 Reconstru\u00e7\u00f5es do conjunto B utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 99\nB.5 Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 100\nB.6 Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 101\nB.7 Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 102\nB.8 Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o . . . . . . . . 103\n\n\n\nLista de Tabelas\n\n4.1 Erros das extens\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n4.2 Erros das extens\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n5.1 Erros de focaliza\u00e7\u00e3o - Conjunto A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n5.2 Erros de focaliza\u00e7\u00e3o - Conjunto B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n5.3 Erros de focaliza\u00e7\u00e3o - Conjunto C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n5.4 Erros de focaliza\u00e7\u00e3o - Total . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n5.5 Erros de focaliza\u00e7\u00e3o - Mediana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n5.6 Erros de autofoco - Conjunto A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n5.7 Erros de autofoco - Conjunto B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n5.8 Erros de autofoco - Conjunto C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\nxiii\n\n\n\nxiv LISTA DE TABELAS\n\n\n\nCap\u00edtulo 1\n\nIntrodu\u00e7\u00e3o\n\nFaremos algumas considera\u00e7\u00f5es preliminares sobre o estudo de pl\u00e2ncton e o uso de sistemas\nhologr\u00e1ficos para sua observa\u00e7\u00e3o e monitoramento. A seguir, apresentaremos os objetivos deste\ntrabalho, suas contribui\u00e7\u00f5es e a organiza\u00e7\u00e3o dos cap\u00edtulos.\n\n1.1 Considera\u00e7\u00f5es Preliminares\n\nA maior parte da superf\u00edcie terrestre \u00e9 coberta pelos oceanos, que cont\u00eam um sistema ecol\u00f3gico\ncomplexo onde diversos organismos interagem entre si e com o ambiente em que vivem. Dentre\nestes organismos, o pl\u00e2ncton forma a base da cadeia alimentar, sendo respons\u00e1vel por grande parte\nda fotoss\u00edntese que ocorre no planeta. O pl\u00e2ncton \u00e9 composto por uma grande variedade de seres\nvivos, como por exemplo as algas, crust\u00e1ceos pequenos, larvas de peixes e bact\u00e9rias. Seu estudo\n\u00e9, portanto, essencial para melhor compreender a din\u00e2mica dos ecossistemas marinhos, al\u00e9m de\npermitir estudar o impacto da atividade humana nestes ambientes aqu\u00e1ticos.\n\nNormalmente, o estudo de pl\u00e2ncton \u00e9 realizado com amostras coletadas atrav\u00e9s de redes e outros\nmecanismos que, embora permitam identificar as esp\u00e9cies presentes, possuem uma resolu\u00e7\u00e3o espa-\ncial e temporal extremamente limitadas, al\u00e9m de poderem danificar organismos mais fr\u00e1geis. Estas\namostras requerem a an\u00e1lise manual, em microsc\u00f3pios, por pessoas treinadas, o que gasta muito\ntempo e limita a quantidade de dados que podem ser analisados. Estes dados s\u00e3o, portanto, insu-\nficientes para compreender a variabilidade manifesta em escalas mais refinadas e realizar previs\u00f5es\ncom grande acur\u00e1cia.\n\nMais recentemente, o avan\u00e7o em tecnologias que permitem capturar imagens digitais, analis\u00e1-las\ne classific\u00e1-las de forma autom\u00e1tica ou semi-autom\u00e1tica permitiu o surgimento de novos equipa-\nmentos, com os quais pode-se estudar a distribui\u00e7\u00e3o de pl\u00e2ncton de forma mais eficiente. Entre\neles, destacam-se o ZooScan [GPWG04, GOP+10] e o FlowCAM\u00ae[SSY98]. Al\u00e9m de realizarem a\nclassifica\u00e7\u00e3o de organismos e detritos, alguns destes sistemas possuem acur\u00e1cia compar\u00e1vel \u00e0 de\num especialista [CWR+03]. Por\u00e9m, muitos destes equipamentos n\u00e3o permitem a an\u00e1lise in situ\nde grandes volumes de \u00e1gua, o que ainda \u00e9 um fator limitante para estudos mais detalhados. Os\nsistemas \u00f3pticos utilizados possuem uma profundidade de campo limitada, deixando apenas duas\nop\u00e7\u00f5es: ou capturar imagens de um pequeno volume, como uma regi\u00e3o laminar [GPWG04] ou uma\nc\u00e2mara micro-flu\u00eddica [SSY98], ou detectar e descartar imagens fora de foco [TSV+98].\n\nPara observar o pl\u00e2ncton em seu habitat natural, e coletar imagens de grandes volumes, sistemas\nhologr\u00e1ficos digitais em linha t\u00eam se mostrado promissores [SHPW07, THM+13, MAK99]. Por n\u00e3o\nutilizar lentes, a focaliza\u00e7\u00e3o \u00e9 feita numericamente ap\u00f3s a aquisi\u00e7\u00e3o da imagem e, assim, a holografia\ndigital permite superar a limita\u00e7\u00e3o da profundidade de campo e coletar imagens de volumes mai-\nores. O uso de holografia em linha simplifica o sistema hologr\u00e1fico, facilitando o seu alinhamento,\nestabiliza\u00e7\u00e3o e miniaturiza\u00e7\u00e3o, caracter\u00edsticas estas que s\u00e3o desej\u00e1veis no desenvolvimento de um\nsistema para observa\u00e7\u00e3o in situ.\n\nEntretanto, a classifica\u00e7\u00e3o autom\u00e1tica destas imagens ainda se mostra desafiadora, e artigos re-\ncentes [THM+13] realizam a classifica\u00e7\u00e3o de organismos, como cop\u00e9podes e diatom\u00e1ceas, de forma\n\n1\n\n\n\n2 INTRODU\u00c7\u00c3O 1.3\n\nvisual. Existem v\u00e1rias dificuldades devido \u00e0 alta variabilidade dos organismos. Al\u00e9m disso, estes\npodem ser observados de qualquer \u00e2ngulo, com algumas observa\u00e7\u00f5es fornecendo pouqu\u00edssima infor-\nma\u00e7\u00e3o que ajude em uma identifica\u00e7\u00e3o correta. Em alguns equipamentos, como o ZooScan, \u00e9 poss\u00edvel\najustar o posicionamento e orienta\u00e7\u00e3o dos organismos para obter a melhor imagem poss\u00edvel, mas\nesta estrutura\u00e7\u00e3o n\u00e3o pode ser feita no sistema hologr\u00e1fico utilizado neste trabalho.\n\nDentre os aspectos mais suscet\u00edveis de serem controlados e com grande influ\u00eancia na quali-\ndade da classifica\u00e7\u00e3o est\u00e1 a correta segmenta\u00e7\u00e3o e focaliza\u00e7\u00e3o do organismo, um problema que est\u00e1\nlonge de ser completamente solucionado, embora tenham sido feitos v\u00e1rios esfor\u00e7os neste sentido\n[Loo11]. Sem algoritmos confi\u00e1veis para se obter imagens bem focalizadas dos organismos, a ho-\nlografia digital perde sua vantagem mais essencial no estudo de pl\u00e2ncton. \u00c9 necess\u00e1rio, portanto,\ndesenvolver e comparar algoritmos e m\u00e9todos de focaliza\u00e7\u00e3o para que se possa aproveitar a riqueza\nde detalhes proporcionada pela holografia digital. Tamb\u00e9m \u00e9 preciso levar em conta a teoria de pro-\ncessamento digital de sinais, para obter boas reconstru\u00e7\u00f5es hologr\u00e1ficas sem artefatos provenientes\nde um processamento num\u00e9rico mal planejado, e entender melhor alguns algoritmos de focaliza\u00e7\u00e3o\ne segmenta\u00e7\u00e3o.\n\n1.2 Objetivos\n\nEste trabalho tem como objetivo o estudo das diferentes etapas necess\u00e1rias para a observa\u00e7\u00e3o\nde pl\u00e2ncton por meio de imagens de holografia digital em linha, incluindo a reconstru\u00e7\u00e3o hologr\u00e1-\nfica, focaliza\u00e7\u00e3o e segmenta\u00e7\u00e3o, e com \u00eanfase nos diversos algoritmos de processamento de imagens\nutilizados, realizando este estudo a partir das teorias da \u00d3ptica de Fourier e do Processamento\nDigital de Sinais. Tamb\u00e9m visa realizar an\u00e1lises e compara\u00e7\u00f5es dos algoritmos estudados em exem-\nplos simulados e reais, objetivando melhorar a qualidade das imagens resultantes. Esta melhoria na\nqualidade \u00e9 feita atrav\u00e9s da elimina\u00e7\u00e3o ou supress\u00e3o de artefatos que s\u00e3o provenientes do sistema\n\u00f3ptico hologr\u00e1fico e dos algoritmos de processamento de imagens, e que n\u00e3o representam adequada-\nmente a morfologia dos organismos, e atrav\u00e9s da recupera\u00e7\u00e3o de uma maior quantidade de detalhes\ndestes organismos sem que isso incorra em um custo computacional demasiadamente elevado. Com\nisso, espera-se obter imagens de alta qualidade dos organismos presentes nos hologramas digitais,\nviabilizando trabalhos futuros de classifica\u00e7\u00e3o autom\u00e1tica de pl\u00e2ncton, cuja correta identifica\u00e7\u00e3o e\ncategoriza\u00e7\u00e3o em classes mais espec\u00edficas (fine-grained categorization [KSDFF13, KJYFF15]) de-\npende do reconhecimento de estruturas e detalhes finos.\n\n1.3 Contribui\u00e7\u00f5es\n\nAs principais contribui\u00e7\u00f5es deste trabalho s\u00e3o as seguintes:\n\n\u2022 Um estudo aprofundado de algoritmos de reconstru\u00e7\u00e3o hologr\u00e1fica, com a an\u00e1lise das frequ\u00ean-\ncias presentes nas imagens e sua propaga\u00e7\u00e3o, e de detalhes de implementa\u00e7\u00e3o que afetam a\nqualidade da imagem reconstru\u00edda, decorrentes da natureza finita e discreta dos algoritmos.\n\n\u2022 Vasta compara\u00e7\u00e3o experimental de diferentes algoritmos de extens\u00e3o de borda, necess\u00e1rios\npara diminuir artefatos presentes na imagem final. \u00c9 proposto um novo algoritmo, a Mini-\nmiza\u00e7\u00e3o do Laplaciano, que \u00e9 baseado em um algoritmo presente na literatura e que obt\u00e9m\nresultados superiores a todos os outros algoritmos considerados no experimento.\n\n\u2022 Extensa compara\u00e7\u00e3o experimental de diferentes medidas de foco, utilizadas para determinar\na dist\u00e2ncia da reconstru\u00e7\u00e3o hologr\u00e1fica e obter uma imagem bem focalizada. S\u00e3o propostas\nalgumas novas medidas, incluindo a Vari\u00e2ncia Total do Gradiente Gaussiano e a Vari\u00e2ncia\ndo M\u00e1ximo Orientado da Intensidade, que obtiveram excelentes resultados na focaliza\u00e7\u00e3o de\nimagens hologr\u00e1ficas de organismos planct\u00f4nicos, com erros m\u00e9dios extremamente pequenos\ne inferiores aos de todas as outras medidas consideradas no experimento.\n\n\n\n1.4 ORGANIZA\u00c7\u00c3O DO TRABALHO 3\n\n\u2022 Desenvolvimento de um sistema web para o processamento distribu\u00eddo de imagens hologr\u00e1ficas\nde organismos planct\u00f4nicos, facilitando a aplica\u00e7\u00e3o dos resultados deste trabalho por outros\npesquisadores e contribuindo para tornar o uso de sistemas hologr\u00e1ficos uma alternativa pr\u00e1-\ntica no estudo de pl\u00e2ncton.\n\n1.4 Organiza\u00e7\u00e3o do Trabalho\n\nNo Cap\u00edtulo 2, apresentamos algumas defini\u00e7\u00f5es da \u00e1rea de Processamento Digital de Sinais,\nal\u00e9m de uma breve introdu\u00e7\u00e3o a alguns conceitos de \u00d3ptica de Fourier que ser\u00e3o utilizados ao longo\ndo texto. No Cap\u00edtulo 3, fazemos uma an\u00e1lise da propaga\u00e7\u00e3o das frequ\u00eancias na forma\u00e7\u00e3o do holo-\ngrama e na sua reconstru\u00e7\u00e3o, discutimos os diferentes algoritmos de reconstru\u00e7\u00e3o, al\u00e9m de todas as\noutras etapas do processamento destas imagens, como a localiza\u00e7\u00e3o de regi\u00f5es de interesse, focaliza-\n\u00e7\u00e3o dos organismos e segmenta\u00e7\u00e3o. No Cap\u00edtulo 4, comparamos diversos algoritmos para diminuir\no efeito de difra\u00e7\u00e3o da borda do holograma na reconstru\u00e7\u00e3o. No Cap\u00edtulo 5, comparamos algumas\nmedidas de foco utilizadas para determinar a melhor dist\u00e2ncia de reconstru\u00e7\u00e3o dos hologramas.\nNo Cap\u00edtulo 6, apresentamos o sistema desenvolvido para o processamento distribu\u00eddo de imagens\nhologr\u00e1ficas de pl\u00e2ncton. Finalmente, no Cap\u00edtulo 7 apresentamos as conclus\u00f5es e indicamos futuras\nlinhas de pesquisa.\n\nAs imagens utilizadas em um dos experimentos realizados no Cap\u00edtulo 4 est\u00e3o dispon\u00edveis no\nAp\u00eandice A. O Ap\u00eandice B apresenta algumas das imagens utilizadas no experimento do Cap\u00edtulo 5.\n\n\n\n4 INTRODU\u00c7\u00c3O 1.4\n\n\n\nCap\u00edtulo 2\n\nConceitos\n\nFaremos uma pequena revis\u00e3o de alguns conceitos de Processamento Digital de Sinais e de \u00d3ptica\nde Fourier. Estes ser\u00e3o utilizados ao longo do texto, principalmente no estudo dos algoritmos de\nreconstru\u00e7\u00e3o hologr\u00e1fica e dos processamentos digitais de imagens realizados. O foco ser\u00e1 um pouco\nmaior na \u00d3ptica de Fourier, com a qual leitores provavelmente ter\u00e3o menor familiaridade.\n\n2.1 Fundamentos de Processamento Digital de Sinais\n\nA seguir est\u00e3o algumas defini\u00e7\u00f5es da \u00e1rea de Processamento Digital de Sinais que ser\u00e3o utilizadas\nao longo do texto. \u00c9 esperada alguma familiaridade com estes conceitos, e maiores detalhes podem\nser encontrados em diversos livros da \u00e1rea [OSB+89, PV08].\n\nA transformada de Fourier (espectro de Fourier ou espectro de frequ\u00eancias) de uma fun\u00e7\u00e3o g de\nduas vari\u00e1veis independentes x, y ? C \u00e9 definida como\n\nG(fX, fY ) = F {g} =\n+?????\n??\n\ng(x, y) exp [?j2?(fXx + fY y)] dxdy,\n\nonde j =\n?\n?1. As vari\u00e1veis fX e fY normalmente ser\u00e3o chamadas de frequ\u00eancias.\n\nA transformada de Fourier inversa de uma fun\u00e7\u00e3o G de duas vari\u00e1veis independentes fX, fY ? C\n\u00e9 definida como\n\ng(x, y) = F?1 {G} =\n+?????\n??\n\nG(fX, fY ) exp [j2?(fXx + fY y)] dfXdfY .\n\nOs algoritmos para calcular a transformada de Fourier discreta e sua inversa ser\u00e3o denotados\npor FFT e IFFT, respectivamente.\n\nTeorema do Deslocamento. Se F {g(x, y)} = G(fX, fY ), ent\u00e3o\n\nF {g(x ? a, y ? b)} = G(fX, fY ) exp [?j2?(fXa + fY b)] .\n\nTeorema da Convolu\u00e7\u00e3o. Se F {g(x, y)} = G(fX, fY ) e F {h(x, y)} = H(fX, fY ), ent\u00e3o\n\nF {g ? h} = F\n\n??\n?\n\n+?????\n??\n\ng(?, ?)h(x ? ?, y ? ?)d?d?\n\n??\n? = G(fX, fY )H(fX, fY ),\n\nonde ? denota a opera\u00e7\u00e3o de convolu\u00e7\u00e3o.\nUma fun\u00e7\u00e3o g \u00e9 separ\u00e1vel nas coordenadas retangulares (x, y) se\n\ng(x, y) = gX(x)gY (y),\n\n5\n\n\n\n6 CONCEITOS 2.2\n\nonde gX(x) e gY (y) s\u00e3o fun\u00e7\u00f5es de uma vari\u00e1vel, e x e y s\u00e3o vari\u00e1veis independentes.\nSe g \u00e9 separ\u00e1vel nas coordenadas retangulares (x, y), ent\u00e3o\n\nF {g(x, y)} = FX {gX} FY {gY } ,\n\nonde FX e FY s\u00e3o as transformadas de Fourier unidimensionais nas vari\u00e1veis x e y, respectivamente.\nA fun\u00e7\u00e3o c\u00edrculo \u00e9 definida como\n\ncirc(\n??\n\nx2 + y2) =\n\n???\n??\n1 se\n\n??\nx2 + y2 &lt;1\n\n1\n2\n\nse\n??\n\nx2 + y2 = 1\n\n0 caso contr\u00e1rio.\n\nA fun\u00e7\u00e3o ret\u00e2ngulo \u00e9 definida como\n\nrect(x) =\n\n???\n??\n1 se |x| &lt;1\n\n2\n1\n2\n\nse |x| = 1\n2\n\n0 caso contr\u00e1rio.\n\nA fun\u00e7\u00e3o sinc \u00e9 definida como\n\nsinc(x) =\nsin(?x)\n\n?x\n.\n\nUm filtro passa-baixa atenua frequ\u00eancias acima de uma frequ\u00eancia de corte. A multiplica\u00e7\u00e3o no\nespectro de Fourier pela fun\u00e7\u00e3o sinc pode ser interpretada como a aplica\u00e7\u00e3o de um filtro passa-baixa,\ne corresponde \u00e0 convolu\u00e7\u00e3o pela fun\u00e7\u00e3o rect.\n\nQualquer fun\u00e7\u00e3o complexa g pode ser representada na forma\n\ng(x, y) = a(x, y) exp[j?(x, y)],\n\nonde a(x, y) \u00e9 uma distribui\u00e7\u00e3o real e n\u00e3o negativa de amplitude, e ?(x, y) \u00e9 uma distribui\u00e7\u00e3o real\nde fase.\n\nA frequ\u00eancia espacial local da fun\u00e7\u00e3o g \u00e9 o par de frequ\u00eancias\n\nflX =\n1\n\n2?\n\n?\n\n?x\n?(x, y) flY =\n\n1\n\n2?\n\n?\n\n?y\n?(x, y)\n\nAl\u00e9m disso, ambas as frequ\u00eancias locais flX e flY s\u00e3o zero por defini\u00e7\u00e3o em regi\u00f5es onde a fun\u00e7\u00e3o\ng torna-se zero. Enquanto que o espectro de Fourier permite analisar a presen\u00e7a de frequ\u00eancias em\ntoda a imagem, de forma global, as frequ\u00eancias locais permitem associar uma regi\u00e3o limitada da\nfun\u00e7\u00e3o a uma frequ\u00eancia espec\u00edfica. Isto d\u00e1 uma ideia aproximada de onde frequ\u00eancias do espectro\nde Fourier ocorrem na fun\u00e7\u00e3o, desde que as varia\u00e7\u00f5es em ?(x, y) sejam suficientemente \u201clentas\u201d.\n\n2.2 Fundamentos de \u00d3ptica de Fourier\n\nO texto a seguir \u00e9 uma breve introdu\u00e7\u00e3o \u00e0 teoria escalar de difra\u00e7\u00e3o de ondas \u00f3pticas, que \u00e9 a\nbase dos algoritmos de reconstru\u00e7\u00e3o hologr\u00e1fica. Maiores detalhes podem ser encontrados em textos\ncomo o de Goodman [Goo96], ou o de Born e Wolf [BW99].\n\n\n\n2.2 FUNDAMENTOS DE \u00d3PTICA DE FOURIER 7\n\n2.2.1 Equa\u00e7\u00f5es de Maxwell e de Helmholtz\n\nSendo uma onda eletromagn\u00e9tica, a luz obedece \u00e0s equa\u00e7\u00f5es de Maxwell. Em unidades MKS e\nna aus\u00eancia de carga livre, as equa\u00e7\u00f5es s\u00e3o\n\n? \u00d7 E = ?\u00b5\n?H\n\n?t\n\n? \u00d7 H = ?\n?E\n\n?t\n? \u00b7 ?E = 0\n? \u00b7 \u00b5H = 0\n\nonde E \u00e9 o campo el\u00e9trico, H \u00e9 o campo magn\u00e9tico, \u00b5 e ? s\u00e3o, respectivamente, a permeabilidade\ne permissividade do meio no qual a onda se propaga.\n\nNote que estas equa\u00e7\u00f5es definem campos vetoriais. Para poder desenvolver uma teoria escalar,\niremos supor que algumas propriedades s\u00e3o v\u00e1lidas no meio de propaga\u00e7\u00e3o da luz. Faremos as\nsuposi\u00e7\u00f5es de que o meio \u00e9 diel\u00e9trico, n\u00e3o magn\u00e9tico (permeabilidade igual ao v\u00e1cuo), homog\u00eaneo\n(permissividade constante), n\u00e3o dispersivo (permissividade independente dos comprimentos de onda\nsendo propagados), linear (conforme a teoria de sistemas lineares, tamb\u00e9m conhecido como princ\u00edpio\nde superposi\u00e7\u00e3o), e isotr\u00f3pico (propriedades n\u00e3o dependem da dire\u00e7\u00e3o de polariza\u00e7\u00e3o). Com isso,\n\u00e9 poss\u00edvel mostrar que todos os componentes dos campos magn\u00e9tico e el\u00e9trico se comportam da\nmesma forma, podendo ser descritos pela equa\u00e7\u00e3o de onda escalar\n\n?2u ?\nn2\n\nc2\n?2u\n\n?t2\n= 0 (2.1)\n\nonde ?2 \u00e9 o operador Laplaciano, c \u00e9 a velocidade de propaga\u00e7\u00e3o da luz no v\u00e1cuo e n \u00e9 o \u00edndice de\nrefra\u00e7\u00e3o do meio. Os valores de c e n s\u00e3o\n\nc =\n1\n\n?\n\u00b50?0\n\nn =\n\n(?\n?\n\n?0\n\n)?1\n2\n\nonde \u00b50 e ?0 s\u00e3o a permeabilidade e permissividade do v\u00e1cuo.\nUma onda monocrom\u00e1tica que obedece \u00e0 equa\u00e7\u00e3o de onda pode ser escrita, utilizando nota\u00e7\u00e3o\n\ncomplexa, por\nu(P, t) = Re {U(P) exp(?j2??t)} (2.2)\n\nonde Re{} \u00e9 a parte real, ? \u00e9 a frequ\u00eancia \u00f3ptica, e U(P) \u00e9 uma fun\u00e7\u00e3o complexa de posi\u00e7\u00e3o,\n\nU(P) = A(P) exp(?j?(P))\n\nonde A(P) e ?(P) s\u00e3o a amplitude e a fase na posi\u00e7\u00e3o P , respectivamente. Definiremos o formato\nda onda como sendo o formato de uma superf\u00edcie de fase constante.\n\nA fun\u00e7\u00e3o complexa U(P) ser\u00e1 utilizada para descrever as ondas estudadas, j\u00e1 que a oscila\u00e7\u00e3o\nexp(?j2??t) \u00e9 r\u00e1pida demais para ser detectada pelos instrumentos. Substituindo a equa\u00e7\u00e3o 2.2 na\nequa\u00e7\u00e3o 2.1, chegamos na equa\u00e7\u00e3o de Helmholtz\n\n?2U + k2U = 0. (2.3)\n\nO valor k \u00e9 o n\u00famero de onda definido por\n\nk = 2?n\n?\n\nc\n=\n\n2?\n\n?\n,\n\n\n\n8 CONCEITOS 2.2\n\nonde ? \u00e9 o comprimento de onda no meio diel\u00e9trico e ? = c/n?.\n\n2.2.2 M\u00e9todo do espectro angular\n\nO nome desta abordagem deve-se \u00e0 interpreta\u00e7\u00e3o da decomposi\u00e7\u00e3o de Fourier de um campo U\ncomo uma soma de ondas planas propagando-se em diferentes dire\u00e7\u00f5es, e maiores detalhes deste\nponto de vista podem ser encontrados em Goodman [Goo96]. Suponha que uma onda monocrom\u00e1-\ntica incidente no plano (x, y) propaga-se na dire\u00e7\u00e3o z. Seja U(x, y, 0) o campo complexo no plano\nz = 0; queremos encontrar o campo U(x, y, z) que est\u00e1 a uma dist\u00e2ncia z do primeiro plano. Pode-\nmos escrever este segundo plano como a transformada inversa de Fourier de seu espectro A(x, y; z),\nou seja,\n\nU(x, y, z) =\n\n+?????\n??\n\nA(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY . (2.4)\n\nAl\u00e9m disso, em todos os pontos que n\u00e3o s\u00e3o fonte, U precisa satisfazer a equa\u00e7\u00e3o de Helmholtz\n2.3, ou seja,\n\n?2\n+?????\n??\n\nA(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY\n\n+ k2\n+?????\n??\n\nA(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY = 0.\n\nUsando as equa\u00e7\u00f5es\n\nd2\n\ndz2\n(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = exp[j2?(fXx + fY y)]\n\nd2\n\ndz2\nA(fX, fY ; z)\n\nd2\n\ndx2\n(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = ?(2?fX)2A(fX, fY ; z) exp[j2?(fXx + fY y)]\n\nd2\n\ndy2\n(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = ?(2?fY )2A(fX, fY ; z) exp[j2?(fXx + fY y)]\n\ntemos\n\n+?????\n??\n\n(?\nd2\n\ndz2\nA(fX, fY ; z)\n\n+\n[?\n(2?)2[?(fX)2 ? (fY )2] + k2\n\n]?\nA(fX, fY ; z)\n\n)?\nexp[j2?(fXx + fY y)]dfXdfY = 0\n\n+?????\n??\n\n(?\nd2\n\ndz2\nA(fX, fY ; z)\n\n+\n\n(?\n2?\n\n?\n\n)?2\n[1 ? (?fX)2 ? (?fY )2]A(fX, fY ; z)\n\n)?\nexp[j2?(fXx + fY y)]dfXdfY = 0.\n\nNote que, como a equa\u00e7\u00e3o est\u00e1 no formato da transformada inversa de Fourier, podemos calcular\na transformada de Fourier para chegar na equa\u00e7\u00e3o diferencial\n\nd2\n\ndz2\nA(fX, fY ; z) +\n\n(?\n2?\n\n?\n\n)?2\n[1 ? (?fX)2 ? (?fY )2]A(fX, fY ; z) = 0.\n\n\n\n2.2 FUNDAMENTOS DE \u00d3PTICA DE FOURIER 9\n\nUma solu\u00e7\u00e3o elementar \u00e9\n\nA(fX, fY ; z) = A(fX, fY ; 0) exp\n\n(?\nj\n2?\n\n?\n\n??\n1 ? (?fX)2 ? (?fY )2z\n\n)?\n.\n\nNote que, quando (?fX)2 + (?fY )2 > 1, podemos reescrever a solu\u00e7\u00e3o como\n\nA(fX, fY ; z) = A(fX, fY ; 0) exp (?\u00b5z)\n\nonde\n\u00b5 =\n\n2?\n\n?\n\n??\n(?fX)2 + (?fY )2 ? 1.\n\nComo \u00b5 \u00e9 um n\u00famero real positivo, estes componentes s\u00e3o rapidamente atenuados devido ao termo\nexp (?\u00b5z). Eles s\u00e3o conhecidos como ondas evanescentes e podem ser desconsiderados caso a dis-\nt\u00e2ncia de propaga\u00e7\u00e3o z seja superior a alguns comprimentos de onda. Portanto, limitaremos a regi\u00e3o\ndo espectro de Fourier com a fun\u00e7\u00e3o circ para eliminar estes componentes.\n\nChegamos ent\u00e3o na equa\u00e7\u00e3o\n\nA(fX, fY ; z) = A(fX, fY ; 0) circ(\n??\n\n(?fX)2 + (?fY )2) exp\n\n[?\nj\n2?\n\n?\nz\n??\n1 ? (?fX)2 ? (?fY )2\n\n]?\nda qual podemos obter a fun\u00e7\u00e3o\n\nH(fX, fY ) =\n\n??\n?exp\n\n[?\nj 2?\n\n?\nz\n??\n\n1 ? (?fX)2 ? (?fY )2\n]?\n\nse\n??\n\nf2X + f\n2\nY ?\n\n1\n?\n\n0 caso contr\u00e1rio\n(2.5)\n\nA fun\u00e7\u00e3o H \u00e9 chamada fun\u00e7\u00e3o de transfer\u00eancia, e relaciona a \u201centrada\u201d U(x, y, 0) \u00e0 \u201csa\u00edda\u201d U(x, y, z)\nem termos das frequ\u00eancias espaciais A(fX, fY ; z).\n\nNote que nenhuma frequ\u00eancia superior a ??1 \u00e9 preservada, e portanto n\u00e3o \u00e9 poss\u00edvel identificar\nestruturas com um per\u00edodo menor do que o comprimento de onda usado.\n\n2.2.3 Aproxima\u00e7\u00e3o de Fresnel\n\nSuponha que uma abertura, ou seja, algo que bloqueia a luz fora de uma determinada regi\u00e3o, est\u00e1\nlocalizada no plano (?, ?) e \u00e9 iluminada na dire\u00e7\u00e3o positiva z. Queremos calcular o campo no plano\n(x, y), que \u00e9 paralelo ao plano (?, ?) e est\u00e1 \u00e0 dist\u00e2ncia z deste. O eixo z passa pela origem de ambos\nos planos. Segundo o princ\u00edpio de Huygens-Fresnel e a f\u00f3rmula de difra\u00e7\u00e3o de Rayleigh-Sommerfeld,\n\nU(x, y) =\nz\n\nj?\n\n+?????\n??\n\nU(?, ?)\nexp(jkr01)\n\nr201\nd?d?,\n\nonde r01 \u00e9 a dist\u00e2ncia\nr01 =\n\n??\nz2 + (x ? ?)2 + (y ? ?)2.\n\nAt\u00e9 agora supusemos as condi\u00e7\u00f5es da teoria escalar e que r01 ? ?. Podemos aproximar r01\nmovendo z para fora da raiz, e usar a expans\u00e3o binomial para obter\n\nr01 ? z\n\n[?\n1 +\n\n1\n\n2\n\n(?\nx ? ?\nz\n\n)?2\n+\n\n1\n\n2\n\n(?\ny ? ?\nz\n\n)?2]?\n.\n\n\n\n10 CONCEITOS 2.2\n\nNo denominador, aproximamos r01 por z apenas. Com isso, a equa\u00e7\u00e3o para o campo em (x, y) \u00e9\n\nU(x, y) =\nejkz\n\nj?z\n\n+?????\n??\n\nU(?, ?) exp\n\n(?\nj\nk\n\n2z\n[(x ? ?)2 + (y ? ?)2]\n\n)?\nd?d?. (2.6)\n\nEsta equa\u00e7\u00e3o pode ser interpretada como a convolu\u00e7\u00e3o de U(?, ?) por\n\nh(x, y) =\nejkz\n\nj?z\nexp\n\n[?\nj\nk\n\n2z\n(x2 + y2)\n\n]?\n.\n\nCalculando analiticamente a transformada de Fourier de h(x, y),\n\nH(fX, fY ) = F\n{?\nejkz\n\nj?z\nexp\n\n[?\nj\n?\n\n?z\n(x2 + y2)\n\n]?}?\n(2.7)\n\n= ejkz exp\n[?\n?j??z(f2X + f\n\n2\nY )\n]?\n. (2.8)\n\nEsta fun\u00e7\u00e3o de transfer\u00eancia \u00e9 uma aproxima\u00e7\u00e3o da fun\u00e7\u00e3o 2.5, utilizando a expans\u00e3o binomial\n\n??\n1 ? (?fX)2 ? (?fY )2 ? 1 ?\n\n(?fX)\n2\n\n2\n?\n\n(?fY )\n2\n\n2\n,\n\nque \u00e9 v\u00e1lida quando |?fX| ? 1 e |?fY | ? 1. Isto ocorre com pequenos \u00e2ngulos de difra\u00e7\u00e3o, ou seja,\nquando x, y, ?, ? ? z. Esta aproxima\u00e7\u00e3o \u00e9 conhecida como aproxima\u00e7\u00e3o de Fresnel ou aproxima\u00e7\u00e3o\nparaxial.\n\nReescrevendo a equa\u00e7\u00e3o 2.6, obtemos\n\nU(x, y) =\nejkz\n\nj?z????\n1\n\nej\nk\n2z\n\n(x2+y2)? ?? ?\n2\n\n+?????\n??\n\nU(?, ?)\n\n4? ?? ?\nej\n\nk\n2z\n\n(?2+?2) e?j\n2?\n?z\n\n(x?+y?)d?d?\n\n? ?? ?\n3\n\n. (2.9)\n\nO termo (1) apenas altera a amplitude e fase globalmente, enquanto que o (2) altera somente\na fase, e normalmente podem ser desconsiderados. J\u00e1 o termo (3) pode ser interpretado como uma\ntransformada de Fourier, e o (4) \u00e9 uma exponencial de fase quadr\u00e1tica (fun\u00e7\u00e3o chirp).\n\n\n\nCap\u00edtulo 3\n\nProcessamento de hologramas de\npl\u00e2ncton\n\nNeste cap\u00edtulo iremos fazer uma breve an\u00e1lise da forma\u00e7\u00e3o e reconstru\u00e7\u00e3o de imagens holo-\ngr\u00e1ficas, e estudar as diversas etapas de processamento que s\u00e3o necess\u00e1rias para obter imagens\nindividuais dos organismos planct\u00f4nicos, permitindo sua identifica\u00e7\u00e3o. Ser\u00e3o analisados alguns al-\ngoritmos de reconstru\u00e7\u00e3o hologr\u00e1fica, a localiza\u00e7\u00e3o e focaliza\u00e7\u00e3o de organismos em um holograma,\ne sua posterior segmenta\u00e7\u00e3o.\n\n3.1 Holografia\n\nHolografia \u00e9 a t\u00e9cnica de gravar e reconstruir a amplitude e a fase de um objeto, utilizando\nilumina\u00e7\u00e3o coerente. Denotaremos por reconstru\u00e7\u00e3o ou propaga\u00e7\u00e3o o processo de obter a amplitude\ne fase de uma onda em outro(s) plano(s), o que pode ser feito numericamente ou com instrumentos\n\u00f3pticos, como ilustrado na figura 3.1. Meios de grava\u00e7\u00e3o, incluindo filmes fotogr\u00e1ficos e sensores\ndigitais, respondem apenas \u00e0 intensidade da luz, que \u00e9 proporcional a |U(P)|2, onde U(P) \u00e9 a\nrepresenta\u00e7\u00e3o complexa utilizada anteriormente na discuss\u00e3o sobre a difra\u00e7\u00e3o de ondas. Portanto,\na informa\u00e7\u00e3o da fase precisa ser gravada como intensidade, caso contr\u00e1rio ela ser\u00e1 completamente\nperdida. Para isso, grava-se a interfer\u00eancia entre a onda do objeto e uma segunda onda, coerente\ncom a primeira e com amplitude e fase conhecidas.\n\nNeste trabalho utilizamos imagens digitais de hologramas de Gabor, criadas com o sistema\nhologr\u00e1fico em linha que pode ser visto na figura 3.2. A vantagem da holografia digital est\u00e1 na\nfacilidade de cria\u00e7\u00e3o, armazenamento, reconstru\u00e7\u00e3o e processamento, n\u00e3o sendo preciso realizar\ntarefas como processar quimicamente os filmes ou fazer reconstru\u00e7\u00f5es \u00f3pticas manualmente. Um dos\nmotivos para utilizar hologramas de Gabor na observa\u00e7\u00e3o de pl\u00e2ncton \u00e9 a baixa resolu\u00e7\u00e3o espacial\nem hologramas digitais, se comparada \u00e0 de filmes hologr\u00e1ficos. Isto n\u00e3o permite a utiliza\u00e7\u00e3o de\noutras t\u00e9cnicas que envolvem o uso de um feixe de refer\u00eancia em um \u00e2ngulo com o holograma, o\nque criaria franjas de interfer\u00eancia com frequ\u00eancias espaciais mais altas do que seria poss\u00edvel gravar\n\n(a) Grava\u00e7\u00e3o do holograma (b) Reconstru\u00e7\u00e3o \u00f3ptica\n\nFigura 3.1: Grava\u00e7\u00e3o e reconstru\u00e7\u00e3o de holograma.\n\n11\n\n\n\n12 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.1\n\nFigura 3.2: Sistema hologr\u00e1fico utilizado nos experimentos. A ilumina\u00e7\u00e3o proveniente de um laser \u00e9 filtrada\nespacialmente, para remover frequ\u00eancias indesejadas, e depois \u00e9 expandida e colimada, formando uma onda\naproximadamente plana que atravessa a amostra e \u00e9 registrada por uma c\u00e2mera. (Imagem fornecida pelo\nLAPS - IO\u2013USP)\n\ncom um sensor digital.\nUm holograma de Gabor \u00e9 obtido quando um objeto altamente transparente \u00e9 iluminado por\n\numa onda colimada coerente. Suponha que o objeto possua transmiss\u00e3o de amplitude\n\nt(xo, yo) = to + ?t(xo, yo),\n\nonde to \u00e9 a m\u00e9dia de transmiss\u00e3o e ?t s\u00e3o as varia\u00e7\u00f5es desta m\u00e9dia, e\n\n|?t| ? |to|. (3.1)\n\nAo ser iluminado pela onda colimada coerente, a luz transmitida ser\u00e1 composta por uma onda plana\nforte, devido ao termo to, e uma onda dispersa fraca devido ao termo ?t(xo, yo). A intensidade\ngravada \u00e0 dist\u00e2ncia zo do objeto \u00e9\n\nI(x, y) = |A + a(x, y)|2\n\n= |A|2 + |a(x, y)|2 + A?a(x, y) + Aa?(x, y),\n\nonde A \u00e9 a amplitude da onda plana e a(x, y) \u00e9 a amplitude da onda dispersa no plano de grava\u00e7\u00e3o.\nSupondo que o meio de grava\u00e7\u00e3o responde linearmente \u00e0 intensidade, a amplitude gravada \u00e9\n\ntA(x, y) = tb + ?\n?(|a(x, y)|2 + A?a(x, y) + Aa?(x, y)), (3.2)\n\nonde tb e ?? s\u00e3o constantes. Iluminando o holograma por uma onda plana com amplitude uniforme\n\n\n\n3.1 HOLOGRAFIA 13\n\nB, o campo transmitido \u00e9\n\nBtA(x, y) = Btb????\nU1\n\n+ ??B|a(x, y)|2? ?? ?\nU2\n\n+ ??A?Ba(x, y)? ?? ?\nU3\n\n+ ??ABa?(x, y)? ?? ?\nU4\n\n. (3.3)\n\nO primeiro termo U1 \u00e9 uma onda plana com amplitude uniforme. O segundo termo U2 pode ser\nignorado usando a hip\u00f3tese da f\u00f3rmula 3.1, que implica em |a(x, y)| ? A. O terceiro termo U3 \u00e9\numa duplica\u00e7\u00e3o exata da frente de onda a(x, y), a menos de um fator constante, e aparenta originar\nde uma imagem virtual a uma dist\u00e2ncia zo do holograma. Similarmente, o termo U4 \u00e9 proporcional\na a?(x, y), e leva \u00e0 forma\u00e7\u00e3o de uma imagem real \u00e0 dist\u00e2ncia zo no lado oposto do holograma. Com\nisso, vemos que o holograma de Gabor gera duas imagens da varia\u00e7\u00e3o de transmiss\u00e3o ?t, separadas\npor uma dist\u00e2ncia axial 2zo, e acompanhadas de um fundo coerente U1 e um halo U2.\n\nNa holografia de pl\u00e2ncton, podemos supor a hip\u00f3tese da f\u00f3rmula 3.1, pois quase a totalidade\ndo volume sendo imageado estar\u00e1 vazio, preenchido apenas com \u00e1gua, e somente alguns poucos\norganismos pequenos ir\u00e3o difratar a onda de luz sendo transmitida. Um estudo sobre o efeito de\ngrandes quantidades de part\u00edculas na qualidade da reconstru\u00e7\u00e3o pode ser encontrado na tese de\ndoutorado de Loomis [Loo11]. Al\u00e9m disso, normalmente as imagens g\u00eameas U3 e U4 poderiam ser\nproblem\u00e1ticas, pois a reconstru\u00e7\u00e3o de uma delas \u00e9 acompanhada pela outra imagem desfocada.\nPor\u00e9m, como os organismos observados s\u00e3o muito pequenos em rela\u00e7\u00e3o \u00e0 dist\u00e2ncia da c\u00e2mera, a\nimagem g\u00eamea aparece extremamente desfocada e normalmente n\u00e3o interfere na correta visualiza\u00e7\u00e3o\nda imagem reconstru\u00edda. Esta imagem g\u00eamea s\u00f3 come\u00e7a a causar problemas quando a quantidade\nde pl\u00e2ncton \u00e9 muito elevada, ou os organismos s\u00e3o grandes.\n\n3.1.1 Remo\u00e7\u00e3o de fundo\n\nPodemos calcular o fundo tb da equa\u00e7\u00e3o 3.2 e subtra\u00ed-lo do holograma gravado, melhorando a\nreconstru\u00e7\u00e3o ao eliminar o termo U1 da equa\u00e7\u00e3o 3.3. Isto pode ser feito de v\u00e1rias formas, como por\nexemplo modelando o feixe transmitido, ou subtraindo uma m\u00e9dia global ou local da imagem.\n\nUma vantagem de remover o fundo \u00e9 que, embora tenhamos suposto que a onda de refer\u00eancia\npossui intensidade constante no plano do holograma, na pr\u00e1tica ela pode variar de acordo com\na posi\u00e7\u00e3o, e nos experimentos feitos ela segue uma distribui\u00e7\u00e3o de intensidade aproximadamente\ngaussiana, com centro pr\u00f3ximo ao da imagem, devido ao laser e configura\u00e7\u00e3o \u00f3ptica utilizados.\nSem o fundo, a ilumina\u00e7\u00e3o torna-se praticamente uniforme, facilitando processamentos posteriores.\nRemov\u00ea-lo tamb\u00e9m acaba melhorando a qualidade da imagem ao subtrair padr\u00f5es de interfer\u00eancia\nindesejados, provenientes de imperfei\u00e7\u00f5es no sistema \u00f3ptico, como part\u00edculas de poeira. Ap\u00f3s re-\nmover o fundo, a imagem \u00e9 linearmente normalizada para que ocupe todo o intervalo [0, 255]. Isso\nacaba adicionando um termo constante em toda a imagem, o que facilita sua visualiza\u00e7\u00e3o, mas pode\ntrazer problemas se n\u00e3o for feito um tratamento adequado da borda, conforme ser\u00e1 discutido em\numa se\u00e7\u00e3o posterior e com mais detalhes no Cap\u00edtulo 4.\n\nDurante os experimentos que foram realizados, foram testadas duas maneiras de se obter a\nimagem de fundo. A primeira consistiu na obten\u00e7\u00e3o de uma sequ\u00eancia curta de imagens antes da\ncoloca\u00e7\u00e3o da amostra a ser observada. Com isto, \u00e9 poss\u00edvel calcular uma imagem m\u00e9dia de fundo,\nque \u00e9 subtra\u00edda das imagens obtidas ap\u00f3s a coloca\u00e7\u00e3o da amostra. A maior dificuldade desta t\u00e9cnica\nconsiste na fixa\u00e7\u00e3o dos componentes. Na pr\u00e1tica, ao capturar estas imagens em laborat\u00f3rio, \u00e9 preciso\ncolocar uma amostra de \u00e1gua do mar filtrada, e s\u00f3 depois substitu\u00ed-la pela amostra de interesse.\nNesta substitui\u00e7\u00e3o, muitas vezes o recipiente acaba sendo levemente movido, o que \u00e9 suficiente\npara mudar completamente o fundo do holograma. Embora ainda n\u00e3o tenha sido testada em um\nequipamento in situ, \u00e9 poss\u00edvel que outras dificuldades apare\u00e7am. Alguns detritos podem grudar\nnos vidros externos, prejudicando a qualidade da imagem. Caso o fundo seja calculado previamente,\neles n\u00e3o ser\u00e3o parcialmente removidos junto com o fundo. O fundo tamb\u00e9m pode ser influenciado\npela profundidade sendo amostrada, alterando a propor\u00e7\u00e3o da ilumina\u00e7\u00e3o laser que \u00e9 absorvida pela\n\u00e1gua e a intensidade da ilumina\u00e7\u00e3o solar que pode chegar na c\u00e2mera.\n\nA outra t\u00e9cnica testada consiste no c\u00e1lculo do fundo a partir dos hologramas obtidos das amos-\n\n\n\n14 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.1\n\n(a) Holograma original (b) Holograma sem fundo\n\nFigura 3.3: Exemplo de remo\u00e7\u00e3o de fundo de um holograma utilizando a m\u00e9dia de v\u00e1rios hologramas.\n\ntras. Caso existam hologramas suficientes, \u00e9 poss\u00edvel calcular uma simples m\u00e9dia a partir de uma\nsele\u00e7\u00e3o grande (maior do que 50, por exemplo) dos hologramas, preferencialmente com organismos\nocupando posi\u00e7\u00f5es diferentes da imagem, e utiliz\u00e1-la como fundo. Um exemplo do resultado desta\nt\u00e9cnica pode ser visto na figura 3.3. Caso a quantidade de hologramas dispon\u00edveis para o c\u00e1lculo\nseja pequena (como 30 imagens no total, por exemplo), a m\u00e9dia de intensidade de cada pixel pode\nser feita desconsiderando uma certa porcentagem (obtida experimentalmente) dos valores mais ex-\ntremos, com o objetivo de ignorar grande parte dos pixels que representam a interfer\u00eancia de algum\norganismo em movimento. Isto sup\u00f5e que, embora existam poucas imagens, elas s\u00e3o suficientemente\ndiferentes umas das outras, n\u00e3o havendo nenhuma regi\u00e3o que \u00e9 ocupada por organismos na maior\nparte dos hologramas.\n\nUm exemplo de subtra\u00e7\u00e3o da m\u00e9dia local em blocos, para uniformizar a ilumina\u00e7\u00e3o do holo-\ngrama, pode ser encontrado na disserta\u00e7\u00e3o de mestrado de Dom\u00ednguez-Caballero [DC06]. A des-\nvantagem \u00e9 que os padr\u00f5es de interfer\u00eancia indesejados n\u00e3o s\u00e3o minimizados, e a ilumina\u00e7\u00e3o realiza\npequenos saltos de um bloco para outro. Isto fez com que, na disserta\u00e7\u00e3o citada, esta imagem sem\nfundo tenha sido utilizada apenas para realizar uma segmenta\u00e7\u00e3o inicial, n\u00e3o sendo utilizada nas\nreconstru\u00e7\u00f5es dos segmentos.\n\n3.1.2 Algoritmos de reconstru\u00e7\u00e3o\n\nTradicionalmente, a reconstru\u00e7\u00e3o hologr\u00e1fica \u00e9 feita iluminando o holograma por uma onda\nigual ao feixe de refer\u00eancia utilizado, embora alguns tipos de holograma permitam outras formas de\nilumina\u00e7\u00e3o, como luz branca. Em holografia digital, a ilumina\u00e7\u00e3o do holograma e sua observa\u00e7\u00e3o \u00e9\nfeita numericamente, calculando-se o efeito de difra\u00e7\u00e3o que a onda sofreria ao passar pelo holograma.\n\nAp\u00f3s a remo\u00e7\u00e3o do fundo, e supondo que o termo U2 pode ser ignorado, conforme discutido\nanteriormente, ao iluminar o holograma por uma onda plana B o campo resultante \u00e9\n\nEB = ?\n?A?Ba(x, y) + ??ABa?(x, y).\n\n= U3 + U4.\n\nComo estamos iluminando por uma onda plana B qualquer, podemos escolher os par\u00e2metros desta\nonda da forma que for mais conveniente, com a \u00fanica restri\u00e7\u00e3o de que a amplitude deve ser estrita-\nmente maior do que zero. Ou seja, podemos supor que, em todo o plano (x, y), ela possui amplitude\nigual a 1 e fase igual a 0, o que significa que iluminar o holograma por B consiste em multiplic\u00e1-lo\npor 1. Portanto, esta opera\u00e7\u00e3o pode ser ignorada, e utilizamos os valores originais do holograma\ncomo sendo o holograma iluminado por uma onda plana. Caso estiv\u00e9ssemos utilizando uma onda\nesf\u00e9rica, por exemplo, isto n\u00e3o seria poss\u00edvel, pois a fase da onda seria diferente dependendo da\n\n\n\n3.1 HOLOGRAFIA 15\n\n(a) Magnitude (b) Parte Real (c) Parte Imagin\u00e1ria (d) Fase\n\nFigura 3.4: Reconstru\u00e7\u00e3o de um organismo de amplitude.\n\n(a) Magnitude (b) Parte Real (c) Parte Imagin\u00e1ria (d) Fase\n\nFigura 3.5: Reconstru\u00e7\u00e3o de um organismo de fase.\n\nposi\u00e7\u00e3o no holograma.\nPara obter a onda a(x, y) do objeto focalizada, ainda precisamos propagar a onda \u00e0 dist\u00e2ncia\n\nzo, pois estamos no plano do holograma e queremos a onda no plano do objeto. Esta propaga\u00e7\u00e3o \u00e9\nfeita numericamente utilizando as f\u00f3rmulas de difra\u00e7\u00e3o presentes na se\u00e7\u00e3o 2.2, como ser\u00e1 detalhado\nabaixo. Ap\u00f3s realizar esta propaga\u00e7\u00e3o, obtemos a soma da imagem do objeto com sua imagem\ndesfocada a uma dist\u00e2ncia 2zo, cada uma correspondendo a um dos termos U3 e U4.\n\nO resultado da propaga\u00e7\u00e3o \u00e9 uma matriz de n\u00fameros complexos E(x, y; zo), a partir da qual\npodemos calcular a magnitude\n\nI = |E|,\n\na intensidade que seria observada opticamente\n\nI = |E|2,\n\ne a fase ? a partir de\n\ntan[?] =\nIm[E]\n\nRe[E]\n\nNas figuras 3.4 e 3.5 podem ser vistos exemplos do resultado desta propaga\u00e7\u00e3o.\nA seguir apresentamos a Reconstru\u00e7\u00e3o pela Integra\u00e7\u00e3o de Fresnel e a Reconstru\u00e7\u00e3o por Convo-\n\nlu\u00e7\u00e3o, que s\u00e3o formas diferentes de utilizar as f\u00f3rmulas da se\u00e7\u00e3o 2.2 para calcular a propaga\u00e7\u00e3o da\nonda a uma dist\u00e2ncia z.\n\nReconstru\u00e7\u00e3o pela Integra\u00e7\u00e3o de Fresnel\n\nFazendo as substitui\u00e7\u00f5es\n\n? =\nx\n\n?z\n\u00b5 =\n\ny\n\n?z\n(3.4)\n\n\n\n16 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.1\n\nna equa\u00e7\u00e3o 2.9, temos\n\nU(?, \u00b5) =\n?j\n?z\n\nej??z(?\n2+\u00b52)\n\n+?????\n??\n\n1? ?? ?\nU(?, ?)ej\n\n?\n?z\n\n(?2+?2) e?j2?(??+\u00b5?)d?d?\n\n? ?? ?\n2\n\n,\n\nonde omitimos o fator ejkz, pois s\u00f3 altera a fase globalmente. O termo (2) \u00e9 a transformada de\nFourier do termo (1), ou seja,\n\nU(?, \u00b5) =\n?j\n?z\n\nej??z(?\n2+\u00b52)F\n\n{?\nU(?, ?)ej\n\n?\n?z\n\n(?2+?2)\n}?\n.\n\nPortanto, podemos reconstruir o holograma a uma dist\u00e2ncia z calculando [SJ02]\n\nIrec = d \u00b7 FFT(Iholo \u00b7 c),\n\nonde \u00b7 representa a multiplica\u00e7\u00e3o ponto a ponto, Iholo \u00e9 a imagem do holograma, e\n\nc(?, ?) = ej\n?\n?z\n\n(?2+?2) d(?, \u00b5) =\n?j\n?z\n\nej??z(?\n2+\u00b52).\n\nPodemos ignorar o termo d se n\u00e3o estivermos interessados na fase.\nAs seguintes rela\u00e7\u00f5es s\u00e3o v\u00e1lidas na transformada de Fourier para as dimens\u00f5es dos pixels ?? e\n\n?? no holograma original:\n\n?? =\n1\n\nM??\n?\u00b5 =\n\n1\n\nN??\n,\n\nonde M e N s\u00e3o o n\u00famero de pixels em cada eixo. Ap\u00f3s refazermos a substitui\u00e7\u00e3o da equa\u00e7\u00e3o 3.4,\n\n?x =\n?z\n\nM??\n?y =\n\n?z\n\nN??\n\nPodemos ver que o tamanho ?x do pixel na reconstru\u00e7\u00e3o n\u00e3o \u00e9 necessariamente igual ao tama-\nnho ?? do pixel no holograma, podendo ser maior ou menor dependendo da dist\u00e2ncia da recons-\ntru\u00e7\u00e3o. Por causa disto, este algoritmo n\u00e3o \u00e9 utilizado para calcular propaga\u00e7\u00f5es a dist\u00e2ncias muito\npequenas.\n\nPara manter o tamanho do pixel aproximadamente constante, pode-se aumentar a imagem com\nzeros, alterando com isso os valores de M e N e as dimens\u00f5es de ?x e ?y. Por\u00e9m, isso aumenta\no custo computacional consideravelmente, n\u00e3o sendo pr\u00e1tico a dist\u00e2ncias um pouco maiores. Como\nexemplo, se estivermos calculando uma reconstru\u00e7\u00e3o com ? = 660nm, ?x = 3, 45\u00b5m e z = 15cm,\nprecisar\u00edamos ter M ? 8317 pixels.\n\nUma outra maneira de manter as dimens\u00f5es dos pixels \u00e9 atrav\u00e9s do c\u00e1lculo do espectro apenas\ndas frequ\u00eancias mais baixas, utilizando o algoritmo conhecido como Chirp Z-Transform [RSR69],\ncujo resultado \u00e9 ilustrado na figura 3.6. Por\u00e9m, isto envolve o c\u00e1lculo de uma convolu\u00e7\u00e3o entre matri-\nzes de n\u00fameros complexos, eliminando assim a principal vantagem deste algoritmo de reconstru\u00e7\u00e3o\nhologr\u00e1fica, que \u00e9 a efici\u00eancia obtida com o c\u00e1lculo de uma \u00fanica FFT.\n\nReconstru\u00e7\u00e3o por Convolu\u00e7\u00e3o\n\n\u00c9 poss\u00edvel reconstruir o holograma realizando a convolu\u00e7\u00e3o pela fun\u00e7\u00e3o h(x, y), obtida na discus-\ns\u00e3o sobre difra\u00e7\u00e3o escalar, e que depende dos par\u00e2metros do experimento e a dist\u00e2ncia de propaga\u00e7\u00e3o\nescolhida. Como \u00e9 poss\u00edvel calcular a transformada de Fourier de h(x, y) analiticamente, iremos uti-\nlizar a matriz H(x, y) resultante, o que evita computa\u00e7\u00f5es desnecess\u00e1rias. O c\u00e1lculo da reconstru\u00e7\u00e3o\n\n\n\n3.1 HOLOGRAFIA 17\n\n(a) Reconstru\u00e7\u00e3o padr\u00e3o (b) Reconstru\u00e7\u00e3o com Chirp Z-Transform\n\nFigura 3.6: Reconstru\u00e7\u00e3o hologr\u00e1fica pelo algoritmo da Integra\u00e7\u00e3o de Fresnel. Como o holograma original\npossu\u00eda diferentes n\u00fameros de pixels nos dois eixos, isto resulta em diferentes dimens\u00f5es dos pixels na\nreconstru\u00e7\u00e3o padr\u00e3o. Estas imagens exibem apenas a regi\u00e3o central da reconstru\u00e7\u00e3o de um padr\u00e3o de teste\nde resolu\u00e7\u00e3o 1951 USAF, a cerca de 15,6 cm de dist\u00e2ncia.\n\nIrec \u00e0 dist\u00e2ncia z, utilizando o holograma Iholo e a fun\u00e7\u00e3o de transfer\u00eancia H, \u00e9\n\nIrec = IFFT(FFT(Iholo) \u00b7 H),\n\nonde \u00b7 representa a multiplica\u00e7\u00e3o ponto a ponto. Embora pare\u00e7a simples, existem alguns detalhes\nde implementa\u00e7\u00e3o importantes que ser\u00e3o mencionados na se\u00e7\u00e3o 3.2. Se desejarmos calcular diversas\ndist\u00e2ncias de propaga\u00e7\u00e3o do mesmo holograma, podemos guardar o resultado de FFT(Iholo) e exe-\ncutar apenas os c\u00e1lculos restantes. Desta forma calculamos a transformada de Fourier do holograma\numa \u00fanica vez, e cada reconstru\u00e7\u00e3o posterior necessita apenas do c\u00e1lculo da fun\u00e7\u00e3o H e de uma\ntransformada inversa de Fourier.\n\nA partir das f\u00f3rmulas da se\u00e7\u00e3o 2.2, temos as fun\u00e7\u00f5es de transfer\u00eancia\n\nHe(fX, fY ) =\n\n??\n?exp\n\n[?\njkz\n??\n\n1 ? (?fX)2 ? (?fY )2\n]?\n\nse\n??\nf2X + f\n\n2\nY ?\n\n1\n?\n\n0 caso contr\u00e1rio\n(3.5)\n\nHf(fX, fY ) = e\njkz exp\n\n[?\n?j??z(f2X + f\n\n2\nY )\n]?\n\n(3.6)\n\nonde He \u00e9 a fun\u00e7\u00e3o de transfer\u00eancia \u201cexata\u201d obtida no m\u00e9todo do espectro angular, e Hf \u00e9 a\naproxima\u00e7\u00e3o de Fresnel. N\u00e3o existe diferen\u00e7a significativa entre o resultado obtido a partir das\nduas fun\u00e7\u00f5es, exceto em dist\u00e2ncias extremamente pequenas ou em casos em que as dist\u00e2ncias\nlaterais n\u00e3o s\u00e3o pequenas em rela\u00e7\u00e3o \u00e0 dist\u00e2ncia axial, conforme j\u00e1 foi estudado em diversos artigos\n[Sou81, SR89, MH03]. A aproxima\u00e7\u00e3o de Fresnel pode resultar em uma computa\u00e7\u00e3o mais r\u00e1pida,\npor n\u00e3o exigir o c\u00e1lculo de uma raiz quadrada, e o termo ejkz pode ser ignorado, pois podemos\nsupor que estamos iluminando o holograma com uma onda plana da forma e?jkz, o que cancelaria\neste termo.\n\n\n\n18 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.1\n\n3.1.3 Captura e propaga\u00e7\u00e3o das frequ\u00eancias em holografia digital\n\nPara visualizar os efeitos da propaga\u00e7\u00e3o num\u00e9rica do holograma, iremos analisar separadamente\nfrequ\u00eancias da forma\n\nufx = rect\n(?x\nL\n\n)?\nexp(j2?xfx),\n\nonde L \u00e9 a largura do holograma e fx \u00e9 a frequ\u00eancia sendo estudada. No caso de hologramas digitais,\nL \u00e9 a largura do sensor da c\u00e2mera referente \u00e0 regi\u00e3o do holograma sendo reconstru\u00edda. Limitar-\nnos-emos ao caso unidimensional, j\u00e1 que as duas dimens\u00f5es podem ser facilmente separadas na\naproxima\u00e7\u00e3o de Fresnel.\n\nA propaga\u00e7\u00e3o da frequ\u00eancia fx = 0 reduz-se \u00e0 difra\u00e7\u00e3o por uma abertura retangular, que pode\nser calculada numericamente atrav\u00e9s das integrais de Fresnel [Goo96]. Supondo que a dist\u00e2ncia de\npropaga\u00e7\u00e3o n\u00e3o \u00e9 extremamente grande, condi\u00e7\u00e3o que \u00e9 satisfeita na holografia de pl\u00e2ncton, quase\ntoda a intensidade continuar\u00e1 no intervalo original de largura L.\n\nSeja U0 = F {u0}, ou seja, U0 \u00e9 a transformada de Fourier quando fx = 0. A propaga\u00e7\u00e3o de\numa frequ\u00eancia fx ?= 0 a uma dist\u00e2ncia z \u00e9\n\nufx(x; z) = F\n?1\n{?\nF\n{?\nrect\n\n(?x\nL\n\n)?\nexp(j2?xfx)\n\n}?\n(?) \u00b7 Hz(?)\n\n}?\n(x)\n\n= F?1\n{?\nF\n{?\nrect\n\n(?x\nL\n\n)?}?\n(? ? fx) \u00b7 Hz(?)\n\n}?\n(x) (Propriedade de deslocamento)\n\n= F?1 {[U0(?) \u00b7 Hz(? + fx)] (? ? fx)} (x) (Reorganizando deslocamentos)\n= F?1 {U0(?) \u00b7 Hz(? + fx)} (x) \u00b7 exp(j2?xfx)\n\nUtilizando a aproxima\u00e7\u00e3o de Fresnel, e ignorando o termo global de fase que n\u00e3o depende da\nfrequ\u00eancia, temos\n\nHz(? + fx) = exp\n[?\n?j??z(? + fx)2\n\n]?\n= exp\n\n[?\n?j??z(?)2\n\n]?\nexp [?j??z(2?fx)] exp\n\n[?\n?j??z(fx)2\n\n]?\n= Hz(?) exp (?j2??fx?z) exp\n\n(?\n?j??zf2x\n\n)?\n.\n\nPortanto,\n\nufx(x; z) = F\n?1 {?U0(?) \u00b7 Hz(?) \u00b7 exp (?j2??fx?z) exp(??j??zf2x)?}?(x) \u00b7 exp(j2?xfx)\n\n= F?1 {U0(?) \u00b7 Hz(?) \u00b7 exp (?j2??fx?z)} (x) \u00b7 exp\n(?\n?j??zf2x\n\n)?\nexp(j2?xfx)\n\n= F?1 {U0(?) \u00b7 Hz(?)} (x ? fx?z) \u00b7 exp\n(?\n?j??zf2x\n\n)?\nexp(j2?xfx)\n\n= u0(x ? fx?z; z) exp\n(?\n?j??zf2x\n\n)?\nexp(j2?xfx).\n\nPodemos tirar algumas conclus\u00f5es a partir desta f\u00f3rmula, que \u00e9 uma aplica\u00e7\u00e3o direta da propri-\nedade de deslocamento da Transformada Can\u00f4nica Linear (Linear Canonical Transform) [HS05].\nA primeira \u00e9 a de que todas as frequ\u00eancias s\u00e3o preservadas, o que pode ser visto no \u00faltimo termo,\nsofrendo apenas uma mudan\u00e7a de fase, representada pelo segundo termo. Isto j\u00e1 era esperado pela\nforma da fun\u00e7\u00e3o de transfer\u00eancia na aproxima\u00e7\u00e3o de Fresnel, que possui amplitude unit\u00e1ria em toda\nsua extens\u00e3o e apenas altera as fases. A segunda \u00e9 a de que todas as frequ\u00eancias sofrem o mesmo\nefeito de difra\u00e7\u00e3o pela borda do holograma, o que pode ser visto no primeiro termo u0(?; z). \u00c9 im-\nportante notar que isto \u00e9 uma consequ\u00eancia da aproxima\u00e7\u00e3o de Fresnel, que remove a raiz quadrada\nda fun\u00e7\u00e3o de transfer\u00eancia, fazendo com que todas as frequ\u00eancias sejam tratadas de forma linear.\nPor \u00faltimo, cada frequ\u00eancia desloca-se uma dist\u00e2ncia fx?z com a propaga\u00e7\u00e3o.\n\nNas figuras 3.7, 3.8 e 3.9 \u00e9 poss\u00edvel visualizar os deslocamentos que ocorrem com diferentes\nfrequ\u00eancias nas reconstru\u00e7\u00f5es hologr\u00e1ficas. Outro fen\u00f4meno que pode ser observado \u00e9 o que ocorre\nna figura 3.9, onde o holograma possui apenas valores reais, ou seja, seus valores imagin\u00e1rios s\u00e3o\nnulos, sendo portanto mais representativo dos hologramas deste trabalho, j\u00e1 que n\u00e3o utilizamos\nnenhuma t\u00e9cnica de recupera\u00e7\u00e3o de fase. Sem a informa\u00e7\u00e3o da fase, a frequ\u00eancia divide-se em duas,\n\n\n\n3.1 HOLOGRAFIA 19\n\nFigura 3.7: Exemplo num\u00e9rico da propaga\u00e7\u00e3o das frequ\u00eancias de um holograma, que est\u00e1 na regi\u00e3o central\n\u00e0 esquerda, sendo iluminado por uma onda plana que se propaga para a direita. Cada coluna da imagem\n\u00e9 calculada a partir da reconstru\u00e7\u00e3o num\u00e9rica do holograma at\u00e9 a dist\u00e2ncia apropriada, sendo exibida a\namplitude resultante. A onda plana \u00e9 bloqueada nas duas regi\u00f5es \u00e0 esquerda que n\u00e3o fazem parte da regi\u00e3o\ncentral com o holograma. O holograma \u00e9 formado pela adi\u00e7\u00e3o de tr\u00eas fun\u00e7\u00f5es cosseno, com frequ\u00eancia linear,\ne tem sua intensidade modulada por uma fun\u00e7\u00e3o gaussiana para evitar os efeitos de difra\u00e7\u00e3o da borda. Uma\ndestas frequ\u00eancias \u00e9 nula, formando a regi\u00e3o central do feixe, e as outras duas frequ\u00eancias formam os outros\nquatro feixes. Como o holograma possui apenas valores reais, sem a parte imagin\u00e1ria, cada frequ\u00eancia n\u00e3o\nnula presente no holograma provoca o surgimento de dois feixes, que correspondem \u00e0quela frequ\u00eancia em\nsentido hor\u00e1rio e anti-hor\u00e1rio. A maior frequ\u00eancia forma os feixes externos, pois se desloca mais com a\npropaga\u00e7\u00e3o.\n\n\n\n20 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.1\n\n(a) Propaga\u00e7\u00e3o de frequ\u00eancia de 15 ciclos/cent\u00edmetro\n\n(b) Propaga\u00e7\u00e3o de frequ\u00eancia de 45 ciclos/cent\u00edmetro\n\nFigura 3.8: Exemplo num\u00e9rico da propaga\u00e7\u00e3o de uma frequ\u00eancia baixa. O holograma unidimensional \u00e9\nexibido no topo de cada imagem, sendo calculada sua reconstru\u00e7\u00e3o a diferentes dist\u00e2ncias, at\u00e9 4 m. Apenas\na parte real \u00e9 exibida, pois a parte imagin\u00e1ria \u00e9 bem similar, e a intensidade do holograma foi modulada\npor uma fun\u00e7\u00e3o gaussiana, para que n\u00e3o ocorram efeitos de difra\u00e7\u00e3o da borda. Cada pixel possui 4 \u00b5m de\nlargura, e foi simulada a ilumina\u00e7\u00e3o por um laser com comprimento de onda igual a 660 nm. Cada frequ\u00eancia\ndesloca-se uma dist\u00e2ncia fx?z com a propaga\u00e7\u00e3o, ou seja, ap\u00f3s 4 m a frequ\u00eancia de 15 ciclos/cent\u00edmetro sofre\num deslocamento de 15 \u00d7 102 \u00d7 660 \u00d7 10?9 \u00d7 4 = 3.96 \u00d7 10?3 m, e a frequ\u00eancia de 45 ciclos/cent\u00edmetro sofre\num deslocamento de 45 \u00d7 102 \u00d7 660 \u00d7 10?9 \u00d7 4 = 1.188 \u00d7 10?2 m, conforme pode ser observado na parte\ninferior de cada figura.\n\n\n\n3.1 HOLOGRAFIA 21\n\nFigura 3.9: Exemplo num\u00e9rico da propaga\u00e7\u00e3o de uma frequ\u00eancia baixa, de 45 ciclos/cent\u00edmetro. O holo-\ngrama unidimensional \u00e9 exibido no topo da imagem, sendo calculada sua reconstru\u00e7\u00e3o a diferentes dist\u00e2ncias,\nat\u00e9 4 m. A parte imagin\u00e1ria do holograma \u00e9 nula, pois este \u00e9 formado por uma fun\u00e7\u00e3o cosseno, e sua in-\ntensidade foi modulada por uma fun\u00e7\u00e3o gaussiana, para que n\u00e3o ocorram efeitos de difra\u00e7\u00e3o da borda. Cada\npixel possui 4 \u00b5m de largura, e foi simulada a ilumina\u00e7\u00e3o por um laser com comprimento de onda igual a\n660 nm. Como cada frequ\u00eancia desloca-se uma dist\u00e2ncia fx?z com a propaga\u00e7\u00e3o, ap\u00f3s 4 m a frequ\u00eancia de\n45 ciclos/cent\u00edmetro sofre um deslocamento de 45 \u00d7 102 \u00d7 660 \u00d7 10?9 \u00d7 4 = 1.188 \u00d7 10?2 m, conforme pode\nser observado na parte inferior da figura. O holograma n\u00e3o possui parte imagin\u00e1ria, portanto \u00e9 equivalente\n\u00e0 soma de duas frequ\u00eancias id\u00eanticas, mas em sentidos opostos, o que faz com que suas partes imagin\u00e1rias\nse anulem, pois cos x = (eix + e?ix)/2. Com a propaga\u00e7\u00e3o, estas duas frequ\u00eancias sofrem deslocamentos em\nsentidos opostos, separando-se uma da outra.\n\n\n\n22 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.2\n\ncada uma sofrendo um deslocamento em uma dire\u00e7\u00e3o. Visualmente, isto corresponde \u00e0 forma\u00e7\u00e3o\nda imagem real e da imagem virtual (ou imagem g\u00eamea).\n\nCaso estejamos interessados em obter a propaga\u00e7\u00e3o do holograma para uma regi\u00e3o paralela\nde mesma largura L, que est\u00e1 \u00e0 dist\u00e2ncia z do holograma e diretamente \u00e0 sua frente, podemos\nsupor que as frequ\u00eancias que tenham se deslocado mais do que L podem ser ignoradas. Ou seja, as\nfrequ\u00eancias fx presentes na reconstru\u00e7\u00e3o s\u00e3o\n\n|fx| ?\nL\n\n?z\n(3.7)\n\nHistoricamente, este resultado relaciona-se \u00e0 teoria da forma\u00e7\u00e3o da imagem de E. Abbe [Abb73], que\nestudou a difra\u00e7\u00e3o da luz em microsc\u00f3pios e observou que frequ\u00eancias mais altas afastam-se mais do\neixo \u00f3tico, levando a uma perda da qualidade da imagem obtida quando parte das frequ\u00eancias n\u00e3o \u00e9\ncapturada ou sofre distor\u00e7\u00f5es devido \u00e0s lentes. A f\u00f3rmula 3.7 obtida acima \u00e9 similar \u00e0s f\u00f3rmulas (17)\ne (20) apresentadas no artigo de Kelly et al. [KHHS11], que considera a forma\u00e7\u00e3o do holograma,\nn\u00e3o sua reconstru\u00e7\u00e3o. Um artigo mais recente de Kelly [Kel14] considera esta an\u00e1lise do ponto de\nvista da reconstru\u00e7\u00e3o num\u00e9rica.\n\nTamb\u00e9m precisamos considerar o efeito de amostragem e integra\u00e7\u00e3o realizado pelos pixels da\nc\u00e2mera. A integra\u00e7\u00e3o pelos pixels resulta na aplica\u00e7\u00e3o de um filtro passa-baixa no holograma, e a\namostragem impede que frequ\u00eancias acima de 1\n\n2?x\nsejam representadas no espectro, onde ?x \u00e9 a\n\nlargura de um pixel no eixo x, resultando em aliasing.\nPode-se dividir a propaga\u00e7\u00e3o em tr\u00eas regi\u00f5es [KNR+09], uma na qual a abertura da c\u00e2mera\n\nlimita a resolu\u00e7\u00e3o, outra na qual tanto a abertura quanto o tamanho do pixel limitam a resolu\u00e7\u00e3o,\ne uma \u00faltima na qual apenas o tamanho do pixel limita a resolu\u00e7\u00e3o. Supondo que a regi\u00e3o a ser\nreconstru\u00edda e o holograma possuem largura L, a integra\u00e7\u00e3o do pixel pode ser ignorada quando\n\n?x ?\n3\n\n10\n\n[?\n?z\n\nL\n\n]?\n. (3.8)\n\nE a abertura da c\u00e2mera pode ser ignorada quando\n\n?x ? 6\n[?\n?z\n\nL\n\n]?\n.\n\nKelly et al. [KHHS11] fazem uma an\u00e1lise mais geral, considerando diversos tipos de sistemas\nhologr\u00e1ficos, e uma das conclus\u00f5es \u00e9 a de que uma ilumina\u00e7\u00e3o esf\u00e9rica altera a distribui\u00e7\u00e3o das\nfrequ\u00eancias, o que pode permitir uma reconstru\u00e7\u00e3o mais exata em compara\u00e7\u00e3o \u00e0 ilumina\u00e7\u00e3o plana.\n\nNa figura 3.10 podemos ver um exemplo num\u00e9rico destas equa\u00e7\u00f5es quando ? = 660 nm, L =\n7.0725 mm e ?x = 3.45 \u00b5m. At\u00e9 cerca de 7.5 cm, o tamanho dos pixels impede que todas as\nfrequ\u00eancias que poderiam estar na reconstru\u00e7\u00e3o sejam corretamente amostradas. Na regi\u00e3o em\nvermelho, a partir de pouco mais de 12 cm, uma parte consider\u00e1vel das frequ\u00eancias presentes na\nimagem n\u00e3o far\u00e1 parte de uma reconstru\u00e7\u00e3o com a mesma largura do holograma, e diminuir o\ntamanho dos pixels n\u00e3o traria grandes benef\u00edcios, pois a resolu\u00e7\u00e3o est\u00e1 limitada pelo tamanho do\nsensor da c\u00e2mera. A regi\u00e3o em que a abertura da c\u00e2mera pode ser ignorada n\u00e3o \u00e9 exibida por ser\nextremamente pequena, extendendo-se a pouco mais de 6 mm de dist\u00e2ncia do holograma.\n\n3.2 Detalhes de implementa\u00e7\u00e3o\n\n3.2.1 FFT real e fun\u00e7\u00f5es de transfer\u00eancia\n\nPara calcular a transformada de Fourier do holograma, \u00e9 altamente recomend\u00e1vel utilizar a\nvers\u00e3o da FFT para matrizes reais, que aproveita a simetria existente no espectro para diminuir\nconsideravelmente o tempo de processamento e o uso de mem\u00f3ria. Com isso, n\u00e3o \u00e9 poss\u00edvel utilizar\na vers\u00e3o original da fun\u00e7\u00e3o de transfer\u00eancia, pois ela \u00e9 a transformada de Fourier de uma matriz de\n\n\n\n3.2 DETALHES DE IMPLEMENTA\u00c7\u00c3O 23\n\nFigura 3.10: Exemplo num\u00e9rico das frequ\u00eancias presentes em um holograma com ? = 660nm, L =\n7, 0725mm e ?x = 3, 45\u00b5m. A linha horizontal preta \u00e9 a frequ\u00eancia de Nyquist, a regi\u00e3o azul representa\nas frequ\u00eancias que satisfazem a equa\u00e7\u00e3o 3.7 e fazem parte da reconstru\u00e7\u00e3o, e a regi\u00e3o vermelha \u00e9 a \u00e1rea em\nque a integra\u00e7\u00e3o do pixel pode ser ignorada segundo a equa\u00e7\u00e3o 3.8.\n\nn\u00fameros complexos. Portanto, para obter os mesmos resultados \u00e9 necess\u00e1rio separ\u00e1-la em termos de\nseno e cosseno, e realizar as convolu\u00e7\u00f5es separadamente, somando os resultados no final. Ou seja,\npara obter a reconstru\u00e7\u00e3o Irec a partir do holograma Iholo, calculamos\n\nIrec = IFFTreal(IFFT \u00b7 Hcos) + 1j \u00b7 IFFTreal(IFFT \u00b7 Hsin)\n\nonde IFFT = FFTreal(Iholo), Hcos = Re[Hf] e Hsin = Im[Hf]. Note que, por se tratar da trans-\nformada de Fourier de uma matriz real, uma das dimens\u00f5es ter\u00e1 metade do tamanho da imagem\noriginal, e os \u00edndices da fun\u00e7\u00e3o de transfer\u00eancia devem percorrer apenas os valores n\u00e3o negativos\nnesta dimens\u00e3o.\n\nSe supusermos que o objeto de interesse possui apenas absor\u00e7\u00e3o da luz, n\u00e3o afetando a fase\nda onda, podemos aproximar a magnitude calculando apenas a parte real da convolu\u00e7\u00e3o, ou seja,\nutilizamos apenas a fun\u00e7\u00e3o de transfer\u00eancia Hcos.\n\n3.2.2 Sobreposi\u00e7\u00e3o espacial\n\nAo realizar a convolu\u00e7\u00e3o atrav\u00e9s da FFT, estamos calculando uma convolu\u00e7\u00e3o circular, o que\npode ter resultados indesejados se n\u00e3o forem tomados certos cuidados. Como a ilumina\u00e7\u00e3o do feixe\nde laser normalmente \u00e9 bem maior do que a \u00e1rea do sensor, padr\u00f5es de interfer\u00eancia de objetos\nque n\u00e3o est\u00e3o diretamente \u00e0 frente da c\u00e2mera acabam criando padr\u00f5es na \u00e1rea do sensor. Uma\nsitua\u00e7\u00e3o similar pode ocorrer se estivermos reconstruindo apenas uma regi\u00e3o do holograma, que\npode conter a interfer\u00eancia de objetos pr\u00f3ximos desta regi\u00e3o. O resultado \u00e9 que, ao reconstruir o\nholograma utilizando uma convolu\u00e7\u00e3o circular, objetos que est\u00e3o logo \u00e0 direita da \u00e1rea \u00e0 frente\nda c\u00e2mera acabam sendo parcialmente reconstru\u00eddos na regi\u00e3o esquerda do holograma, aparecendo\ncomo \u201cimagens fantasmas\u201d. Algo an\u00e1logo ocorre nas outras bordas, e objetos que s\u00e3o cortados pela\nborda continuam na borda oposta, de forma mais fraca e menos detalhada. Os efeitos da convolu\u00e7\u00e3o\ncircular podem ser vistos nas imagens de algumas publica\u00e7\u00f5es [CVM+11, SBB+08] e na figura 3.11.\n\nA FFT sup\u00f5e que estamos calculando a transformada de Fourier de uma fun\u00e7\u00e3o peri\u00f3dica, e\no efeito disso \u00e9 que, ao calcularmos a difra\u00e7\u00e3o como uma convolu\u00e7\u00e3o, de um ponto de vista f\u00edsico\nestamos calculando a difra\u00e7\u00e3o de uma parede formada por infinitas c\u00f3pias do holograma lado a\nlado. Lembrando da an\u00e1lise apresentada na se\u00e7\u00e3o 3.1.3, vemos que as frequ\u00eancias mais altas destas\nc\u00f3pias acabam sobrepostas na reconstru\u00e7\u00e3o, causando a perda da qualidade da imagem descrita\n\n\n\n24 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.2\n\n(a) Holograma (b) Reconstru\u00e7\u00e3o com \u201cimagem fantasma\u201d\n\nFigura 3.11: Reconstru\u00e7\u00e3o hologr\u00e1fica com sobreposi\u00e7\u00e3o espacial. No holograma existem ondas de difra\u00e7\u00e3o\nde outro organismo na parte superior da imagem, que provocam o surgimento de uma \u201cimagem fantasma\u201d\ndeste organismo na parte inferior da reconstru\u00e7\u00e3o.\n\nacima. Note que na reconstru\u00e7\u00e3o pela integra\u00e7\u00e3o de Fresnel, como o tamanho dos pixels diminui\nde forma inversamente proporcional \u00e0 propaga\u00e7\u00e3o da frequ\u00eancia de Nyquist, esta sobreposi\u00e7\u00e3o n\u00e3o\nocorre neste algoritmo.\n\nPara diminuir o efeito destas sobreposi\u00e7\u00f5es, uma abordagem \u00e9 aumentar o holograma com ze-\nros, deixando-o com tamanho suficiente para que nenhuma frequ\u00eancia se afaste a ponto de causar\nproblemas [Kel14, KFK12]. Por\u00e9m, com o aumento da dist\u00e2ncia isso provoca um aumento compu-\ntacional consider\u00e1vel, e uma abordagem mais razo\u00e1vel \u00e9 a combina\u00e7\u00e3o da adi\u00e7\u00e3o de zeros com um\nfiltro passa-baixa.\n\nPara calcular a convolu\u00e7\u00e3o linear, podemos fazer com que o holograma fique com o triplo do\ntamanho adicionando zeros, e calculamos a fun\u00e7\u00e3o de transfer\u00eancia como sendo a transformada de\nFourier de\n\nhR(x, y) =\nejkz\n\nj?z\nexp\n\n[?\nj\nk\n\n2z\n(x2 + y2)\n\n]?\nrect\n\n(?\nx\n\n2LX\n\n)?\nrect\n\n(?\ny\n\n2LY\n\n)?\n,\n\ncom LX e LY sendo iguais ao tamanho original do holograma nos dois eixos. Note que estamos\nusando a aproxima\u00e7\u00e3o de Fresnel.\n\nPodemos evitar o c\u00e1lculo da transformada de Fourier de hR(x, y) fazendo algumas aproxima\u00e7\u00f5es.\nAs frequ\u00eancias locais de hR(x, y) s\u00e3o\n\nflX =\nx\n\n?z\nrect\n\n(?\nx\n\n2LX\n\n)?\n, flY =\n\ny\n\n?z\nrect\n\n(?\ny\n\n2LY\n\n)?\n.\n\nPortanto, podemos aproximar o espectro de Fourier de hR(x, y) calculando Hf(x, y), como definida\nna equa\u00e7\u00e3o 3.5, e aplicando um filtro para suprimir frequ\u00eancias maiores do que\n\nfMAXlX =\nLX\n?z\n\n, fMAXlY =\nLY\n?z\n\n.\n\n\n\n3.2 DETALHES DE IMPLEMENTA\u00c7\u00c3O 25\n\nFigura 3.12: Exemplo num\u00e9rico da propaga\u00e7\u00e3o das frequ\u00eancias de um holograma, utilizando um filtro para\nsuprimir frequ\u00eancias acima de fc = L?z . Os par\u00e2metros utilizados foram ? = 660nm, L = 7, 0725mm,\nz = 10cm e ?x = 3, 45\u00b5m. Foram propagados dois hologramas: o de uma onda plana (constante igual a\n1), e o de uma onda com frequ\u00eancia igual a fc. Adicionou-se zeros para duplicar o tamanho do holograma,\ne esta regi\u00e3o adicional, demarcada com linhas verticais pretas, \u00e9 exibida no lado direito da figura. A curva\nazul mostra a intensidade da difra\u00e7\u00e3o da onda plana, e a curva verde mostra a intensidade da difra\u00e7\u00e3o da\nonda de frequ\u00eancia fc. Em vermelho, \u00e9 poss\u00edvel ver a intensidade da difra\u00e7\u00e3o da onda de frequ\u00eancia fc, sem\na utiliza\u00e7\u00e3o de nenhum filtro passa-baixa.\n\nEsta condi\u00e7\u00e3o \u00e9 igual \u00e0 da equa\u00e7\u00e3o 3.7, e devido \u00e0 an\u00e1lise da propaga\u00e7\u00e3o das frequ\u00eancias, podemos\nadicionar zeros no holograma para que tenha apenas o dobro do tamanho, e n\u00e3o o triplo, sem que\nisso cause muita degrada\u00e7\u00e3o na reconstru\u00e7\u00e3o.\n\nNa figura 3.12 \u00e9 poss\u00edvel ver o efeito de aplicar um filtro passa-baixa, no caso uma janela de Tu-\nkey, para suprimir frequ\u00eancias acima de fc = L/(?z). No lado esquerdo da figura aparecem os efeitos\nda convolu\u00e7\u00e3o circular. Embora a onda propagada sem o filtro, em vermelho, tenha uma intensidade\nconsider\u00e1vel na borda esquerda, a onda filtrada, em verde, possui uma intensidade extremamente\nbaixa. Na borda direita da regi\u00e3o sendo propagada, que aparece demarcada por uma linha vertical\nno centro da figura, \u00e9 poss\u00edvel ver que as ondas em verde e vermelho possuem intensidades muito\npr\u00f3ximas, exceto nos cerca de 25 pixels finais, em que a onda em verde acaba tendo uma intensidade\nmenor devido ao filtro. Todas as difra\u00e7\u00f5es foram calculadas com a aproxima\u00e7\u00e3o de Fresnel, e a falta\nde simetria na onda em vermelho provavelmente se deve \u00e0 baixa taxa de amostragem da fun\u00e7\u00e3o de\ntransfer\u00eancia, assunto que ser\u00e1 tratado em uma se\u00e7\u00e3o posterior.\n\n3.2.3 Efeito de borda\n\nAo reconstruir o holograma, o resultado \u00e9 n\u00e3o apenas a difra\u00e7\u00e3o da imagem formada no sensor\nda c\u00e2mera, mas tamb\u00e9m a difra\u00e7\u00e3o da abertura retangular que limita esta regi\u00e3o. Isto gera artefatos\nindesej\u00e1veis, como ilustrado na figura 3.13. Trataremos deste assunto com detalhes no Cap\u00edtulo 4.\n\n3.2.4 Amostragem\n\nA fun\u00e7\u00e3o de transfer\u00eancia Hf(fX, fY ) apresenta frequ\u00eancias que aumentam conforme a dist\u00e2ncia\nao centro, e pode sofrer problemas de amostragem caso estas frequ\u00eancias ultrapassem a frequ\u00eancia\nde Nyquist. Como na aproxima\u00e7\u00e3o de Fresnel os dois eixos s\u00e3o separ\u00e1veis, faremos a an\u00e1lise do caso\nunidimensional, e as mesmas f\u00f3rmulas ser\u00e3o v\u00e1lidas no caso bidimensional para os dois eixos. A\n\n\n\n26 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.2\n\n(a) Reconstru\u00e7\u00e3o de holograma estendido com zeros\n\nFigura 3.13: Efeito da borda na reconstru\u00e7\u00e3o hologr\u00e1fica. A reconstru\u00e7\u00e3o exibe os efeitos da difra\u00e7\u00e3o da\nborda, pois no c\u00e1lculo da convolu\u00e7\u00e3o o holograma foi estendido com zeros.\n\nfrequ\u00eancia local de Hf(fX) \u00e9\nflX = ??zfX.\n\nNote que flX refere-se \u00e0 frequ\u00eancia local de Hf , enquanto que fX refere-se \u00e0 frequ\u00eancia do espectro\nde hf .\n\nPara satisfazer o crit\u00e9rio de amostragem, \u00e9 preciso que [VR09]\n\n|?zfX|&lt;\n1\n\n2?fX\n.\n\nSupondo que o tamanho do holograma foi duplicado com zeros, e sua largura original \u00e9 L, temos\n\n?fX =\n1\n\n2L\n.\n\nLogo, precisamos satisfazer\n|?zfX| &lt;L.\n\nSupondo que z, ? ? 0,\n|fX|&lt;\n\nL\n\n?z\n.\n\nOu seja, temos novamente a equa\u00e7\u00e3o 3.7.\nPara satisfazer esta equa\u00e7\u00e3o, podemos suprimir as frequ\u00eancias mais altas, o que foi sugerido\n\nno m\u00e9todo conhecido como \u201cBand-Limited Angular Spectrum\u201d [MS09], que trata do algoritmo do\nEspectro Angular, n\u00e3o da Aproxima\u00e7\u00e3o de Fresnel. Alguns artigos posteriores sugerem melhorias\nadicionais [YXY+12, YXH+12].\n\nObservando a amostragem de Hf , poder\u00edamos argumentar que, caso uma dist\u00e2ncia z viole a\ncondi\u00e7\u00e3o acima, \u00e9 poss\u00edvel calcular v\u00e1rias propaga\u00e7\u00f5es a dist\u00e2ncias menores, que separadamente\nn\u00e3o violam esta condi\u00e7\u00e3o, e que somadas resultam na dist\u00e2ncia z desejada. Observando a f\u00f3rmula\nda fun\u00e7\u00e3o de transfer\u00eancia Hf , fica \u00f3bvio que isto n\u00e3o iria alterar em nada o resultado, exceto\npossivelmente por alguns pequenos erros num\u00e9ricos. A propaga\u00e7\u00e3o por dist\u00e2ncias menores m\u00faltiplas\nvezes j\u00e1 foi sugerida na literatura [Kre02, Syp95], embora outros artigos digam que esta abordagem\napresenta os mesmos problemas [VR09], ou os troca por novos tipos de erros [MS09], dependendo\ndos detalhes de implementa\u00e7\u00e3o.\n\n\n\n3.3 DETALHES DE IMPLEMENTA\u00c7\u00c3O 27\n\nTamb\u00e9m \u00e9 interessante observar o caso em que\n\nfNYQ&lt;\nL\n\n?z\n,\n\no que ocorre a pequenas dist\u00e2ncias de propaga\u00e7\u00e3o, ou seja, quando\n\nz&lt;\nL2?x\n\n?\n.\n\nSe observarmos a fun\u00e7\u00e3o hf , vemos que sua frequ\u00eancia local \u00e9\n\nflX =\nx\n\n?z\n,\n\ne para satifazer o crit\u00e9rio de amostragem \u00e9 necess\u00e1rio que\n\nx\n\n?z\n<\n\n1\n\n2?x\n.\n\nComo estamos calculando hf em uma regi\u00e3o de largura 2L, o valor m\u00e1ximo de x \u00e9 L, e portanto a\ndist\u00e2ncia z precisa satisfazer\n\nz >\nL2?x\n\n?\n.\n\nOu seja, quando temos uma superamostragem de Hf , a fun\u00e7\u00e3o hf est\u00e1 subamostrada, e vice-versa\n[VR09].\n\nA fun\u00e7\u00e3o Hf pode ser interpretada como uma fun\u00e7\u00e3o chirp [Goo96] multiplicada por uma janela\nretangular, limitando sua extens\u00e3o ao dom\u00ednio em que a frequ\u00eancia de Nyquist n\u00e3o \u00e9 ultrapassada. A\nTransformada Inversa de Fourier de Hf \u00e9, aproximadamente, uma fun\u00e7\u00e3o chirp em que a magnitude\n\u00e9 pr\u00f3xima de 1 em uma regi\u00e3o finita, e pr\u00f3xima de 0 nas demais regi\u00f5es [Goo96, VR09]. Conforme a\ndist\u00e2ncia z diminui, a Transformada Inversa de Fourier de Hf corresponde aproximadamente a um\nchirp de dura\u00e7\u00e3o finita cada vez menor, n\u00e3o violando a condi\u00e7\u00e3o de amostragem de hf . Do ponto\nde vista da convolu\u00e7\u00e3o, ao calcularmos a propaga\u00e7\u00e3o utilizando Hf , o tamanho finito da fun\u00e7\u00e3o hf\ncorrespondente limita os \u00e2ngulos de difra\u00e7\u00e3o sendo calculados. Utilizando a discuss\u00e3o anterior sobre\na propaga\u00e7\u00e3o das frequ\u00eancias, podemos calcular o \u00e2ngulo m\u00e1ximo de difra\u00e7\u00e3o na aproxima\u00e7\u00e3o de\nFresnel como sendo [DC06]\n\n?MAX = arctan\n\n(?\nfNYQ?z\n\nz\n\n)?\n= arctan\n\n(?\n?\n\n2?x\n\n)?\n.\n\nComo exemplo, quando temos ? = 660 nm e ?x = 3.45 \u00b5m, o \u00e2ngulo m\u00e1ximo de difra\u00e7\u00e3o \u00e9\n?MAX ? 0.095 radianos, ou cerca de 5.45?. Isso significa que os \u00e2ngulos de difra\u00e7\u00e3o sendo calculados\ns\u00e3o pequenos o suficiente para que a aproxima\u00e7\u00e3o de Fresnel seja v\u00e1lida, obtendo resultados muito\npr\u00f3ximos aos do m\u00e9todo do Espectro Angular, mesmo a pequenas dist\u00e2ncias. O m\u00e9todo do Espectro\nAngular s\u00f3 apresentaria diferen\u00e7as significativas em rela\u00e7\u00e3o \u00e0 Aproxima\u00e7\u00e3o de Fresnel caso ? seja\nmaior ou aproximadamente igual a ?x, o que n\u00e3o ocorre com o comprimento de onda usado em\nholografia de pl\u00e2ncton e a tecnologia atual de sensores CCD (n\u00e3o estamos considerando o caso de\nmicroscopia hologr\u00e1fica).\n\nA tese de Dom\u00ednguez-Caballero [DC06] considera que este \u00e2ngulo determina uma dist\u00e2ncia m\u00ed-\nnima para que um objeto possa ser observado, de forma que n\u00e3o ocorra aliasing. Por\u00e9m, a dist\u00e2ncias\nmenores do que a recomendada na tese, este aliasing apenas causaria a perda de detalhes mais finos,\nque tamb\u00e9m n\u00e3o seriam gravados a uma dist\u00e2ncia maior, e possivelmente uma pequena degrada\u00e7\u00e3o\nna imagem. A dist\u00e2ncias extremamente curtas, a proximidade da imagem g\u00eamea provavelmente\nseria muito mais problem\u00e1tica do que o aliasing. Realizamos experimentos nos quais foram grava-\ndas imagens a dist\u00e2ncias menores do que a recomendada na tese citada, sem que isso provocasse\nnenhuma perda percept\u00edvel na qualidade da imagem.\n\n\n\n28 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.3\n\n3.3 Segmenta\u00e7\u00e3o de regi\u00e3o de interesse\n\nPara diminuir o tempo de processamento, o holograma \u00e9 segmentado em diversas regi\u00f5es de\ninteresse, cada uma correspondendo idealmente a um \u00fanico organismo. Esta segmenta\u00e7\u00e3o envolve\nduas etapas: primeiro determinamos as coordenadas de um ret\u00e2ngulo que envolve o organismo nos\neixos x e y, e depois determinamos a profundidade z na qual ele se encontra melhor focalizado. De-\nterminar as posi\u00e7\u00f5es laterais na qual um objeto de interesse se encontra tamb\u00e9m ajuda a determinar\na melhor dist\u00e2ncia de focaliza\u00e7\u00e3o.\n\n3.3.1 Reconstru\u00e7\u00e3o volum\u00e9trica\n\nMilgram e Li [ML02] sugeriram calcular a m\u00e9dia de v\u00e1rias reconstru\u00e7\u00f5es em intervalos igualmente\nespa\u00e7ados, entre as profundidades za e zb, e segmentar esta reconstru\u00e7\u00e3o m\u00e9dia. Como isto \u00e9 uma\nsoma de convolu\u00e7\u00f5es onde um dos termos \u00e9 o holograma, podemos somar as fun\u00e7\u00f5es de transfer\u00eancia\ne realizar uma \u00fanica convolu\u00e7\u00e3o. E devido \u00e0 forma da fun\u00e7\u00e3o de transfer\u00eancia, esta soma \u00e9 uma\ns\u00e9rie de pot\u00eancias que pode ser calculada analiticamente.\n\nSe fizermos os intervalos entre as diferentes reconstru\u00e7\u00f5es tender a zero, o resultado \u00e9 a integral\n[Loo11]\n\nSK =\n1\n\nzb ? za\n\n?? zb\nza\n\nexp(?j??z(f2X + f\n2\nY ))dz\n\n=\nexp(?j??zb(f2X + f\n\n2\nY )) ? exp(?j??za(f\n\n2\nX + f\n\n2\nY ))\n\n?j??(zb ? za)(f2X + f\n2\nY )\n\n.\n\nObservando o termo (f2X + f\n2\nY ) do denominador, podemos ver que isso tem o efeito de um filtro\n\npassa-baixa, o que ajuda a visualizar objetos maiores e elimina oscila\u00e7\u00f5es r\u00e1pidas e objetos muito\npequenos.\n\nSe considerarmos apenas a parte real da fun\u00e7\u00e3o de transfer\u00eancia, temos\n\nSKREAL =\n1\n\nzb ? za\n\n?? zb\nza\n\ncos(??z(f2X + f\n2\nY ))dz\n\n=\nsin(??zb(f\n\n2\nX + f\n\n2\nY )) ? sin(??za(f\n\n2\nX + f\n\n2\nY ))\n\n??(zb ? za)(f2X + f\n2\nY )\n\n.\n\nSupondo que za = 0,\n\nSKREAL =\nsin(??zb(f\n\n2\nX + f\n\n2\nY ))\n\n??zb(f\n2\nX + f\n\n2\nY )\n\n= sinc(?zb(f\n2\nX + f\n\n2\nY )).\n\nO holograma m\u00e9dio \u00e9 ent\u00e3o\nImedio = Iholo ? SK,\n\nonde ? denota convolu\u00e7\u00e3o.\nA imagem Imedio \u00e9 segmentada aplicando uma limiariza\u00e7\u00e3o adaptativa. Primeiro a imagem \u00e9\n\nnormalizada linearmente para o intervalo [0, 255]. Ent\u00e3o um filtro gaussiano com um valor elevado\npara ? \u00e9 aplicado, e a diferen\u00e7a entre a imagem filtrada e a original \u00e9 limiarizada, utilizando um\nvalor est\u00e1tico determinado experimentalmente. A esta segmenta\u00e7\u00e3o s\u00e3o adicionados pixels com\nintensidades muito baixas na imagem Imedio, pois a limiariza\u00e7\u00e3o adaptativa acaba desconsiderando\ngrandes regi\u00f5es com baixa intensidade. Por fim, esta segmenta\u00e7\u00e3o sofre uma pequena dilata\u00e7\u00e3o\nbin\u00e1ria e objetos muito pr\u00f3ximos da borda s\u00e3o removidos.\n\n\n\n3.4 SEGMENTA\u00c7\u00c3O FINAL 29\n\n(a) Holograma original (b) Holograma m\u00e9dio (c) Holograma segmentado\n\nFigura 3.14: Segmenta\u00e7\u00e3o de um holograma em regi\u00f5es de interesse. O holograma m\u00e9dio foi calculado ap\u00f3s\na remo\u00e7\u00e3o do fundo do holograma original.\n\n(a) Holograma n\u00e3o focalizado (b) Holograma focalizado\n\nFigura 3.15: Focaliza\u00e7\u00e3o de um holograma segundo a medida de entropia. O holograma foi reconstru\u00eddo a\nv\u00e1rias dist\u00e2ncias, e a imagem \u00e0 direita \u00e9 a que obteve o melhor foco, minimizando a entropia.\n\n3.3.2 Focaliza\u00e7\u00e3o\n\nPara calcular a melhor dist\u00e2ncia de focaliza\u00e7\u00e3o, uma regi\u00e3o com 4 vezes a largura e altura\nsegmentadas \u00e9 reconstru\u00edda a v\u00e1rias dist\u00e2ncias, desde uma dist\u00e2ncia m\u00ednima za at\u00e9 uma dist\u00e2ncia\nm\u00e1xima zb, que dependem das dist\u00e2ncias usadas no experimento. Em cada reconstru\u00e7\u00e3o, \u00e9 aplicada\numa medida de foco na regi\u00e3o que foi segmentada originalmente. A imagem que maximiza (ou\nminimiza) esta medida \u00e9 considerada a melhor focaliza\u00e7\u00e3o, e \u00e0 regi\u00e3o originalmente segmentada \u00e9\nadicionada uma borda fixa adicional de 50 pixels, determinada experimentalmente. A adi\u00e7\u00e3o desta\nborda fixa \u00e9 para evitar o corte excessivo de pequenos detalhes dos organismos, como as antenas,\npois estas n\u00e3o podem ser detectadas na reconstru\u00e7\u00e3o volum\u00e9trica. O uso de uma regi\u00e3o 4 vezes\nmaior em largura e altura para a reconstru\u00e7\u00e3o tem o objetivo de n\u00e3o perder muita qualidade, pois\ncomo foi visto a dimens\u00e3o lateral usada influencia diretamente nas frequ\u00eancias e detalhes presentes.\n\nV\u00e1rias medidas de foco podem ser usadas, e fazemos uma compara\u00e7\u00e3o experimental no Cap\u00ed-\ntulo 5.\n\n3.4 Segmenta\u00e7\u00e3o Final\n\nCada regi\u00e3o focalizada \u00e9 novamente segmentada, para determinar o formato e localiza\u00e7\u00e3o do\norganismo na imagem. A segmenta\u00e7\u00e3o \u00e9 similar \u00e0 das regi\u00f5es de interesse, com uma limiariza\u00e7\u00e3o\nadaptativa, adi\u00e7\u00e3o de pixels com intensidades muito baixas, e uma abertura morfol\u00f3gica. Isto pode\ngerar v\u00e1rios segmentos, e apenas o de maior \u00e1rea \u00e9 considerado. Caso o maior segmento possua um\ncentr\u00f3ide muito pr\u00f3ximo da borda, ou uma \u00e1rea total muito pequena, esta imagem \u00e9 desconsiderada\n\n\n\n30 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.5\n\n(a) Reconstru\u00e7\u00e3o focalizada (b) Segmenta\u00e7\u00e3o\n\nFigura 3.16: Segmenta\u00e7\u00e3o final de uma regi\u00e3o de interesse focalizada.\n\npor se tratar de um erro de segmenta\u00e7\u00e3o, n\u00e3o contendo nenhum organismo de interesse. Um exemplo\nde segmenta\u00e7\u00e3o pode ser visto na figura 3.16.\n\nA partir desta segmenta\u00e7\u00e3o poderiam ser extra\u00eddas v\u00e1rias caracter\u00edsticas da regi\u00e3o, e usadas em\num classificador autom\u00e1tico, determinando o tipo de organismo planct\u00f4nico presente na imagem.\nPor\u00e9m, n\u00e3o tratamos da classifica\u00e7\u00e3o de organismos pl\u00e2nctonicos neste trabalho, deixando para um\ntrabalho futuro.\n\n3.5 Outras considera\u00e7\u00f5es\n\n3.5.1 Custo computacional\n\nN\u00e3o foram feitas medidas do custo computacional das diferentes etapas de processamento, mas\nsabe-se que o maior gasto de tempo decorre do c\u00e1lculo da FFT e sua inversa, que em uma imagem\nde tamanho N \u00d7N gasta O(N2 log N) opera\u00e7\u00f5es. C\u00e1lculos como a limiariza\u00e7\u00e3o da imagem possuem\ncusto O(N2).\n\nPara reduzir o tempo de processamento, uma estrat\u00e9gia \u00e9 diminuir o n\u00famero de transformadas\nde Fourier que precisam ser calculadas, ou diminuir o tamanho de cada uma. A segmenta\u00e7\u00e3o inicial\ndo holograma em regi\u00f5es de interesse segue esta ideia, pois cada segmento costuma ser significa-\ntivamente menor do que a imagem total, diminuindo o tempo de processamento da reconstru\u00e7\u00e3o.\nAinda assim, a reconstru\u00e7\u00e3o de cada segmento a diferentes dist\u00e2ncias gasta um tempo consider\u00e1vel.\n\nOutra op\u00e7\u00e3o \u00e9 paralelizar o processamento, j\u00e1 que, exceto na obten\u00e7\u00e3o do holograma da imagem\nde fundo, todos os hologramas podem ser processados separadamente, e muitos dos c\u00e1lculos podem\nser feitos de forma paralela. A implementa\u00e7\u00e3o de parte do processamento em uma GPU j\u00e1 obteria\nganhos de tempo consider\u00e1veis [Loo11], embora esteja fora do escopo deste trabalho.\n\n3.5.2 Processamentos adicionais\n\nAl\u00e9m dos processamentos que foram realizados, existem v\u00e1rios outros que podem ser aplicados\npara melhorar a qualidade das imagens obtidas. Embora a imagem g\u00eamea n\u00e3o cause problemas\nem alguns casos, quando temos uma maior quantidade de objetos sendo observados a imagem\nreconstru\u00edda de um objeto n\u00e3o ter\u00e1 apenas o ru\u00eddo de sua pr\u00f3pria imagem g\u00eamea, mas tamb\u00e9m\ndas imagens g\u00eameas de todos os outros objetos pr\u00f3ximos. Existem diversas t\u00e9cnicas para diminuir\no efeito da imagem g\u00eamea, e um resumo de v\u00e1rias delas pode ser visto no artigo de Hennelly et al.\n[HKPM09].\n\n\n\n3.5 OUTRAS CONSIDERA\u00c7\u00d5ES 31\n\n(a) Reconstru\u00e7\u00e3o padr\u00e3o (b) Supress\u00e3o da imagem g\u00eamea\n\nFigura 3.17: Ilustra\u00e7\u00e3o do efeito da imagem g\u00eamea. A segunda imagem foi calculada a partir da primeira,\nrealizando-se uma limiariza\u00e7\u00e3o, propagando-se esta imagem binarizada para calcular uma estimativa da\nimagem g\u00eamea, e subtraindo esta imagem g\u00eamea da imagem original. Com isso, podemos ter uma ideia do\nefeito da imagem g\u00eamea na qualidade da reconstru\u00e7\u00e3o, principalmente em imagens como esta, em que existem\nv\u00e1rios elementos de tamanho razo\u00e1vel bloqueando a passagem da luz. Apenas a \u00e1rea central da reconstru\u00e7\u00e3o\nde um teste de resolu\u00e7\u00e3o 1951 USAF \u00e9 exibida.\n\nTamb\u00e9m existe o efeito de objetos fora de foco, que pode aparecer sobre objetos focalizados\nem outro plano. Para tentar resolver este problema foi sugerido que objetos focalizados sejam\nsegmentados e removidos do holograma, para que no processamento dos outros objetos eles n\u00e3o\napare\u00e7am desfocados [MDYL05].\n\nComo \u00e9 poss\u00edvel construir imagens focalizadas a v\u00e1rias dist\u00e2ncias, e normalmente v\u00e1rias destas\nimagens possuem informa\u00e7\u00f5es importantes que aparecem fora de foco nos outros planos, na \u00e1rea de\nmicroscopia hologr\u00e1fica foi sugerido que se usasse uma medida de foco para combinar v\u00e1rias imagens\na dist\u00e2ncias diferentes, formando uma \u00fanica imagem que seria estudada sem precisar mudar o foco\nconstantemente para observar outras caracter\u00edsticas do objeto [BCP+09]. Por\u00e9m, isto foi feito para\norganismos transparentes, e faltam estudos sobre a aplica\u00e7\u00e3o desta ideia em organismos opacos.\n\nPara tentar melhorar a qualidade da imagem reconstru\u00edda e a localiza\u00e7\u00e3o de part\u00edculas, foram\npropostas formas de realizar a desconvolu\u00e7\u00e3o complexa de um volume formado pela reconstru\u00e7\u00e3o do\nholograma a diversas dist\u00e2ncias. Por\u00e9m, as t\u00e9cnicas propostas parecem obter resultados melhores\npara part\u00edculas do que para objetos extensos [LGF10, DCG11].\n\nPor fim, \u00e9 importante ressaltar que v\u00e1rias destas t\u00e9cnicas est\u00e3o intimamente relacionadas, com\nalgoritmos de desconvolu\u00e7\u00e3o sendo aplicados tanto para remover a imagem g\u00eamea quanto para me-\nlhorar a localiza\u00e7\u00e3o de part\u00edculas e a qualidade das imagens individuais de um volume; imagens\nreconstru\u00eddas a diferentes profundidades sendo usadas para realizar a desconvolu\u00e7\u00e3o, mas tamb\u00e9m\npara criar uma \u00fanica imagem melhor focalizada; e algoritmos que alternam entre diferentes planos\nsendo aplicados na remo\u00e7\u00e3o da imagem g\u00eamea e tamb\u00e9m em segmenta\u00e7\u00f5es que diminuem os efeitos\nde interfer\u00eancia entre os diferentes objetos. O artigo de Denis et al. [DFFD08] unifica alguns algo-\nritmos de remo\u00e7\u00e3o de imagem g\u00eamea sob o ponto de vista da desconvolu\u00e7\u00e3o, al\u00e9m propor um novo\nalgoritmo e observar sua rela\u00e7\u00e3o estrita com algoritmos de segmenta\u00e7\u00e3o.\n\n\n\n32 PROCESSAMENTO DE HOLOGRAMAS DE PL\u00c2NCTON 3.5\n\n\n\nCap\u00edtulo 4\n\nEfeito de borda\n\nA propaga\u00e7\u00e3o do holograma gera efeitos de difra\u00e7\u00e3o n\u00e3o apenas devido \u00e0 imagem formada no\nsensor da c\u00e2mera, mas tamb\u00e9m devido \u00e0 borda do holograma. Neste cap\u00edtulo, iremos tratar dos\ndiferentes m\u00e9todos para minimizar os efeitos de difra\u00e7\u00e3o pela borda nas reconstru\u00e7\u00f5es hologr\u00e1ficas.\n\n4.1 Introdu\u00e7\u00e3o\n\nNo caso mais simples, onde o holograma \u00e9 formado por uma ilumina\u00e7\u00e3o uniforme e nenhum\nobjeto sendo observado, a reconstru\u00e7\u00e3o consiste na difra\u00e7\u00e3o da luz por uma abertura retangular,\npois, assim como na aproxima\u00e7\u00e3o de Fresnel (2.2.3), supomos na simula\u00e7\u00e3o num\u00e9rica que a luz \u00e9\nbloqueada na regi\u00e3o exterior ao holograma. No caso de um organismo sendo reconstru\u00eddo, temos\ncomo resultado a combina\u00e7\u00e3o da imagem deste organismo com a difra\u00e7\u00e3o da luz pela borda do holo-\ngrama. Isto gera diversos efeitos indesej\u00e1veis, alterando a fase e amplitude da imagem reconstru\u00edda\nde forma brusca, o que diminui a qualidade da imagem, dificulta a observa\u00e7\u00e3o dos organismos e\npode afetar o resultado de algoritmos de focaliza\u00e7\u00e3o e segmenta\u00e7\u00e3o.\n\nNa figura 4.1 \u00e9 poss\u00edvel comparar duas reconstru\u00e7\u00f5es, nas quais o holograma original foi esten-\ndido para o dobro de sua largura e altura utilizando diferentes m\u00e9todos. Na primeira imagem, o\nholograma \u00e9 estendido preenchendo a \u00e1rea adicional com zeros, enquanto que na segunda imagem\nessa extens\u00e3o \u00e9 feita com a m\u00e9dia do holograma, apresentando efeitos de difra\u00e7\u00e3o pela borda bem\nmenos vis\u00edveis. Na figura 3.12 tamb\u00e9m \u00e9 poss\u00edvel ver o efeito da borda na intensidade da reconstru-\n\u00e7\u00e3o, neste caso em apenas uma dimens\u00e3o, o que torna o efeito ainda mais evidente. A intensidade\noriginal \u00e9 igual a 1 em todas as curvas, mas ocorrem r\u00e1pidas oscila\u00e7\u00f5es com a propaga\u00e7\u00e3o, que s\u00e3o\nexibidas na figura.\n\nPara resolver este problema, na \u00e1rea de \u00f3ptica costuma-se utilizar a t\u00e9cnica conhecida como\napodiza\u00e7\u00e3o, e que corresponde na \u00e1rea de processamento de sinais \u00e0 aplica\u00e7\u00e3o de uma janela. Esta\njanela torna a borda do holograma mais suave, evitando que ela contenha muitas frequ\u00eancias altas,\nque s\u00e3o as mais problem\u00e1ticas. Cuche et al. [CMD00] sugerem uma janela similar \u00e0 de Tukey,\nmas usando interpola\u00e7\u00e3o por uma fun\u00e7\u00e3o spline c\u00fabica. Zhang et al. [ZFL+13] prop\u00f5em uma outra\njanela, calculada a partir da convolu\u00e7\u00e3o da fun\u00e7\u00e3o ret\u00e2ngulo com uma janela cosseno, e otimizando\nos par\u00e2metros.\n\nPor\u00e9m, t\u00e9cnicas de apodiza\u00e7\u00e3o e suas equivalentes digitais geram novas complica\u00e7\u00f5es, pois re-\nduzem a visibilidade da regi\u00e3o da borda, removendo informa\u00e7\u00e3o da reconstru\u00e7\u00e3o que poderia ser\nrecuperada sem a janela. Para evitar esta perda de informa\u00e7\u00e3o, existe uma alternativa digital que\nseria de dif\u00edcil execu\u00e7\u00e3o atrav\u00e9s de instrumentos \u00f3pticos: pode-se estender o holograma artificial-\nmente, adicionando-se pixels na regi\u00e3o externa que extrapolam o que foi observado. Isto deve ser\nfeito sem que surjam frequ\u00eancias altas, para evitar o aparecimento de artefatos. A forma mais sim-\nples de extrapolar o holograma \u00e9 utilizando a m\u00e9dia no lugar de zeros na regi\u00e3o externa. Dyomin\net al. [DO08] fazem uma aproxima\u00e7\u00e3o por uma fun\u00e7\u00e3o spline bic\u00fabica para estender o holograma,\ne Dubois et al. [DMYL02] prop\u00f5em um m\u00e9todo de estender o holograma minimizando frequ\u00eancias\nespaciais altas.\n\n33\n\n\n\n34 EFEITO DE BORDA 4.1\n\n(a) Holograma estendido com zeros (b) Holograma estendido com a m\u00e9dia\n\nFigura 4.1: Efeito da borda na reconstru\u00e7\u00e3o hologr\u00e1fica. A primeira reconstru\u00e7\u00e3o exibe os efeitos da difra\u00e7\u00e3o\nda borda, pois no c\u00e1lculo da convolu\u00e7\u00e3o o holograma foi estendido com zeros. Na segunda reconstru\u00e7\u00e3o, o\nholograma foi estendido com a m\u00e9dia, apresentando efeitos menos significativos devido \u00e0 borda.\n\n(a) Holograma original (b) Holograma reconstru\u00eddo com apodiza\u00e7\u00e3o\n\nFigura 4.2: Apodiza\u00e7\u00e3o do holograma para evitar efeito da borda. \u00c9 poss\u00edvel ver que a aplica\u00e7\u00e3o da janela\nremove informa\u00e7\u00e3o da regi\u00e3o pr\u00f3xima \u00e0 borda que est\u00e1 presente no holograma original. (Imagens obtidas do\nartigo de Kebbel et al. [KHJ01])\n\n\n\n4.2 M\u00c9TODOS 35\n\n(a) Imagem original (b) Imagem estendida\n\nFigura 4.3: Extens\u00e3o de holograma para evitar efeito da borda, utilizando o algoritmo proposto por Dubois\net al. O quadrado na segunda imagem indica a \u00e1rea original que foi estendida. (Imagens obtidas do artigo\nde Dubois et al. [DMYL02])\n\nPor fim, pode-se combinar as duas ideias e estender o holograma e aplicar uma janela nesta\nextens\u00e3o. Zhang et al. [ZZF+09] estendem o holograma copiando os valores da borda, o que \u00e9\ncomputacionalmente mais eficiente do que calcular a extens\u00e3o proposta por Dubois et al., e ent\u00e3o\naplicam uma janela para diminuir o efeito destes novos valores, mas sem afetar a \u00e1rea original do\nholograma. Com isso, resolve-se o problema da baixa visibilidade na regi\u00e3o da borda, que ocorre\ncom a simples aplica\u00e7\u00e3o de uma janela, e do elevado custo computacional, que ocorre em extens\u00f5es\nmais elaboradas.\n\nPor\u00e9m, n\u00e3o est\u00e1 claro qual m\u00e9todo resulta nos menores erros, pois v\u00e1rios artigos exibem apenas\numa compara\u00e7\u00e3o visual entre a extens\u00e3o sendo proposta e a extens\u00e3o com zeros, ou nenhuma\nextens\u00e3o [DMYL02, ZZF+09]. Assim, fazemos a seguir uma compara\u00e7\u00e3o experimental de diversos\nm\u00e9todos para avaliar os resultados obtidos e a complexidade computacional.\n\n4.2 M\u00e9todos\n\nTodos os m\u00e9todos recebem um holograma de tamanho M \u00d7N e devolvem um holograma esten-\ndido de tamanho 2M \u00d7 2N, onde os pixels de [0, 0] a [M ? 1, N ? 1] s\u00e3o id\u00eanticos aos do holograma\noriginal. Ou seja, trataremos aqui apenas de m\u00e9todos que preenchem os pixels adicionais do holo-\ngrama estendido, sem modificar os valores presentes na regi\u00e3o original do holograma.\n\nTamb\u00e9m poder\u00edamos considerar m\u00e9todos que aplicam uma janela ao holograma, fazendo os va-\nlores da borda diminuirem gradativamente de magnitude at\u00e9 o valor zero. A aplica\u00e7\u00e3o de uma janela\npoderia remover a necessidade de estender o holograma, o que seria desej\u00e1vel pois esta extens\u00e3o au-\nmenta o custo computacional da reconstru\u00e7\u00e3o. Mas, conforme discutido anteriormente, para evitar\nos efeitos de reconstru\u00e7\u00f5es \u201cfantasmas\u201d \u00e9 necess\u00e1rio estender o holograma antes de reconstru\u00ed-lo,\nou seja, a aplica\u00e7\u00e3o da janela n\u00e3o seria suficiente e ainda seria necess\u00e1rio estender o holograma\ncom zeros. Estes m\u00e9todos n\u00e3o trariam ganhos computacionais, al\u00e9m de remover informa\u00e7\u00e3o pre-\nsente na borda e, por estes motivos, m\u00e9todos que alterem a regi\u00e3o original do holograma n\u00e3o ser\u00e3o\nanalisados.\n\nA seguir listamos as extens\u00f5es de borda que ser\u00e3o comparadas.\n\n\n\n36 EFEITO DE BORDA 4.2\n\n(a) Zeros (b) M\u00e9dia (c) C\u00f3pia da borda\n\n(d) Mediana da borda (e) Reflex\u00e3o (f) Rampa linear\n\n(g) Rampa linear circular (h) Filtro gaussiano com ? = 16 (i) Filtro gaussiano iterativo\n\nFigura 4.4: M\u00e9todos de extens\u00e3o de borda. A regi\u00e3o superior esquerda cont\u00e9m a imagem original de tamanho\nN \u00d7 N, e as tr\u00eas regi\u00f5es restantes, tamb\u00e9m de tamanho N \u00d7 N cada uma, cont\u00eam a extens\u00e3o da borda.\n\n\n\n4.2 M\u00c9TODOS 37\n\n(a) Rampa linear com janela de\nTukey\n\n(b) C\u00f3pia da borda com janela\nSpline\n\n(c) Mediana com janela de cosseno\n\n(d) Minimiza\u00e7\u00e3o de frequ\u00eancias al-\ntas\n\n(e) Minimiza\u00e7\u00e3o do Laplaciano\n\nFigura 4.5: M\u00e9todos de extens\u00e3o de borda. A regi\u00e3o superior esquerda cont\u00e9m a imagem original de tamanho\nN \u00d7 N, e as tr\u00eas regi\u00f5es restantes, tamb\u00e9m de tamanho N \u00d7 N cada uma, cont\u00eam a extens\u00e3o da borda.\n\n\n\n38 EFEITO DE BORDA 4.2\n\n4.2.1 Zeros\n\nEsta \u00e9 uma das extens\u00f5es mais simples, que apenas preenche os pixels adicionais com o valor 0.\n\n4.2.2 M\u00e9dia\n\nOutra extens\u00e3o simples, preenchendo os pixels adicionais com a m\u00e9dia da imagem.\n\n4.2.3 C\u00f3pia da borda\n\nOs pixels de cada uma das quatro bordas s\u00e3o copiados. Ou seja, a primeira e a \u00faltima coluna\ns\u00e3o copiadas \u00e0 esquerda e \u00e0 direita da imagem, e a primeira e \u00faltima linhas s\u00e3o copiadas acima e\nabaixo da imagem, respectivamente. Isto pode provocar uma descontinuidade no local da imagem\nem que estas novas bordas estendidas se encontram, por\u00e9m ela ocorre a uma certa dist\u00e2ncia do\nholograma original.\n\n4.2.4 Mediana da borda\n\nSimilar \u00e0 c\u00f3pia da borda, mas ao inv\u00e9s de utilizar o valor do primeiro e \u00faltimo pixel de cada\nlinha e coluna, utiliza os valores das medianas dos primeiros e \u00faltimos k pixels de cada linha e\ncoluna. Assim como na c\u00f3pia da borda, pode provocar uma descontinuidade no encontro destas\nnovas bordas, pois a mediana dos primeiros pixels em geral \u00e9 diferente da mediana dos \u00faltimos\npixels de uma mesma linha ou coluna. A mediana \u00e9 usada para tentar diminuir o efeito do ru\u00eddo\nda imagem na extens\u00e3o da borda.\n\n4.2.5 Reflex\u00e3o\n\nA imagem \u00e9 refletida em torno das bordas. Embora isto possa diminuir a descontinuidade na\nborda, faz com que apare\u00e7am reconstru\u00e7\u00f5es \u201cfantasmas\u201d sobre a imagem.\n\n4.2.6 Rampa linear\n\nSimilar \u00e0 c\u00f3pia da borda, mas os valores dos pixels v\u00e3o diminuindo gradativamente de magnitude\nat\u00e9 o valor 0, de forma linear. Assim, n\u00e3o ocorre uma descontinuidade no encontro destas novas\nbordas, pois nesta regi\u00e3o ambas possuem o valor 0.\n\n4.2.7 Rampa linear circular\n\n\u00c9 feita uma rampa linear entre os valores do primeiro e \u00faltimo pixel de cada linha e coluna.\nDesta forma, a extens\u00e3o faz com que a \u00faltima coluna se transforme gradativamente na primeira\ncoluna da imagem, de forma linear, e o mesmo ocorre com a primeira e a \u00faltima linha.\n\n4.2.8 Filtro gaussiano\n\nA imagem \u00e9 inicialmente estendida com sua m\u00e9dia, e ent\u00e3o \u00e9 aplicado um filtro gaussiano com\npar\u00e2metro ?. Ap\u00f3s aplicar o filtro, a regi\u00e3o correspondente \u00e0 imagem sendo estendida \u00e9 restaurada\naos seus valores originais.\n\n4.2.9 Filtro gaussiano iterativo\n\nA imagem \u00e9 inicialmente estendida com sua m\u00e9dia, e ent\u00e3o \u00e9 aplicado um filtro gaussiano de\nforma iterativa. Para um par\u00e2metro ?, a i-\u00e9sima itera\u00e7\u00e3o aplica o filtro gaussiano com ?i = ?2i ,\ni = 0 . . . ?log2(?)+1?, e ent\u00e3o substitui os valores na regi\u00e3o da imagem original pelos do holograma\nn\u00e3o estendido. Por causa desta substitui\u00e7\u00e3o da \u00e1rea do holograma original a cada itera\u00e7\u00e3o, este\nm\u00e9todo n\u00e3o \u00e9 equivalente a aplicar um \u00fanico filtro gaussiano com o par\u00e2metro ? apropriado.\n\n\n\n4.2 M\u00c9TODOS 39\n\nFigura 4.6: Janela de Tukey para ? = 0.5.\n\nFigura 4.7: Janela de spline c\u00fabica. Os par\u00e2metros utilizados foram x0 = 0, x1 = 42, x2 = 65, T(x0) = 0,\nT(x1) = 0.65, T(x2) = 1, T ?(x0) = 0 e T ?(x2) = 0.\n\n4.2.10 Rampa linear com janela de Tukey\n\nAp\u00f3s realizar a extens\u00e3o com a rampa linear, \u00e9 aplicada uma janela de Tukey na imagem\nestendida.\n\nA janela de Tukey com par\u00e2metro ? \u00e9\n\nTukey(x) =\n\n???\n??\n\n1\n2\n\n{?\n1 + cos\n\n(?\n2?\n?\n[x ? ?\n\n2\n]\n)?}?\n\nse 0 ? x &lt;?\n2\n\n1 se ?\n2\n? x &lt;1 ? ?\n\n2\n1\n2\n\n{?\n1 + cos\n\n(?\n2?\n?\n[x ? 1 + ?\n\n2\n]\n)?}?\n\nse 1 ? ?\n2\n? x ? 1\n\n(4.1)\n\n4.2.11 C\u00f3pia da borda com janela Spline\n\nAp\u00f3s realizar a extens\u00e3o com a c\u00f3pia da borda, \u00e9 aplicada uma janela de spline c\u00fabica na\nimagem estendida. Esta janela utiliza interpola\u00e7\u00e3o por uma spline c\u00fabica nas regi\u00f5es de transi\u00e7\u00e3o\nentre os valores 0 e 1.\n\nA fun\u00e7\u00e3o interpolada T(x), utilizada no lado esquerdo (come\u00e7o) da janela, \u00e9 definida pelos pontos\n{x0, x1, x2}, os valores T(x0), T(x1), T(x2) e as derivadas T ?(x0) e T ?(x2). A spline espelhada \u00e9\nutilizada no lado direito (final) da janela, e os valores no trecho entre as duas splines s\u00e3o iguais a 1.\n\nMaiores detalhes sobre esta janela podem ser encontrados no artigo de Cuche et al. [CMD00].\n\n\n\n40 EFEITO DE BORDA 4.2\n\nFigura 4.8: Janela de cosseno com k = 2.5, L0 = 150, L = 300.\n\n4.2.12 Mediana com janela de cosseno\n\nAp\u00f3s realizar a extens\u00e3o com a mediana, \u00e9 aplicada uma janela de cosseno na imagem estendida.\nEsta janela com par\u00e2metro k \u00e9 definida como\n\nW(l) =\n\n????\n???\ncosk\n\n[?\na\n(?\n\n2l\nL?L0 ? 1\n\n)?]?\nse 1 ? l &lt;L?L0\n\n2\n\n1 se L?L0\n2\n\n+ 1 ? l &lt;L+L0\n2\n\ncosk\n[?\nb\n(?\n\n2l\nL+L0+2\n\n? 1\n)?]?\n\nse L+L0\n2\n\n? l ? L\n, (4.2)\n\nonde L0 e L s\u00e3o os n\u00fameros de pixels horizontais ou verticais no holograma original e no holograma\nestendido, respectivamente. Os valores a e b s\u00e3o definidos como\n\na = ?\n?\n\n2\n\u00b7\n\nL ? L0\nL0 + 2 ? L\n\n, b =\n?\n\n2\n\u00b7\nL + L0 + 2\n\nL ? L0 ? 2\n.\n\nMaiores detalhes sobre esta janela podem ser encontrados no artigo de Zhang et al. [ZZF+09].\n\n4.2.13 Minimiza\u00e7\u00e3o de frequ\u00eancias altas\n\nPara criar uma extens\u00e3o de borda suave, pode-se minimizar as frequ\u00eancias mais altas do ho-\nlograma estendido, como \u00e9 sugerido por Dubois et al. [DMYL02]. Iremos apresentar apenas uma\nideia do algoritmo, que envolve o c\u00e1lculo de diversas matrizes, e os detalhes podem ser encontrados\nno artigo citado.\n\nSeja w? o vetor de uma linha ou coluna do holograma estendido, com a restri\u00e7\u00e3o de que a regi\u00e3o\noriginal do holograma n\u00e3o pode ser modificada. Queremos minimizar\n\n? = a|W ?(0)|2 +\nN?1??\nU=1\n\nU2|W ?(U)|2 +\n2N?1??\nU=N\n\n(2N ? U)2|W ?(U)|2,\n\nonde W ?(U) s\u00e3o os componentes da transformada discreta de Fourier de w?(z) e a \u00e9 uma constante\nreal n\u00e3o nula, necess\u00e1ria para a solu\u00e7\u00e3o do problema matem\u00e1tico. Os dois somat\u00f3rios est\u00e3o separados\ndevido \u00e0 forma c\u00edclica da transformada de Fourier.\n\nPrimeiro a linha ou coluna w? \u00e9 estendida com zeros, ficando com tamanho 2N, e calcula-se\numa matriz A de tamanho 2N \u00d7 2N. O c\u00e1lculo desta matriz envolve a multiplica\u00e7\u00e3o de algumas\nmatrizes de tamanho ?(N2), al\u00e9m do c\u00e1lculo da inversa de uma matriz de mesmo tamanho. Calcula-\nse W ? = FFT(w?) e ent\u00e3o G = AW ? ?W ?. Por fim, a transformada inversa g = IFFT(G) \u00e9 utilizada\ncomo o valor final da linha ou coluna sendo estendida. Note que o c\u00e1lculo de A n\u00e3o depende dos\nvalores da linha ou coluna sendo estendida, mas depende apenas do tamanho 2N e do par\u00e2metro a\nmencionado acima.\n\n\n\n4.2 M\u00c9TODOS 41\n\n4.2.14 Minimiza\u00e7\u00e3o do Laplaciano\n\nI A\n\nB C\n\nFigura 4.9: Minimiza\u00e7\u00e3o do Laplaciano. A imagem I \u00e9 estendida calculando-se as regi\u00f5es A, B e C sepa-\nradamente.\n\nO artigo de Liu e Jia [LJ08] prop\u00f5e criar uma extens\u00e3o suave de borda que minimiza a soma\ndas derivadas parciais de segunda ordem. Para isso, este m\u00e9todo minimiza o Laplaciano no interior\nda extens\u00e3o, com a restri\u00e7\u00e3o de que a borda desta nova regi\u00e3o deve ser similar \u00e0 borda da imagem,\ngarantindo uma transi\u00e7\u00e3o suave entre a imagem e a extens\u00e3o. Isto cria uma imagem estendida\ncircular adequada ao uso de algoritmos que dependam do c\u00e1lculo da FFT da imagem.\n\nA extens\u00e3o \u00e9 feita em tr\u00eas regi\u00f5es separadas: em um bloco A \u00e0 direita da imagem original; em\num bloco B abaixo da imagem original; e em um bloco C na diagonal, preenchendo a \u00e1rea restante.\nDetalharemos como obter o bloco A, pois os outros podem ser obtidos de forma similar, sendo que\no bloco C, computado por \u00faltimo, possuir\u00e1 as quatro bordas restringidas, e n\u00e3o apenas duas bordas\nopostas como nos blocos A e B.\n\nPrimeiro \u00e9 utilizado um filtro gaussiano para suavizar a imagem I, de tamanho M \u00d7N. Apenas\nestes valores suavizados ser\u00e3o utilizados no c\u00e1lculo dos blocos da extens\u00e3o, mas a imagem final\nestendida continuar\u00e1 com os valores originais no lugar de I. Para obter o bloco A, de tamanho\nM \u00d7(N +2?), primeiro definimos um bloco A?, tamb\u00e9m com tamanho M \u00d7(N +2?). As primeiras\ne \u00faltimas ? colunas de A?, que formam a borda ?A, s\u00e3o iguais \u00e0s \u00faltimas e primeiras ? colunas da\nimagem suavizada I, respectivamente. O m\u00e9todo consiste ent\u00e3o em resolver o seguinte problema de\nm\u00ednimos quadrados regularizados:\n\nmin(??A?2 + ??A ? A??2?A),\n\nonde ?\u2022 = ?\n2\u2022\n\n?x2\n+ ?\n\n2\u2022\n?y2\n\n\u00e9 o operador laplaciano, e ? \u00e9 um peso que controla a suavidade do bloco A\ne sua transi\u00e7\u00e3o para a imagem I. As colunas que formam a borda ?A s\u00e3o descartadas, resultando\nem um bloco A de tamanho M \u00d7 N.\n\nA principal desvantagem do m\u00e9todo proposto por Liu e Jia \u00e9 o alto custo computacional para\nresolver o problema de m\u00ednimos quadrados regularizados. Se este m\u00e9todo fosse utilizado no proces-\nsamento de hologramas digitais, o tempo gasto no c\u00e1lculo da extens\u00e3o da borda seria maior do que\nem todas as outras etapas de processamento juntas. Por este motivo, propomos um novo algoritmo\nde extens\u00e3o de borda, que mant\u00e9m a ideia principal de minimizar o Laplaciano, mas possui um\ncusto computacional consideravelmente menor.\n\nDescri\u00e7\u00e3o da extens\u00e3o proposta\n\nCriamos uma extens\u00e3o suave da borda atrav\u00e9s da minimiza\u00e7\u00e3o do Laplaciano no interior da\nextens\u00e3o, com a restri\u00e7\u00e3o de que a borda desta regi\u00e3o, com 1 pixel de largura, deve ser igual \u00e0\nborda da imagem. Ou seja, comparando com o m\u00e9todo proposto por Liu e Jia, fazemos com que\n? = 1 e conseguimos obter min(??A?2 + ??A ? A??2?A) = 0. Neste caso, em que a borda ?A s\u00f3\npossui 1 pixel de largura, n\u00e3o calculamos ?A nos pixels da borda, mas apenas no interior de A,\n\n\n\n42 EFEITO DE BORDA 4.2\n\nonde o operador laplaciano est\u00e1 bem definido e podemos utilizar um pixel e seus 4 pixels adjacentes\npara calcular a vers\u00e3o discretizada do laplaciano. O artigo de Liu e Jia n\u00e3o deixa claro se o operador\nlaplaciano deve ser calculado nos pixels da borda de A e, em caso afirmativo, qual seria a defini\u00e7\u00e3o\nutilizada para lidar com a falta de um dos pixels. Outra diferen\u00e7a \u00e9 que n\u00e3o aplicamos um filtro\ngaussiano na imagem antes de realizar a extens\u00e3o, optando pelo ganho de desempenho em n\u00e3o\nrealizar este passo.\n\nA extens\u00e3o que propomos tamb\u00e9m \u00e9 feita em tr\u00eas regi\u00f5es separadas. Resolvemos a equa\u00e7\u00e3o de\nLaplace no interior do bloco da extens\u00e3o:\n\n?u = 0,\n\nonde ? \u00e9 o Laplaciano. Para o ret\u00e2ngulo A (e de forma an\u00e1loga para B), duas bordas opostas da\nimagem I determinam a condi\u00e7\u00e3o de contorno de Dirichlet,\n\nu(i, 0) = I(i, N ? 1), u(i, N ? 1) = I(i, 0), i ? {0, . . . , M ? 1},\n\ne impomos a condi\u00e7\u00e3o de contorno de Neumann nas duas bordas restantes:\n\nu?(0, i) = u?(M ? 1, i) = 0, i ? {0, . . . , N ? 1}.\n\nNote que o m\u00e9todo proposto por Liu e Jia n\u00e3o deixa claro qual a restri\u00e7\u00e3o que deve ser utilizada\nnestas duas bordas que n\u00e3o fazem fronteira com a imagem. Dependendo da restri\u00e7\u00e3o escolhida e da\nf\u00f3rmula utilizada para calcular (ou n\u00e3o) o operador laplaciano nestas bordas, o m\u00e9todo de Liu e Jia\npode ter diferentes resultados, incluindo casos com infinitas solu\u00e7\u00f5es. As restri\u00e7\u00f5es que utilizamos\nnas quatro bordas garantem que a solu\u00e7\u00e3o \u00e9 \u00fanica e escolhemos a condi\u00e7\u00e3o de contorno de Neumann\nde forma a obter uma solu\u00e7\u00e3o suave.\n\nPara o ret\u00e2ngulo C, ap\u00f3s determinar os valores de A e B \u00e9 poss\u00edvel impor a condi\u00e7\u00e3o de contorno\nde Dirichlet nas quatro bordas.\n\nM\u00e9todo da Transformada de Fourier\n\nPara o c\u00e1lculo eficiente da extens\u00e3o u, utilizaremos o M\u00e9todo da Transformada de Fourier\n[PTVF96]. Primeiro solucionamos a equa\u00e7\u00e3o mais geral\n\n?2u\n\n?x2\n+\n\n?2u\n\n?y2\n= ?(x, y).\n\nNote que, se fizermos ?(x, y) = 0, teremos a equa\u00e7\u00e3o de Laplace.\nA vers\u00e3o discretizada \u00e9\n\nuj+1,l + uj?1,l + uj,l+1 + uj,l?1 ? 4uj,l = ?2?j,l, (4.3)\n\nonde ? = ?x = ?y \u00e9 o espa\u00e7amento da grade.\nImpomos a condi\u00e7\u00e3o de contorno de Dirichlet u = 0 nas quatro bordas do ret\u00e2ngulo, e calculamos\n\na transformada discreta inversa de seno em duas dimens\u00f5es\n\nujl = IDST(u?)jl =\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn sin\n?jm\n\nJ\nsin\n\n?ln\n\nL\n.\n\nIsto satisfaz as condi\u00e7\u00f5es u = 0 em j = 0, J e em l = 0, L.\nUtilizando as identidades trigonom\u00e9tricas\n\nsin(? + ?) = sin ? cos ? + cos ? sin ?\n\nsin(? ? ?) = sin ? cos ? ? cos ? sin ?\n\n\n\n4.2 M\u00c9TODOS 43\n\nobtemos\n\nuj+1,l =\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn sin\n?(j + 1)m\n\nJ\nsin\n\n?ln\n\nL\n\n=\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn\n\n[?\nsin\n\n?jm\n\nJ\ncos\n\n?m\n\nJ\n+ cos\n\n?jm\n\nJ\nsin\n\n?m\n\nJ\n\n]?\nsin\n\n?ln\n\nL\n;\n\nuj?1,l =\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn sin\n?(j ? 1)m\n\nJ\nsin\n\n?ln\n\nL\n\n=\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn\n\n[?\nsin\n\n?jm\n\nJ\ncos\n\n?m\n\nJ\n? cos\n\n?jm\n\nJ\nsin\n\n?m\n\nJ\n\n]?\nsin\n\n?ln\n\nL\n.\n\nPortanto,\n\nuj+1,l + uj?1,l =\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn2 cos\n?m\n\nJ\nsin\n\n?jm\n\nJ\nsin\n\n?ln\n\nL\n(4.4)\n\ne, analogamente,\n\nuj,l+1 + uj,l?1 =\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn2 cos\n?n\n\nL\nsin\n\n?jm\n\nJ\nsin\n\n?ln\n\nL\n(4.5)\n\nSubstituindo as equa\u00e7\u00f5es 4.4 e 4.5 na equa\u00e7\u00e3o 4.3, e calculando a transformada inversa discreta\nde seno no lado direito da equa\u00e7\u00e3o, temos\n\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\nu?mn2\n(?\ncos\n\n?m\n\nJ\n+ cos\n\n?n\n\nL\n? 2\n)?\nsin\n\n?jm\n\nJ\nsin\n\n?ln\n\nL\n=\n\n2\n\nJ\n\n2\n\nL\n\nJ?1??\nm=1\n\nL?1??\nn=1\n\n?2??mn sin\n?jm\n\nJ\nsin\n\n?ln\n\nL\n.\n\nDevido \u00e0 unicidade da transformada discreta de seno e sua inversa, isto \u00e9 equivalente a igualar os\ncoeficientes\n\nu?mn2\n(?\ncos\n\n?m\n\nJ\n+ cos\n\n?n\n\nL\n? 2\n)?\n= ?2??mn\n\nu?mn =\n?2??mn\n\n2\n(?\ncos ?m\n\nJ\n+ cos ?n\n\nL\n? 2\n)?.\n\nO algoritmo para obter u consiste em primeiro calcular ?? = DST(?), utilizar a f\u00f3rmula acima para\nobter u?, e por fim calcular u = IDST(u?).\n\nNo caso em que u = 0 em todas as bordas, exceto na borda x = J?, em que u = f(y), podemos\nreescrever u como\n\nu = u? + uB (4.6)\n\nonde u? = 0 na borda; e uB = 0 em toda a regi\u00e3o, exceto na borda, onde possui os valores f(y).\nA equa\u00e7\u00e3o 4.3 torna-se\n\nu?j+1,l + u\n?\nj?1,l + u\n\n?\nj,l+1 + u\n\n?\nj,l?1 ? 4u\n\n?\nj,l = ?(u\n\nB\nj+1,l + u\n\nB\nj?1,l + u\n\nB\nj,l+1 + u\n\nB\nj,l?1 ? 4u\n\nB\nj,l) + ?\n\n2?j,l.\n\nTodos os termos uB desta equa\u00e7\u00e3o desaparecem, exceto quando j = J ? 1, onde\n\nu?J,l + u\n?\nJ?2,l + u\n\n?\nJ?1,l+1 + u\n\n?\nJ?1,l?1 ? 4u\n\n?\nJ?1,l = ?f(l) + ?\n\n2?J?1,l.\n\nComo os valores de f s\u00e3o conhecidos, isto \u00e9 equivalente ao problema anterior com u = 0 em todas\n\n\n\n44 EFEITO DE BORDA 4.2\n\nas bordas, bastando fazer a substitui\u00e7\u00e3o\n\n?2?J?1,l ? ?f(l) + ?2?J?1,l.\n\nPodemos utilizar o mesmo racioc\u00ednio para impor a condi\u00e7\u00e3o de contorno de Dirichlet nas quatro\nbordas ao mesmo tempo, com os valores desejados, bastando fazer as substitui\u00e7\u00f5es adequadas para\nos valores de ?.\n\nConsideramos agora o caso em que duas das bordas possuem a condi\u00e7\u00e3o de contorno de Neumann\n\n?u0,l\n?x\n\n= 0,\n?uJ,l\n?x\n\n= 0, l ? {1, . . . , L ? 1}.\n\nCalculamos a tranformada discreta inversa de cosseno no eixo em que impomos a condi\u00e7\u00e3o\nde contorno de Neumann, mantendo a transformada discreta inversa de seno no outro eixo, onde\ncontinuaremos impondo a condi\u00e7\u00e3o de contorno de Dirichlet:\n\nujl =\n2\n\nJ\n\n2\n\nL\n\nJ????\nm=0\n\nL?1??\nn=1\n\nu?mn cos\n?jm\n\nJ\nsin\n\n?ln\n\nL\n,\n\nonde as linhas duplas no somat\u00f3rio indicam que o primeiro e o \u00faltimo termo (quando m = 0 e\nm = J) devem ser multiplicados por 1\n\n2\n.\n\nOs c\u00e1lculos s\u00e3o an\u00e1logos aos realizados para a condi\u00e7\u00e3o de contorno de Dirichlet. Utilizamos as\nidentidades trigonom\u00e9tricas\n\ncos(? + ?) = cos ? cos ? ? sin ? sin ?\ncos(??) = cos ?\nsin(??) = ? sin ?\n\ne obtemos novamente a f\u00f3rmula\n\nu?mn =\n?2??mn\n\n2\n(?\ncos ?m\n\nJ\n+ cos ?n\n\nL\n? 2\n)?,\n\ncom a diferen\u00e7a de que utilizamos a transformada discreta de cosseno no eixo em que queremos\na condi\u00e7\u00e3o de contorno de Neumann. Como n\u00e3o estamos interessados em derivadas diferentes de\nzero, podemos parar por aqui, n\u00e3o sendo necess\u00e1rio reescrever u como na equa\u00e7\u00e3o 4.6.\n\nDetalhes de implementa\u00e7\u00e3o\n\nAs defini\u00e7\u00f5es utilizadas acima para as transformadas de seno e cosseno s\u00e3o levemente diferentes\ndas normalmente encontradas em bibliotecas num\u00e9ricas. Como exemplo, a biblioteca SciPy fornece\nas seguintes transformadas inversas de seno e cosseno, ambas de Tipo I e para uma dimens\u00e3o:\n\nul = IDST(u?)l = 2\nL?1??\nn=0\n\nu?n sin\n?(l + 1)(n + 1)\n\nL + 1\n\nul = IDCT(u?)l = 2\n\nL?1????\nn=0\n\nu?n cos\n?ln\n\nL ? 1\n= u?0 + (?1)lu?L?1 + 2\n\nL?2??\nn=1\n\nu?n cos\n?ln\n\nL ? 1\n\nPara obter os resultados corretos, alguns cuidados devem ser tomados. Os valores devem ser\ndivididos por 2, removendo esta constante da f\u00f3rmula. Al\u00e9m disso, realizando algumas substitui\u00e7\u00f5es\n\n\n\n4.3 COMPLEXIDADE COMPUTACIONAL 45\n\nde vari\u00e1veis chegamos na seguinte f\u00f3rmula para a condi\u00e7\u00e3o de contorno de Dirichlet:\n\nu?mn =\n?2??mn\n\n2\n(?\ncos\n\n?(m+1)\nJ+1\n\n+ cos\n?(n+1)\nL+1\n\n? 2\n)?; m = 0, . . . , J ? 1; n = 0, . . . , L ? 1.\n\nPara a condi\u00e7\u00e3o de contorno de Neumann em um dos eixos, e de Dirichlet no outro eixo, a f\u00f3rmula\nutilizada \u00e9\n\nu?mn =\n?2??mn\n\n2\n(?\ncos ?m\n\nJ?1 + cos\n?(n+1)\nL+1\n\n? 2\n)?; m = 0, . . . , J ? 1; n = 0, . . . , L ? 1.\n\nComo estamos resolvendo a equa\u00e7\u00e3o de Laplace, \u00e9 poss\u00edvel realizar algumas otimiza\u00e7\u00f5es no\nc\u00e1lculo de ??. O c\u00e1lculo sem otimiza\u00e7\u00f5es consiste em:\n\n1. Criar a vari\u00e1vel ? com tamanho J \u00d7 L, preenchida com zeros.\n\n2. Nas bordas em que impomos a condi\u00e7\u00e3o de contorno de Dirichlet, subtra\u00edmos os valores\ndesejados. Note que, caso utilizemos a condi\u00e7\u00e3o de Dirichlet nas quatro bordas, ocorrer\u00e3o\nduas subtra\u00e7\u00f5es nos quatro cantos de ?, cada uma referente a uma das bordas vizinhas.\n\n3. Calculamos a transformada discreta de seno no(s) eixo(s) em que impomos a condi\u00e7\u00e3o de\nDirichlet nas duas bordas, e a transformada discreta de cosseno no eixo em que impomos a\ncondi\u00e7\u00e3o de Neumann com valor zero nas duas bordas.\n\nOu seja, o valor de ? \u00e9 diferente de zero apenas nos pixels vizinhos \u00e0s bordas em que impomos a\ncondi\u00e7\u00e3o de Dirichlet.\n\nQuando impomos a condi\u00e7\u00e3o de contorno de Dirichlet nas quatro bordas, podemos calcular a\ntransformada discreta de seno nas colunas de forma direta, com exce\u00e7\u00e3o da primeira e \u00faltima coluna,\ncujos valores em geral s\u00e3o diferentes de zero. Primeiro calculamos normalmente a transformada\ndiscreta de seno apenas na primeira e \u00faltima coluna. Nas colunas restantes, notando que a f\u00f3rmula\nda transformada se reduz \u00e0 soma do primeiro e \u00faltimo termo do somat\u00f3rio, pois os restantes s\u00e3o\nnulos, calculamos a transformada diretamente somando estes dois termos. Por fim calculamos a\ntransformada discreta de seno no outro eixo. Este procedimento faz com que o c\u00e1lculo de ?? passe de\nO(N2 log N) para O(N2) em um dos eixos, permanecendo com custo O(N2 log N) no outro eixo.\n\nQuando impomos a condi\u00e7\u00e3o de contorno de Neumann em duas das bordas, podemos calcular a\ntransformada discreta de cosseno primeiro. Desta forma, basta calcular a transformada na primeira e\n\u00faltima linha, onde impomos a condi\u00e7\u00e3o de contorno de Dirichlet e o valor de ? \u00e9 em geral diferente de\nzero. Todas as outras linhas continuar\u00e3o iguais a zero. A seguir, calculamos a transformada discreta\nde seno nas colunas como descrito acima, somando o primeiro e \u00faltimo termo do somat\u00f3rio. Desta\nforma, o c\u00e1lculo total de ?? passa de O(N2 log N) para O(N2).\n\nRealizando alguns testes, observamos que estas otimiza\u00e7\u00f5es fazem com que o tempo total do\nc\u00e1lculo da extens\u00e3o seja pouco menos de 70% do tempo gasto sem as otimiza\u00e7\u00f5es, considerando o\nc\u00e1lculo das tr\u00eas regi\u00f5es e a cria\u00e7\u00e3o da imagem estendida. N\u00e3o \u00e9 feita nenhuma otimiza\u00e7\u00e3o no c\u00e1lculo\ndas transformadas inversas, sendo utilizados os algoritmos usuais.\n\n4.3 Complexidade computacional\n\nIremos considerar a extens\u00e3o de uma imagem de tamanho N\u00d7N para uma de tamanho 2N\u00d72N.\nEmbora nenhum dos algoritmos tenha alguma restri\u00e7\u00e3o sobre o tamanho final da imagem estendida,\neste \u00e9 o mais apropriado no caso de holografia digital, para evitar os efeitos de convolu\u00e7\u00e3o circular\ne de aliasing, conforme discutido anteriormente.\n\nOs seguintes algoritmos possuem complexidade O(N2): zeros, m\u00e9dia, c\u00f3pia da borda, mediana\nda borda, reflex\u00e3o, rampa linear, rampa linear circular, rampa linear com janela de Tukey, c\u00f3pia\nda borda com janela Spline e mediana com janela de cosseno. Supondo que ? seja um valor menor\n\n\n\n46 EFEITO DE BORDA 4.4\n\nFigura 4.10: Tempo de execu\u00e7\u00e3o dos algoritmos de extens\u00e3o de borda.\n\ndo que uma constante K razo\u00e1vel, digamos ? ? 32, o filtro gaussiano e o filtro gaussiano iterativo\ntamb\u00e9m possuem complexidade O(N2).\n\nO algoritmo de minimiza\u00e7\u00e3o das frequ\u00eancias altas proposto por Dubois et al. [DMYL02] depende\ndos algoritmos utilizados para realizar as multiplica\u00e7\u00f5es de matrizes e a invers\u00e3o da matriz. Na\npr\u00e1tica, os algoritmos utilizados possuem complexidade O(N3). \u00c9 poss\u00edvel fixar o par\u00e2metro a e\npr\u00e9-computar as matrizes A do algoritmo para v\u00e1rios valores de N, o que diminui o tempo gasto,\npor\u00e9m n\u00e3o altera a complexidade do algoritmo e utiliza uma quantidade consider\u00e1vel de mem\u00f3ria\nadicional.\n\nPara resolver a equa\u00e7\u00e3o de Laplace em um ret\u00e2ngulo, utilizamos o m\u00e9todo de Fourier, que realiza\no c\u00e1lculo de transformadas discretas de cosseno e seno, al\u00e9m das respectivas transformadas inversas.\nPortanto, este m\u00e9todo de extens\u00e3o da borda possui complexidade O(N2 log N).\n\nNos gr\u00e1ficos 4.10 e 4.11 \u00e9 poss\u00edvel ver os tempos de execu\u00e7\u00e3o para todos os m\u00e9todos, que\nforam implementados em Python 2 utilizando as bibliotecas SciPy [JOP+ ], NumPy [VDWCV11]\ne FFTW [FJ98]. Os algoritmos foram executados em um MacBook Pro com processador Intel Core\ni5 de 2,5 GHz e 8 GB de mem\u00f3ria DDR3 1600 MHz. A Minimiza\u00e7\u00e3o das Frequ\u00eancias Altas possui\no pior desempenho, n\u00e3o sendo recomend\u00e1vel caso se deseje um baixo tempo de execu\u00e7\u00e3o. O Filtro\nGaussiano Iterativo tamb\u00e9m tem um custo alto, mas bem abaixo da Minimiza\u00e7\u00e3o das Frequ\u00eancias\nAltas. A Minimiza\u00e7\u00e3o do Laplaciano \u00e9 relativamente r\u00e1pida para quadrados de at\u00e9 1000 pixels\nde largura, mas seu custo aumenta consideravelmente para imagens maiores. O Filtro Gaussiano\npossui um custo ligeiramente elevado para imagens maiores do que 1000 pixels de largura, mas com\ndesempenho melhor do que a Minimiza\u00e7\u00e3o do Laplaciano. Os m\u00e9todos restantes s\u00e3o extremamente\nr\u00e1pidos, conforme pode ser visto na Figura 4.11, com os preenchimentos com zeros ou a m\u00e9dia sendo\nquase instant\u00e2neos. Como observado na figura, as diferen\u00e7as de desempenho entre estes \u00faltimos\nm\u00e9todos decorrem principalmente de detalhes de implementa\u00e7\u00e3o, e seria poss\u00edvel obter resultados\nbem similares entre eles com uma implementa\u00e7\u00e3o mais cuidadosa, com exce\u00e7\u00e3o dos Zeros e da\nM\u00e9dia, que exigem menos processamento e continuariam sendo os mais r\u00e1pidos.\n\nA Minimiza\u00e7\u00e3o das Frequ\u00eancias Altas e a Minimiza\u00e7\u00e3o do Laplaciano utilizaram duas threads,\nenquanto que os outros m\u00e9todos utilizaram uma \u00fanica thread. A biblioteca FFTW foi utilizada na\nMinimiza\u00e7\u00e3o do Laplaciano para os c\u00e1lculos das transformadas, pois possui um desempenho bem\nsuperior ao das bibliotecas NumPy e SciPy no c\u00e1lculo da Transformada de Fourier.\n\n\n\n4.4 RESULTADOS EXPERIMENTAIS 47\n\nFigura 4.11: Tempo de execu\u00e7\u00e3o dos algoritmos de extens\u00e3o de borda (detalhe). Os m\u00e9todos mais r\u00e1pidos\ns\u00e3o o preenchimento com zeros ou com a m\u00e9dia, que n\u00e3o exigem muitas opera\u00e7\u00f5es. Em seguida, a rampa\nlinear circular, que foi implementada de forma mais cuidadosa. Os m\u00e9todos restantes em geral utilizam\nfun\u00e7\u00f5es das bibliotecas SciPy e NumPy, al\u00e9m de algumas fun\u00e7\u00f5es auxiliares no caso da aplica\u00e7\u00e3o de janelas\ne, por serem mais gerais, estas fun\u00e7\u00f5es acabam aumentando o custo computacional. Ou seja, as diferen\u00e7as\nde tempo entre estes \u00faltimos m\u00e9todos e a rampa linear circular decorrem principalmente de detalhes de\nimplementa\u00e7\u00e3o, e n\u00e3o de alguma caracter\u00edstica intr\u00ednseca do m\u00e9todo.\n\n4.4 Resultados experimentais\n\nOs algoritmos ser\u00e3o avaliados de acordo com a raiz do erro quadr\u00e1tico m\u00e9dio (RMSE):\n\nRMSE(I?) =\n\n????M\nx=1\n\n??N\ny=1 |I?x,y ? Ix,y|2\n\nMN\n,\n\nonde I? \u00e9 a reconstru\u00e7\u00e3o obtida utilizando algum algoritmo de extens\u00e3o da borda e I \u00e9 a reconstru\u00e7\u00e3o\nde refer\u00eancia, com tamanho M \u00d7 N. Embora a reconstru\u00e7\u00e3o seja realizada com uma imagem esten-\ndida de tamanho 2M \u00d7 2N, apenas a regi\u00e3o correspondente ao holograma original \u00e9 considerada.\nNote que a f\u00f3rmula utilizada tamb\u00e9m \u00e9 v\u00e1lida para n\u00fameros complexos, resultando em um valor\nreal.\n\nComo ser\u00e3o utilizadas imagens obtidas experimentalmente, n\u00e3o \u00e9 poss\u00edvel ter uma imagem\nde refer\u00eancia I que n\u00e3o apresente nenhum efeito de difra\u00e7\u00e3o da borda. Portanto cada holograma\nser\u00e1 reconstru\u00eddo utilizando a extens\u00e3o com zeros, mas apenas um ret\u00e2ngulo na regi\u00e3o central do\nholograma reconstru\u00eddo ser\u00e1 utilizado como a imagem de refer\u00eancia I. Esta mesma regi\u00e3o retangular\ndo holograma original ser\u00e1 estendida com algum algoritmo e sua reconstru\u00e7\u00e3o hologr\u00e1fica I? ser\u00e1\ncomparada com a imagem I.\n\nPor fim, ordenamos os algoritmos de acordo com a magnitude dos erros. O valor RMSE de-\npende n\u00e3o s\u00f3 do algoritmo de extens\u00e3o da borda utilizado, mas tamb\u00e9m dos v\u00e1rios par\u00e2metros da\nreconstru\u00e7\u00e3o, aumentando, por exemplo, com a dist\u00e2ncia z da reconstru\u00e7\u00e3o. Al\u00e9m disso, parte do\nerro representa a perda de informa\u00e7\u00e3o ao utilizar uma regi\u00e3o menor do holograma para a extens\u00e3o\nsendo avaliada, em compara\u00e7\u00e3o com a reconstru\u00e7\u00e3o de refer\u00eancia que utiliza o holograma inteiro.\nPor estes motivos os erros s\u00e3o normalizados para cada imagem, subtraindo dos valores RMSE o\nmenor valor obtido. Ou seja, o algoritmo com o menor erro para aquela imagem passa a ter erro\nigual a zero. Ap\u00f3s esta normaliza\u00e7\u00e3o, ordenamos os algoritmos pela m\u00e9dia dos erros, e tamb\u00e9m\n\n\n\n48 EFEITO DE BORDA 4.4\n\n(a) Holograma (b) Reconstru\u00e7\u00e3o\n\n(c) Extens\u00e3o com rampa linear (d) Reconstru\u00e7\u00e3o da extens\u00e3o (e) Diferen\u00e7a das reconstru\u00e7\u00f5es\n\nFigura 4.12: C\u00e1lculo do erro dos m\u00e9todos de extens\u00e3o de borda. O holograma (a) foi estendido com zeros e\nreconstru\u00eddo com z = 19 cm, resultando na imagem (b). A regi\u00e3o destacada no holograma (a) foi estendida\ncom a rampa linear, resultando na imagem estendida (c). Esta imagem estendida foi reconstru\u00edda e a regi\u00e3o\noriginal recortada, obtendo-se a imagem (d). No c\u00e1lculo do valor RMSE, a regi\u00e3o destacada na imagem\n(b) \u00e9 utilizada como refer\u00eancia para calcular o erro da imagem (d). A diferen\u00e7a entre estas duas imagens\npode ser observada na imagem (e), onde as regi\u00f5es mais escuras representam as maiores diferen\u00e7as e a\nescala \u00e9 logar\u00edtmica para facilitar a visualiza\u00e7\u00e3o. A maior parte do erro se deve \u00e0 perda de informa\u00e7\u00e3o\nprovocada pela utiliza\u00e7\u00e3o de uma regi\u00e3o menor do holograma na reconstru\u00e7\u00e3o, o que pode ser visto nas\nbordas do organismo. Por\u00e9m, tamb\u00e9m \u00e9 poss\u00edvel observar interfer\u00eancias horizontais e verticais na imagem\n(e), causadas pela difra\u00e7\u00e3o da borda da imagem.\n\n\n\n4.4 RESULTADOS EXPERIMENTAIS 49\n\n(a) Holograma (b) Reconstru\u00e7\u00e3o com z = 6.2 cm\n\nFigura 4.13: Holograma utilizado nos gr\u00e1ficos de erro por dist\u00e2ncia e erro por tamanho da reconstru\u00e7\u00e3o\n(figuras 4.14 e 4.17).\n\ncalculamos a raiz da m\u00e9dia dos quadrados destes erros (RMS dos erros). Assim, podemos avaliar\nquais algoritmos obt\u00eam o menor erro em m\u00e9dia, e tamb\u00e9m quais n\u00e3o se distanciam muito do menor\nerro obtido pelos algoritmos considerados.\n\nA normaliza\u00e7\u00e3o n\u00e3o altera a ordena\u00e7\u00e3o dos algoritmos pela m\u00e9dia dos erros, pois apenas subtrai\numa mesma constante dos erros de todos os algoritmos, mas pode alterar a ordena\u00e7\u00e3o pelo RMS\ndos erros. A ideia \u00e9 que, ap\u00f3s a normaliza\u00e7\u00e3o, um erro igual a zero indica que o m\u00e9todo foi melhor\ndo que todos os outros para todas as imagens. Um valor acima de zero indica o qu\u00e3o distante o\nm\u00e9todo est\u00e1 de ser melhor do que todos os outros, utilizando duas formas diferentes de medir esta\ndist\u00e2ncia (erro m\u00e9dio ou RMS dos erros).\n\n4.4.1 Resultados\n\nInicialmente, foram usadas 36 imagens na compara\u00e7\u00e3o dos diferentes m\u00e9todos, com reconstru\u00e7\u00f5es\nde diferentes tamanhos e dist\u00e2ncias, que podem ser visualizadas no Ap\u00eandice A. As imagens foram\nfeitas com duas c\u00e2meras diferentes, com tamanho de pixels e resolu\u00e7\u00e3o distintas, e capturadas em\nalguns dias, com diferentes amostras. A primeira c\u00e2mera possui resolu\u00e7\u00e3o de 1312 \u00d7 1082 pixels,\ncom pixels quadrados de largura 8.5 \u00b5m. A segunda c\u00e2mera possui resolu\u00e7\u00e3o de 2448 \u00d7 2050 pixels,\ncom pixels quadrados de largura 3.45 \u00b5m. Tamb\u00e9m foi utilizado um holograma com resolu\u00e7\u00e3o de\n1000 \u00d7 686 pixels, e outro com resolu\u00e7\u00e3o de 1024 \u00d7 1024 pixels, sendo que ambos foram capturados\ncom a primeira c\u00e2mera e depois recortados para ficarem com estas resolu\u00e7\u00f5es. O laser utilizado\npossui comprimento de onda igual a 660 nm, e as dist\u00e2ncias de reconstru\u00e7\u00e3o utilizadas foram entre\n3.65 cm e 19 cm.\n\nEm um segundo experimento foram utilizadas 200 imagens na compara\u00e7\u00e3o dos diferentes m\u00e9-\ntodos, com reconstru\u00e7\u00f5es de diferentes tamanhos e dist\u00e2ncias. As imagens foram capturadas no\nmesmo dia e com a mesma amostra de pl\u00e2ncton, e feitas com uma \u00fanica c\u00e2mera, que possui re-\nsolu\u00e7\u00e3o de 2448 \u00d7 2050 pixels, com pixels quadrados de largura 3.45 \u00b5m. O laser utilizado possui\ncomprimento de onda igual a 660 nm, e as dist\u00e2ncias de reconstru\u00e7\u00e3o utilizadas foram entre 5 cm e\n7 cm, escolhidas aleatoriamente. O tamanho da regi\u00e3o central utilizada na reconstru\u00e7\u00e3o foi escolhido\naleatoriamente entre 748\u00d7550 e 1648\u00d71250 pixels, sempre com uma dist\u00e2ncia m\u00ednima de 400 pixels\npara qualquer uma das bordas da imagem.\n\nNa mediana da borda, foi utilizado o par\u00e2metro k = 5 pixels. Na rampa linear com janela de\nTukey foi utilizado o par\u00e2metro ? = 0.5. Na c\u00f3pia da borda com janela Spline, os par\u00e2metros\nutilizados para uma janela de largura L foram x0 = 0, x1 = 0.677L4.85 , x2 =\n\n1.042L\n4.85\n\n, T(x0) = 0,\nT(x1) = 0.65, T(x2) = 1, T ?(x0) = 0 e T ?(x2) = 0. Na mediana com janela de cosseno, o \u00fanico\npar\u00e2metro k utilizado para a janela foi 2.5, com k = 5 pixels para o c\u00e1lculo da mediana. No filtro\n\n\n\n50 EFEITO DE BORDA 4.4\n\nFigura 4.14: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o. Um ho-\nlograma de tamanho 2448 \u00d7 2050 foi reconstru\u00eddo para cada uma das dist\u00e2ncias, sendo estendido com a\nminimiza\u00e7\u00e3o do Laplaciano e usado como refer\u00eancia. Os valores dos pixels do holograma est\u00e3o no intervalo\n[0, 255]. Um quadrado de 512 pixels de largura no centro deste holograma foi reconstru\u00eddo a v\u00e1rias dist\u00e2ncias,\nde 2 cm a 7 cm, utilizando os diferentes m\u00e9todos de extens\u00e3o de borda. Para cada um dos m\u00e9todos e dist\u00e2n-\ncias utilizados, foi calculada a raiz do erro quadr\u00e1tico m\u00e9dio utilizando o quadrado central da reconstru\u00e7\u00e3o\nde refer\u00eancia. \u00c9 poss\u00edvel ver que a extens\u00e3o com zeros, a extens\u00e3o com reflex\u00e3o da imagem e a rampa linear\nobt\u00eam erros bem maiores do que os outros m\u00e9todos. Tr\u00eas organismos aparecem parcialmente no quadrado\nutilizado na compara\u00e7\u00e3o. Um destes entra em foco a cerca de 5.75 cm de dist\u00e2ncia, outro a cerca de 6.2 cm\ne o restante a cerca de 6.7 cm.\n\nFigura 4.15: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o (detalhe da\nfigura 4.14). As reconstru\u00e7\u00f5es com zeros e reflex\u00e3o possuem erros muito elevados e n\u00e3o aparecem na figura.\nA rampa linear obt\u00e9m um erro maior, seguida pela m\u00e9dia e filtro gaussiano. Os outros m\u00e9todos possuem\nerros similares, com a minimiza\u00e7\u00e3o do Laplaciano obtendo os menores erros.\n\n\n\n4.4 RESULTADOS EXPERIMENTAIS 51\n\nFigura 4.16: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes dist\u00e2ncias de reconstru\u00e7\u00e3o (detalhe\nda figura 4.14). As reconstru\u00e7\u00f5es com zeros, reflex\u00e3o e rampa linear possuem erros muito elevados e n\u00e3o\naparecem na figura. A m\u00e9dia obt\u00e9m um erro maior, seguida pelo filtro gaussiano e pela c\u00f3pia da borda. A\nmediana da borda obt\u00e9m um erro similar ao filtro gaussiano iterativo. Os m\u00e9todos restantes possuem erros\nsimilares entre si, com exce\u00e7\u00e3o da minimiza\u00e7\u00e3o do Laplaciano que possui os menores erros.\n\nFigura 4.17: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem. Um holograma\nfoi reconstru\u00eddo com a minimiza\u00e7\u00e3o do Laplaciano e utilizado como refer\u00eancia. Os valores dos pixels da\nimagem est\u00e3o no intervalo [0, 255]. V\u00e1rios quadrados com larguras diferentes foram reconstru\u00eddos no centro\ndo holograma, e foi calculada a raiz do erro quadr\u00e1tico m\u00e9dio para diferentes m\u00e9todos de extens\u00e3o de borda.\n\u00c9 poss\u00edvel ver que as extens\u00f5es com zeros, com reflex\u00e3o da imagem e com rampa linear obt\u00eam erros bem\nmaiores do que os outros m\u00e9todos, e para quadrados com largura maior do que 700 pixels n\u00e3o h\u00e1 muita\ndiferen\u00e7a entre estes outros m\u00e9todos.\n\n\n\n52 EFEITO DE BORDA 4.4\n\nFigura 4.18: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem (detalhe da figura\n4.17). Neste gr\u00e1fico \u00e9 poss\u00edvel ver que a minimiza\u00e7\u00e3o do Laplaciano obt\u00e9m o menor erro para todas as\nreconstru\u00e7\u00f5es com largura entre 250 e 700 pixels. Os erros da extens\u00e3o com reflex\u00e3o (canto superior direito)\nou com rampa linear s\u00e3o bem elevados. Dentre os m\u00e9todos restantes, a m\u00e9dia e o filtro gaussiano obt\u00eam\nem geral erros um pouco maiores do que os outros m\u00e9todos, que t\u00eam erros bem similares e ligeiramente\nsuperiores aos da minimiza\u00e7\u00e3o do Laplaciano.\n\nFigura 4.19: Compara\u00e7\u00e3o entre extens\u00f5es de borda para diferentes tamanhos de imagem (detalhe da figura\n4.17). Neste gr\u00e1fico \u00e9 poss\u00edvel ver que os erros de diversos m\u00e9todos s\u00e3o bem similares, com o filtro gaussiano,\no filtro gaussiano iterativo e a minimiza\u00e7\u00e3o do Laplaciano possuindo os menores erros. As extens\u00f5es com\nzeros e com reflex\u00e3o n\u00e3o aparecem na figura, pois os erros s\u00e3o bem elevados, e a extens\u00e3o com rampa linear\naparece no canto superior direito. A minimiza\u00e7\u00e3o do Laplaciano obt\u00e9m erros menores do que os outros\nm\u00e9todos.\n\n\n\n4.4 RESULTADOS EXPERIMENTAIS 53\n\ngaussiano e no filtro gaussiano iterativo foi utilizado ? = 16.\n\nTabela 4.1: Erros das extens\u00f5es (36 imagens)\n\nM\u00e9todo RMS dos erros Erro m\u00e9dio\nMinimiza\u00e7\u00e3o do Laplaciano 0.0141082577 0.0057092772\nFiltro gaussiano iterativo (? = 16) 0.1338226195 0.0869404209\nFiltro gaussiano (? = 16) 0.2708025712 0.1637602514\nMediana com janela de cosseno 0.2353874979 0.1675396627\nMediana da borda 0.2704227127 0.1882365677\nRampa linear circular 0.2447774611 0.2095109489\nC\u00f3pia da borda com janela Spline 0.2552086359 0.2169131570\nRampa linear com janela de Tukey 0.2645534074 0.2282238668\nMinimiza\u00e7\u00e3o das frequ\u00eancias altas 0.2679204009 0.2343276076\nC\u00f3pia da borda 0.2918432957 0.2436156405\nM\u00e9dia 0.4610219089 0.2895375755\nRampa linear 4.4178637247 3.4239223930\nReflex\u00e3o 5.4039674754 4.7871119578\nZeros 15.3849337862 14.2193549607\n\nTabela 4.2: Erros das extens\u00f5es (200 imagens)\n\nM\u00e9todo RMS dos erros Erro m\u00e9dio\nMinimiza\u00e7\u00e3o do Laplaciano 0.3518018652 0.214208946\nFiltro gaussiano (? = 16) 0.4702341748 0.320962085\nFiltro gaussiano iterativo (? = 16) 0.4738536993 0.324729852\nM\u00e9dia 0.4818261562 0.332819976\nRampa linear circular 0.5811989071 0.420472612\nMinimiza\u00e7\u00e3o das frequ\u00eancias altas 0.6316798803 0.463814411\nMediana da borda 0.9714098964 0.684723224\nC\u00f3pia da borda 1.0367849283 0.759131488\nReflex\u00e3o 2.0498254644 1.648931627\nRampa linear 12.0247648276 9.650624437\nC\u00f3pia da borda com janela Spline 17.1005024836 15.931436500\nMediana com janela de cosseno 17.9511958961 17.086757526\nRampa linear com janela de Tukey 19.3300137749 17.824049186\nZeros 43.9944100212 43.904314537\n\nNa tabela 4.1 est\u00e3o os resultados do primeiro experimento, com 36 imagens. Os resultados do\nsegundo experimento, com 200 imagens, podem ser vistos na tabela 4.2. Em ambos o m\u00e9todo com\no menor erro foi a minimiza\u00e7\u00e3o do Laplaciano, seguido pelos filtros gaussianos, e o maior erro foi a\nextens\u00e3o com zeros. Embora a minimiza\u00e7\u00e3o das frequ\u00eancias altas tenha sido criada especificamente\npara o processamento de hologramas, em ambos os experimentos obteve resultados piores do que\numa simples rampa linear circular, que \u00e9 um m\u00e9todo bem mais eficiente em tempo de processamento\ne uso de mem\u00f3ria.\n\nNas figuras 4.14, 4.15 e 4.16 \u00e9 poss\u00edvel ver que o erro de reconstru\u00e7\u00e3o devido \u00e0 borda depende da\ndist\u00e2ncia utilizada na reconstru\u00e7\u00e3o. J\u00e1 as figuras 4.17, 4.18 e 4.19 mostram como a utiliza\u00e7\u00e3o de uma\nregi\u00e3o maior do holograma na reconstru\u00e7\u00e3o diminui o erro, pois h\u00e1 uma menor perda de informa\u00e7\u00e3o,\ne a \u00e1rea central da imagem que \u00e9 menos afetada pelos erros de borda \u00e9 proporcionalmente maior.\n\n\n\n54 EFEITO DE BORDA 4.4\n\nOutros par\u00e2metros que influenciam o erro s\u00e3o o tamanho do pixel da c\u00e2mera e o comprimento de\nonda do laser. Ignorando o conte\u00fado da imagem sendo reconstru\u00edda e analisando apenas a fun\u00e7\u00e3o\nde transfer\u00eancia usada na reconstru\u00e7\u00e3o (equa\u00e7\u00e3o 3.5), podemos ver que aumentar o comprimento\nde onda \u00e9 similar a aumentar a dist\u00e2ncia de reconstru\u00e7\u00e3o, provocando um maior erro devido \u00e0\nborda. J\u00e1 o tamanho do pixel \u00e9 inversamente proporcional \u00e0 dist\u00e2ncia, e a diminui\u00e7\u00e3o do tamanho\ndos pixels \u00e9 similar ao aumento da dist\u00e2ncia de reconstru\u00e7\u00e3o, com um fator quadr\u00e1tico, caso a\nquantidade de pixels seja mantida constante.\n\nN\u00e3o realizamos um estudo mais aprofundado de como cada um destes fatores influencia o erro\nde borda. Por\u00e9m, os testes que realizamos mostraram que a extens\u00e3o que realiza a minimiza\u00e7\u00e3o do\nLaplaciano obt\u00e9m resultados consistentemente melhores do que os outros m\u00e9todos, e que mesmo nos\npoucos casos em que n\u00e3o \u00e9 o melhor, ainda consegue obter um erro bem pr\u00f3ximo ao melhor m\u00e9todo\ndentre os considerados. Os gr\u00e1ficos de erro por dist\u00e2ncia e erro por tamanho da imagem, apesar de\nserem espec\u00edficos para um \u00fanico holograma, indicam que, em geral, os melhores m\u00e9todos possuem\num comportamento bem similar entre si. Portanto, embora exista a possibilidade de que algum\nm\u00e9todo obtenha erros menores para certos casos, \u00e9 razo\u00e1vel escolher a minimiza\u00e7\u00e3o do Laplaciano\ncomo um m\u00e9todo geral para diminuir o erro de reconstru\u00e7\u00e3o de hologramas de pl\u00e2ncton devido \u00e0\ndescontinuidade da borda.\n\nPor fim, \u00e9 interessante notar que os m\u00e9todos com menor erro m\u00e9dio tratam a imagem de forma\nbidimensional. A grande maioria dos m\u00e9todos considerados realiza a extens\u00e3o linha a linha e coluna\na coluna, ou seja, os valores de uma linha ou coluna da imagem n\u00e3o influenciam a extens\u00e3o de\noutra linha ou coluna. Isto provoca o surgimento de v\u00e1rias frequ\u00eancias perpendiculares \u00e0 dire\u00e7\u00e3o\nsendo estendida, como pode ser observado na figura 4.12c, onde a rampa linear cria faixas verticais\nna regi\u00e3o inferior esquerda da figura, e faixas horizontais na regi\u00e3o superior direita. J\u00e1 no caso da\nminimiza\u00e7\u00e3o do Laplaciano, do filtro gaussiano e do filtro gaussiano iterativo, a extens\u00e3o tamb\u00e9m\n\u00e9 suave na dire\u00e7\u00e3o perpendicular \u00e0 que est\u00e1 sendo estendida, pois estes m\u00e9todos tratam a imagem\ncomo um objeto bidimensional, e n\u00e3o como um conjunto de linhas ou colunas independentes. Isto\npode ser observado na figura 4.5e, onde a regi\u00e3o da extens\u00e3o \u00e9 bem suave em todas as dire\u00e7\u00f5es,\npossuindo apenas frequ\u00eancias baixas, al\u00e9m de ter uma transi\u00e7\u00e3o suave entre a imagem original e a\nextens\u00e3o.\n\n\n\nCap\u00edtulo 5\n\nFocaliza\u00e7\u00e3o\n\nA maior vantagem proporcionada pela holografia digital no estudo de pl\u00e2ncton decorre da possi-\nbilidade de realizar a focaliza\u00e7\u00e3o da imagem ap\u00f3s sua aquisi\u00e7\u00e3o, o que permite a observa\u00e7\u00e3o de um\nmaior volume de \u00e1gua. Esta caracter\u00edstica \u00e9 vantajosa para a identifica\u00e7\u00e3o de organismos planct\u00f4ni-\ncos ou a an\u00e1lise do comportamento e da intera\u00e7\u00e3o destes organismos em diferentes profundidades.\nPor\u00e9m, para isto \u00e9 necess\u00e1rio que a focaliza\u00e7\u00e3o das regi\u00f5es de interesse seja feita de forma auto-\nm\u00e1tica, caso contr\u00e1rio o tempo gasto realizando a focaliza\u00e7\u00e3o manual tornaria o uso da holografia\ninvi\u00e1vel em diversos casos.\n\nA abordagem que utilizamos para realizar a focaliza\u00e7\u00e3o autom\u00e1tica consiste no uso de uma\nmedida de foco que \u00e9 calculada sobre o holograma reconstru\u00eddo. Ao variar a dist\u00e2ncia de reconstru\u00e7\u00e3o\nem um determinado intervalo, a imagem que maximiza (ou minimiza) esta medida \u00e9 considerada\na melhor focalizada. Embora existam diversos artigos comparando medidas de foco no caso de\nfotografia digital, as compara\u00e7\u00f5es realizadas para holografia digital de pl\u00e2ncton s\u00e3o mais limitadas.\n\nUma exce\u00e7\u00e3o \u00e9 a tese de Loomis, que realiza um estudo detalhado de v\u00e1rias medidas de foco\n[Loo11]. Em sua tese, um valor de foco \u00e9 atribu\u00eddo para cada pixel , onde este valor \u00e9 o resultado da\nmedida calculada em uma pequena janela centralizada neste mesmo pixel . Os valores de foco s\u00e3o\ncalculados para v\u00e1rias dist\u00e2ncias, e a profundidade do pixel \u00e9 a que maximiza a medida utilizada.\nCom isso, \u00e9 poss\u00edvel obter um mapa de profundidade (depth map), e uma imagem onde todos os\npixels maximizam a medida de foco sendo estudada.\n\nO problema deste m\u00e9todo \u00e9 que, em imagens de holografia digital em linha, apenas pixels pr\u00f3-\nximos a bordas possuem valores confi\u00e1veis de foco. Enquanto que em imagens de fotografia digital\na textura dos objetos pode auxiliar em sua focaliza\u00e7\u00e3o, nesta configura\u00e7\u00e3o hologr\u00e1fica o interior\ndos objetos ou n\u00e3o possui nenhuma informa\u00e7\u00e3o, pois toda a luz foi absorvida pelo objeto, ou pos-\n\n(a) Holograma n\u00e3o focalizado (b) Holograma focalizado\n\nFigura 5.1: Focaliza\u00e7\u00e3o de um holograma segundo a medida de entropia. O holograma foi reconstru\u00eddo a\nv\u00e1rias dist\u00e2ncias, e a imagem \u00e0 direita \u00e9 a que obteve o melhor foco, minimizando a entropia.\n\n55\n\n\n\n56 FOCALIZA\u00c7\u00c3O 5.0\n\nsui padr\u00f5es de dif\u00edcil focaliza\u00e7\u00e3o, devido \u00e0s refra\u00e7\u00f5es e dispers\u00e3o da luz provocadas por um objeto\ntransparente. Al\u00e9m disso, grande parte da imagem \u00e9 formada pelo fundo que n\u00e3o pode ser focalizado\npor defini\u00e7\u00e3o, pois \u00e9 a aus\u00eancia de objetos e n\u00e3o uma superf\u00edcie. Ou seja, os pixels que n\u00e3o est\u00e3o\npr\u00f3ximos a bordas e que formam a maior parte da imagem acabam sendo focalizados em dist\u00e2ncias\nincorretas, adicionando ru\u00eddo \u00e0 imagem final. Ondas de difra\u00e7\u00e3o de objetos pr\u00f3ximos, por exem-\nplo, podem ser consideradas melhor focalizadas do que o fundo uniforme da imagem. Sobre estas\ndificuldades, Loomis comenta que imagens poucos mil\u00edmetros fora de foco podem exibir gradientes\nmais fortes do que a imagem focalizada, e ilustra esta situa\u00e7\u00e3o com uma imagem hologr\u00e1fica de um\ncop\u00e9podo, onde a difra\u00e7\u00e3o de suas antenas finas gera gradientes fortes quando levemente desfocadas.\nTamb\u00e9m menciona que algumas medidas geram ru\u00eddo pr\u00f3ximo ao organismo devido aos efeitos de\ndesfocaliza\u00e7\u00e3o e a imagem g\u00eamea.\n\nPara evitar estes problemas, na aplica\u00e7\u00e3o demonstrada na tese de Loomis, que consiste em de-\ntectar e classificar part\u00edculas de petr\u00f3leo, \u00e9 feita uma limiariza\u00e7\u00e3o e apenas os pixels com maior\nresposta \u00e0 medida de foco s\u00e3o considerados. Os valores da medida nestes pixels s\u00e3o ent\u00e3o usados\nconjuntamente para determinar a profundidade da part\u00edcula. Uma diferen\u00e7a importante em rela\u00e7\u00e3o\nao presente trabalho \u00e9 que Loomis utiliza as medidas de foco n\u00e3o apenas para determinar a profundi-\ndade de um objeto, mas tamb\u00e9m para detectar a presen\u00e7a destes objetos nas imagens reconstru\u00eddas.\nOu seja, as medidas s\u00e3o utilizadas como um filtro que \u00e9 aplicado em todas as reconstru\u00e7\u00f5es para\nsegmentar objetos, determinando suas posi\u00e7\u00f5es nos tr\u00eas eixos.\n\nEm hologramas de rostos humanos, Thelen et al. [TFHH09] utilizam diversas t\u00e9cnicas para li-\ndar com estes problemas na focaliza\u00e7\u00e3o de pixels. \u00c9 calculada uma medida de confian\u00e7a para os\nresultados obtidos pela medida de foco, e caso esta confian\u00e7a esteja abaixo do valor de uma f\u00f3rmula\ndeterminada experimentalmente, \u00e9 selecionada uma janela maior em torno do pixel para a focali-\nza\u00e7\u00e3o. Isto \u00e9 feito utilizando janelas de v\u00e1rios tamanhos, e caso nenhuma destas possua um valor\naceit\u00e1vel para a medida de confian\u00e7a, ao final do algoritmo \u00e9 calculada uma m\u00e9dia ponderada na ja-\nnela de maior tamanho usando os valores de confian\u00e7a como peso, preenchendo assim estas lacunas\ncom valores similares ao da regi\u00e3o na qual est\u00e3o localizadas. Tamb\u00e9m \u00e9 feito um ajuste gaussiano\nna medida de foco ao determinar a dist\u00e2ncia de cada pixel . Desta forma, as dist\u00e2ncias obtidas n\u00e3o\nficam restritas \u00e0s utilizadas no algoritmo de focaliza\u00e7\u00e3o, resultando em uma superf\u00edcie mais suave,\nsem os degraus t\u00edpicos de uma focaliza\u00e7\u00e3o realizada em passos discretos uniformemente espa\u00e7ados.\nE por fim \u00e9 feita uma suaviza\u00e7\u00e3o anisotr\u00f3pica para diminuir o ru\u00eddo presente na superf\u00edcie.\n\nPodemos notar que existe uma grande dificuldade de se obter uma boa focaliza\u00e7\u00e3o para pixels\nindividuais, sem ru\u00eddo excessivo, sendo necess\u00e1rios v\u00e1rios algoritmos para se chegar ao resultado\ndesejado. Vale ressaltar que estas imagens hologr\u00e1ficas de rostos humanos s\u00e3o distintas das imagens\nde pl\u00e2ncton em v\u00e1rios aspectos, alguns dos quais facilitam a focaliza\u00e7\u00e3o. A configura\u00e7\u00e3o hologr\u00e1fica\nn\u00e3o \u00e9 em linha, a reconstru\u00e7\u00e3o realizada \u00e9 \u00f3ptica e as imagens resultantes n\u00e3o possuem fortes ondas\nde difra\u00e7\u00e3o e imagens g\u00eameas como na holografia de pl\u00e2ncton. Al\u00e9m disso, praticamente toda a\nimagem cont\u00e9m a superf\u00edcie formada pelo rosto, e n\u00e3o um fundo sem objetos.\n\nNeste trabalho, realizamos a compara\u00e7\u00e3o de medidas de foco para determinar a profundidade\nda imagem como um todo, e n\u00e3o de cada pixel individualmente. A vantagem \u00e9 que n\u00e3o h\u00e1 a cria\u00e7\u00e3o\nde um ru\u00eddo adicional na imagem como na focaliza\u00e7\u00e3o de pixels, por\u00e9m \u00e9 poss\u00edvel que organismos\nmaiores fiquem parcialmente desfocados. Al\u00e9m disso, caso existam organismos muito pr\u00f3ximos estes\npoder\u00e3o afetar o resultado da focaliza\u00e7\u00e3o, inclusive fazendo com que outros organismos fiquem\nfocalizados no lugar do organismo sendo processado. Ainda assim, caso os organismos tenham sido\ncorretamente segmentados, acreditamos que esta abordagem proporciona um resultado superior a\numa simples focaliza\u00e7\u00e3o de pixels.\n\nUm dos problemas da focaliza\u00e7\u00e3o de hologramas de organismos planct\u00f4nicos \u00e9 o tempo gasto\npara realizar as reconstru\u00e7\u00f5es a v\u00e1rias dist\u00e2ncias e calcular a medida de foco. Para diminuir o\ntempo de processamento, pode-se reconstruir o holograma a uma quantidade menor de dist\u00e2ncias\ne, a partir dos valores da medida de foco, realizar mais reconstru\u00e7\u00f5es apenas na regi\u00e3o em que\nse acredita que o holograma estar\u00e1 bem focalizado. Ou seja, a focaliza\u00e7\u00e3o \u00e9 realizada em algumas\netapas: primeiro \u00e9 feita uma focaliza\u00e7\u00e3o grosseira, com uma dist\u00e2ncia maior entre as reconstru\u00e7\u00f5es; e\n\n\n\n5.1 MEDIDAS DE FOCO 57\n\nem seguida \u00e9 feita uma focaliza\u00e7\u00e3o mais fina, diminuindo-se a dist\u00e2ncia entre as reconstru\u00e7\u00f5es, mas\nrealizando-as apenas na regi\u00e3o que obteve o melhor foco na etapa anterior. Pode-se realizar quantas\netapas forem necess\u00e1rias para se obter uma boa focaliza\u00e7\u00e3o, terminando com uma dist\u00e2ncia bem\npequena entre cada reconstru\u00e7\u00e3o. Um algoritmo extremamente similar foi utilizado por Dom\u00ednguez-\nCaballero [DC06], por\u00e9m avaliaremos o uso de diferentes medidas de foco neste algoritmo, enquanto\nque Dom\u00ednguez-Caballero utilizou uma \u00fanica medida de foco, baseada no laplaciano da imagem.\n\n5.1 Medidas de foco\n\nA seguir detalhamos as medidas que foram estudadas.\n\n5.1.1 Medidas estat\u00edsticas\n\nEstas medidas realizam algum c\u00e1lculo estat\u00edstico sobre os valores dos pixels, ignorando a posi\u00e7\u00e3o\ndestes na imagem.\n\nEntropia\n\nA dist\u00e2ncia de focaliza\u00e7\u00e3o escolhida \u00e9 a que minimiza a entropia da imagem [GK89], que \u00e9\ncalculada utilizando seu histograma. Para uma imagem com N n\u00edveis de cinza, a entropia \u00e9 definida\ncomo\n\nEntropia = ?\nN??\n\nn=1\n\nPn log Pn\n\nonde Pn \u00e9 a probabilidade do n-\u00e9simo n\u00edvel de cinza, definida como sua frequ\u00eancia relativa na\nimagem.\n\nAmplitude\n\nA amplitude de uma imagem I de tamanho M \u00d7 N \u00e9 [DSCY06]\n\nAmplitude =\nM??\ni=1\n\nN??\nj=1\n\n|I(i, j)| .\n\nVari\u00e2ncia\n\nUtilizada em diversos artigos de processamento de imagens [GYL85, MHN08, LJ05, TBG+05,\nLSHW09, BCP+09, PPCCMFV00, HJ07], a vari\u00e2ncia 1 de uma imagem I de tamanho M \u00d7 N \u00e9\n\nVar(I) =\n1\n\nMN\n\nM??\ni=1\n\nN??\nj=1\n\n[?\nI(i, j) ? I?\n\n]?2\n,\n\nonde I? \u00e9 a m\u00e9dia de intensidades da imagem I. Alguns autores tamb\u00e9m utilizam o desvio pa-\ndr\u00e3o [Loo11], mas como os valores s\u00e3o considerados de forma relativa, obtendo portanto resultados\nid\u00eanticos aos da vari\u00e2ncia, n\u00e3o utilizaremos o desvio padr\u00e3o como medida de foco.\n\nContraste de Tamura\n\nSeja ?4 a medida de curtose, isto \u00e9,\n?4 =\n\n\u00b54\n?4\n\n,\n\n1Usamos o termo \u201cvari\u00e2ncia\u201d por ser comumente utilizado na \u00e1rea de processamento de imagens, mas \u00e9 bom deixar\nclaro que n\u00e3o estamos realizando qualquer tipo de an\u00e1lise estat\u00edstica das imagens.\n\n\n\n58 FOCALIZA\u00c7\u00c3O 5.1\n\nonde \u00b54 \u00e9 o quarto momento central e ?2 \u00e9 a vari\u00e2ncia. O contraste de uma imagem I, segundo as\nmedidas de textura propostas por Tamura et al. [TMY78], \u00e9 definido como\n\nTamura =\n?\n\n(?4)n\n,\n\nonde ? \u00e9 o desvio padr\u00e3o de I e o valor n \u00e9 igual a 0.25 (recomendado).\nUma aproxima\u00e7\u00e3o deste coeficiente utilizada por Memmolo et al. [MDP+11] \u00e9\n\nTamuraaprox =\n\n??\n?\n\nI?\n.\n\nEsta aproxima\u00e7\u00e3o \u00e9 similar \u00e0 medida de vari\u00e2ncia, mas com um peso levemente maior para ima-\ngens mais escuras, que possuem m\u00e9dia mais pr\u00f3xima a zero. Uma outra vers\u00e3o equivalente a esta\naproxima\u00e7\u00e3o, mas sem a raiz quadrada, \u00e9 chamada de Desvio Padr\u00e3o Normalizado [GYL85].\n\nMomento Central Absoluto\n\nO Momento Central Absoluto (Absolute Central Moment) de uma imagem I \u00e9 [LJ05]\n\nACM =\n??\n\n|i ? I?|p(i),\n\nonde i \u00e9 o n\u00edvel de cinza e p(i) \u00e9 a probabilidade do i-\u00e9simo valor de cinza na imagem, segundo sua\nfrequ\u00eancia relativa. Ou seja, esta medida \u00e9 calculada a partir do histograma da imagem I.\n\nUma defini\u00e7\u00e3o equivalente \u00e9\n\nACM2 =\n1\n\nMN\n\nM??\ni=1\n\nN??\nj=1\n\n??\nI(i, j) ? I?\n\n??\n,\n\nonde I? \u00e9 a m\u00e9dia de intensidades da imagem I. Esta defini\u00e7\u00e3o \u00e9 chamada de Amplitude [CNAJ01]\nou Varia\u00e7\u00e3o Absoluta [GYL85].\n\n5.1.2 Medidas com filtro espacial\n\nEstas medidas utilizam algum tipo de filtro espacial, com o objetivo de detectar a presen\u00e7a de\nbordas e assim determinar se uma imagem est\u00e1 focalizada.\n\nVaria\u00e7\u00e3o Total\n\nA Varia\u00e7\u00e3o Total (anisotr\u00f3pica) de uma imagem I \u00e9\n\nTV(I) =\nM??\ni=1\n\nN??\nj=1\n\n|I(i + 1, j) ? I(i, j)| + |I(i, j + 1) ? I(i, j)|.\n\nEsta medida tamb\u00e9m \u00e9 chamada de Sum Modulus Difference (SMD) [Jar76, CNAJ01] e Energy\nof Gradient Absolute (EOGA) [BCP+09].\n\n\u00cdndice S\n\nO \u00cdndice S [LM15] se baseia na ideia de que altera\u00e7\u00f5es aleat\u00f3rias na fase de uma imagem em\ngeral aumentam a Varia\u00e7\u00e3o Total medida, mas isto ocorre de forma mais dr\u00e1stica para imagens\n\n\n\n5.1 MEDIDAS DE FOCO 59\n\nn\u00edtidas. O \u00cdndice S de uma imagem I \u00e9\n\nS(I) = ? log10 ?\n(?\n\u00b5 ? TV(I)\n\n?a\n\n)?\n,\n\n?(t) =\n1\n\n?\n2?\n\n?? ?\nt\n\ne\n?s2\n2 ds,\n\nonde \u00b5 e ?a s\u00e3o definidos pelas equa\u00e7\u00f5es (10) e (14) no artigo de Leclaire e Moisan [LM15], respec-\ntivamente.\n\nO c\u00e1lculo de S \u00e9 mais complexo do que o das outras medidas apresentadas aqui, e envolve o\nuso de uma FFT. Al\u00e9m disso, como a imagem \u00e9 tratada de forma peri\u00f3dica, bordas opostas da\nimagem podem gerar descontinuidades. Para evitar isso, os autores sugerem que seja usada uma\ndecomposi\u00e7\u00e3o peri\u00f3dica da imagem original, cujo c\u00e1lculo envolve o uso de uma FFT e uma IFFT.\nCom isso, temos o equivalente a tr\u00eas usos da FFT para o c\u00e1lculo desta medida.\n\nMomento Central Absoluto com Filtro Passa-altas\n\nBaseada no Momento Central Absoluto, mas com a aplica\u00e7\u00e3o de um filtro passa-altas [LJ05]. A\nimagem filtrada \u00e9\n\nI(i, j)HP =\n{?\nI(i, j)\n\n??\n|I(i, j) ? I(i ? s, j)| ? T\n\n}?\nO valor s \u00e9 o passo do filtro e T \u00e9 um valor de limiariza\u00e7\u00e3o, que descarta parte dos pixels. A imagem\nfiltrada \u00e9 um conjunto de pixels, podendo inclusive ser vazia, sendo que neste caso o valor da medida\n\u00e9 0 por defini\u00e7\u00e3o.\n\nO Momento Central Absoluto com Filtro Passa-altas (HPACM) \u00e9\n\nHPACM(I) = ACM(IHP ),\n\nou seja, utilizamos a medida ACM definida anteriormente na imagem filtrada.\n\nMagnitude do Gradiente Gaussiano\n\nA partir da fun\u00e7\u00e3o gaussiana em duas dimens\u00f5es\n\nG?(x, y) =\n1\n\n2??2\nexp?\n\nx2+y2\n\n2?? ,\n\nonde ? \u00e9 o desvio padr\u00e3o, obtemos o gradiente\n\n?G? =\n[?\n?G?\n?x\n\n,\n?G?\n?y\n\n]?T\n.\n\nPodemos realizar a convolu\u00e7\u00e3o deste gradiente gaussiano com a imagem I e utilizar o resultado\npara obter a magnitude do gradiente gaussiano\n\nGGM =\n\n??(?\n?G?\n?x\n\n? I\n)?2\n\n+\n\n(?\n?G?\n?y\n\n? I\n)?2\n\n.\n\nComo medida de focaliza\u00e7\u00e3o, podemos utilizar o somat\u00f3rio\n\nGGMSUM =\n??\ni\n\n??\nj\n\nGGM\n\nou a vari\u00e2ncia\nGGMVAR =\n\n??\ni\n\n??\nj\n\n(?\nGGM(i, j) ? GGM\n\n)?2\n.\n\n\n\n60 FOCALIZA\u00c7\u00c3O 5.1\n\nM\u00e1ximo Orientado da Intensidade\n\nEsta medida foi criada originalmente para determinar o valor de focaliza\u00e7\u00e3o de pixels, e n\u00e3o da\nimagem como um todo [Loo11]. Por\u00e9m, podemos utilizar o somat\u00f3rio dos valores de todos os pixels\npara obter a medida de foco\n\nSIM(I) =\n??\ni,j\n\nSM(i, j) [Imax ? I(i, j)] ,\n\nonde SM \u00e9 a magnitude do gradiente gaussiano da imagem, e Imax \u00e9 uma constante maior do\nque qualquer valor I(i, j). Utilizaremos Imax = 255, supondo que os valores da imagem est\u00e3o no\nintervalo [0, 255]. Tamb\u00e9m podemos calcular a vari\u00e2ncia, ao inv\u00e9s de utilizar a soma dos valores:\n\nSIMVAR(I) = Var(SM(i, j) [Imax ? I(i, j)]).\n\nN\u00e3o temos conhecimento do uso da medida SIMVAR na literatura.\n\nCorrela\u00e7\u00e3o do Desvio Padr\u00e3o\n\nEsta medida \u00e9 baseada em correla\u00e7\u00e3o para diferenciar imagens bem focalizadas das que est\u00e3o\nfora de foco. \u00c9 calculada a partir da f\u00f3rmula [LSHW09]\n\nSDC =\n1\n\n(M ? 1)N\n\nM?1??\ni=1\n\nN??\nj=1\n\nI(i + 1, j)I(i, j) ? I?2,\n\nonde I \u00e9 uma imagem de tamanho M \u00d7 N.\n\nSoma do Laplaciano Modificado\n\nOriginalmente foi definida para uma janela ao redor de cada pixel , mas aqui utilizaremos a\nimagem como um todo. Para evitar o cancelamento de termos, o operador laplaciano \u00e9 modificado\npara utilizar valores absolutos:\n\n?2I(i, j) = |2I(i, j) ? I(i ? 1, j) ? I(i + 1, j)| + |2I(i, j) ? I(i, j ? 1) ? I(i, j + 1)|\n\nO valor da medida \u00e9 [NN94]\n\nSML =\n??\ni,j\n\n?2I(i, j), para ?2I(i, j) ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o.\n\nSoma Cruzada do Laplaciano Modificado\n\nSimilar \u00e0 Soma do Laplaciano Modificado, mas tamb\u00e9m considera os pixels nas diagonais e\nutiliza um passo s:\n\n?2XSMLI(i, j) = |2I(i, j) ? I(i ? s, j) ? I(i + s, j)| + |2I(i, j) ? I(i, j ? s) ? I(i, j + s)|\n\n+\n1\n?\n2\n|2I(i, j) ? I(i ? s, j ? s) ? I(i + s, j + s)|\n\n+\n1\n?\n2\n|2I(i, j) ? I(i ? s, j + s) ? I(i + s, j ? s)|\n\n\n\n5.1 MEDIDAS DE FOCO 61\n\nO valor da medida \u00e9 [TFHH09]\n\nXSML =\n??\ni,j\n\n?2XSMLI(i, j), para ?\n2\nXSMLI(i, j) ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o.\n\nMedida de Pieper e Korpel\n\nO m\u00e9todo de Pieper e Korpel utiliza um operador diferencial n\u00e3o-direcional [BCP+09]\n\nPK(i, j) = |I(i ? 1, j + 1) ? I(i + 1, j ? 1)| + |I(i + 1, j + 1) ? I(i ? 1, j ? 1)|\n+ |I(i, j + 1) ? I(i, j ? 1)| + |I(i ? 1, j) ? I(i + 1, j)|\n\nO valor da medida \u00e9\nPK =\n\n??\ni,j\n\nPK(i, j).\n\nTenengrad\n\nO m\u00e9todo de Tenengrad utiliza o filtro passa-altas de Sobel\n\n?S(i, j) =\n??\n?Sx(i, j)2 + ?Sy(i, j)2,\n\nonde ?Sx(i, j) e ?Sy(i, j) s\u00e3o os filtros horizontal e vertical de Sobel, respectivamente, calculados\natrav\u00e9s das m\u00e1scaras de convolu\u00e7\u00e3o\n\nSx =\n\n?\n?1 0 ?12 0 ?2\n1 0 ?1\n\n?\n? ; Sy =\n\n?\n? 1 2 10 0 0\n?1 ?2 ?1\n\n?\n? .\n\nO valor da medida \u00e9 [BCP+09]\n\nTenengrad =\nM?1??\ni=2\n\nN?1??\nj=2\n\n(?S(i, j))2 , para ?S(i, j) ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o.\n\nBoddeke\n\nEste m\u00e9todo utiliza um filtro passa-altas em uma dimens\u00e3o\n\n?B(i, j) = I(i + 1, j) ? I(i ? 1, j)\n\npara obter a medida [BIA+05]\n\nBoddeke =\nM?1??\ni=2\n\nN??\nj=1\n\n[?B(i, j)]2 .\n\nLaplaciano\n\nAp\u00f3s aplicar o filtro laplaciano utilizando a m\u00e1scara de convolu\u00e7\u00e3o\n\nL =\n\n?\n? 0 ?1 0?1 4 ?1\n\n0 ?1 0\n\n?\n? ,\n\n\n\n62 FOCALIZA\u00c7\u00c3O 5.1\n\nobt\u00e9m-se o valor da medida [BIA+05]\n\nLaplaciano =\nM?1??\ni=2\n\nN?1??\nj=2\n\n|?L(i, j)| , para |?L(i, j)| ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o.\n\nEnergia do Laplaciano\n\nNesta medida o filtro laplaciano \u00e9 utilizado com a m\u00e1scara de convolu\u00e7\u00e3o\n\nL =\n\n?\n??1 ?4 ?1?4 20 ?4\n?1 ?4 ?1\n\n?\n?\n\npara obter o valor da medida [HJ07]\n\nEOL =\nM?1??\ni=2\n\nN?1??\nj=2\n\n(?L(i, j))2 .\n\nEnergia Quadr\u00e1tica do Gradiente\n\nA Energia Quadr\u00e1tica do Gradiente \u00e9 [BCP+09, HJ07]\n\nEOGS =\nM??\ni=2\n\nN??\nj=2\n\n(?\nfx(i, j)\n\n2 + fy(i, j)\n2\n)?\n,\n\nfx(i, j) = I(i, j) ? I(i ? 1, j),\nfy(i, j) = I(i, j) ? I(i, j ? 1).\n\nUma defini\u00e7\u00e3o similar \u00e9 chamada de Frequ\u00eancia Espacial (spatial frequency) [HJ07, LY08]:\n\nSF =\n??\n\n(RF)2 + (CF)2,\n\nRF =\n\n???\n? 1\n\nMN\n\nM??\ni=1\n\nN??\nj=2\n\n[I(i, j) ? I(i, j ? 1)]2,\n\nCF =\n\n???\n? 1\n\nMN\n\nM??\ni=2\n\nN??\nj=1\n\n[I(i, j) ? I(i ? 1, j)]2.\n\nComo utilizamos os valores das medidas de forma relativa, buscando o valor m\u00e1ximo, as duas\ndefini\u00e7\u00f5es s\u00e3o equivalentes e apenas a medida EOGS ser\u00e1 considerada.\n\nVari\u00e2ncia de Sobel\n\nSimilar \u00e0 medida Tenengrad, por\u00e9m calcula a vari\u00e2ncia do gradiente da imagem ap\u00f3s aplicar o\nfiltro de Sobel [PPCCMFV00]:\n\nSOBVAR =\nM?1??\ni=2\n\nN?1??\nj=2\n\n(?\n?S(i, j) ? ?S\n\n)?2\n, para ?S(i, j) ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o.\n\n\n\n5.1 MEDIDAS DE FOCO 63\n\nVari\u00e2ncia do Laplaciano\n\nSimilar \u00e0 medida Laplaciano, por\u00e9m calcula a vari\u00e2ncia do gradiente da imagem ap\u00f3s aplicar o\nfiltro laplaciano [PPCCMFV00]:\n\nLAPVAR =\nM?1??\ni=2\n\nN?1??\nj=2\n\n(?\n|?L(i, j)| ? ?L\n\n)?2\n, para |?L(i, j)| ? T,\n\nonde T \u00e9 um valor de limiariza\u00e7\u00e3o e ?L \u00e9 a m\u00e9dia dos valores absolutos de ?L(i, j).\n\n5.1.3 Medidas com janelas\n\nEstas medidas realizam c\u00e1lculos primeiramente em uma janela ao redor de cada pixel , e depois\nagregam os resultados de todas as janelas. Nos m\u00e9todos considerados existem tr\u00eas passos: o primeiro,\nopcional, \u00e9 a aplica\u00e7\u00e3o de algum filtro na imagem; o segundo calcula a vari\u00e2ncia em uma janela de\ntamanho fixo ao redor de cada pixel ; e o terceiro calcula a soma ou vari\u00e2ncia de todos os valores.\nO segundo passo resulta em uma imagem ligeiramente menor dependendo do tamanho da janela,\npois s\u00e3o usadas apenas janelas contidas inteiramente na imagem.\n\nComo estes algoritmos calculam a vari\u00e2ncia de janelas na imagem, \u00e9 importante que a implemen-\nta\u00e7\u00e3o seja feita de forma eficiente. No artigo de Bueno-Ibarra et. al [BIA+05], por exemplo, o c\u00e1lculo\nda Vari\u00e2ncia Global em uma imagem de 3.2 MP possui tempo de execu\u00e7\u00e3o de quase 28 segundos,\nmuito maior do que outros algoritmos testados no artigo. Uma forma simples de realizar o c\u00e1lculo\nda vari\u00e2ncia em janelas de forma mais eficiente \u00e9 atrav\u00e9s da f\u00f3rmula\n\nVar(I) = E[I2] ? (E[I])2.\n\nOu seja, primeiro calcula-se a imagem com os valores ao quadrado I2, e depois calcula-se a m\u00e9dia\nem janelas nesta imagem para se obter E[I2] para cada janela. Ent\u00e3o calcula-se a m\u00e9dia em janelas\nna imagem original e subtrai-se os valores ao quadrado (E[I])2 dos valores obtidos no passo anterior,\nresultando nas vari\u00e2ncias das janelas Var(I).\n\nO c\u00e1lculo da m\u00e9dia em janelas pode ser feito em duas etapas, uma para cada dimens\u00e3o da\nimagem. Em cada dimens\u00e3o \u00e9 calculada a m\u00e9dia m\u00f3vel, que pode ser obtida de forma iterativa\nsubtraindo o \u00faltimo elemento da janela e somando o pr\u00f3ximo, dividindo o resultado pela largura\nda janela e somando este valor \u00e0 m\u00e9dia da janela anterior. Ou seja, n\u00e3o \u00e9 necess\u00e1rio somar todos os\nelementos da janela novamente a cada passo, bastando calcular uma subtra\u00e7\u00e3o, uma divis\u00e3o e uma\nsoma por passo. Na biblioteca SciPy a m\u00e9dia m\u00f3vel em duas dimens\u00f5es \u00e9 calculada pela fun\u00e7\u00e3o\nuniform_filter, atrav\u00e9s da qual se obt\u00e9m a Vari\u00e2ncia Global de uma imagem de 3.2 MP em cerca de\n272 ms, quando calculada em um MacBook Pro com processador Intel Core i5 de 2.5 GHz e 8 GB\nde mem\u00f3ria DDR3 1600 MHz.\n\nVari\u00e2ncia Global\n\nA Vari\u00e2ncia Global [PPCCMFV00, BIA+05] primeiro calcula a vari\u00e2ncia da imagem I em janelas\nde largura e altura r, resultando em uma imagem de vari\u00e2ncias locais ILV . Por fim \u00e9 calculado o\nvalor da medida\n\nGBLVAR = Var(ILV ).\n\nVari\u00e2ncia Global do Gradiente Gaussiano\n\nA medida GBLVARGG \u00e9 o resultado da Vari\u00e2ncia Global aplicada no gradiente gaussiano da\nimagem. N\u00e3o temos conhecimento do uso desta medida na literatura.\n\n\n\n64 FOCALIZA\u00c7\u00c3O 5.3\n\nVari\u00e2ncia Total do Gradiente Gaussiano\n\nEsta medida \u00e9 similar \u00e0 Vari\u00e2ncia Global do Gradiente Gaussiano, mas utiliza um somat\u00f3rio no\n\u00faltimo passo, ao inv\u00e9s da vari\u00e2ncia. Primeiro \u00e9 calculado o gradiente gaussiano da imagem, e ent\u00e3o\ncalcula-se a vari\u00e2ncia deste gradiente em janelas de altura e largura r, resultando em uma imagem\nde vari\u00e2ncias locais ILV . Por fim \u00e9 calculado o valor da medida\n\nTOTVAR =\n??\n\nILV .\n\nN\u00e3o temos conhecimento do uso desta medida na literatura.\n\nVari\u00e2ncia Global do Laplaciano do Gaussiano\n\nA medida GBLVARLoG \u00e9 o resultado da Vari\u00e2ncia Global aplicada no laplaciano do gaussiano\nda imagem. N\u00e3o temos conhecimento do uso desta medida na literatura.\n\n5.2 Complexidade computacional\n\nIremos supor que o gradiente gaussiano \u00e9 utilizado com um par\u00e2metro ? de valor inferior a\numa constante razo\u00e1vel, digamos ? ? 32. Para uma imagem de tamanho N \u00d7 N, os algoritmos\ndas medidas de foco possuem complexidade O(N2), com exce\u00e7\u00e3o do \u00cdndice S, que utiliza a FFT e\npossui complexidade O(N2 log N).\n\nPortanto, o maior gasto computacional na focaliza\u00e7\u00e3o decorre das reconstru\u00e7\u00f5es hologr\u00e1ficas a\ndiversas dist\u00e2ncias, e n\u00e3o do c\u00e1lculo de uma medida de foco (desconsiderando o \u00cdndice S).\n\n5.3 Resultados experimentais\n\nAs medidas de focaliza\u00e7\u00e3o ser\u00e3o avaliadas de acordo com o erro m\u00e9dio (ME) e a raiz do erro\nquadr\u00e1tico m\u00e9dio (RMSE). Para cada imagem, o erro \u00e9 calculado como a diferen\u00e7a absoluta entre\na dist\u00e2ncia obtida pela medida de foco e a dist\u00e2ncia de refer\u00eancia, em mil\u00edmetros.\n\nComo ser\u00e3o utilizadas imagens obtidas experimentalmente, n\u00e3o \u00e9 poss\u00edvel saber a dist\u00e2ncia\ncorreta de cada objeto. Por este motivo, cada imagem foi focalizada manualmente, e a dist\u00e2ncia\nescolhida \u00e9 utilizada como refer\u00eancia. Existe alguma subjetividade neste processo, pois pessoas dife-\nrentes poderiam focalizar a mesma imagem em dist\u00e2ncias diferentes. Por\u00e9m, como cada imagem foi\nreconstru\u00edda em v\u00e1rios passos uniformemente espa\u00e7ados, e considerando as dist\u00e2ncias destes passos\nque foram usadas nos experimentos entre uma reconstru\u00e7\u00e3o hologr\u00e1fica e a reconstru\u00e7\u00e3o imediata-\nmente seguinte, para grande parte das imagens existe apenas uma dist\u00e2ncia que est\u00e1 claramente\nmelhor focalizada do que as demais. Al\u00e9m disso, o pr\u00f3prio problema sendo analisado possui certa\nambiguidade, pois como os objetos sendo focalizados s\u00e3o tridimensionais, \u00e9 comum que diferentes\nsegmentos do objeto estejam bem focalizados a dist\u00e2ncias distintas, n\u00e3o havendo uma \u00fanica dist\u00e2n-\ncia que seja a correta. Desta forma, acreditamos que o uso de dist\u00e2ncias escolhidas manualmente \u00e9\nrazo\u00e1vel, desde que se tenha em mente que diferen\u00e7as muito pequenas entre os erros das medidas\nde foco podem ser o resultado desta subjetividade ou da ambiguidade do problema de focaliza\u00e7\u00e3o.\n\nPara obter as imagens que ser\u00e3o focalizadas, cada holograma foi estendido com a Minimiza\u00e7\u00e3o\ndo Laplaciano, descrita no Cap\u00edtulo 4, e reconstru\u00eddo a 30 dist\u00e2ncias diferentes, espa\u00e7adas de forma\nuniforme. As reconstru\u00e7\u00f5es foram limiarizadas para que as intensidades ficassem no intervalo [0, 255].\nAlgumas regi\u00f5es que continham algum objeto foram escolhidas para serem focalizadas, evitando\nregi\u00f5es com mais de um objeto, exceto quando um destes \u00e9 muito maior do que os demais, caso em\nque este objeto maior \u00e9 o que foi focalizado. As medidas de foco foram aplicadas nestas regi\u00f5es, e a\ndist\u00e2ncia que maximiza (ou minimiza) o valor da medida \u00e9 considerada como a melhor focalizada\nsegundo a medida sendo avaliada.\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 65\n\n5.3.1 Resultados\n\nForam utilizados tr\u00eas conjuntos de imagens, obtidas experimentalmente de amostras diferen-\ntes de organismos planct\u00f4nicos. Nos tr\u00eas conjuntos, a c\u00e2mera utilizada possui pixels quadrados de\n3.45 \u00b5m de largura. No conjunto A, o laser utilizado possui comprimento de onda de 660 nm e os\nhologramas foram reconstru\u00eddos entre 5 cm e 7 cm. No conjunto B, o laser utilizado possui com-\nprimento de onda de 660 nm e os hologramas foram reconstru\u00eddos entre 6 cm e 8 cm. No conjunto\nC, o laser utilizado possui comprimento de onda de 633 nm e os hologramas foram reconstru\u00ed-\ndos entre 2.5 cm e 4 cm. Com isso, os hologramas dos conjuntos A e B foram reconstru\u00eddos com\naproximadamente 0.6897 mm de dist\u00e2ncia entre cada reconstru\u00e7\u00e3o, e os hologramas do conjunto C\ncom aproximadamente 0.5172 mm de dist\u00e2ncia entre cada reconstru\u00e7\u00e3o. O conjunto A possui 19\nimagens, o conjunto B possui 50 imagens e o conjunto C possui 118 imagens, em um total de 187\nimagens. Algumas destas imagens podem ser visualizadas no Ap\u00eandice B, que cont\u00e9m reconstru\u00e7\u00f5es\nrealizadas \u00e0 dist\u00e2ncia escolhida manualmente como sendo a correta.\n\nAo exibir os erros das medidas, iremos desconsiderar medidas com erro m\u00e9dio superior a dois\npassos da dist\u00e2ncia de refer\u00eancia, ou seja, com erro m\u00e9dio superior a 2 \u00d7 0.6897 mm = 1.3794 mm\npara os conjuntos A e B, superior a 2 \u00d7 0.5172 mm = 1.0344 mm para o conjunto C, e superior a\n1.1617 mm para a uni\u00e3o dos tr\u00eas conjuntos. Uma grande quantidade das medidas avaliadas mostrou-\nse inadequada para a focaliza\u00e7\u00e3o de imagens hologr\u00e1ficas de organismos planct\u00f4nicos, e omiti-las\nfacilitar\u00e1 a interpreta\u00e7\u00e3o dos resultados.\n\nAs seguintes medidas foram maximizadas: SIMVAR, GBLVAR, TOTVAR, GGMVAR, SOBVAR,\nGBLVARGG, GBLVARLoG, HPACM, LAPVAR, Amplitude, Laplaciano, \u00cdndice S, SDC, Vari\u00e2ncia,\nTamuraaprox, SML, Tenengrad, EOL, EOGS, XSML, Boddeke, TV.\n\nAs seguintes medidas foram minimizadas: Entropia, GGMSUM, SIM, ACM, Tamura, PK.\nFoi utilizado o par\u00e2metro ? = 1 para as medidas TOTVAR, SIMVAR, GGMVAR, e GBLVARGG;\n\no par\u00e2metro ? = 1.5 para a medida GBLVARLoG; e ? = 2 para as medidas GGMSUM e SIM. Foram\nutilizadas janelas de largura e altura igual a 6 pixels para as medidas GBLVAR e GBLVARGG, e\n20 pixels para as medidas TOTVAR e GBLVARLoG. Foi realizada uma limiariza\u00e7\u00e3o com T = 30\nnas medidas SOBVAR, LAPVAR e Laplaciano; T = 32 na medida HPACM; T = 40 na medida\nSML; T = 70 na medida XSML; e T = 100 na medida Tenengrad. Na medida HPACM foi utilizado\no passo s = 5.\n\nNa figura 5.2 s\u00e3o exibidas todas as reconstru\u00e7\u00f5es utilizadas no experimento para um dos or-\nganismos do conjunto C. Os valores de algumas medidas de foco para este organismo podem ser\nvistos na figura 5.3. Existem v\u00e1rias caracter\u00edsticas que dificultam a focaliza\u00e7\u00e3o desta imagem: o\norganismo \u00e9 pequeno, n\u00e3o possuindo muitas bordas bem definidas; existem padr\u00f5es de difra\u00e7\u00e3o no\nlado esquerdo da regi\u00e3o inferior da imagem, que aparentam ser de outro organismo pr\u00f3ximo que\nn\u00e3o aparece na reconstru\u00e7\u00e3o; e tamb\u00e9m existe um padr\u00e3o de interfer\u00eancia formado por linhas quase\nhorizontais que criam oscila\u00e7\u00f5es na intensidade. O resultado \u00e9 que as medidas SOBVAR e HPACM\ns\u00e3o maximizadas em dist\u00e2ncias incorretas de focaliza\u00e7\u00e3o, al\u00e9m de apresentarem fortes oscila\u00e7\u00f5es em\nseus valores.\n\nNa figura 5.4 s\u00e3o exibidas todas as reconstru\u00e7\u00f5es de outro organismo do conjunto C que foram\nutilizadas no experimento. Os valores de algumas medidas de foco para este organismo podem ser\nvistos na figura 5.5. Este exemplo tamb\u00e9m possui caracter\u00edsticas que dificultam sua focaliza\u00e7\u00e3o: o\norganismo \u00e9 transparente, possuindo intensidades que s\u00e3o em grande parte similares ao fundo; al\u00e9m\ndisso, quando est\u00e1 fora de foco a sua forma esf\u00e9rica cria padr\u00f5es de difra\u00e7\u00e3o circulares, que algumas\nmedidas n\u00e3o diferenciam da imagem focalizada. Neste caso, as medidas GBLVARGG, GBLVAR e\nGBLVARLoG s\u00e3o maximizadas em dist\u00e2ncias incorretas de focaliza\u00e7\u00e3o, al\u00e9m de apresentarem fortes\noscila\u00e7\u00f5es na regi\u00e3o pr\u00f3xima ao valor m\u00e1ximo.\n\nA tabela 5.1 apresenta os erros de focaliza\u00e7\u00e3o para o conjunto A. O uso das medidas TOTVAR\ne SIMVAR resultou na focaliza\u00e7\u00e3o incorreta de apenas 1 imagem em 19, com a escolha de outra\ndist\u00e2ncia imediatamente seguida, enquanto que para as medidas Amplitude e GBLVARGG o mesmo\nocorreu em 2 imagens.\n\nNa tabela 5.2, podemos ver que o uso das medidas SIMVAR e GGMVAR resultou nos menores\n\n\n\n66 FOCALIZA\u00c7\u00c3O 5.3\n\nFigura 5.2: Exemplo de organismo sendo focalizado. Este organismo pertence ao conjunto C, e \u00e9 de dif\u00edcil\nfocaliza\u00e7\u00e3o por ser extremamente pequeno para a c\u00e2mera e possuir poucos detalhes. Todas as reconstru\u00e7\u00f5es\nutilizadas no experimento de focaliza\u00e7\u00e3o s\u00e3o exibidas, com a dist\u00e2ncia de reconstru\u00e7\u00e3o aumentando da es-\nquerda para a direita, de cima para baixo. A imagem escolhida manualmente como a melhor focalizada \u00e9 a\nquinta da terceira linha.\n\nTabela 5.1: Erros de focaliza\u00e7\u00e3o - Conjunto A\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nTOTVAR 0.15822 0.03630\nSIMVAR 0.15822 0.03630\nAmplitude 0.22375 0.07260\nGBLVARGG 0.22375 0.07260\nGGMVAR 0.27404 0.10889\nSOBVAR 0.27404 0.10889\nGBLVAR 0.27404 0.10889\nGBLVARLoG 0.27404 0.10889\nEntropia 0.67126 0.21779\nHPACM 1.14092 0.36298\nGGMSUM 0.86659 0.72595\nLAPVAR 2.03849 0.79855\nLaplaciano 2.55118 1.37931\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 67\n\nFigura 5.3: Valores de medidas de foco para um organismo. O organismo sendo focalizado \u00e9 o exibido na\nfigura 5.2, e a linha vertical pontilhada representa a dist\u00e2ncia escolhida manualmente. O gr\u00e1fico exibe o\nnegativo da Entropia, desta forma a dist\u00e2ncia escolhida \u00e9 a que maximiza a medida.\n\nTabela 5.2: Erros de focaliza\u00e7\u00e3o - Conjunto B\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nSIMVAR 0.19506 0.05517\nGGMVAR 0.19506 0.05517\nTOTVAR 0.21809 0.06897\nGBLVARGG 0.21809 0.06897\nGBLVAR 0.23890 0.08276\nSOBVAR 0.25805 0.09655\nGBLVARLoG 0.32348 0.12414\nLaplaciano 0.60909 0.26207\nLAPVAR 0.71671 0.30345\nEntropia 2.26013 0.42759\nHPACM 2.19609 0.56552\nSDC 2.48084 0.78621\n\n\n\n68 FOCALIZA\u00c7\u00c3O 5.3\n\nFigura 5.4: Exemplo de organismo sendo focalizado. Este organismo pertence ao conjunto C, e \u00e9 de dif\u00edcil\nfocaliza\u00e7\u00e3o por ser transparente e esf\u00e9rico, criando padr\u00f5es de difra\u00e7\u00e3o que algumas medidas n\u00e3o diferenciam\ndo organismo focalizado. Todas as reconstru\u00e7\u00f5es utilizadas no experimento de focaliza\u00e7\u00e3o s\u00e3o exibidas, com\na dist\u00e2ncia de reconstru\u00e7\u00e3o aumentando da esquerda para a direita, de cima para baixo. A imagem escolhida\nmanualmente como a melhor focalizada \u00e9 a terceira da quarta linha.\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 69\n\nFigura 5.5: Valores de medidas de foco para um organismo. O organismo sendo focalizado \u00e9 o exibido na\nfigura 5.4, e a linha vertical pontilhada representa a dist\u00e2ncia escolhida manualmente. O gr\u00e1fico exibe o\nnegativo da Entropia, desta forma a dist\u00e2ncia escolhida \u00e9 a que maximiza a medida.\n\nerros para as imagens do conjunto B. Com estas medidas obteve-se a focaliza\u00e7\u00e3o incorreta de 4\nimagens em 50, nas quais foi escolhida outra dist\u00e2ncia imediatamente seguida, enquanto que para\nas medidas TOTVAR e GBLVARGG o mesmo ocorreu em 5 imagens.\n\nTabela 5.3: Erros de focaliza\u00e7\u00e3o - Conjunto C\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nTOTVAR 0.17168 0.05698\nSIMVAR 0.20202 0.07890\nGBLVAR 0.50840 0.10520\nGGMVAR 0.27353 0.10959\nGBLVARGG 0.59852 0.11397\nSOBVAR 0.72370 0.17972\nHPACM 0.55325 0.31999\nEntropia 1.50575 0.42957\nGBLVARLoG 1.34846 0.43834\n\nNa tabela 5.3 s\u00e3o apresentados os erros de focaliza\u00e7\u00e3o para as imagens do conjunto C. O uso da\nmedida TOTVAR resultou na focaliza\u00e7\u00e3o incorreta de 13 imagens em 118, nas quais foi escolhida\noutra dist\u00e2ncia imediatamente seguida, e para a medida SIMVAR o mesmo ocorreu em 18 imagens.\n\nA figura 5.6 exibe as distribui\u00e7\u00f5es de erros de focaliza\u00e7\u00e3o para cada uma das medidas testadas,\nconsiderando o conjunto total de 187 imagens. Enquanto que nas tabelas foram utilizados os erros\nabsolutos, nesta figura existem erros positivos e negativos. Isto permite diferenciar o caso em que\na dist\u00e2ncia de reconstru\u00e7\u00e3o escolhida foi pr\u00f3xima demais ao sensor da c\u00e2mera do caso em que a\ndist\u00e2ncia foi muito distante. Atrav\u00e9s dos quartis, \u00e9 poss\u00edvel notar no gr\u00e1fico superior que v\u00e1rias das\nmelhores medidas obtiveram a dist\u00e2ncia correta de focaliza\u00e7\u00e3o para pelo menos 50% das imagens.\n\n\n\n70 FOCALIZA\u00c7\u00c3O 5.3\n\nFigura 5.6: Distribui\u00e7\u00e3o dos erros de focaliza\u00e7\u00e3o. Erros negativos indicam uma reconstru\u00e7\u00e3o mais pr\u00f3xima\nao sensor da c\u00e2mera do que a dist\u00e2ncia de refer\u00eancia escolhida manualmente.\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 71\n\nTabela 5.4: Erros de focaliza\u00e7\u00e3o - Total\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nTOTVAR 0.18401 0.05809\nSIMVAR 0.19614 0.06823\nGGMVAR 0.25498 0.09497\nGBLVARGG 0.49381 0.09773\nGBLVAR 0.43126 0.09958\nSOBVAR 0.59659 0.15029\nGBLVARLoG 1.08767 0.32086\nHPACM 1.27080 0.39001\nEntropia 1.68591 0.40752\nLAPVAR 2.15071 0.97547\n\nNas duas medidas com menor erro m\u00e9dio, TOTVAR e SIMVAR, o maior erro foi de apenas um\npasso de focaliza\u00e7\u00e3o para mais ou para menos.\n\nConforme a tabela 5.4, a medida TOTVAR \u00e9 a que obteve o melhor desempenho dentre as\nmedidas avaliadas, possuindo o menor erro m\u00e9dio nos conjuntos de imagens A e C, e um erro\nm\u00e9dio apenas um pouco superior ao da melhor medida para o conjunto B. Por\u00e9m, como foi dito\nanteriormente, estes pequenos erros da medida podem ser atribu\u00eddos \u00e0 subjetividade das dist\u00e2ncias\nde refer\u00eancia e \u00e0 ambiguidade do problema de focaliza\u00e7\u00e3o, e n\u00e3o \u00e9 poss\u00edvel afirmar a partir destes\nresultados que seu desempenho \u00e9 superior ao da medida SIMVAR. Todas as outras medidas obtive-\nram um erro de pelo menos dois passos de focaliza\u00e7\u00e3o para pelo menos uma das imagens. Portanto,\nconclu\u00edmos que as medidas TOTVAR e SIMVAR empataram como as melhores medidas de foco\navaliadas, tendo erros m\u00e9dios extremamente baixos. Lembrando que n\u00e3o temos conhecimento destas\nduas medidas que est\u00e3o sendo propostas neste trabalho sendo utilizadas na literatura.\n\n\u00c9 interessante notar algumas semelhan\u00e7as entre as medidas que obtiveram os menores erros.\nAs quatro melhores medidas utilizam a magnitude do gradiente gaussiano em seu c\u00e1lculo. E das\nsete melhores medidas de foco, todas exceto a TOTVAR podem ser interpretadas como a aplica-\n\u00e7\u00e3o de um filtro na imagem seguida pelo c\u00e1lculo da vari\u00e2ncia da imagem filtrada. Isto faz sentido\nquando comparamos visualmente imagens fora de foco com imagens bem focalizadas: as que est\u00e3o\nfocalizadas possuem algumas bordas fortes e a maior parte da imagem tem poucas varia\u00e7\u00f5es, e\nconforme o objeto \u00e9 desfocalizado as ondas de difra\u00e7\u00e3o geram ondula\u00e7\u00f5es na intensidade de boa\nparte da imagem. Portanto, um filtro que responda a estas varia\u00e7\u00f5es ter\u00e1 um valor bem elevado\npara algumas regi\u00f5es e relativamente baixo para outras em uma imagem focalizada, ou seja, ter\u00e1\numa vari\u00e2ncia alta. J\u00e1 em uma imagem fora de foco as ondas de difra\u00e7\u00e3o ir\u00e3o gerar valores simi-\nlares para este filtro em grande parte da imagem, e a vari\u00e2ncia ser\u00e1 baixa. Outra caracter\u00edstica\nque pode ser observada \u00e9 que v\u00e1rias medidas combinam valores obtidos em diferentes escalas. A\nmedida TOTVAR, por exemplo, utiliza os valores dos pixels para calcular a magnitude do gradiente\ngaussiano, que se torna menos local quanto maior for o valor de ?; depois utiliza esta magnitude\npara calcular a vari\u00e2ncia em janelas, resultando em valores menos localizados do que o gradiente; e\nfinaliza calculando o somat\u00f3rio global para a imagem.\n\nTamb\u00e9m \u00e9 poss\u00edvel combinar mais de uma medida de foco, ao inv\u00e9s de utilizar apenas uma.\nN\u00e3o faremos um estudo detalhado das diferentes formas de realizar estas combina\u00e7\u00f5es, mas apenas\nmostraremos que mesmo uma t\u00e9cnica simples j\u00e1 pode trazer bons resultados. Ao inv\u00e9s de utilizar\na dist\u00e2ncia escolhida por uma medida, utilizamos 5 medidas e escolhemos a mediana como dist\u00e2n-\ncia final. Na tabela 5.5 est\u00e1 o resultado de utilizar a mediana das medidas SIMVAR, GBLVAR,\nTOTVAR, SOBVAR e Entropia. Neste caso, a medida TOTVAR foi calculada com o par\u00e2metro\n? = 2. Os erros nos conjuntos A e B s\u00e3o id\u00eanticos aos da medida SIMVAR, por\u00e9m h\u00e1 uma diminui\u00e7\u00e3o\nnos erros do conjunto C, que s\u00e3o menores do que os erros de qualquer medida individual.\n\n\n\n72 FOCALIZA\u00c7\u00c3O 5.3\n\nTabela 5.5: Erros de focaliza\u00e7\u00e3o - Mediana\n\nConjunto RMSE (mm) Erro m\u00e9dio (mm)\nA 0.15822 0.03630\nB 0.19506 0.05517\nC 0.16495 0.05260\nTotal 0.17287 0.05163\n\nAlgoritmo de autofoco\n\nAs medidas tamb\u00e9m foram avaliadas quando utilizadas em um algoritmo de autofoco que realiza\na focaliza\u00e7\u00e3o em tr\u00eas etapas, com o objetivo de diminuir o n\u00famero total de reconstru\u00e7\u00f5es. Para cada\nimagem s\u00e3o utilizadas as mesmas 30 reconstru\u00e7\u00f5es que nos experimentos anteriores, por\u00e9m em cada\netapa do algoritmo apenas um subconjunto destas reconstru\u00e7\u00f5es tem seu foco avaliado. Na primeira\netapa \u00e9 medido o foco das reconstru\u00e7\u00f5es cujos \u00edndices pertencem ao conjunto {0, 5, 10, 15, 20, 25, 29}.\nNa segunda etapa, al\u00e9m da reconstru\u00e7\u00e3o de \u00edndice k escolhida na etapa anterior, tamb\u00e9m s\u00e3o\nconsideradas as reconstru\u00e7\u00f5es de \u00edndice par e que pertencem ao intervalo ]k ? 5, k + 5[. Na terceira\ne \u00faltima etapa s\u00e3o consideradas as reconstru\u00e7\u00f5es de \u00edndice k ? 1, k e k + 1, onde k \u00e9 o \u00edndice que\nobteve o melhor foco na etapa anterior.\n\n(a) Passo 1 (b) Passo 2\n\nFigura 5.7: Exemplo de execu\u00e7\u00e3o do algoritmo de autofoco. No primeiro passo (a), o foco de algumas\nreconstru\u00e7\u00f5es \u00e9 avaliado por uma medida de foco, e a reconstru\u00e7\u00e3o de \u00edndice 15 \u00e9 a que obt\u00e9m o melhor foco,\nindicado pela linha tracejada vertical. A regi\u00e3o sombreada em torno deste \u00edndice \u00e9 selecionada para o passo\nseguinte (b), no qual as reconstru\u00e7\u00f5es de \u00edndices 12, 14, 16 e 18 s\u00e3o avaliadas. A reconstru\u00e7\u00e3o de \u00edndice\n15 continua sendo a melhor focalizada segundo a medida, e a regi\u00e3o sombreada mais escura \u00e9 selecionada\npara o passo 3. Por\u00e9m, as reconstru\u00e7\u00f5es de \u00edndices 14, 15 e 16 que seriam avaliadas no passo 3 j\u00e1 foram\nexaminadas, e o algoritmo termina escolhendo a reconstru\u00e7\u00e3o de \u00edndice 15 como a melhor focalizada por\nesta medida.\n\nComo exemplo, suponha que das 7 reconstru\u00e7\u00f5es iniciais na primeira etapa, a que est\u00e1 melhor\nfocalizada segundo a medida sendo avaliada \u00e9 a de \u00edndice 15, como ilustrado na figura 5.7a. Na\nsegunda etapa \u00e9 avaliado o foco das reconstru\u00e7\u00f5es de \u00edndices 12, 14, 16 e 18, al\u00e9m da reconstru\u00e7\u00e3o\n15 que j\u00e1 foi avaliada. Suponha que, dentre estas 5 reconstru\u00e7\u00f5es, a de \u00edndice 15 continue sendo\na melhor, como ilustrado na figura 5.7b. Na terceira etapa s\u00e3o avaliadas as reconstru\u00e7\u00f5es 14, 15\ne 16. Como as tr\u00eas j\u00e1 foram avaliadas nas etapas anteriores, temos que a melhor reconstru\u00e7\u00e3o \u00e9\na de \u00edndice 15. Neste exemplo foram feitas 7 reconstru\u00e7\u00f5es na primeira etapa, 4 reconstru\u00e7\u00f5es na\nsegunda e nenhuma reconstru\u00e7\u00e3o na terceira. Com isso temos 11 reconstru\u00e7\u00f5es, ao inv\u00e9s das 30 que\nseriam feitas se a focaliza\u00e7\u00e3o tivesse uma \u00fanica etapa.\n\nOutro exemplo: na primeira etapa a reconstru\u00e7\u00e3o 10 obt\u00e9m o melhor foco, conforme ilustrado na\nfigura 5.8a. Na segunda etapa s\u00e3o avaliadas as reconstru\u00e7\u00f5es 6, 8, 12 e 14, al\u00e9m da reconstru\u00e7\u00e3o 10,\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 73\n\n(a) Passo 1 (b) Passo 2\n\n(c) Passo 3\n\nFigura 5.8: Exemplo de execu\u00e7\u00e3o do algoritmo de autofoco. No primeiro passo (a), o foco de algumas\nreconstru\u00e7\u00f5es \u00e9 avaliado por uma medida de foco, e a reconstru\u00e7\u00e3o de \u00edndice 10 \u00e9 a que obt\u00e9m o melhor foco,\nindicado pela linha tracejada vertical. A regi\u00e3o sombreada em torno deste \u00edndice \u00e9 selecionada para o passo\nseguinte (b), no qual as reconstru\u00e7\u00f5es de \u00edndices 6, 8, 12 e 14 s\u00e3o avaliadas. A reconstru\u00e7\u00e3o de \u00edndice 8\ntorna-se a melhor focalizada segundo a medida, e a regi\u00e3o sombreada mais escura \u00e9 selecionada para o passo\n3. Neste \u00faltimo passo, as reconstru\u00e7\u00f5es de \u00edndices 7 e 9 s\u00e3o avaliadas, e o algoritmo termina escolhendo a\nreconstru\u00e7\u00e3o de \u00edndice 8 como a melhor focalizada segundo a medida.\n\n\n\n74 FOCALIZA\u00c7\u00c3O 5.3\n\nconforme ilustrado na figura 5.8b. Supondo que a reconstru\u00e7\u00e3o 8 obteve o melhor foco, na terceira\netapa s\u00e3o avaliadas as reconstru\u00e7\u00f5es 7, 8 e 9, conforme ilustrado na figura 5.8c. Com rela\u00e7\u00e3o ao\nn\u00famero de reconstru\u00e7\u00f5es este \u00e9 o pior caso, pois foram feitas 7 reconstru\u00e7\u00f5es na primeira etapa, 4\nna segunda e 2 na terceira, totalizando 13 reconstru\u00e7\u00f5es.\n\nTabela 5.6: Erros de autofoco - Conjunto A\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nSIMVAR 0.15822 0.03630\nTOTVAR 0.15822 0.03630\nGBLVARGG 0.22375 0.07260\nSOBVAR 0.27404 0.10889\nGGMVAR 0.27404 0.10889\nGBLVAR 0.27404 0.10889\nGBLVARLoG 0.27404 0.10889\nHPACM 0.31644 0.14519\nEntropia 0.67126 0.21779\nGGMSUM 0.82212 0.68966\nAmplitude 3.01445 0.76225\nLAPVAR 2.12860 0.90744\nLaplaciano 2.55118 1.37931\n\nTabela 5.7: Erros de autofoco - Conjunto B\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nSIMVAR 0.19506 0.05517\nGGMVAR 0.19506 0.05517\nGBLVARGG 0.21809 0.06897\nGBLVAR 0.23890 0.08276\nSOBVAR 0.25805 0.09655\nGBLVARLoG 0.57701 0.23448\nEntropia 2.26013 0.42759\nLAPVAR 1.35846 0.44138\nTOTVAR 2.68169 0.80000\nHPACM 2.85854 1.03448\nLaplaciano 3.39406 1.17241\n\nNas tabelas 5.6, 5.7 e 5.8 s\u00e3o exibidos os erros de focaliza\u00e7\u00e3o ao utilizar este algoritmo de\nautofoco. A medida SIMVAR n\u00e3o s\u00f3 obteve os menores erros nos tr\u00eas conjuntos de imagens, mas os\nerros nos conjuntos A e B s\u00e3o iguais aos dos experimentos anteriores que utilizam 30 reconstru\u00e7\u00f5es,\ndemonstrando a viabilidade de usar este algoritmo para obter focaliza\u00e7\u00f5es mais r\u00e1pidas sem que\nisto resulte em uma perda consider\u00e1vel de precis\u00e3o.\n\n\n\n5.3 RESULTADOS EXPERIMENTAIS 75\n\nTabela 5.8: Erros de autofoco - Conjunto C\n\nMedida RMSE (mm) Erro m\u00e9dio (mm)\nSIMVAR 0.40122 0.11835\nGBLVAR 0.73612 0.17972\nGBLVARGG 1.04213 0.23232\nSOBVAR 0.89842 0.28930\nGGMVAR 1.05939 0.32876\nHPACM 1.09413 0.51724\nTOTVAR 1.60063 0.53477\nGBLVARLoG 1.48299 0.60491\nEntropia 1.99760 0.62244\n\n\n\n76 FOCALIZA\u00c7\u00c3O 5.3\n\n\n\nCap\u00edtulo 6\n\nSistema web\n\nNeste cap\u00edtulo descrevemos o sistema que foi desenvolvido para o processamento de imagens de\nhologramas digitais de pl\u00e2ncton.\n\n6.1 Arquitetura\n\nFigura 6.1: Arquitetura do sistema.\n\nFoi desenvolvido um sistema web para o processamento distribu\u00eddo de imagens hologr\u00e1ficas,\ndisponibilizado sob a licen\u00e7a GPLv2 1 ou vers\u00e3o posterior, cuja arquitetura pode ser vista na\nfigura 6.1. O sistema usa o arcabou\u00e7o Django 2 , sendo programado quase inteiramente na linguagem\nPython, exceto pela interface que utiliza HTML, CSS e JavaScript. Os arquivos de imagens s\u00e3o\narmazenados de forma distribu\u00edda no sistema de arquivos GlusterFS 3 (Files). O Gunicorn 4 \u00e9\nusado nos servidores de aplica\u00e7\u00e3o (Application) . O RabbitMQ 5 \u00e9 usado no servidor de mensagens\n\n1https://www.gnu.org/licenses/gpl-2.0.html Acessado em 6 de julho de 2017.\n2https://www.djangoproject.com/ Acessado em 27 de fevereiro de 2017.\n3https://www.gluster.org/ Acessado em 27 de fevereiro de 2017.\n4http://gunicorn.org/ Acessado em 27 de fevereiro de 2017.\n5https://www.rabbitmq.com/ Acessado em 27 de fevereiro de 2017.\n\n77\n\nhttps://www.gnu.org/licenses/gpl-2.0.html\nhttps://www.djangoproject.com/\nhttps://www.gluster.org/\nhttp://gunicorn.org/\nhttps://www.rabbitmq.com/\n\n\n78 SISTEMA WEB 6.2\n\n(Message Server ) para realizar a comunica\u00e7\u00e3o entre os servidores de aplica\u00e7\u00e3o e os servidores de\nprocessamento (Processing). Nos servidores de processamento, o Celery 6 \u00e9 usado para executar\ntarefas de processamento de forma distribu\u00edda. O status destas tarefas (e.g., \u201cEm processamento\u201d\nou \u201cFinalizada\u201d) \u00e9 armazenado no Redis 7 , que tamb\u00e9m est\u00e1 localizado no servidor de mensagens. O\nbanco de dados (Database) PostgreSQL 8 armazena todos os dados do sistema, exceto as imagens,\npara as quais armazena apenas o caminho do arquivo. O servidor NGINX 9 (Web server ) recebe as\nrequisi\u00e7\u00f5es e as redireciona para os servidores de aplica\u00e7\u00e3o, al\u00e9m de servir os arquivos de imagem.\n\nEsta arquitetura permite uma flexibilidade razo\u00e1vel no crescimento do sistema, podendo serem\nadicionadas novas m\u00e1quinas onde forem mais necess\u00e1rias. O processamento de imagens \u00e9 uma tarefa\nque consome muitos recursos computacionais e \u00e9 demorada, sendo realizado em m\u00e1quinas separa-\ndas de forma ass\u00edncrona. Isto libera os servidores de aplica\u00e7\u00e3o destas tarefas, para que continuem\nrespondendo de forma r\u00e1pida, sem lentid\u00f5es no uso da interface. Os arquivos de imagens, que repre-\nsentam a maior parte dos dados, s\u00e3o armazenados no GlusterFS, que permite distribuir e replicar\nos arquivos em v\u00e1rios dispositivos de armazenamento. Desta forma, mesmo que um dispositivo falhe\nainda \u00e9 poss\u00edvel acessar os arquivos sem a necessidade de recuperar um backup. Tamb\u00e9m facilita a\nadi\u00e7\u00e3o de novos dispositivos de armazenamento, pois todos eles s\u00e3o vistos pelos clientes como um\n\u00fanico sistema de arquivos. O arcabou\u00e7o Django permite que novas funcionalidades sejam adiciona-\ndas ao sistema de forma modular, simplificando o compartilhamento e reaproveitamento de c\u00f3digo\nentre diferentes sistemas. Portanto, a maior dificuldade de se adicionar uma nova funcionalidade ao\nsistema est\u00e1 em seu desenvolvimento, e n\u00e3o na sua integra\u00e7\u00e3o ao resto do c\u00f3digo, incentivando a\nadi\u00e7\u00e3o de novas funcionalidades e a realiza\u00e7\u00e3o de melhorias.\n\nAlgumas dificuldades que surgem nos estudos de pl\u00e2ncton decorrem do uso de diversas m\u00e1qui-\nnas e dispositivos de armazenamento, o que faz com que os dados n\u00e3o sejam facilmente localizados\ne compartilhados entre os diversos pesquisadores. Na pr\u00e1tica, n\u00e3o existe uma pol\u00edtica de geren-\nciamento destes dados, o que pode inclusive ocasionar a perda de meses de pesquisas caso uma\nm\u00e1quina falhe e n\u00e3o existam outras c\u00f3pias. Tendo em vista esta situa\u00e7\u00e3o, e lembrando que a grande\nmaioria dos pesquisadores envolvidos n\u00e3o \u00e9 da \u00e1rea de Tecnologia da Informa\u00e7\u00e3o, escolheu-se a\narquitetura apresentada com o objetivo de centralizar e organizar o armazenamento de imagens\nhologr\u00e1ficas. Apesar da instala\u00e7\u00e3o inicial ser um tanto complexa, a manuten\u00e7\u00e3o pode ser feita sem\ngrandes esfor\u00e7os. Esta arquitetura j\u00e1 prev\u00ea situa\u00e7\u00f5es como a falha em um disco r\u00edgido, e facilita\no compartilhamento de dados at\u00e9 mesmo com grupos de pesquisa localizados em outros pa\u00edses,\nbastando fornecer credenciais de acesso ao sistema.\n\n6.2 Interface\n\nO sistema possui uma interface web, fazendo com que possa ser utilizado de praticamente qual-\nquer computador de forma f\u00e1cil, sem precisar ser instalado em cada m\u00e1quina. A seguir ilustraremos\nas principais caracter\u00edsticas do sistema e sua interface.\n\nA tela inicial do sistema pode ser vista na figura 6.2. Os arquivos de imagens s\u00e3o organizados em\nexperimentos, e nesta figura podem ser vistos alguns dos hologramas de dois experimentos diferentes.\n\nCada experimento possui um conjunto de par\u00e2metros, como pode ser visto na figura 6.3. Estes\npar\u00e2metros incluem as dimens\u00f5es dos pixels da c\u00e2mera, o comprimento de onda do laser, e as\ndist\u00e2ncias m\u00ednima e m\u00e1xima entre a amostra sendo observada e o sensor da c\u00e2mera, entre outros.\n\nAp\u00f3s preencher os par\u00e2metros do experimento, os hologramas podem ser enviados ao sistema,\ncomo ilustrado na figura 6.4. \u00c9 poss\u00edvel realizar o upload de v\u00e1rios arquivos simultaneamente, e\nestes podem ser arrastados e soltados na tela de upload, facilitando o envio.\n\nOs hologramas enviados podem ser visualizados na tela exibida na figura 6.5. \u00c9 poss\u00edvel iniciar\no processamento de todos os hologramas, ou exib\u00ed-los em lista, e ent\u00e3o processar ou excluir alguns\n\n6http://www.celeryproject.org/ Acessado em 27 de fevereiro de 2017.\n7https://redis.io/ Acessado em 27 de fevereiro de 2017.\n8https://www.postgresql.org/ Acessado em 27 de fevereiro de 2017.\n9https://www.nginx.com/ Acessado em 27 de fevereiro de 2017.\n\nhttp://www.celeryproject.org/\nhttps://redis.io/\nhttps://www.postgresql.org/\nhttps://www.nginx.com/\n\n\n6.2 INTERFACE 79\n\nFigura 6.2: Tela inicial.\n\nFigura 6.3: Par\u00e2metros de um experimento.\n\n\n\n80 SISTEMA WEB 6.2\n\nFigura 6.4: Tela para upload de hologramas.\n\nFigura 6.5: Visualiza\u00e7\u00e3o dos hologramas enviados.\n\n\n\n6.2 INTERFACE 81\n\nhologramas espec\u00edficos.\n\n(a) Organismos segmentados (b) Organismo reconstru\u00eddo\n\n(c) Holograma com fundo removido\n\nFigura 6.6: Visualiza\u00e7\u00e3o de um holograma.\n\nAp\u00f3s serem processados, os resultados de cada holograma podem ser vistos como na figura 6.6.\nAo mover o mouse sobre o holograma, as regi\u00f5es segmentadas s\u00e3o destacadas, como na figura 6.6a.\nQuando o mouse \u00e9 colocado sobre uma das regi\u00f5es destacadas, a reconstru\u00e7\u00e3o focalizada desta\nregi\u00e3o \u00e9 exibida como na figura 6.6b, na qual o cop\u00e9podo pr\u00f3ximo ao centro est\u00e1 sendo visualizado.\nExistem alguns organismos que aparentemente n\u00e3o foram segmentados na figura 6.6a, mas grande\nparte destes s\u00e3o parte do fundo da imagem, ou seja, s\u00e3o padr\u00f5es est\u00e1ticos que foram removidos com\no fundo. A imagem sem o fundo pode ser vista selecionando-se um checkbox, como na figura 6.6c.\n\nAs regi\u00f5es de interesse que foram segmentadas e focalizadas automaticamente s\u00e3o exibidas em\numa aba separada, ilustrada na figura 6.7. Os segmentos s\u00e3o separados em tr\u00eas grupos: os que n\u00e3o\nforam validados manualmente, os que precisam ser focalizados manualmente, e os que j\u00e1 foram\nvalidados. \u00c9 poss\u00edvel realizar a valida\u00e7\u00e3o manual de todas as imagens de uma s\u00f3 vez, seja aceitando\nos resultados autom\u00e1ticos, ou exigindo uma focaliza\u00e7\u00e3o manual para todas elas.\n\nA figura 6.8 mostra a tela de focaliza\u00e7\u00e3o manual, na qual uma barra pode ser deslizada para\nmodificar a dist\u00e2ncia de reconstru\u00e7\u00e3o. Quando estiver bem focalizado, basta clicar no bot\u00e3o OK\npara validar o organismo.\n\n\n\n82 SISTEMA WEB 6.2\n\n(a) Organismos segmentados\n\nFigura 6.7: Visualiza\u00e7\u00e3o dos organismos segmentados.\n\n\n\n6.2 INTERFACE 83\n\nFigura 6.8: Focaliza\u00e7\u00e3o manual de um organismo.\n\nOs resultados do processamento podem ser baixados de uma \u00fanica vez na tela de par\u00e2metros,\nno bot\u00e3o Download experiment. Assim, se desejar o usu\u00e1rio pode utilizar outro sistema para realizar\na classifica\u00e7\u00e3o das imagens, por exemplo.\n\n\n\n84 SISTEMA WEB 6.2\n\n\n\nCap\u00edtulo 7\n\nConclus\u00e3o\n\nCriada v\u00e1rias d\u00e9cadas atr\u00e1s, a holografia era uma t\u00e9cnica muito a frente de seu tempo, e ainda\nseriam necess\u00e1rios alguns avan\u00e7os tecnol\u00f3gicos para sua ado\u00e7\u00e3o em maior escala. A inven\u00e7\u00e3o do laser\npermitiu a cria\u00e7\u00e3o de hologramas \u00f3pticos de forma relativamente simples, e avan\u00e7os em computa-\ndores e sensores digitais de c\u00e2meras tornaram a holografia digital uma alternativa pr\u00e1tica. Por\u00e9m,\nainda resta o desenvolvimento de algoritmos e software que transformem os hologramas digitais em\ndados \u00fateis para pesquisadores de forma simples.\n\nAs possibilidades oferecidas pelo processamento digital de hologramas s\u00e3o in\u00fameras, e nas se\u00e7\u00f5es\nabaixo recapitulamos as contribui\u00e7\u00f5es deste trabalho, al\u00e9m de indicar algumas poss\u00edveis linhas de\npesquisa para estend\u00ea-lo.\n\n7.1 Contribui\u00e7\u00f5es\n\nNeste trabalho, detalhamos as diversas etapas de processamento de imagens de holografia di-\ngital de pl\u00e2ncton, partindo dos hologramas obtidos experimentalmente e chegando em imagens\nfocalizadas e segmentadas de organismos planct\u00f4nicos. Realizamos uma an\u00e1lise de diferentes algo-\nritmos de reconstru\u00e7\u00e3o hologr\u00e1fica, verificando como diferentes frequ\u00eancias da imagem s\u00e3o afetadas\ne quais os cuidados necess\u00e1rios para evitar artefatos na imagem final. Tratamos os aspectos discre-\ntos dos algoritmos, notando os efeitos de amostragem de fun\u00e7\u00f5es de transfer\u00eancia, e da convolu\u00e7\u00e3o\ncircular realizada atrav\u00e9s da FFT. Propomos algoritmos para melhorar a qualidade das imagens\nque dificilmente poderiam ser implementados com instrumentos \u00f3pticos: removemos o fundo dos\nhologramas, tornando a ilumina\u00e7\u00e3o mais uniforme e suprimindo artefatos provenientes do sistema\n\u00f3ptico; e estendemos a borda dos hologramas antes de sua reconstru\u00e7\u00e3o, obtendo imagens com me-\nnos ondula\u00e7\u00f5es provenientes da difra\u00e7\u00e3o da borda retangular do holograma. Tamb\u00e9m comparamos\ndiferentes medidas de foco, com as quais podemos obter imagens focalizadas dos organismos de\nforma autom\u00e1tica.\n\nNo Cap\u00edtulo 4, estudamos diversos algoritmos para estender imagens de holografia digital, e pro-\npomos um novo algoritmo: a Minimiza\u00e7\u00e3o do Laplaciano. Fizemos uma compara\u00e7\u00e3o experimental\npara determinar quais destes algoritmos obt\u00eam os menores erros na imagem reconstru\u00edda, e a Mini-\nmiza\u00e7\u00e3o do Laplaciano mostrou-se superior aos outros algoritmos testados. Com isso, conseguimos\ndiminuir consideravelmente o efeito de difra\u00e7\u00e3o da borda do holograma, permitindo a visualiza\u00e7\u00e3o\ndo objeto sendo observado sem estes artefatos que decorrem da natureza finita das dimens\u00f5es da\nimagem.\n\nNo Cap\u00edtulo 5, fizemos a compara\u00e7\u00e3o de diversas medidas de foco, al\u00e9m de propor algumas novas\nmedidas, incluindo a Vari\u00e2ncia Total do Gradiente Gaussiano e a Vari\u00e2ncia do M\u00e1ximo Orientado da\nIntensidade. Realizamos compara\u00e7\u00f5es experimentais das medidas, e estas duas medidas propostas\nmostraram-se superiores a todas as outras que foram avaliadas, com erros de focaliza\u00e7\u00e3o extrema-\nmente pequenos. Tamb\u00e9m apresentamos um algoritmo de autofoco, que realiza um n\u00famero menor\nde reconstru\u00e7\u00f5es hologr\u00e1ficas, diminuindo o tempo de processamento, com pouca perda de qualidade\nna focaliza\u00e7\u00e3o. Conclu\u00edmos que a focaliza\u00e7\u00e3o totalmente autom\u00e1tica de organismos planct\u00f4nicos \u00e9\n\n85\n\n\n\n86 CONCLUS\u00c3O 7.2\n\nperfeitamente fact\u00edvel, o que remove uma das principais dificuldades do uso da holografia no estudo\nde pl\u00e2ncton, que \u00e9 a necessidade de focalizar as imagens ap\u00f3s sua aquisi\u00e7\u00e3o, algo que seria muito\ntrabalhoso se precisasse ser feito de forma manual.\n\nPor fim, no Cap\u00edtulo 6 apresentamos o sistema web que foi desenvolvido para o processamento\nde imagens hologr\u00e1ficas de pl\u00e2ncton. O sistema permite o processamento distribu\u00eddo das imagens,\ndiminuindo o tempo total de processamento. O uso de uma interface web faz com que o sistema\npossa ser usado em praticamente qualquer computador, sem a necessidade de instalar o programa em\ncada m\u00e1quina, bastando a configura\u00e7\u00e3o dos servidores. E sua disponibiliza\u00e7\u00e3o como software livre\nfacilita sua ado\u00e7\u00e3o por diversos pesquisadores, al\u00e9m de permitir futuras melhorias por seus usu\u00e1rios.\nCom isso, os resultados deste trabalho poder\u00e3o ser utilizados no dia-a-dia do estudo de organismos\nplanct\u00f4nicos, sem que para isso seja necess\u00e1rio compreender todos os detalhes e complexidades da\nholografia digital.\n\n7.2 Trabalhos futuros\n\nExistem diversas formas de estender e aprimorar os resultados deste trabalho, e a seguir listamos\nalgumas que julgamos serem interessantes.\n\nUm aspecto pouco estudado na \u00e1rea de holografia digital de pl\u00e2ncton \u00e9 o p\u00f3s-processamento\ndas imagens reconstru\u00eddas, que normalmente consiste apenas na segmenta\u00e7\u00e3o e extra\u00e7\u00e3o de carac-\nter\u00edsticas para classifica\u00e7\u00e3o. Devido \u00e0 capacidade de focalizar numericamente a qualquer dist\u00e2ncia\ndesejada, \u00e9 poss\u00edvel obter um volume que, ap\u00f3s algum processamento, resultaria em uma imagem\ncom qualidade superior a qualquer uma das imagens individuais que o comp\u00f5em.\n\nUma das t\u00e9cnicas existentes \u00e9 a desconvolu\u00e7\u00e3o, que j\u00e1 foi utilizada em holografia com o objetivo\nde obter maior precis\u00e3o na localiza\u00e7\u00e3o de part\u00edculas, e com alguns resultados limitados para objetos\nextensos [LGF10]. A desconvolu\u00e7\u00e3o tamb\u00e9m pode ser usada para diminuir o efeito da imagem\ng\u00eamea ou de objetos fora de foco. A maior desvantagem \u00e9 que o gasto de mem\u00f3ria e o tempo de\nprocessamento s\u00e3o extremamente elevados, diminuindo a utilidade pr\u00e1tica desta t\u00e9cnica. Tamb\u00e9m\n\u00e9 poss\u00edvel realizar a desconvolu\u00e7\u00e3o de uma \u00fanica imagem, e n\u00e3o de um volume, o que poderia ser\numa alternativa com menor custo computacional.\n\nOutro p\u00f3s-processamento poss\u00edvel consiste na remo\u00e7\u00e3o ou supress\u00e3o da imagem g\u00eamea, e v\u00e1rias\nt\u00e9cnicas j\u00e1 foram propostas para realizar esta tarefa, com diferentes graus de sucesso [HKPM09].\nAlgumas delas possuem certas restri\u00e7\u00f5es, como a exig\u00eancia de diferentes configura\u00e7\u00f5es \u00f3pticas, ou\napenas objetos de amplitude.\n\nOutra t\u00e9cnica \u00e9 conhecida por composi\u00e7\u00e3o focal (focus stacking) e permite combinar v\u00e1rias\nimagens, cada uma focalizada a uma dist\u00e2ncia diferente, em uma imagem final que \u00e9 uma \u201ccolagem\u201d\nde peda\u00e7os bem focalizados das imagens originais. Com isso, poderia-se obter uma imagem em que\no organismo inteiro apare\u00e7a focalizado, permitindo visualizar os detalhes de sua morfologia. A\ncomposi\u00e7\u00e3o focal tamb\u00e9m poderia ser feita utilizando o resultado da desconvolu\u00e7\u00e3o de um volume,\ncaso esta desconvolu\u00e7\u00e3o obtenha bons resultados. Na \u00e1rea de holografia, esta t\u00e9cnica e outras\nsimilares j\u00e1 foram utilizadas na microscopia hologr\u00e1fica digital de objetos de fase, para observar\numa ameba [BCP+09], al\u00e9m de ter sido utilizada em objetos n\u00e3o biol\u00f3gicos, tanto macrosc\u00f3picos\nquanto microsc\u00f3picos [MHN08, FGA+05, DJ07, NN\u0160+03], e rostos humanos [TFHH09]. Por\u00e9m,\nnenhuma destas t\u00e9cnicas parece ter sido estudada no processamento de hologramas de pl\u00e2ncton.\n\nAl\u00e9m do algoritmo de autofoco apresentado neste trabalho, tamb\u00e9m \u00e9 poss\u00edvel utilizar outros\nalgoritmos para diminuir o tempo gasto na focaliza\u00e7\u00e3o. Uma possibilidade seria diminuir a resolu\u00e7\u00e3o\ndos hologramas em uma primeira etapa de focaliza\u00e7\u00e3o e, em etapas posteriores, utilizar resolu\u00e7\u00f5es\nmaiores apenas nas dist\u00e2ncias em que a medida de foco indicar a exist\u00eancia de um objeto. Seria\nnecess\u00e1rio estudar como esta resolu\u00e7\u00e3o menor afeta as medidas de foco, para determinar como\nmanter uma focaliza\u00e7\u00e3o confi\u00e1vel mesmo com a perda de detalhes nas primeiras etapas do algoritmo.\n\nNeste trabalho focalizamos a imagem de um organismo como um todo, e n\u00e3o os pixels indivi-\ndualmente, ou pequenas regi\u00f5es da imagem. Caso se deseje posteriormente fazer uma focaliza\u00e7\u00e3o\nmais local, os resultados obtidos no Cap\u00edtulo 5 poder\u00e3o auxiliar na escolha de medidas de foco,\n\n\n\n7.2 TRABALHOS FUTUROS 87\n\nal\u00e9m de ajudar a clarificar quais s\u00e3o as caracter\u00edsticas que distinguem imagens bem focalizadas das\nrestantes. E como ilustrado por Thelen et al. [TFHH09], n\u00e3o \u00e9 poss\u00edvel realizar uma focaliza\u00e7\u00e3o\nmais local em toda a imagem, sendo necess\u00e1rio em v\u00e1rios casos utilizar janelas maiores, nas quais\nos resultados obtidos aqui podem ser aplicados.\n\nAs t\u00e9cnicas utilizadas no artigo de Thelen et al. [TFHH09] poderiam ser analisadas em um\ntrabalho futuro sobre holografia de pl\u00e2ncton, em especial o uso de alguma medida de confian\u00e7a\npara determinar se o valor da medida de foco deve ser utilizado, ou se alguma outra opera\u00e7\u00e3o\ndeve ser realizada. Tamb\u00e9m poderia-se realizar o algoritmo inverso ao do artigo, come\u00e7ando pela\nfocaliza\u00e7\u00e3o de todo o organismo com as medidas deste trabalho, e depois refinando esta focaliza\u00e7\u00e3o\npara regi\u00f5es cada vez menores.\n\nOutra forma de utilizar uma medida de confian\u00e7a seria no algoritmo de autofoco. Caso a medida\nde foco tenha resultados que n\u00e3o sejam considerados confi\u00e1veis, o algoritmo poderia realizar uma\nfocaliza\u00e7\u00e3o mais refinada em todo o intervalo de dist\u00e2ncias, e n\u00e3o apenas na regi\u00e3o em que a\nmedida de foco atinge seu valor m\u00e1ximo (ou m\u00ednimo). Isto aumentaria um pouco o tempo de\nprocessamento, mas poderia melhorar consideravelmente a qualidade de focaliza\u00e7\u00e3o. Uma medida\nde confian\u00e7a tamb\u00e9m poderia ser usada ao combinar v\u00e1rias medidas de foco. Neste trabalho usamos\na mediana das dist\u00e2ncias escolhidas por v\u00e1rias medidas, mas tamb\u00e9m poderia-se usar uma medida\nde confian\u00e7a para descartar as medidas de foco que provavelmente n\u00e3o conseguiram focalizar o\norganismo.\n\nUma aplica\u00e7\u00e3o extremamente relevante do sistema apresentado neste trabalho \u00e9 a classifica\u00e7\u00e3o\nde pl\u00e2ncton. O sistema j\u00e1 permite obter imagens focalizadas e segmentadas dos organismos, e seria\nnecess\u00e1rio realizar a extra\u00e7\u00e3o de caracter\u00edsticas e o treinamento de classificadores, tornando poss\u00edvel\na classifica\u00e7\u00e3o autom\u00e1tica das imagens. Seria necess\u00e1rio determinar quais caracter\u00edsticas s\u00e3o mais\nrelevantes, e quais classificadores s\u00e3o mais precisos, o que demandaria um trabalho consider\u00e1vel, mas\ntornaria o sistema web apresentado uma excelente op\u00e7\u00e3o no estudo de pl\u00e2ncton, sem a necessidade\nde utilizar um sistema secund\u00e1rio para a classifica\u00e7\u00e3o. Tamb\u00e9m seria recomend\u00e1vel analisar o efeito\nde diferentes segmenta\u00e7\u00f5es na qualidade da classifica\u00e7\u00e3o.\n\nFuturamente tamb\u00e9m seria interessante realizar a observa\u00e7\u00e3o in situ dos organismos, e o rastre-\namento destes nas imagens, levando em considera\u00e7\u00e3o o aspecto sequencial das imagens capturadas\ne tratando-as como um v\u00eddeo.\n\nApesar das vantagens apresentadas na arquitetura do sistema web desenvolvido neste trabalho,\nexistem situa\u00e7\u00f5es nas quais esta arquitetura n\u00e3o \u00e9 a ideal. Caso se queira realizar o processamento\ndas imagens a bordo de uma embarca\u00e7\u00e3o, uma aplica\u00e7\u00e3o desktop seria mais apropriada. Outro caso\nseria o de um laborat\u00f3rio sem conex\u00e3o r\u00e1pida \u00e0 internet, e no qual n\u00e3o seja vi\u00e1vel instalar e manter\num servidor com o sistema. E um terceiro caso seria o processamento em um ve\u00edculo subaqu\u00e1tico\naut\u00f4nomo, no qual seria necess\u00e1rio um sistema embarcado.\n\nNo caso do sistema embarcado, mesmo que seja poss\u00edvel realizar a implementa\u00e7\u00e3o na liguagem de\nprograma\u00e7\u00e3o Python, apenas os trechos de c\u00f3digo referentes ao processamento de imagens poderiam\nser reaproveitados. Como uma parte consider\u00e1vel do sistema \u00e9 a interface com o usu\u00e1rio, n\u00e3o seria\nvantajoso tentar modific\u00e1-lo para que funcione de modo embarcado. Se n\u00e3o forem necess\u00e1rias muitas\nmodifica\u00e7\u00f5es no c\u00f3digo de processamento, este poderia ser extra\u00eddo como uma biblioteca que seria\nutilizada pelos dois sistemas.\n\nPara utilizar o sistema como uma aplica\u00e7\u00e3o desktop, com uma instala\u00e7\u00e3o mais simples, por\u00e9m\nlocal, seriam necess\u00e1rias algumas altera\u00e7\u00f5es que demandariam certo esfor\u00e7o 1. Dependendo do\nsistema operacional a ser utilizado, o sistema poderia ser empacotado em um aplicativo utilizando\nferramentas como o py2app 2, Pynsist 3, py2exe 4 ou PyInstaller 5. O arcabou\u00e7o Django continuaria\n\n1https://moosystems.com/articles/14-distribute-django-app-as-native-desktop-app-01.html Acessado em 6 de ju-\nlho de 2017.\n\n2https://pythonhosted.org/py2app/ Acessado em 6 de julho de 2017.\n3https://pynsist.readthedocs.io/ Acessado em 6 de julho de 2017.\n4http://py2exe.org/ Acessado em 6 de julho de 2017.\n5http://www.pyinstaller.org/ Acessado em 6 de julho de 2017.\n\nhttps://moosystems.com/articles/14-distribute-django-app-as-native-desktop-app-01.html\nhttps://pythonhosted.org/py2app/\nhttps://pynsist.readthedocs.io/\nhttp://py2exe.org/\nhttp://www.pyinstaller.org/\n\n\n88 CONCLUS\u00c3O\n\nsendo utilizado, mas com o banco de dados SQLite 6, que \u00e9 mais adequado para uma aplica\u00e7\u00e3o\ndesktop. O GlusterFS e o NGINX n\u00e3o precisariam ser usados, e o Gunicorn seria substitu\u00eddo pelo\nCherryPy 7, que faria o papel de servidor web. Para mostrar as p\u00e1ginas HTML da interface, uma\nforma seria usar o pywebview 8, que exibe o conte\u00fado das p\u00e1ginas em uma janela atrav\u00e9s de\ncomponentes nativos do sistema operacional. Tamb\u00e9m poderia-se usar o Chromium Embedded\nFramework 9, que permite embarcar um navegador web na aplica\u00e7\u00e3o. Isto possui a desvantagem de\naumentar consideravelmente o tamanho do aplicativo, por\u00e9m facilitaria a manuten\u00e7\u00e3o da interface,\nj\u00e1 que os componentes nativos utilizados pelo pywebview poderiam renderizar as p\u00e1ginas de forma\ndistinta em cada sistema operacional.\n\nEm suma, a \u00e1rea de holografia digital abre diversas possibilidades no estudo de pl\u00e2ncton e,\napesar de todos os avan\u00e7os obtidos neste e em outros trabalhos, ainda existem diversas ideias a\nserem exploradas, tornando esta uma \u00e1rea f\u00e9rtil para futuras pesquisas.\n\n6https://sqlite.org Acessado em 6 de julho de 2017.\n7http://www.cherrypy.org/ Acessado em 6 de julho de 2017.\n8https://github.com/r0x0r/pywebview Acessado em 6 de julho de 2017.\n9https://bitbucket.org/chromiumembedded/cef Acessado em 6 de julho de 2017.\n\nhttps://sqlite.org\nhttp://www.cherrypy.org/\nhttps://github.com/r0x0r/pywebview\nhttps://bitbucket.org/chromiumembedded/cef\n\n\nAp\u00eandice A\n\nImagens utilizadas no experimento de\nextens\u00f5es de borda\n\nAs 36 imagens deste ap\u00eandice foram utilizadas no primeiro experimento comparando os erros\ndas diferentes extens\u00f5es de borda. S\u00e3o exibidos os hologramas originais e suas reconstru\u00e7\u00f5es, que\nforam utilizadas como refer\u00eancia, utilizando os mesmos par\u00e2metros usados no experimento. Um\nret\u00e2ngulo branco nos hologramas mostra a regi\u00e3o da imagem que foi estendida com cada m\u00e9todo\nantes de ser reconstru\u00edda para a compara\u00e7\u00e3o. Um ret\u00e2ngulo branco na reconstru\u00e7\u00e3o mostra a regi\u00e3o\nda imagem utilizada como refer\u00eancia no c\u00e1lculo do erro.\n\nFigura A.1: Hologramas utilizados no experimento de extens\u00e3o de borda. A regi\u00e3o destacada foi estendida\ne reconstru\u00edda utilizando os v\u00e1rios m\u00e9todos de extens\u00e3o de borda, e o holograma inteiro foi reconstru\u00eddo com\na extens\u00e3o com zeros para obter a regi\u00e3o utilizada como refer\u00eancia no c\u00e1lculo do RMSE.\n\n89\n\n\n\n90 AP\u00caNDICE A\n\nFigura A.2: Hologramas utilizados no experimento de extens\u00e3o de borda. A regi\u00e3o destacada foi estendida\ne reconstru\u00edda utilizando os v\u00e1rios m\u00e9todos de extens\u00e3o de borda, e o holograma inteiro foi reconstru\u00eddo com\na extens\u00e3o com zeros para obter a regi\u00e3o utilizada como refer\u00eancia no c\u00e1lculo do RMSE.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE EXTENS\u00d5ES DE BORDA 91\n\nFigura A.3: Hologramas utilizados no experimento de extens\u00e3o de borda. A regi\u00e3o destacada foi estendida\ne reconstru\u00edda utilizando os v\u00e1rios m\u00e9todos de extens\u00e3o de borda, e o holograma inteiro foi reconstru\u00eddo com\na extens\u00e3o com zeros para obter a regi\u00e3o utilizada como refer\u00eancia no c\u00e1lculo do RMSE.\n\n\n\n92 AP\u00caNDICE A\n\nFigura A.4: Hologramas utilizados no experimento de extens\u00e3o de borda. A regi\u00e3o destacada foi estendida\ne reconstru\u00edda utilizando os v\u00e1rios m\u00e9todos de extens\u00e3o de borda, e o holograma inteiro foi reconstru\u00eddo com\na extens\u00e3o com zeros para obter a regi\u00e3o utilizada como refer\u00eancia no c\u00e1lculo do RMSE.\n\nFigura A.5: Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda. O holograma\ninteiro foi reconstru\u00eddo ap\u00f3s ser estendido com zeros, e a regi\u00e3o destacada foi utilizada como refer\u00eancia no\nc\u00e1lculo do RMSE dos diversos m\u00e9todos de extens\u00e3o de borda.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE EXTENS\u00d5ES DE BORDA 93\n\nFigura A.6: Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda. O holograma\ninteiro foi reconstru\u00eddo ap\u00f3s ser estendido com zeros, e a regi\u00e3o destacada foi utilizada como refer\u00eancia no\nc\u00e1lculo do RMSE dos diversos m\u00e9todos de extens\u00e3o de borda.\n\n\n\n94 AP\u00caNDICE A\n\nFigura A.7: Reconstru\u00e7\u00f5es dos hologramas utilizados no experimento de extens\u00e3o de borda. O holograma\ninteiro foi reconstru\u00eddo ap\u00f3s ser estendido com zeros, e a regi\u00e3o destacada foi utilizada como refer\u00eancia no\nc\u00e1lculo do RMSE dos diversos m\u00e9todos de extens\u00e3o de borda.\n\n\n\nAp\u00eandice B\n\nImagens utilizadas no experimento de\nfocaliza\u00e7\u00e3o\n\nAs imagens deste ap\u00eandice foram utilizadas nos experimentos do Cap\u00edtulo 5, que comparam as\nmedidas de foco. S\u00e3o exibidas algumas das imagens utilizadas como refer\u00eancia, ou seja, reconstru\u00eddas\n\u00e0 dist\u00e2ncia que foi considerada nos experimentos como sendo a correta.\n\n95\n\n\n\n96 AP\u00caNDICE B\n\nFigura B.1: Reconstru\u00e7\u00f5es do conjunto A utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZA\u00c7\u00c3O 97\n\nFigura B.2: Reconstru\u00e7\u00f5es do conjunto A utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\n98 AP\u00caNDICE B\n\nFigura B.3: Reconstru\u00e7\u00f5es do conjunto B utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZA\u00c7\u00c3O 99\n\nFigura B.4: Reconstru\u00e7\u00f5es do conjunto B utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\n100 AP\u00caNDICE B\n\nFigura B.5: Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZA\u00c7\u00c3O 101\n\nFigura B.6: Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\n102 AP\u00caNDICE B\n\nFigura B.7: Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\nIMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZA\u00c7\u00c3O 103\n\nFigura B.8: Reconstru\u00e7\u00f5es do conjunto C utilizadas no experimento de focaliza\u00e7\u00e3o.\n\n\n\n104 AP\u00caNDICE B\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas\n\n[Abb73] E. Abbe. Beitr\u00e4ge zur theorie des mikroskops und der mikroskopischen wahrneh-\nmung. Archiv f\u00fcr mikroskopische Anatomie, 9(1):413\u2013418, 1873. 22\n\n[BCP+09] Isabelle Bergo\u00ebnd, Tristan Colomb, Nicolas Pavillon, Yves Emery e Christian De-\npeursinge. Depth-of-field extension and 3d reconstruction in digital holographic\nmicroscopy. Em SPIE Europe Optical Metrology, p\u00e1ginas 73901C\u201373901C. Inter-\nnational Society for Optics and Photonics, 2009. 31, 57, 58, 61, 62, 86\n\n[BIA+05] Mario A Bueno-Ibarra, Leonardo Acho et al. Fast autofocus algorithm for auto-\nmated microscopes. Optical Engineering, 44(6):063601\u2013063601, 2005. 61, 62, 63\n\n[BW99] Max Born e Emil Wolf. Principles of optics: electromagnetic theory of propagation,\ninterference and diffraction of light. CUP Archive, 1999. 6\n\n[CMD00] Etienne Cuche, Pierre Marquet e Christian Depeursinge. Aperture apodization\nusing cubic spline interpolation: application in digital holographic microscopy. Op-\ntics communications, 182(1):59\u201369, 2000. 33, 39\n\n[CNAJ01] Nathaniel Ng Kuang Chern, Po Aun Neow e Marcelo H Ang Jr. Practical issues in\npixel-based autofocusing for machine vision. Em Robotics and Automation, 2001.\nProceedings 2001 ICRA. IEEE International Conference on, volume 3, p\u00e1ginas\n2791\u20132796. IEEE, 2001. 58\n\n[CVM+11] Giuseppe A. Cirino, Patrick Verdonck, Ronaldo D. Mansano, Jos\u00e9 C. Pizolato Jr.,\nDaniel B. Mazulquim e Luiz G. Neto. Digital holography: Computer-generated ho-\nlograms and diffractive optics in scalar diffraction domain. Em Dr. Freddy Monroy,\neditor, Holography - Different Fields of Application. InTech, 2011. 23\n\n[CWR+03] Phil F Culverhouse, Robert Williams, Beatriz Reguera, Vincent Herry e Sonsoles\nGonz\u00e1lez-Gil. Do experts make mistakes? a comparison of human and machine\nidentification of dinoflagellates. Marine Ecology Progress Series, 247(17-25):5, 2003.\n1\n\n[DC06] Jos\u00e9 Antonio Dom\u00ednguez-Caballero. Digital holographic imaging of aquatic species.\nDisserta\u00e7\u00e3o de Mestrado, Massachusetts Institute of Technology, 2006. 14, 27, 57\n\n[DCG11] Lisa Dixon, Fook Chiong Cheong e David G Grier. Holographic deconvolution mi-\ncroscopy for high-resolution particle tracking. Optics express, 19(17):16410\u201316417,\n2011. 31\n\n[DFFD08] Lo\u00efc Denis, Corinne Fournier, Thierry Fournel e Christophe Ducottet. Numerical\nsuppression of the twin image in in-line holography of a volume of micro-objects.\nMeasurement Science and Technology, 19(7):074004, 2008. 31\n\n[DJ07] Cuong Manh Do e Bahram Javidi. Multifocus holographic 3-d image fusion using\nindependent component analysis. Display Technology, Journal of, 3(3):326\u2013332,\n2007. 86\n\n105\n\n\n\n106 REFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\n[DMYL02] Frank Dubois, Olivier Monnom, Catherine Yourassowsky e J-C Legros. Border\nprocessing in digital holography by extension of the digital hologram and reduction\nof the higher spatial frequencies. Applied optics, 41(14):2621\u20132626, 2002. 33, 35,\n40, 46\n\n[DO08] Victor V Dyomin e Alexey S Olshukov. Digital holographic video of plankton. Em\nOptical Engineering+ Applications, p\u00e1ginas 70732B\u201370732B. International Society\nfor Optics and Photonics, 2008. 33\n\n[DSCY06] Frank Dubois, C\u00e9dric Schockaert, Natcaha Callens e Catherine Yourassowsky. Fo-\ncus plane detection criteria in digital holography microscopy by amplitude analysis.\nOptics Express, 14(13):5895\u20135908, 2006. 57\n\n[FGA+05] Pietro Ferraro, Simonetta Grilli, Domenico Alfieri, Sergio De Nicola, Andrea Fi-\nnizio, Giovanni Pierattini, Bahram Javidi, Giuseppe Coppola e Valerio Striano.\nExtended focused image in microscopy by digital holography. Optics express,\n13(18):6738\u20136749, 2005. 86\n\n[FJ98] Matteo Frigo e Steven G Johnson. Fftw: An adaptive software architecture for\nthe fft. Em Acoustics, Speech and Signal Processing, 1998. Proceedings of the 1998\nIEEE International Conference on, volume 3, p\u00e1ginas 1381\u20131384. IEEE, 1998. 46\n\n[GK89] John Gillespie e RA King. The use of self-entropy as a focus measure in digital\nholography. Pattern recognition letters, 9(1):19\u201325, 1989. 57\n\n[Goo96] J.W. Goodman. Introduction to Fourier optics. McGraw-Hill series in electrical\nand computer engineering. McGraw-Hill, 1996. 6, 8, 18, 27\n\n[GOP+10] Gaby Gorsky, Mark D Ohman, Marc Picheral, St\u00e9phane Gasparini, Lars Stem-\nmann, Jean-Baptiste Romagnan, Alison Cawood, St\u00e9phane Pesant, Carmen\nGarc\u00eda-Comas e Franck Prejger. Digital zooplankton image analysis using the\nzooscan integrated system. Journal of Plankton Research, 32(3):285\u2013303, 2010. 1\n\n[GPWG04] Philippe Grosjean, Marc Picheral, Caroline Warembourg e Gabriel Gorsky. Enu-\nmeration, measurement, and identification of net zooplankton samples using the\nzooscan digital imaging system. ICES Journal of Marine Science: Journal du Con-\nseil, 61(4):518\u2013525, 2004. 1\n\n[GYL85] Frans CA Groen, Ian T Young e Guido Ligthart. A comparison of different focus\nfunctions for use in autofocus algorithms. Cytometry, 6(2):81\u201391, 1985. 57, 58\n\n[HJ07] Wei Huang e Zhongliang Jing. Evaluation of focus measures in multi-focus image\nfusion. Pattern Recognition Letters, 28(4):493\u2013500, 2007. 57, 62\n\n[HKPM09] Bryan M Hennelly, Damien P Kelly, Nitesh Pandey e David S Monaghan. Review\nof twin reduction and twin removal techniques in holography. 2009. 30, 86\n\n[HS05] Bryan M Hennelly e John T Sheridan. Fast numerical algorithm for the linear\ncanonical transform. JOSA A, 22(5):928\u2013937, 2005. 18\n\n[Jar76] Ray A Jarvis. Focus optimization criteria for computer image-processing. Micros-\ncope, 24(2):163\u2013180, 1976. 58\n\n[JOP+ ] Eric Jones, Travis Oliphant, Pearu Peterson et al. SciPy: Open source scientific\ntools for Python, 2001\u2013. [Online; accessed 2014-08-16]. 46\n\n[Kel14] Damien P Kelly. Numerical calculation of the fresnel transform. JOSA A,\n31(4):755\u2013764, 2014. 22, 24\n\n\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS 107\n\n[KFK12] Tomasz Kozacki, Konstantinos Falaggis e Malgorzata Kujawinska. Computation of\ndiffracted fields for the case of high numerical aperture using the angular spectrum\nmethod. Applied optics, 51(29):7080\u20137088, 2012. 24\n\n[KHHS11] DP Kelly, JJ Healy, BM Hennelly e JT Sheridan. Quantifying the 2.5 d ima-\nging performance of digital holographic systems. Journal of the European Optical\nSociety-Rapid publications vol 6 11034, 6:1034, 2011. 22\n\n[KHJ01] Volker Kebbel, Hans-J\u00fcrgen Hartmann e Werner PO J\u00fcptner. Application of digital\nholographic microscopy for inspection of micro-optical components. Em Lasers in\nMetrology and Art Conservation, p\u00e1ginas 189\u2013198. International Society for Optics\nand Photonics, 2001. 34\n\n[KJYFF15] Jonathan Krause, Hailin Jin, Jianchao Yang e Li Fei-Fei. Fine-grained recognition\nwithout part annotations. Em Proceedings of the IEEE Conference on Computer\nVision and Pattern Recognition, p\u00e1ginas 5546\u20135555, 2015. 2\n\n[KNR+09] Damien P Kelly, Thomas J Naughton, William T Rhodes, Bryan M Hennelly e\nNitesh Pandey. Resolution limits in practical digital holographic systems. Optical\nEngineering, 48(9):095801\u2013095801, 2009. 22\n\n[Kre02] Thomas M Kreis. Frequency analysis of digital holography with reconstruction by\nconvolution. Optical Engineering, 41(8):1829\u20131839, 2002. 26\n\n[KSDFF13] Jonathan Krause, Michael Stark, Jia Deng e Li Fei-Fei. 3d object representations for\nfine-grained categorization. Em Proceedings of the IEEE International Conference\non Computer Vision Workshops, p\u00e1ginas 554\u2013561, 2013. 2\n\n[LGF10] Tatiana Latychevskaia, Fabian Gehri e Hans-Werner Fink. Depth-resolved ho-\nlographic reconstructions by three-dimensional deconvolution. Optics express,\n18(21):22527\u201322544, 2010. 31, 86\n\n[LJ05] Feng Li e Hong Jin. A fast auto focusing method for digital still camera. Em\nMachine Learning and Cybernetics, 2005. Proceedings of 2005 International Con-\nference on, volume 8, p\u00e1ginas 5001\u20135005. IEEE, 2005. 57, 58, 59\n\n[LJ08] Renting Liu e Jiaya Jia. Reducing boundary artifacts in image deconvolution.\nEm Image Processing, 2008. ICIP 2008. 15th IEEE International Conference on,\np\u00e1ginas 505\u2013508. IEEE, 2008. 41\n\n[LM15] Arthur Leclaire e Lionel Moisan. No-reference image quality assessment and blind\ndeblurring with sharpness metrics exploiting fourier phase information. Journal of\nMathematical Imaging and Vision, 52(1):145\u2013172, 2015. 58, 59\n\n[Loo11] Nicholas Charles Loomis. Computational imaging and automated identification for\naqueous environments. Tese de Doutorado, Massachusetts Institute of Technology,\n2011. 2, 13, 28, 30, 55, 57, 60\n\n[LSHW09] Jingbo Liu, Xiufa Song, Rui Han e Huaying Wang. Autofocus method in digital\nholographic microscopy. Em 4th International Symposium on Advanced Optical\nManufacturing and testing technologies: Optical Test and Measurement Techno-\nlogy and Equipment, p\u00e1ginas 72833Q\u201372833Q. International Society for Optics and\nPhotonics, 2009. 57, 60\n\n[LY08] Shutao Li e Bin Yang. Multifocus image fusion using region segmentation and\nspatial frequency. Image and Vision Computing, 26(7):971\u2013979, 2008. 62\n\n\n\n108 REFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\n[MAK99] Edwin Malkiel, Omar Alquaddoomi e Joseph Katz. Measurements of plankton\ndistribution in the ocean using submersible holography. Measurement Science and\nTechnology, 10(12):1142, 1999. 1\n\n[MDP+11] P Memmolo, C Distante, M Paturzo, A Finizio, P Ferraro e B Javidi. Automatic\nfocusing in digital holography and its application to stretched holograms. Optics\nletters, 36(10):1945\u20131947, 2011. 58\n\n[MDYL05] Olivier Monnom, Frank Dubois, Catherine Yourassowsky e Jean Claude Legros.\nImprovement in visibility of an in-focus reconstructed image in digital holography\nby reduction of the influence of out-of-focus objects. Applied optics, 44(18):3827\u2013\n3832, 2005. 31\n\n[MH03] Samir Mezouari e Andy Robert Harvey. Validity of fresnel and fraunhofer ap-\nproximations in scalar diffraction. Journal of Optics A: Pure and Applied Optics,\n5(4):S86, 2003. 17\n\n[MHN08] Conor P McElhinney, Bryan M Hennelly e Thomas J Naughton. Extended focused\nimaging for digital holograms of macroscopic three-dimensional objects. Applied\nOptics, 47(19):D71\u2013D79, 2008. 57, 86\n\n[ML02] Jerome H Milgram e Weichang Li. Computational reconstruction of images from\nholograms. Applied optics, 41(5):853\u2013864, 2002. 28\n\n[MS09] Kyoji Matsushima e Tomoyoshi Shimobaba. Band-limited angular spectrum\nmethod for numerical simulation of free-space propagation in far and near fields.\nOptics express, 17(22):19662\u201319673, 2009. 26\n\n[NN94] Shree K Nayar e Yasuo Nakagawa. Shape from focus. IEEE Transactions on\nPattern analysis and machine intelligence, 16(8):824\u2013831, 1994. 60\n\n[NN\u0160+03] Markus Nieder\u00f6st, Jana Nieder\u00f6st, Ji?\u00ed \u0160?u?ka, Markus Nieder\u00f6st, Markus Nie-\nder\u00f6st, Jana Nieder\u00f6st e Jana Nieder\u00f6st. Automatic 3D reconstruction and visuali-\nzation of microscopic objects from a monoscopic multifocus image sequence. ETH,\nSwiss Federal Institute of Technology, Institute of Geodesy and Photogrammetry,\n2003. 86\n\n[OSB+89] Alan V Oppenheim, Ronald W Schafer, John R Buck et al. Discrete-time signal\nprocessing, volume 2. Prentice-hall Englewood Cliffs, 1989. 5\n\n[PPCCMFV00] Jos\u00e9 Luis Pech-Pacheco, Gabriel Crist\u00f3bal, Jes\u00fas Chamorro-Martinez e Joaqu\u00edn\nFern\u00e1ndez-Valdivia. Diatom autofocusing in brightfield microscopy: a comparative\nstudy. Em Pattern Recognition, 2000. Proceedings. 15th International Conference\non, volume 3, p\u00e1ginas 314\u2013317. IEEE, 2000. 57, 62, 63\n\n[PTVF96] William H Press, Saul A Teukolsky, William T Vetterling e Brian P Flannery.\nNumerical recipes in C, volume 2. Cambridge university press Cambridge, 1996.\n42\n\n[PV08] Paolo Prandoni e Martin Vetterli. Signal processing for communications. CRC\nPress, 2008. 5\n\n[RSR69] Lawrence R Rabiner, Ronald W Schafer e Charles M Rader. The chirp z-transform\nalgorithm and its application. Bell System Technical Journal, 48(5):1249\u20131292,\n1969. 16\n\n\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS 109\n\n[SBB+08] H Sun, PW Benzie, N Burns, DC Hendry, MA Player e J Watson. Underwa-\nter digital holography for studies of marine plankton. Philosophical Transac-\ntions of the Royal Society A: Mathematical, Physical and Engineering Sciences,\n366(1871):1789\u20131806, 2008. 23\n\n[SHPW07] Hongyue Sun, David C Hendry, Michael A Player e John Watson. In situ underwa-\nter electronic holographic camera for studies of plankton. Oceanic Engineering,\nIEEE Journal of, 32(2):373\u2013382, 2007. 1\n\n[SJ02] Ulf Schnars e Werner PO J\u00fcptner. Digital recording and numerical reconstruction\nof holograms. Measurement science and technology, 13(9):R85, 2002. 16\n\n[Sou81] WH Southwell. Validity of the fresnel approximation in the near field. JOSA,\n71(1):7\u201314, 1981. 17\n\n[SR89] AM Steane e HN Rutt. Diffraction calculations in the near field and the validity\nof the fresnel approximation. JOSA A, 6(12):1809\u20131814, 1989. 17\n\n[SSY98] Christian K Sieracki, Michael E Sieracki e Charles S Yentsch. An imaging-in-flow\nsystem for automated analysis of marine microplankton. Marine Ecology Progress\nSeries, 168:285\u2013296, 1998. 1\n\n[Syp95] Maciej Sypek. Light propagation in the fresnel region. new numerical approach.\nOptics communications, 116(1):43\u201348, 1995. 26\n\n[TBG+05] Andrea Thelen, Jens Bongartz, Dominik Giel, Susanne Frey e Peter Hering. Ite-\nrative focus detection in hologram tomography. JOSA A, 22(6):1176\u20131180, 2005.\n57\n\n[TFHH09] Andrea Thelen, Susanne Frey, Sven Hirsch e Peter Hering. Improvements in\nshape-from-focus for holographic reconstructions with regard to focus operators,\nneighborhood-size, and height value interpolation. IEEE transactions on image pro-\ncessing: a publication of the IEEE Signal Processing Society, 18(1):151\u2013157, 2009.\n56, 61, 86, 87\n\n[THM+13] Siddharth Talapatra, Jiarong Hong, Malcolm McFarland, Aditya R Nayak, Cao\nZhang, Joseph Katz, James Sullivan, Michael Twardowski, Jan Rines e Percy Do-\nnaghay. Characterization of biophysical interactions in the water column using in\nsitu digital holography. Mar. Ecol. Prog. Ser, 473:29\u201351, 2013. 1\n\n[TMY78] Hideyuki Tamura, Shunji Mori e Takashi Yamawaki. Texture features correspon-\nding to visual perception. IEEE Transactions on System, Man and Cybernatic, 6,\n1978. 58\n\n[TSV+98] Xiaoou Tang, W Kenneth Stewart, Luc Vincent, HE Huang, Marty Marra, Scott M\nGallager e Cabell S Davis. Automatic plankton image recognition. Em Artificial\nIntelligence for Biology and Agriculture, p\u00e1ginas 177\u2013199. Springer, 1998. 1\n\n[VDWCV11] Stefan Van Der Walt, S Chris Colbert e Gael Varoquaux. The numpy array: a\nstructure for efficient numerical computation. Computing in Science &amp; Engineering,\n13(2):22\u201330, 2011. 46\n\n[VR09] David G Voelz e Michael C Roggemann. Digital simulation of scalar optical diffrac-\ntion: revisiting chirp function sampling criteria and consequences. Applied optics,\n48(32):6132\u20136142, 2009. 26, 27\n\n\n\n110 REFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\n[YXH+12] Xiao Yu, Tang Xiahui, Peng Hao, Wang Wei et al. Wide-window angular spectrum\nmethod for diffraction propagation in far and near field. Optics letters, 37(23):4943\u2013\n4945, 2012. 26\n\n[YXY+12] Xiao Yu, Tang Xiahui, Qin Yingxiong, Peng Hao e Wang Wei. Band-limited angu-\nlar spectrum numerical propagation method with selective scaling of observation\nwindow size and sample number. JOSA A, 29(11):2415\u20132420, 2012. 26\n\n[ZFL+13] Yancao Zhang, Qi Fan, Xinchao Li, Jianjun Shi e Baiyu Yang. Optimization of the\nwindow function for digital hologram apodization in reconstructing the holographic\nimage. Journal of Optics, 15(10):105406, 2013. 33\n\n[ZZF+09] Yancao Zhang, Jianlin Zhao, Qi Fan, Wei Zhang e Sheng Yang. Improving the\nreconstruction quality with extension and apodization of the digital hologram. Ap-\nplied optics, 48(16):3070\u20133074, 2009. 35, 40\n\n\n\tLista de Abreviaturas\n\tLista de S\u00edmbolos\n\tLista de Figuras\n\tLista de Tabelas\n\tIntrodu\u00e7\u00e3o\n\tConsidera\u00e7\u00f5es Preliminares\n\tObjetivos\n\tContribui\u00e7\u00f5es\n\tOrganiza\u00e7\u00e3o do Trabalho\n\n\tConceitos\n\tFundamentos de Processamento Digital de Sinais\n\tFundamentos de \u00d3ptica de Fourier\n\tEqua\u00e7\u00f5es de Maxwell e de Helmholtz\n\tM\u00e9todo do espectro angular\n\tAproxima\u00e7\u00e3o de Fresnel\n\n\n\tProcessamento de hologramas de pl\u00e2ncton\n\tHolografia\n\tRemo\u00e7\u00e3o de fundo\n\tAlgoritmos de reconstru\u00e7\u00e3o\n\tCaptura e propaga\u00e7\u00e3o das frequ\u00eancias em holografia digital\n\n\tDetalhes de implementa\u00e7\u00e3o\n\tFFT real e fun\u00e7\u00f5es de transfer\u00eancia\n\tSobreposi\u00e7\u00e3o espacial\n\tEfeito de borda\n\tAmostragem\n\n\tSegmenta\u00e7\u00e3o de regi\u00e3o de interesse\n\tReconstru\u00e7\u00e3o volum\u00e9trica\n\tFocaliza\u00e7\u00e3o\n\n\tSegmenta\u00e7\u00e3o Final\n\tOutras considera\u00e7\u00f5es\n\tCusto computacional\n\tProcessamentos adicionais\n\n\n\tEfeito de borda\n\tIntrodu\u00e7\u00e3o\n\tM\u00e9todos\n\tZeros\n\tM\u00e9dia\n\tC\u00f3pia da borda\n\tMediana da borda\n\tReflex\u00e3o\n\tRampa linear\n\tRampa linear circular\n\tFiltro gaussiano\n\tFiltro gaussiano iterativo\n\tRampa linear com janela de Tukey\n\tC\u00f3pia da borda com janela Spline\n\tMediana com janela de cosseno\n\tMinimiza\u00e7\u00e3o de frequ\u00eancias altas\n\tMinimiza\u00e7\u00e3o do Laplaciano\n\n\tComplexidade computacional\n\tResultados experimentais\n\tResultados\n\n\n\tFocaliza\u00e7\u00e3o\n\tMedidas de foco\n\tMedidas estat\u00edsticas\n\tMedidas com filtro espacial\n\tMedidas com janelas\n\n\tComplexidade computacional\n\tResultados experimentais\n\tResultados\n\n\n\tSistema web\n\tArquitetura\n\tInterface\n\n\tConclus\u00e3o\n\tContribui\u00e7\u00f5es\n\tTrabalhos futuros\n\n\tImagens utilizadas no experimento de extens\u00f5es de borda\n\tImagens utilizadas no experimento de focaliza\u00e7\u00e3o\n\tRefer\u00eancias Bibliogr\u00e1ficas"}]}}}