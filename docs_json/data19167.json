{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.23142"}, {"@name": "filename", "#text": "7220_Dissertacao_ALVARO_MARCELO_ACEVEDO_PENA.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "ALVARO MARCELO ACEVEDO PE\u00d1A \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nAvalia\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o para a otimiza\u00e7\u00e3o em tempo real de \n\numa unidade de produ\u00e7\u00e3o de propeno \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nS\u00e3o Paulo \n\n(2015) \n\n\n\nALVARO MARCELO ACEVEDO PE\u00d1A \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nAvalia\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o para a otimiza\u00e7\u00e3o em tempo real de \n\numa unidade de produ\u00e7\u00e3o de propeno \n\n \n\n \n\n \n\n \n\n \n\n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \nPolit\u00e9cnica da Universidade de S\u00e3o Paulo \npara obten\u00e7\u00e3o do t\u00edtulo de Mestre em \nCi\u00eancias \n \n \n \nOrientador: Prof. Dr. Galo Carrillo Le Roux \n\n \n\n \n\n \n\n \n\nS\u00e3o Paulo \n\n(2015) \n\n\n\nALVARO MARCELO ACEVEDO PE\u00d1A \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nAvalia\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o para a otimiza\u00e7\u00e3o em tempo real de \n\numa unidade de produ\u00e7\u00e3o de propeno \n\n \n\n \n\n \n\n \n\n \n\n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \nPolit\u00e9cnica da Universidade de S\u00e3o Paulo \npara obten\u00e7\u00e3o do t\u00edtulo de Mestre em \nCi\u00eancias \n \n \n\u00c1rea de Concentra\u00e7\u00e3o: Engenharia \nQu\u00edmica \n \n \nOrientador: Prof. Dr. Galo Carrillo Le Roux \n\n \n\n \n\n \n\nS\u00e3o Paulo \n\n(2015) \n\n\n\n \n\n \n\nEste exemplar foi revisado e corrigido em rela\u00e7\u00e3o \u00e0 vers\u00e3o original, sob \n\nresponsabilidade \u00fanica do autor e com a anu\u00eancia de seu orientador. \n\n \n\nS\u00e3o Paulo,      de janeiro de 2015. \n\n \n\n \n\nAssinatura do autor   ____________________________ \n\n \n\n \n\nAssinatura do orientador   _______________________ \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nCataloga\u00e7\u00e3o-na-publica\u00e7\u00e3o \n\n  \n \n \nAcevedo Pe\u00f1a, Alvaro Marcelo \n\nAvalia\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o para a otimiza\u00e7\u00e3o \nem tempo real de uma unidade de produ\u00e7\u00e3o de propeno / A.M. \nAcevedo Pe\u00f1a. \u2013 vers\u00e3o corr. -- S\u00e3o Paulo, 2015. \n\n117 p. \n \n\nDisserta\u00e7\u00e3o (Mestrado) - Escola Polit\u00e9cnica da Universidade   \nde S\u00e3o Paulo. Departamento de Engenharia Qu\u00edmica. \n \n\n1.Tempo real (Otimiza\u00e7\u00e3o) 2.Otimiza\u00e7\u00e3o econ\u00f4mica 3.T\u00e9cni- \ncas de decomposi\u00e7\u00e3o 4.Refinarias de petr\u00f3leo I.Universidade de \nS\u00e3o Paulo. Escola Polit\u00e9cnica. Departamento de Engenharia \nQu\u00edmica II.t. \n\n \n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nA minhas av\u00f3s, Yolanda (in memoriam) e \n\nJuana, que contribu\u00edram diretamente na \n\nminha forma\u00e7\u00e3o como pessoa, sempre \n\ncom amor incondicional, e que sempre \n\ntorceram pela realiza\u00e7\u00e3o de meus \n\nobjetivos.   Voc\u00eas est\u00e3o no meu cora\u00e7\u00e3o. \n\n\n\nAGRADECIMENTOS \n\n \n\nAos meus pais, Carlos e Gioconda, pelo carinho, amor e dedica\u00e7\u00e3o  durante todos \n\nos anos da minha vida e que sempre me deram exemplos de honestidade, \n\nresponsabilidade e amor. Sem voc\u00eas nada disto teria sido poss\u00edvel. Agrade\u00e7o \n\ntamb\u00e9m aos meus irm\u00e3os, Gonzalo e Carlos, pelo apoio incondicional. \n\nAo Prof. Galo Carrillo Le Roux, pela orienta\u00e7\u00e3o deste trabalho, por acreditar no meu \n\npotencial como profissional e pela  oportunidade de participar do projeto RTO. \n\nAgrade\u00e7o a Jos\u00e9 Lu\u00eds, Gabriela, Nicole, Eliana e Lourdes, minha fam\u00edlia no Brasil, \n\npor todo o apoio e por me fazer sentir em casa. \n\nA Gabriela Burgulla, pelo apoio, companheirismo e sobretudo pela paci\u00eancia, for\u00e7a e \n\namor que me d\u00e1 dia a dia para superar os todos os obst\u00e1culos. \n\nA Bruno Faccini, pela revis\u00e3o de portugu\u00eas desta disserta\u00e7\u00e3o e a Jos\u00e9 Otavio e \n\nDavid, pelos conselhos na reda\u00e7\u00e3o. \n\nAos professores Ardson dos Santos, Darci Outloak, Jorge Gut e doutores Marcel \n\nJoly, Antonio Carlos Zanin e Lincoln Moro pela dedica\u00e7\u00e3o na leitura da disserta\u00e7\u00e3o e \n\npelas sugest\u00f5es de melhorias dadas tanto durante o exame de qualifica\u00e7\u00e3o quanto \n\ndurante a defensa. \n\nE por \u00faltimo, mas n\u00e3o por isso menos importante, agrade\u00e7o a todos meus amigos do \n\nlaborat\u00f3rio e da Bol\u00edvia pelos conselhos, risadas e momentos incr\u00edveis que fizeram \n\ndestes dois anos momentos inesquec\u00edveis.    \n\n \n\n \n\n\n\n1 \n \n\nRESUMO \n\n \n\nEstrat\u00e9gias de otimiza\u00e7\u00e3o em tempo real (RTO: Real Time Optimization) s\u00e3o \n\nutilizadas para avaliar e determinar as condi\u00e7\u00f5es \u00f3timas operacionais de uma planta \n\nem estado estacionario, maximizando a produtividade econ\u00f4mica do processo \n\nsujeita a restri\u00e7\u00f5es operacionais. Esse problema de otimiza\u00e7\u00e3o engloba toda a \n\nplanta e pode ser resolvido utilizando um s\u00f3 modelo para todo o processo que \n\nmaximize o lucro bruto operacional considerando os pre\u00e7os de mercado das \n\ncorrentes de entrada e sa\u00edda do processo. No entanto, na pr\u00e1tica, essa abordagem \n\ncentralizada muitas vezes n\u00e3o pode ser aplicada, devido ao tamanho e \n\ncomplexidade do problema de otimiza\u00e7\u00e3o, a que \u00e9 muito dif\u00edcil que todas as \n\nunidades da planta estejam em estado estacion\u00e1rio ao mesmo tempo e a que as \n\nunidades de processo n\u00e3o est\u00e3o sincronizadas j\u00e1 que em muitos processos n\u00e3o \n\nexiste armazenamento intermedi\u00e1rio. Uma solu\u00e7\u00e3o \u00e9 utilizar uma estrutura \n\ndistribu\u00edda, na qual o problema de otimiza\u00e7\u00e3o deve ser decomposto em \n\nsubproblemas com reduzida complexidade num\u00e9rica. Tal decomposi\u00e7\u00e3o, no entanto, \n\nexige que o pre\u00e7o das correntes de entrada e sa\u00edda de cada subproblema sejam \n\nadequadamente determinados. Com este proposito, neste trabalho, ser\u00e3o aplicadas \n\nt\u00e9cnicas de decomposi\u00e7\u00e3o em uma unidade de produ\u00e7\u00e3o de propeno da refinaria \n\nREPLAN (Refinaria de Paul\u00ednia, S\u00e3o Paulo) da PETROBRAS. Essa unidade ser\u00e1 \n\nmodelada, simulada e otimizada no software orientado a equa\u00e7\u00f5es EMSO \n\n(Environment for Modeling, Simulation and Optimization). Com o objetivo de testar as \n\nt\u00e9cnicas de decomposi\u00e7\u00e3o, a unidade ser\u00e1 decomposta em tr\u00eas divis\u00f5es que s\u00e3o: \n\ndepropanizadora, deetanizadora e C3 splitter. Mostra-se que duas t\u00e9cnicas \n\ntradicionais chamadas de relaxa\u00e7\u00e3o Lagrangiana e  Lagrangeano aumentado n\u00e3o \n\nconseguem convergir em uma solu\u00e7\u00e3o devido a duas causas. A primeira causa \u00e9 \n\nque o processo estudado cont\u00e9m divis\u00f5es indiferentes, o que significa que n\u00e3o \n\nexiste depend\u00eancia linear entre a fun\u00e7\u00e3o objetivo e as restri\u00e7\u00f5es complicadoras. A \n\nsegunda causa \u00e9 que os subproblemas de otimiza\u00e7\u00e3o que representam cada uma \n\ndas divis\u00f5es da unidade t\u00eam fun\u00e7\u00f5es objetivos lineares, neste caso, a restri\u00e7\u00e3o ativa \n\nde cada subproblema ir\u00e1 ser sempre a capacidade de produ\u00e7\u00e3o m\u00e1xima ou m\u00ednima \n\nde cada divis\u00e3o e n\u00e3o uma vaz\u00e3o intermedi\u00e1ria. Uma t\u00e9cnica alternativa, Pricing \n\nInterprocess Streams Using Slack Auctions, tamb\u00e9m foi aplicada ao processo \n\nestudado. Essa t\u00e9cnica define uma folga de recurso entre as correntes \n\n\n\n2 \n \n\nintermedi\u00e1rias das divis\u00f5es e utiliza leil\u00f5es para ajustar o pre\u00e7o dos produtos \n\nintermedi\u00e1rios. Mostra-se que esse \u00faltimo abordagem tamb\u00e9m apresenta problemas \n\nna sua aplica\u00e7\u00e3o, porque todas as divis\u00f5es estudadas t\u00eam dois produtos diferentes, \n\nisso significa que a t\u00e9cnica produzir\u00e1 sempre a vaz\u00e3o m\u00e1xima do produto final \n\n(vaz\u00e3o que tem pre\u00e7o de mercado) de cada divis\u00e3o e n\u00e3o assim do produto \n\nintermedi\u00e1rio (vaz\u00e3o que vai de uma divis\u00e3o para outra). Identificados os problemas \n\nnessas t\u00e9cnicas de decomposi\u00e7\u00e3o, \u00e9 proposta uma modifica\u00e7\u00e3o do algoritmo de \n\nrelaxa\u00e7\u00e3o Lagrangeana.  Para o qual \u00e9 considerada uma nova vari\u00e1vel denominada \n\nlimite de produ\u00e7\u00e3o dispon\u00edvel (LPD) e uma restri\u00e7\u00e3o para as vaz\u00f5es de carga de \n\ncada uma das divis\u00f5es, a qual ser\u00e1 atualizada a cada itera\u00e7\u00e3o. Essa modifica\u00e7\u00e3o no \n\nalgoritmo consegue superar os problemas apresentados para a resolu\u00e7\u00e3o do \n\nproblema de otimiza\u00e7\u00e3o para a unidade estudada considerando uma estrutura \n\ndistribu\u00edda.  \n\nPalavras-Chave: Otimiza\u00e7\u00e3o em tempo real. Otimiza\u00e7\u00e3o econ\u00f4mica. T\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o. Refinaria de petr\u00f3leo. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n3 \n \n\nABSTRACT \n\n \n\nReal time optimization strategies (RTO) are used to evaluate and determine the \n\noptimum operating conditions of a plant, maximizing the economic productivity of the \n\nprocess which is subject to operational constraints. This optimization framework \n\nencompasses the entire plant, and can be solved using one model for the entire \n\nprocess that maximizes the operating gross profit considering the market prices of \n\ninput and output stream`s process. However, in practice this centralized approach \n\noften cannot be applied due to the size and complexity of the optimization problem. \n\nOne solution is to use a distributed structure, in which the optimization problem must \n\nbe broken into sub-problems with reduced numerical complexity. Such \n\ndecomposition, however, requires that the price of input and output stream of each \n\nsub-problem should be adequately  determined. With this purpose, in this work, \n\ndecomposition techniques is applied in a propylene production unit at the refinery \n\nREPLAN (Refinaria de Paul\u00ednia, S\u00e3o Paulo) owned by PETROBRAS. This unit is \n\nmodeled, simulated and optimized in an equation oriented software EMSO \n\n(Environment for Modeling, Simulation and Optimization). In order to test the \n\ndecomposition techniques, the unit is decomposed into three divisions, which are \n\ndepropanizer, deethanizer and C3 splitter. It is shown that two traditional techniques \n\ncalled Lagrangian relaxation and augmented Lagrangian cannot converge on a \n\nsolution due to two causes. The first cause is that the studied process contains \n\nindifferent divisions, which means that there is no linear dependence between the \n\nobjective function and the complicating constraints. The second cause is that the \n\noptimization sub-problem that represent each divisions has linear objective functions, \n\nin this case, the active constraint of each sub-problem will always be the maximum or \n\nminimum production capacity of each division and not an intermediate flow rate. An \n\nalternative technique Pricing Interprocess Streams Using Slack Auctions was also \n\napplied to the studied process. This technique defines a resource slack between the \n\nintermediary streams and use auctions for adjusting the price of intermediary \n\nproducts. It is shown that this technique also presents problems in its applications \n\nbecause all divisions studied has two different products, this means that this \n\ntechnique will always produce the maximum flow rate of the final product (flow rate \n\nthat has a market price) of each division, and not  the intermediate product (flow rate \n\nthat goes from one division another). Identified problems in these decomposition \n\n\n\n4 \n \n\ntechniques, the proposed approach extended the Lagrangian relaxation algorithm, in \n\nwhich a new variable called \"available production limit\" (LPD) and a restriction to the \n\nfeed flow rate from each divisions are considered, which will be updated at every \n\niteration. This change in the algorithm can overcome the issues presented for solving \n\nthe optimization problem for the unit studied considering a distributed structure. \n\nKeywords: Real time optimization. Economic optimization. Decomposition \n\ntechniques. Petroleum Refinery. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n5 \n \n\nLISTA DE ILUSTRA\u00c7\u00d5ES \n\n \n\nFigura 2.1 \u2013 Hierarquia de atividades no refino de petr\u00f3leo......................... 18 \n\nFigura 2.2 \u2013 Tipos de decis\u00f5es a serem tomadas numa refinaria................ 21 \n\nFigura 2.3 \u2013 Estrutura e o mecanismo cl\u00e1ssico de atua\u00e7\u00e3o dos sistemas \n\nRTO........................................................................................... 23 \n\nFigura 2.4 \u2013 Otimiza\u00e7\u00e3o modular para divis\u00f5es independentes da planta.. 28 \n\nFigura 2.5 \u2013 Divis\u00f5es da planta interagem pelas correntes intermedi\u00e1rias \n\nentre processos........................................................................ 28 \n\nFigura 2.6 \u2013 Divis\u00f5es da planta necessitam conhecer os pre\u00e7os das \n\ncorrentes intermediarias........................................................... 29 \n\nFigura 2.7 \u2013 Otimiza\u00e7\u00e3o centralizada vs distribu\u00edda..................................... 33 \n\nFigura 3.1 \u2013 Interpreta\u00e7\u00e3o geom\u00e9trica para a depend\u00eancia linear dos \n\ngradientes.................................................................................. 40 \n\nFigura 3.2 \u2013 Interpreta\u00e7\u00e3o geom\u00e9trica para a depend\u00eancia linear dos \n\ngradientes.................................................................................. 42 \n\nFigura 3.3 \u2013 Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo \n\nm\u00e9todo de decomposi\u00e7\u00e3o Lagrangeana................................... 55 \n\nFigura 3.4 \u2013 Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo \n\nm\u00e9todo de Lagrangeano aumentado........................................ 63 \n\nFigura 3.5 \u2013 Defini\u00e7\u00e3o impropria das correntes intermediarias entre \n\nprocessos.................................................................................. 66 \n\nFigura 3.6 \u2013 Remodelando o microcadeia de suprimento usando recursos \n\nde folga...................................................................................... 67 \n\nFigura 3.7 \u2013 Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo \n\nm\u00e9todo de Slack Aunctions....................................................... 70 \n\nFigura 4.1 \u2013 Fluxograma simplificado da unidade de produ\u00e7\u00e3o de \n\npropeno..................................................................................... 72 \n\nFigura 5.1 \u2013 Fluxograma simplificado da unidade de produ\u00e7\u00e3o de propeno \n\ndecomposta em tr\u00eas subproblemas.......................................... 80 \n\nFigura 5.2 \u2013 Problema de converg\u00eancia da decomposi\u00e7\u00e3o Lagrangeana.. 85 \n\nFigura 5.3 \u2013 Depend\u00eancia linear dos gradientes........................................... 86 \n\nFigura 5.4 \u2013 Depend\u00eancia linear dos gradientes para o problema 87 \n\n\n\n6 \n \n\nestudado.................................................................................... \n\nFigura 5.5 \u2013 Vaz\u00e3o Corrente intermediaria 5S1-5S2.................................... 88 \n\nFigura 5.6 \u2013 Vaz\u00e3o Corrente intermediaria 17S2-17S3................................ 89 \n\nFigura 5.7 \u2013 Pricing interprocess streams using slack auctions aplicado ao \n\nprocesso de produ\u00e7\u00e3o conjunta - fun\u00e7\u00e3o objetivo dos \n\nsubproblemas............................................................................ 94 \n\nFigura 5.8  Fluxograma simplificado da unidade de produ\u00e7\u00e3o de propeno \n\n-algoritmo proposto................................................................... 95 \n\nFigura 5.9  Fluxograma do algoritmo proposto......................................... 96 \n\nFigura 5.10  Converg\u00eancia do algoritmo proposto..................................... 100 \n\nFigura 5.11  Vaz\u00e3o da corrente intermediaria 5S1 - 5S2 utilizando o \n\nalgoritmo proposto..................................................................... 101 \n\nFigura 5.12  Vaz\u00e3o da corrente intermediaria 17S2 - 17S3 utilizando o \n\nalgoritmo proposto..................................................................... 102 \n\n    \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n7 \n \n\nLISTA DE TABELAS \n\n \n\nTabela 4.1 \u2013 Composi\u00e7\u00e3o da carga (GLP) para a se\u00e7\u00e3o da \n\nDepropanizadora..................................................................... 73 \n\nTabela 4.2  \u2013 Resultados da simula\u00e7\u00e3o e a otimiza\u00e7\u00e3o do processo \n\nestudado.................................................................................. 78 \n\nTabela 5.1 \u2013 Respostas da relaxa\u00e7\u00e3o Lagrangeana.................................... 84 \n\nTabela 5.2 \u2013 Respostas pricing interprocess streams using slack \n\nauctions.................................................................................... 92 \n\nTabela 5.3 \u2013 Respostas da proposta de modifica\u00e7\u00e3o do algoritmo de \n\nrelaxa\u00e7\u00e3o Lagrangeana........................................................... 99 \n\nTabela 5.4 \u2013 Respostas do problema considerando uma estrutura \n\ncentralizada e distribu\u00edda......................................................... 102 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n8 \n \n\nLISTA DE ABREVIATURA E SIGLAS \n\n \n\nRTO Real Time Optimization \n\nPID Process and Instrumentation Diagram \n\nMCP Model Predictive Control \n\nLPD Limite de Produ\u00e7\u00e3o Dispon\u00edvel \n\nEMSO Environment for modeling, simulation and optimization \n\nIPOPT Interior Point OPTimizer \n\nGLP G\u00e1s Liquefeito de Petr\u00f3leo \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n9 \n \n\nLISTA DE SIMBOLOS \n\n \n\nv Contador das itera\u00e7\u00f5es \n\n? Diferencia aceit\u00e1vel entre os multiplicadores de Lagrange de duas \n\nitera\u00e7\u00f5es consecutivas \n\nx Vari\u00e1vel de decis\u00e3o \n\ny Vari\u00e1vel dual \n\nz Fun\u00e7\u00e3o objetivo \n\nh(x) Restri\u00e7\u00f5es de igualdade \n\ng(x) Restri\u00e7\u00f5es de desigualdade \n\n? Fun\u00e7\u00e3o dual \n\n?i\n(v) \n\nMultiplicador de Lagrange das restri\u00e7\u00f5es de igualdade \n\n? Multiplicador de Lagrange das restri\u00e7\u00f5es de desigualdade \n\nL Fun\u00e7\u00e3o Lagrangeana \n\n? Vetor dos multiplicadores de Lagrange \n\ns\n(v)\n\n Subgradiente na itera\u00e7\u00e3o v \n\nK Tamanho de passo na dire\u00e7\u00e3o s\n(v)\n\n \n\nDi Demanda de recursos da corrente i \n\nS Oferta total de recursos \n\nPi\n(v) \n\nPre\u00e7o da vaz\u00e3o i na itera\u00e7\u00e3o v \n\nE\n(v)\n\n Excesso de demanda na itera\u00e7\u00e3o v \n\nT-i Coluna de destila\u00e7\u00e3o i \n\nSRi Splitter de refluxo \n\nSBi Splitter de reboiler \n\nSC1 Splitter do compressor \n\nS-i Divis\u00e3o de processo i \n\nPri Pre\u00e7o do produto i \n\nPc Pre\u00e7o da corrente de carga \n\nCops-i Custo operacional da divis\u00e3o i \n\nCIu,d Corrente intermedi\u00e1ria de upstream e downstream  \n\nLPDi\n(v) \n\nLimite de produ\u00e7\u00e3o dispon\u00edvel i na itera\u00e7\u00e3o v \n\n  \n\n \n\n\n\n10 \n \n\nSUM\u00c1RIO \n\n \n\n1 INTRODU\u00c7\u00c3O........................................................................................ 12 \n\n1.1 MOTIVA\u00c7\u00c3O.......................................................................................... 12 \n\n1.2 OBJETIVOS............................................................................................ 15 \n\n1.3 ESTRUTURA DA TESE......................................................................... 16 \n\n2 REVIS\u00c3O BIBLIOGR\u00c1FICA................................................................... 17 \n\n2.1 HIERARQUIA DAS DECIS\u00d5ES NA IND\u00daSTRIA DE REFINO DE \n\nPETR\u00d3LEO............................................................................................ 17 \n\n2.2 OTIMIZA\u00c7\u00c3O EM TEMPO REAL (RTO)................................................ 21 \n\n2.3 OTIMIZA\u00c7\u00c3O DO PROCESSO - OTIMIZA\u00c7\u00c3O ECON\u00d4MICA............. 27 \n\n2.4 DECOMPOSI\u00c7\u00c3O DE PROBLEMAS DE OTIMIZA\u00c7\u00c3O....................... 31 \n\n3 T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O NA OTIMIZA\u00c7\u00c3O DE \n\nPROCESSOS......................................................................................... 36 \n\n3.1 T\u00c9CNICAS DE RELAXA\u00c7\u00c3O E DECOMPOSI\u00c7\u00c3O.............................. 36 \n\n3.2 RELAXA\u00c7\u00c3O LAGRANGEANA E DUALIDADE.................................... 38 \n\n3.2.1 Condi\u00e7\u00f5es de Otimalidade..................................................................... 38 \n\n3.2.2 Dualidade................................................................................................ 44 \n\n3.3 DECOMPOSI\u00c7\u00c3O LAGRANGEANA...................................................... 51 \n\n3.3.1 Atualiza\u00e7\u00e3o do Multiplicador de Lagrange.............................................. 55 \n\n3.3.1.1 M\u00e9todo do Subgradiente........................................................................ 56 \n\n3.3.1.2 Cutting Plane Method............................................................................. 57 \n\n3.3.1.3 Bundle Method........................................................................................ 57 \n\n3.3.1.4 Trust Region Method.............................................................................. 59 \n\n3.4 LAGRANGEANO AUMENTADO............................................................ 60 \n\n3.5 PRICING INTERPROCESS STREAMS USING SLACK AUCTIONS... 64 \n\n4 APRESENTA\u00c7\u00c3O DO PROCESSO ESTUDADO................................. 71 \n\n4.1 DESCRI\u00c7\u00c3O DO PROCESSO ESTUDADO.......................................... 71 \n\n4.2 MODELAGEM, SIMULA\u00c7\u00c3O E OTIMIZA\u00c7\u00c3O DO PROCESSO \n\nESTUDADO (EMSO).............................................................................. 75 \n\n5 APLICA\u00c7\u00c3O DAS T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O AO \n\nPROCESSO ESTUDADO...................................................................... 79 \n\n\n\n11 \n \n\n5.1 T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O APLICADAS AO PROCESSO \n\nESTUDADO............................................................................................ 79 \n\n5.1.1 Decomposi\u00e7\u00e3o Lagrangeana aplicada ao processo estudado............... 81 \n\n5.1.2 Pricing interprocess streams using slack auctions aplicada ao \n\nprocesso estudado................................................................................. 90 \n\n5.1.3 Proposta modifica\u00e7\u00e3o do algoritmo de relaxa\u00e7\u00e3o Lagrangeana \n94 \n\n6 CONCLUS\u00d5ES E SUGEST\u00d5ES PARA TRABALHOS FUTUROS........ 104 \n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS....................................................... 107 \n\n  \n \n\n\n\n12 \n \n\n1. INTRODU\u00c7\u00c3O \n\n \n\nDesde a revolu\u00e7\u00e3o industrial, os processos produtivos pelos quais a humanidade \n\nobt\u00e9m os seus bens e produtos de consumo v\u00eam experimentando um avan\u00e7o \n\nconsider\u00e1vel. Diversos s\u00e3o os fatores que levam os processos produtivos a se \n\ndesenvolverem t\u00e3o velozmente. O aumento da demanda de produtos impelido pelo \n\ncrescimento da popula\u00e7\u00e3o mundial, a forte concorr\u00eancia pelo mercado, os elevados \n\ncustos de produ\u00e7\u00e3o, a escassez de recursos naturais para a produ\u00e7\u00e3o de energia e \n\nmat\u00e9ria-prima e a conscientiza\u00e7\u00e3o sobre a preserva\u00e7\u00e3o do meio ambiente obrigaram \n\nas ind\u00fastrias a aprimorar seus processos produtivos, levando estes a operar mais \n\npr\u00f3ximos ao limite de sua capacidade. Em uma \u00e9poca em que se exigem produtos \n\nreunindo conceitos t\u00e3o antag\u00f4nicos como mais qualidade e menor pre\u00e7o, nenhuma \n\nind\u00fastria pode desperdi\u00e7ar mat\u00e9ria-prima e energia, ou gerar rejeitos industriais sem \n\nrestri\u00e7\u00f5es sob pena de ser aniquilada, seja pela legisla\u00e7\u00e3o vigente, seja pela \n\nconcorr\u00eancia. \n\nEste conjunto de fatores faz com que os processos industriais se tornem mais \n\ncomplexos devido \u00e0 necessidade de integra\u00e7\u00e3o m\u00e1ssica e energ\u00e9tica, tornando seus \n\ncomportamentos menos intuitivos e com maior dificuldade de prever qual a melhor \n\ncondi\u00e7\u00e3o operacional. Por essa raz\u00e3o, tecnologias de otimiza\u00e7\u00e3o v\u00eam sendo \n\naplicadas aos processos qu\u00edmicos h\u00e1 v\u00e1rias d\u00e9cadas, na busca cont\u00ednua da m\u00e1xima \n\nexplora\u00e7\u00e3o do potencial das unidades de processo. Grande parte destes m\u00e9todos, \n\nconsolidados em ferramentas de otimiza\u00e7\u00e3o, controle e automa\u00e7\u00e3o de processos, \n\nforam destinados ao setor de petr\u00f3leo e petroqu\u00edmica. \n\n \n\n1.1. MOTIVA\u00c7\u00c3O \n\n \n\nA elevada competitividade dos processos na ind\u00fastria do refino de petr\u00f3leo, \n\ndefinidos por caracter\u00edsticas como elevada variabilidade no mercado, exigentes \n\nrestri\u00e7\u00f5es dos produtos, elevados custos operacionais e constantes mudan\u00e7as nos \n\npre\u00e7os dos produtos, imp\u00f5e a constante necessidade de implantar estrat\u00e9gias e \n\nm\u00e9todos mais sofisticados de controle e otimiza\u00e7\u00e3o de processos industriais. Tais \n\nestrat\u00e9gias e m\u00e9todos de otimiza\u00e7\u00e3o s\u00e3o desenvolvidos na busca cont\u00ednua da \n\nm\u00e1xima explora\u00e7\u00e3o do potencial das unidades que comp\u00f5em a refinaria. A obten\u00e7\u00e3o \n\n\n\n13 \n \n\nde melhores resultados econ\u00f4micos em uma refinaria depende, em grande medida, \n\nde tomar as decis\u00f5es certas no momento certo (Hartmann, 1998). Essas decis\u00f5es \n\ns\u00e3o geralmente tomadas em diferentes n\u00edveis hier\u00e1rquicos (controle avan\u00e7ado de \n\nprocesso, otimiza\u00e7\u00e3o em tempo real, programa\u00e7\u00e3o da produ\u00e7\u00e3o, planejamento da \n\nprodu\u00e7\u00e3o e planejamento estrat\u00e9gico) e em diferentes horizontes de tempo \n\n(segundos, minutos, horas, dias, semanas, meses e anos). A justificativa para que \n\nestes m\u00e9todos sejam aplicados na ind\u00fastria do petr\u00f3leo \u00e9 a elevada escala de \n\nprodu\u00e7\u00e3o: o grande volume de produtos gerados, o elevado consumo de energia e \n\ninsumos fazem com que pequenas melhorias na efici\u00eancia dos processos se \n\ntraduzam em ganhos expressivos no lucro operacional (Carvalho, 2007). Neste \n\ncontexto, a otimiza\u00e7\u00e3o em tempo real (RTO: Real Time Optimization) torna-se uma \n\nimportante ferramenta no incremento da rentabilidade da empresa. O principal \n\nobjetivo da RTO \u00e9 poder operar a planta, em cada instante de tempo, o mais \n\npr\u00f3ximo poss\u00edvel das condi\u00e7\u00f5es \u00f3timas operacionais (Sequeira et al., 2002). O ciclo \n\ncl\u00e1ssico da RTO inclui m\u00faltiplas etapas entre as quais est\u00e3o a detec\u00e7\u00e3o do estado \n\nestacion\u00e1rio, tratamento de erros grosseiros, reconcilia\u00e7\u00e3o de dados e estima\u00e7\u00e3o de \n\npar\u00e2metros, otimiza\u00e7\u00e3o econ\u00f4mica e implementa\u00e7\u00e3o dos pontos \u00f3timos no sistema \n\nde controle (White, 1997). \n\nOs problemas de otimiza\u00e7\u00e3o que surgem neste contexto baseiam-se essencialmente \n\nem modelos matem\u00e1ticos do processo estudado e em algoritmos de otimiza\u00e7\u00e3o \n\natrav\u00e9s dos quais busca-se determinar o ponto operacional que melhor satisfa\u00e7a o \n\ncrit\u00e9rio de desempenho econ\u00f4mico do processo produtivo. A busca de descri\u00e7\u00f5es \n\nmais completas e precisas dos processos ou sistemas a serem otimizados leva \u00e0 \n\nconcep\u00e7\u00e3o de modelos matem\u00e1ticos de complexidade crescente, tornando a \n\natividade de otimiza\u00e7\u00e3o de processos tamb\u00e9m crescentemente complexa. Isto leva a \n\nproblemas de elevado n\u00famero de restri\u00e7\u00f5es e vari\u00e1veis, o que pode torna-los \n\ninvi\u00e1veis computacionalmente devido \u00e0 dimens\u00e3o, comprometendo a utilidade do \n\nmodelo (Carvalho, 2007). Al\u00e9m disso, mesmo que o poder de computa\u00e7\u00e3o dispon\u00edvel \n\nseja suficiente para resolver estes problemas, muitas vezes para modelar e operar \n\ndiferentes unidades de uma mesma refinaria s\u00e3o utilizados softwares de empresas \n\ndiferentes e incompat\u00edveis, fazendo com que a integra\u00e7\u00e3o e centraliza\u00e7\u00e3o das \n\nunidades de uma refinaria seja ainda mais dif\u00edcil (Jose e Ungar, 2000). \n\n\n\n14 \n \n\nNo entanto, considerando que o problema de otimiza\u00e7\u00e3o engloba toda a refinaria, \n\numa \u00fanica unidade ou divis\u00e3o otimizada cobre apenas um subconjunto do problema \n\ne como tal, n\u00e3o necessariamente fornece uma resposta v\u00e1lida. Ainda assim, a \n\nmodelagem de uma refinaria completa \u00e9 muito complexa de ser feita, ent\u00e3o \u00e9 mais \n\nvantajoso utilizar otimiza\u00e7\u00f5es locais (modelos para cada divis\u00e3o) que conseguem \n\natingir (em seu conjunto) um lucro similar ao de toda a refinaria considerando s\u00f3 um \n\nmodelo (Friedman, 1995). Para este prop\u00f3sito podem-se utilizar t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o para problemas de otimiza\u00e7\u00e3o em que s\u00e3o determinados \n\nadequadamente os pre\u00e7os das correntes intermediarias que permitam maximizar o \n\nlucro de toda a refinaria.  \n\nA ideia geral das t\u00e9cnicas de decomposi\u00e7\u00e3o \u00e9 relaxar as restri\u00e7\u00f5es globais, que \n\nconectam duas ou mais partes relativamente independentes de um problema de \n\notimiza\u00e7\u00e3o. Para este fim, existem diversas formas de se realizar esta tarefa. O \n\nmecanismo base em todos os princ\u00edpios de decomposi\u00e7\u00e3o \u00e9 decompor o problema \n\noriginal em subproblemas menores, que s\u00e3o coordenados por um problema mestre \n\nem que um procedimento iterativo \u00e9 usado para buscar a converg\u00eancia para uma \n\nsolu\u00e7\u00e3o global (Gunnerud, 2010). \n\nEstrat\u00e9gias de decomposi\u00e7\u00e3o para problemas de otimiza\u00e7\u00e3o s\u00e3o um campo maduro \n\nem pesquisa operacional em que, baseadas nas fun\u00e7\u00f5es dual e primal, destacam-se \n\nduas alternativas: relaxa\u00e7\u00e3o Lagrangeana e o Lagrangeano aumentado (Neiro, \n\n2004). Al\u00e9m disso, tamb\u00e9m existem abordagens alternativas de decomposi\u00e7\u00e3o, \n\ncapazes de resolver problemas que essas t\u00e9cnicas cl\u00e1ssicas apresentam, mas sua \n\naplicabilidade depende da estrutura do problema em quest\u00e3o (Jose e Ungar, 2000).  \n\nO presente trabalho centra-se no estudo e avalia\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o \n\npara problemas de otimiza\u00e7\u00e3o que podem ser ligados a um sistema RTO, com este \n\nprop\u00f3sito, ser\u00e1 considerada uma estrutura distribu\u00edda da unidade de produ\u00e7\u00e3o de \n\npropeno (escala industrial) da refinaria REPLAN da PETROBRAS. Essa unidade \u00e9 \n\ncomposta por tr\u00eas colunas de destila\u00e7\u00e3o: depropanizadora, deetanizadora e a \n\nfraccionadora de propeno. As tr\u00eas divis\u00f5es ser\u00e3o modeladas, simuladas e \n\notimizadas em EMSO \"Environment for Modeling, Simulation and Optimization\" \n\n(Soares e Secchi, 2003), que \u00e9 um software de modelagem orientado a equa\u00e7\u00f5es \n\n(EO). A escolha deste software foi realizada levando-se em conta suas vantagens \n\n\n\n15 \n \n\ncomo a efici\u00eancia de c\u00e1lculo, boa flexibilidade na especifica\u00e7\u00e3o de graus de \n\nliberdade para a simula\u00e7\u00e3o, uma interface mais natural e numericamente adequada \n\npara os problemas de otimiza\u00e7\u00e3o e uma maior autonomia para criar e manipular o \n\nmodelo (Mendoza et al., 2013). Este trabalho \u00e9 uma contribui\u00e7\u00e3o ao projeto \n\n\u201cDesenvolvimento de Solu\u00e7\u00e3o em Tempo Real Utilizando uma Abordagem Orientada \n\na Equa\u00e7\u00f5es com Implanta\u00e7\u00e3o em Unidade Industrial\u201d que visa ao desenvolvimento, \n\ncomo projeto de pesquisa, de tecnologia b\u00e1sica de RTO. \n\n \n\n1.2. OBJETIVOS \n\n \n\nDe acordo com a discuss\u00e3o da se\u00e7\u00e3o anterior sobre a otimiza\u00e7\u00e3o dos processos da \n\nind\u00fastria petroleira, mais concretamente do refino do petr\u00f3leo, o principal objetivo do \n\npresente trabalho \u00e9 o de avaliar, aplicar e interpretar economicamente as t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o mais relevantes para problemas de otimiza\u00e7\u00e3o que possam ser \n\nacopladas num sistema de RTO, considerando uma unidade de processamento a \n\nescala industrial como uma estrutura descentralizada. Para que dessa forma, seja \n\nposs\u00edvel decompor eficientemente o problema original em subproblemas que sejam \n\nresolvidos separadamente por meio da relaxa\u00e7\u00e3o das restri\u00e7\u00f5es complicadoras, que \n\ns\u00e3o coordenados por um problema mestre que garante uma solu\u00e7\u00e3o global. \n\nCom este fim, o trabalho foca-se nos seguintes objetivos espec\u00edficos: \n\n? Estudar t\u00e9cnicas de decomposi\u00e7\u00e3o cl\u00e1ssicas e alternativas para problemas de \n\notimiza\u00e7\u00e3o que possam ser aplicadas a processos industriais de grande porte, \n\nreduzindo a complexidade e o tempo computacional consumido na sua \n\nresolu\u00e7\u00e3o e que gerem pre\u00e7os dos produtos intermedi\u00e1rios adequados para \n\ntomada de decis\u00f5es. \n\n? Modelar, simular e otimizar a unidade de produ\u00e7\u00e3o de propeno da refinaria \n\nREPLAN da PETROBRAS, utilizando o ambiente orientado a equa\u00e7\u00f5es \n\nEMSO. O modelagem e simula\u00e7\u00e3o deste processo servir\u00e1 como plataforma \n\npara que as t\u00e9cnicas posam ser aplicadas e testadas. \n\n? Dirigir um estudo de avalia\u00e7\u00e3o e aplica\u00e7\u00e3o das t\u00e9cnicas de decomposi\u00e7\u00e3o \n\npara a unidade de produ\u00e7\u00e3o de propeno, no qual sejam mostrados os \n\nproblemas de efic\u00e1cia que essas t\u00e9cnicas, cl\u00e1ssicas e alternativas, \n\napresentam. \n\n\n\n16 \n \n\n? Propor uma modifica\u00e7\u00e3o no algoritmo de resolu\u00e7\u00e3o das t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o que consiga superar os problemas de efic\u00e1cia encontrados na \n\naplica\u00e7\u00e3o destas t\u00e9cnicas. \n\n \n\n1.3. ESTRUTURA DO DOCUMENTO  \n\n \n\nEste texto \u00e9 composto de seis se\u00e7\u00f5es. Na segunda se\u00e7\u00e3o \u00e9 apresentada uma \n\nrevis\u00e3o bibliogr\u00e1fica geral da RTO e sua rela\u00e7\u00e3o com a decomposi\u00e7\u00e3o de problemas \n\nde otimiza\u00e7\u00e3o. A se\u00e7\u00e3o 3 apresenta uma revis\u00e3o sucinta das t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o, que podem ser aplicadas para gerar uma estrutura distribu\u00edda de \n\nproblemas de otimiza\u00e7\u00e3o de grande porte encontradas na industria petroleira. Na \n\nse\u00e7\u00e3o 4 \u00e9 detalhado o processo considerado como caso de estudo, que \u00e9 a unidade \n\nde produ\u00e7\u00e3o de propeno composta por suas 3 divis\u00f5es (depropanizadora, \n\ndeetanizadora e fraccionadora de propeno). A unidade ser\u00e1 modelada, simulada e \n\notimizada no software EMSO. Na se\u00e7\u00e3o 5 \u00e9 apresentado um estudo das t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o que s\u00e3o aplicadas na unidade de produ\u00e7\u00e3o de propeno na qual s\u00e3o \n\nexplicadas as raz\u00f5es pelas quais essas t\u00e9cnicas s\u00e3o ineficazes para resolver o \n\nproblema de otimiza\u00e7\u00e3o do processo estudado. Nesta se\u00e7\u00e3o tamb\u00e9m \u00e9 apresentada \n\numa proposta de modifica\u00e7\u00e3o no algoritmo de resolu\u00e7\u00e3o da relaxa\u00e7\u00e3o Lagrangeana, \n\nessa modifica\u00e7\u00e3o \u00e9 testada e consegue resolver os problemas que as t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o descritas na se\u00e7\u00e3o 3 apresentam. A se\u00e7\u00e3o 6 resume as conclus\u00f5es e \n\napresenta propostas de continua\u00e7\u00e3o de trabalho. \n\n\n\n17 \n \n\n2. REVIS\u00c3O BIBLIOGR\u00c1FICA \n\n \n\nNuma opera\u00e7\u00e3o industrial, al\u00e9m da seguran\u00e7a operacional \u00e9 necess\u00e1rio tamb\u00e9m \n\nfazer com que sua rentabilidade atinja o m\u00e1ximo poss\u00edvel. Isto \u00e9 alcan\u00e7ado somente \n\nquando por meio de algum m\u00e9todo ou algoritmo a partir do qual se determinam as \n\ncondi\u00e7\u00f5es operacionais \u00f3timas do processo. Nesta se\u00e7\u00e3o ser\u00e1 discutida a \n\nfundamenta\u00e7\u00e3o te\u00f3rica relevante em que se evidencia que a otimiza\u00e7\u00e3o em \n\nsequ\u00eancia dos processos de refino de petr\u00f3leo \u00e9 de vital import\u00e2ncia para a \n\naplica\u00e7\u00e3o de uma ferramenta de RTO nessa ind\u00fastria. \n\n \n\n2.1. HIERARQUIA DAS DECIS\u00d5ES NA IND\u00daSTRIA DE REFINO DE PETR\u00d3LEO \n\n \n\nEm fun\u00e7\u00e3o da grande complexidade da estrutura de refino, o emprego da otimiza\u00e7\u00e3o \n\n(do ponto de vista econ\u00f4mico) na ind\u00fastria do petr\u00f3leo \u00e9 realizado em v\u00e1rios n\u00edveis, \n\ncomo mostra a figura 2.1 baseada em Edgar et al., (2001), Romagnoli e S\u00e1nchez \n\n(2000), Guerra e Le Roux (2011) e Kreipl e Pinedo (2004). Nesta figura, as \n\nopera\u00e7\u00f5es da planta podem ser divididas em cinco camadas hier\u00e1rquicas: \n\n? Planejamento Estrat\u00e9gico. \n\n? Planejamento da Produ\u00e7\u00e3o. \n\n? Programa\u00e7\u00e3o da Produ\u00e7\u00e3o. \n\n? Otimiza\u00e7\u00e3o de Unidades de Processo. \n\n? Controle e Monitoramento do Processo. \n\nAs cinco camadas trabalham em conjunto de forma integrada. A tarefa para cada \n\ncamada \u00e9 diferente, mas todas s\u00e3o parte de um controle de forma decrescente \n\ncomposto de um objetivo, que \u00e9 o de maximizar o desempenho econ\u00f4mico da \n\nplanta, mantendo um produto de qualidade e gerando o maior lucro poss\u00edvel. As \n\ncamadas se comunicam, transmitindo a informa\u00e7\u00e3o de forma crescente. \n\nDe acordo com Kreipl e Pinedo (2004), a intera\u00e7\u00e3o entre os diferentes n\u00edveis da \n\nhierarquia em refinarias pode ser complicada, principalmente porque os modelos de \n\nhierarquia superior abrangem horizontes de tempo muito maiores do que aqueles \n\nconsiderados nos modelos de n\u00edvel inferior. Por outro lado, \u00e0 medida que a ordem \n\nhier\u00e1rquica das decis\u00f5es \u00e9 aumentada, diminui a informa\u00e7\u00e3o dispon\u00edvel e o lucro \n\n\n\n18 \n \n\n(ganho) \u00e9 aumentado com menor esfor\u00e7o na modelagem de n\u00edveis hier\u00e1rquicos que \n\nconsideram maiores horizontes de tempo e, portanto, espera-se que os esfor\u00e7os \n\ncomputacionais sejam menores (Guerra e Le Roux, 2011). Isto faz com que os \n\nresultados de um modelo de elevada ordem hier\u00e1rquica (planejamento da produ\u00e7\u00e3o) \n\nsejam menos confi\u00e1veis do que aqueles de modelos de menores ordens \n\n(programa\u00e7\u00e3o da produ\u00e7\u00e3o), conforme mostra a figura 2.1. \n\n \n\nFigura 2.1 - Hierarquia de atividades no refino de petr\u00f3leo \n\n \nFonte: Elabora\u00e7\u00e3o pr\u00f3pria, baseada em Edgar et al., (2001), Romagnoli e S\u00e1nchez (2000), Guerra e \n\nLe Roux (2011) e Kreipl e Pinedo (2004). \n\n \n\nBaseado em Carvalho (2007), Moro et al. (1998) e Guerra e Le Roux (2011) \u00e9 \n\napresentada a seguir uma breve descri\u00e7\u00e3o dos n\u00edveis que comp\u00f5em a hierarquia de \n\ndecis\u00f5es em refinarias de petr\u00f3leo.  \n\nPlanejamento Estrat\u00e9gico \n\nEssa atividade \u00e9 realizada no n\u00edvel administrativo das empresas e se baseia em \n\ncen\u00e1rios de m\u00e9dio e longo prazo, revistos a cada um ou dois anos. O problema \n\nprincipal do planejamento estrat\u00e9gico \u00e9 determinar quais s\u00e3o as oportunidades ou \n\nnecessidades de investimento priorit\u00e1rias, levando em considera\u00e7\u00e3o defini\u00e7\u00f5es \n\nestrat\u00e9gicas, tend\u00eancias mercadol\u00f3gicas, altera\u00e7\u00f5es em legisla\u00e7\u00f5es, cen\u00e1rios \n\npol\u00edticos e disponibilidade de capital. A partir dessa avalia\u00e7\u00e3o de oportunidades pode \n\n\n\n19 \n \n\nocorrer a constru\u00e7\u00e3o ou aquisi\u00e7\u00e3o de novas plantas ou unidades de processo, \n\namplia\u00e7\u00f5es, incorpora\u00e7\u00e3o de novas tecnologias, etc. \n\nPlanejamento da produ\u00e7\u00e3o \n\nO planejamento da produ\u00e7\u00e3o tem metas econ\u00f4micas e se d\u00e1 em dois n\u00edveis. No \n\nn\u00edvel corporativo, decis\u00f5es s\u00e3o tomadas considerando toda a estrutura da empresa \n\n(log\u00edstica, distribui\u00e7\u00e3o, transporte e produ\u00e7\u00e3o), proje\u00e7\u00f5es de demanda e pre\u00e7os de \n\nprodutos, disponibilidade e custo de mat\u00e9ria-prima. \u00c9 nesse n\u00edvel que s\u00e3o definidos \n\nos volumes e tipos de petr\u00f3leo a serem comprados no mercado para posterior refino, \n\naproveitando-se da escolha para obter melhores pre\u00e7os. As ferramentas de \n\notimiza\u00e7\u00e3o utilizadas neste n\u00edvel baseiam-se em modelos simplificados (em geral \n\nlineares) do processo, em fun\u00e7\u00e3o do elevado grau de complexidade do problema. O \n\nplanejamento neste n\u00edvel considera, tipicamente, horizontes de seis meses com \n\natualiza\u00e7\u00e3o mensal. J\u00e1 no n\u00edvel operacional das plantas de petr\u00f3leo (por exemplo, \n\nrefinarias), o mesmo problema \u00e9 resolvido em escala menor. Neste caso, o modelo \n\ncontempla apenas os processos da unidade em quest\u00e3o e a parte da cadeia \n\nlog\u00edstica utilizada pela mesma. A previs\u00e3o de demanda \u00e9 mais precisa que no caso \n\ncorporativo e busca-se refinar a estrat\u00e9gia prevista no planejamento corporativo para \n\nmaximizar os lucros. Muitas ferramentas especializadas de otimiza\u00e7\u00e3o s\u00e3o \n\noferecidas no mercado (PIMS\u2122 Aspen Technology, RPMS\u00ae Honeywell Process \n\nSolutions, etc.) para solucionar os problemas de planejamento de produ\u00e7\u00e3o. \n\nPrograma\u00e7\u00e3o da Produ\u00e7\u00e3o \n\nO problema de programa\u00e7\u00e3o da produ\u00e7\u00e3o \u00e9 de grande complexidade j\u00e1 que tem \n\ncomo objetivo produzir um agendamento vi\u00e1vel das opera\u00e7\u00f5es, sendo resolvido no \n\nn\u00edvel das unidades de uma empresa. Seu objetivo \u00e9 programar as opera\u00e7\u00f5es a \n\nserem realizadas, de forma a atender \u00e0s demandas no prazo, minimizando o \n\narmazenamento de mat\u00e9ria-prima e produtos. Assim, a programa\u00e7\u00e3o de produ\u00e7\u00e3o \n\nconsiste em um problema din\u00e2mico que define tempos e volumes envolvidos em \n\ncada opera\u00e7\u00e3o. Normalmente em refinarias, o horizonte considerado para \n\nprograma\u00e7\u00e3o varia de dois a sete dias, com atualiza\u00e7\u00e3o di\u00e1ria. Atualmente, as \n\nferramentas dispon\u00edveis comercialmente ou citadas na literatura para programa\u00e7\u00e3o \n\nda produ\u00e7\u00e3o baseiam-se em modelos bastante complexos, que podem ser lineares \n\nou n\u00e3o, envolvendo vari\u00e1veis discretas e cont\u00ednuas simultaneamente. Em fun\u00e7\u00e3o da \n\n\n\n20 \n \n\ncomplexidade do problema, essas ferramentas podem n\u00e3o ser utilizadas para \n\ndeterminar a solu\u00e7\u00e3o \u00f3tima do ponto de vista matem\u00e1tico, mas auxiliam o usu\u00e1rio a \n\nchegar \u00e0 uma programa\u00e7\u00e3o vi\u00e1vel. As atividades de planejamento e programa\u00e7\u00e3o da \n\nprodu\u00e7\u00e3o s\u00e3o realizadas com estreita rela\u00e7\u00e3o entre si, pois o modelo de \n\nplanejamento fornece informa\u00e7\u00e3o (plano de produ\u00e7\u00e3o) para o modelo de \n\nprograma\u00e7\u00e3o (este modelo define o programa de produ\u00e7\u00e3o). Se os resultados do \n\nmodelo de programa\u00e7\u00e3o de produ\u00e7\u00e3o n\u00e3o s\u00e3o compat\u00edveis com o plano de \n\nprodu\u00e7\u00e3o, devem-se revisar os dados de produ\u00e7\u00e3o como disponibilidade de \n\nmat\u00e9rias-primas e disponibilidade de unidades. Esse procedimento \u00e9 repetido at\u00e9 \n\nque haja coer\u00eancia entre os resultados dos dois modelos. \n\nOtimiza\u00e7\u00e3o de unidades de processo \n\nNo n\u00edvel das unidades de processo, o objetivo da otimiza\u00e7\u00e3o \u00e9 determinar o valor \n\napropriado para as vari\u00e1veis do processo que proporcionam m\u00e1ximo desempenho, \n\ndentro do perfil de produ\u00e7\u00e3o definido pelas camadas superiores. Embora esta \n\ndecis\u00e3o possa ser tomada a partir da experi\u00eancia e conhecimentos dos t\u00e9cnicos \n\nrespons\u00e1veis pela opera\u00e7\u00e3o da unidade, muitas vezes a determina\u00e7\u00e3o do ponto \n\n\u00f3timo de opera\u00e7\u00e3o exige a utiliza\u00e7\u00e3o de ferramentas de apoio. Entre as ferramentas \n\nmais sofisticadas para a otimiza\u00e7\u00e3o de unidades de processo est\u00e3o os sistemas de \n\nRTO. Esta t\u00e9cnica baseia-se na associa\u00e7\u00e3o de modelos matem\u00e1ticos rigorosos do \n\nprocesso a algoritmos de otimiza\u00e7\u00e3o, que  buscam continuamente a determina\u00e7\u00e3o \n\ndo ponto operacional que gere o maior lucro poss\u00edvel para a empresa. \n\nControle Preditivo Multivari\u00e1vel \n\nA implementa\u00e7\u00e3o de um ponto \u00f3timo operacional definido por um sistema de RTO \n\nn\u00e3o pode, em geral, ser realizada de forma instant\u00e2nea. Varia\u00e7\u00f5es dr\u00e1sticas \n\npoderiam levar a unidade de processo a oscila\u00e7\u00f5es indesej\u00e1veis ou mesmo \u00e0 \n\ninstabilidade. Frequentemente, a solu\u00e7\u00e3o do problema din\u00e2mico de como conduzir o \n\nprocesso ao novo ponto operacional com seguran\u00e7a e confiabilidade \u00e9 deixada a \n\ncargo dos controladores preditivos multivari\u00e1veis. Uma vez implementado o ponto \n\n\u00f3timo, o controlador dever\u00e1 ainda rejeitar eventuais perturba\u00e7\u00f5es, tomando a\u00e7\u00f5es \n\nque minimizem as flutua\u00e7\u00f5es do processo em torno do ponto \u00f3timo definido. A \n\natua\u00e7\u00e3o do Controle Preditivo Multivari\u00e1vel sobre o processo \u00e9 feito atrav\u00e9s do envio \n\nde set-points \u00e0s malhas de controle regulat\u00f3rio da unidade de processo. \n\n\n\n21 \n \n\nFeita uma breve descri\u00e7\u00e3o dos n\u00edveis hier\u00e1rquicos das decis\u00f5es nas refinarias, na \n\nfigura 2.2 (Hartmann, 1998) mostra-se em resumo o tipo de decis\u00f5es a serem \n\ntomadas em uma refinaria, assim como o tipo de modelo utilizado para auxiliar a \n\ntomada de decis\u00f5es e os objetivos usados para avaliar as diferentes op\u00e7\u00f5es \n\ndispon\u00edveis. Neste trabalho vamos focar na otimiza\u00e7\u00e3o de unidades de processo, \n\nonde, de acordo com a figura 2.2, a decis\u00e3o \u00e9 feita em termos de  \u201ccomo operar\u201d e \n\n\u201ccomo produzir\u201d. Para este prop\u00f3sito tem que ser feito um modelo para a opera\u00e7\u00e3o, \n\nconsiderando uma fun\u00e7\u00e3o objetivo econ\u00f4mica para a otimiza\u00e7\u00e3o das unidades de \n\nprocesso, a principal ferramenta de apoio utilizada \u00e9 o RTO que ser\u00e1 descrita a \n\nseguir.   \n\n \n\nFigura 2.2 Tipos de decis\u00f5es a serem tomadas numa refinaria \n\n \nFonte: Adaptado de Hartmann (1998). \n \n\n2.2. OTIMIZA\u00c7\u00c3O EM TEMPO REAL (RTO) \n\n \n\nA camada de otimiza\u00e7\u00e3o de um processo industrial surgiu com o avan\u00e7o e o \n\ncrescimento das estruturas de controle. Primordialmente, o controle de processos \n\nprocura manter o processo funcionando atrav\u00e9s de um controle regulat\u00f3rio \n\nrespons\u00e1vel por enviar a\u00e7\u00f5es de controle a atuadores simples baseadas nos \n\n\n\n22 \n \n\nobjetivos (set-points) especificados para n\u00edveis, press\u00f5es e temperaturas dos \n\nprocessos. Isto n\u00e3o \u00e9 o suficiente, pois exige dos operadores um trabalho \n\nconsider\u00e1vel para, baseados nestas vari\u00e1veis de controle, tomar decis\u00f5es para \n\nmanter a qualidade dos produtos. \n\nEis que surge ent\u00e3o o conceito de controle supervis\u00f3rio. O controle supervis\u00f3rio veio \n\ncomplementar a automa\u00e7\u00e3o dos processos industriais no sentido de tornar as \n\ntomadas de decis\u00e3o em rela\u00e7\u00e3o \u00e0s vari\u00e1veis controladas mais intuitivas e vis\u00edveis ao \n\noperador. Com este advento passou-se a controlar diretamente os objetivos finais \n\ndos processos como, por exemplo, a especifica\u00e7\u00e3o dos produtos. O controle \n\nsupervis\u00f3rio articula-se com o controle regulat\u00f3rio sendo uma malha de controle \n\nsuperior a este na ordem hier\u00e1rquica. \n\nContudo, uma nova necessidade surgiu no \u00e2mbito industrial em termos dos objetivos \n\nfinais de se controlar um processo. Certamente \u00e9 desej\u00e1vel que se tenham produtos \n\nsobre especificados sendo gerados dentro do processo, mas seria este o objetivo \n\nfinal de uma empresa como uma entidade econ\u00f4mica? Na verdade, um dos fins de \n\nqualquer empresa \u00e9 inegavelmente o lucro, e entre se ter produtos sobre \n\nespecificados e lucro existe um gap conceitual. Nem sempre um produto \n\nespecificado \u00e9 sin\u00f4nimo de lucro e um esfor\u00e7o adicional se torna necess\u00e1rio neste \n\nsentido. Por este motivo tornou-se necess\u00e1rio desenvolver uma camada de \n\notimiza\u00e7\u00e3o que n\u00e3o trabalhasse somente com modelos lineares, mas sim com \n\nmodelos mais completos e n\u00e3o-lineares do processo, capazes de descrever com \n\nmaior precis\u00e3o o comportamento da unidade industrial em um dado instante. Surgiu \n\nassim o conceito de RTO (Duraiski, 2009). \n\nPor tudo isso, a atualiza\u00e7\u00e3o permanente dos par\u00e2metros deste modelo \u00e9 \n\nfundamental para que a determina\u00e7\u00e3o do \u00f3timo seja eficaz. Portanto, o termo RTO \u00e9 \n\nusado para designar o algoritmo capaz de avaliar e alterar continuamente as \n\ncondi\u00e7\u00f5es de opera\u00e7\u00e3o do processo, enviando objetivos \u00f3timos automaticamente \n\npara o controle avan\u00e7ado, de modo que a produtividade econ\u00f4mica do processo seja \n\nmaximizada sujeita a restri\u00e7\u00f5es operacionais (Jang et al., 1987). \n\nA aplica\u00e7\u00e3o cl\u00e1ssica de uma ferramenta de RTO utiliza a otimiza\u00e7\u00e3o em estado \n\nestacion\u00e1rio para obter as condi\u00e7\u00f5es operacionais que gerem o maior lucro poss\u00edvel \n\npara a ind\u00fastria. Os benef\u00edcios que Latour (1979) destaca de uma otimiza\u00e7\u00e3o em \n\nestado estacion\u00e1rio, s\u00e3o: \n\n\n\n23 \n \n\n? Melhor qualidade e rendimento do produto. \n\n? Redu\u00e7\u00e3o do consumo de energia e dos custos. \n\n? Aumento da capacidade dos equipamentos. \n\n? Menores custos de manuten\u00e7\u00e3o das equipes do processo. \n\n? Menores custos de processo para projetos que incluem um sistema RTO. \n\n \n\nAs ferramentas de otimiza\u00e7\u00e3o em tempo real baseiam-se na associa\u00e7\u00e3o de um \n\nmodelo matem\u00e1tico do processo a um algoritmo de otimiza\u00e7\u00e3o que periodicamente \n\ndetermina o ponto \u00f3timo operacional a ser perseguido. Por\u00e9m, para assegurar a \n\nconfiabilidade dos resultados, as aplica\u00e7\u00f5es industriais de RTO envolvem uma s\u00e9rie \n\nde etapas preliminares antes do equacionamento do problema de otimiza\u00e7\u00e3o \n\necon\u00f4mica propriamente dito. A figura 2.3 ilustra a estrutura e o mecanismo cl\u00e1ssico \n\nde atua\u00e7\u00e3o dos sistemas RTO. Baseado em Naysmith et al., (1995) e Hanmandlu et \n\nal., (1985) \u00e9 apresentada a seguir uma breve descri\u00e7\u00e3o dos componentes cl\u00e1ssicos \n\nde um sistema RTO. \n\n \n\nFigura 2.3 - Estrutura e o mecanismo cl\u00e1ssico de atua\u00e7\u00e3o dos sistemas RTO. \n\n \n Fonte: Naysmith et al., (1995) \n\n \n\n \n\n\n\n24 \n \n\nDetec\u00e7\u00e3o do estado estacion\u00e1rio: \n\nA implementa\u00e7\u00e3o de um procedimento para determinar se o processo est\u00e1 \n\nsuficientemente pr\u00f3ximo do estado estacion\u00e1rio torna-se necess\u00e1ria j\u00e1 que a \n\nrealiza\u00e7\u00e3o de simula\u00e7\u00f5es baseadas em dados obtidos durante o transiente pode \n\nlevar a resultados inconsistentes (Jiant et al., 2003). Em geral define-se um intervalo \n\nde tempo do passado a ser analisado (imediatamente anterior ao do in\u00edcio do \n\nprocedimento de otimiza\u00e7\u00e3o), em que s\u00e3o coletados dados referentes aos sinais de \n\num conjunto de vari\u00e1veis de processo selecionadas para representar a condi\u00e7\u00e3o \n\nestacion\u00e1ria do mesmo. A partir destes dados, a variabilidade das vari\u00e1veis em \n\nquest\u00e3o \u00e9 quantificada e comparada com par\u00e2metros previamente definidos por \n\nmeio de testes estat\u00edsticos ou heur\u00edsticos que definem se o processo pode ou n\u00e3o \n\nser considerado estacion\u00e1rio (Carvalho, 2007). \n\n \nReconcilia\u00e7\u00e3o de dados e detec\u00e7\u00e3o de erros grosseiros: \n\nTodos os valores medidos est\u00e3o sujeitos a erros que podem comprometer a precis\u00e3o \n\nda solu\u00e7\u00e3o do problema de otimiza\u00e7\u00e3o. A reconcilia\u00e7\u00e3o de dados consiste em um \n\nprocedimento de otimiza\u00e7\u00e3o atrav\u00e9s do qual um conjunto de dados \u00e9 confrontado \n\ncom um modelo matem\u00e1tico considerado confi\u00e1vel \u2013 em geral um modelo \n\nfenomenol\u00f3gico baseado nas leis de conserva\u00e7\u00e3o de massa, energia e quantidade \n\nde movimento e modelos rigorosos para a descri\u00e7\u00e3o de fen\u00f4menos como o equil\u00edbrio \n\nde fases e o mecanismo de sistemas reacionais. Com base nos valores estimados \n\npara as vari\u00e1veis atrav\u00e9s deste procedimento e an\u00e1lise estat\u00edstica pr\u00e9via da sua \n\nvariabilidade t\u00edpica, verifica-se se os valores fornecidos pelos instrumentos de \n\nmedi\u00e7\u00e3o s\u00e3o aceit\u00e1veis dentro de certo grau de probabilidade. O problema de \n\notimiza\u00e7\u00e3o decorrente caracteriza-se por uma fun\u00e7\u00e3o objetivo que leva em \n\nconsidera\u00e7\u00e3o os desvios entre os valores medidos e estimados (pelo modelo) para \n\nas vari\u00e1veis de processo, tendo como vari\u00e1veis de decis\u00e3o as vari\u00e1veis \n\nindependentes do modelo. Contudo, erros de predi\u00e7\u00e3o podem surgir ainda se o \n\nmodelo do processo n\u00e3o tiver condi\u00e7\u00f5es de represent\u00e1-lo com a precis\u00e3o \n\nnecess\u00e1ria. Frequentemente, o processo sofre altera\u00e7\u00f5es em seu comportamento \n\n(por exemplo, em fun\u00e7\u00e3o de altera\u00e7\u00f5es na composi\u00e7\u00e3o da carga de uma unidade ou \n\nda desativa\u00e7\u00e3o de um catalisador), e torna-se necess\u00e1rio corrigir par\u00e2metros do \n\nmodelo matem\u00e1tico para garantir resultados satisfat\u00f3rios (Carvalho, 2007). Assim, a \n\n\n\n25 \n \n\ndetec\u00e7\u00e3o dos erros grosseiros toma a\u00e7\u00f5es corretivas adequadas para corrigir \n\neventuais erros encontrados nas medi\u00e7\u00f5es do processo, ajustando-as a partir dos \n\ndados da planta para depois envi\u00e1-las para a pr\u00f3xima etapa.  \n\nEstima\u00e7\u00e3o de Par\u00e2metros: \n\nA estima\u00e7\u00e3o de par\u00e2metros \u00e9 tamb\u00e9m realizada atrav\u00e9s de um problema de \n\notimiza\u00e7\u00e3o. Aqui as vari\u00e1veis de decis\u00e3o s\u00e3o os par\u00e2metros do modelo e a fun\u00e7\u00e3o \n\nobjetivo geralmente representa os desvios entre valores medidos e estimados para \n\nas vari\u00e1veis dependentes. A natureza dos modelos rigorosos permite o ajuste de \n\nseus par\u00e2metros para compensar perturba\u00e7\u00f5es n\u00e3o medidas e mudan\u00e7as no \n\ndesempenho do processo provocadas por diversos fatores. O ajuste dos par\u00e2metros \n\ndo modelo corresponde \u00e0 corre\u00e7\u00e3o do mesmo atrav\u00e9s da a\u00e7\u00e3o de retroalimenta\u00e7\u00e3o \n\ndo processo (Camolesi et al., 2008). \n\nTanto a reconcilia\u00e7\u00e3o de dados como o ajuste de par\u00e2metros consistem em \n\nproblemas de otimiza\u00e7\u00e3o que podem ser resolvidos separadamente ou de forma \n\nsimult\u00e2nea. Embora a solu\u00e7\u00e3o integrada dos dois problemas seja considerada mais \n\neficiente, h\u00e1 implementa\u00e7\u00f5es em que a reconcilia\u00e7\u00e3o de dados \u00e9 resolvida primeiro \n\nutilizando-se modelos mais simples (por exemplo apenas os balan\u00e7os de massa e \n\nenergia) e os valores reconciliados das vari\u00e1veis de processo (vaz\u00f5es, \n\ntemperaturas) s\u00e3o ent\u00e3o utilizados na estima\u00e7\u00e3o de par\u00e2metros. Com isto, reduz-se \n\na magnitude e a complexidade dos problemas de otimiza\u00e7\u00e3o a serem resolvidos. \n\nOutro recurso frequentemente utilizado para este fim \u00e9 selecionar apenas um \n\nsubconjunto de todos os par\u00e2metros e vari\u00e1veis poss\u00edveis para reconcilia\u00e7\u00e3o e/ ou \n\nestima\u00e7\u00e3o em tempo real (Arora e Biegler, 2001). \n\nModelo de Processo: \n\nO modelo matem\u00e1tico do processo deve representar o sistema em uma ampla faixa \n\nde opera\u00e7\u00f5es e com elevado grau de precis\u00e3o, de forma que, quando utilizado pelo \n\notimizador, n\u00e3o sejam violadas as restri\u00e7\u00f5es do processo e a sua lucratividade \n\npotencial seja obtida (Camolesi et al., 2008). \n\nO modelo de processo utilizado na RTO deve representar mudan\u00e7as nas vari\u00e1veis \n\nindependentes do processo, fornecendo assim os pontos de ajuste atualizados que \n\ns\u00e3o calculados pelo algoritmo de otimiza\u00e7\u00e3o.  O efeito das vari\u00e1veis independentes \n\n\n\n26 \n \n\nsobre as vari\u00e1veis dependentes, que s\u00e3o geralmente aquelas que est\u00e3o nas \n\nrestri\u00e7\u00f5es, deve ter um impacto econ\u00f4mico significativo. Basicamente em todos os \n\ncasos pr\u00e1ticos, o modelo \u00e9 n\u00e3o-linear e \u00e9 simulado em estado estacion\u00e1rio.  \n\nNo trabalho de Mendoza et al. (2013) mostra-se que um modelo implementado em \n\num ambiente orientado a equa\u00e7\u00f5es \u00e9 adequado para a otimiza\u00e7\u00e3o de aplica\u00e7\u00f5es em \n\ntempo real, devido \u00e0 sua robustez, converg\u00eancia r\u00e1pida e capacidade de representar \n\no processo real. A an\u00e1lise do modelo permite uma melhor compreens\u00e3o do processo \n\ne do estabelecimento de limites para processar as especifica\u00e7\u00f5es e os par\u00e2metros \n\natualizados no ciclo RTO.  \n\nOtimiza\u00e7\u00e3o Econ\u00f4mica: \n\nNeste trabalho a aten\u00e7\u00e3o ser\u00e1 focada no problema de otimiza\u00e7\u00e3o econ\u00f4mica em \n\numa aplica\u00e7\u00e3o de RTO, que consiste na determina\u00e7\u00e3o do ponto operacional que \n\nmelhor satisfa\u00e7a um determinado crit\u00e9rio de desempenho de uma planta. Este \n\ncrit\u00e9rio \u00e9 expresso matematicamente atrav\u00e9s de uma fun\u00e7\u00e3o objetivo que pode \n\nrepresentar, por exemplo, o lucro bruto operacional de uma unidade de processo  \n\n(valor dos produtos finais menos os custos operacionais e das mat\u00e9rias-primas) o \n\nrendimento de um produto, ou mesmo uma combina\u00e7\u00e3o de diferentes objetivos. O \n\nespa\u00e7o de busca do ponto \u00f3timo \u00e9 normalmente limitado por restri\u00e7\u00f5es. Essas \n\nrestri\u00e7\u00f5es em geral representam limites de seguran\u00e7a ou capacidade de \n\nequipamentos, especifica\u00e7\u00f5es de qualidade de produtos, restri\u00e7\u00f5es ambientais, etc. \n\nA rela\u00e7\u00e3o entre as vari\u00e1veis utilizadas para definir o ponto \u00f3timo operacional e as \n\nvari\u00e1veis que expressam as respostas do processo a est\u00edmulos externos \u00e9 dada por \n\num modelo matem\u00e1tico do processo. \n\nA classifica\u00e7\u00e3o dos problemas de otimiza\u00e7\u00e3o pode ser feita de diversas maneiras, \n\nconsiderando as caracter\u00edsticas das vari\u00e1veis, das fun\u00e7\u00f5es objetivo e das restri\u00e7\u00f5es \n\nimpostas ao problema. Biegler e Grossmann (2004) apresentam de forma \n\nabrangente as in\u00fameras alternativas poss\u00edveis. Aplica\u00e7\u00f5es em tempo real para a \n\nind\u00fastria do petr\u00f3leo em geral baseiam-se em vari\u00e1veis cont\u00ednuas, e, por \n\nconseguinte os problemas t\u00edpicos decorrentes s\u00e3o de Programa\u00e7\u00e3o n\u00e3o-linear \n\n(NLP). Esta etapa ser\u00e1 desenvolvida com mais detalhes na subdivis\u00e3o 2.4. \n\n \n\n\n\n27 \n \n\nImplementa\u00e7\u00e3o da solu\u00e7\u00e3o \u00f3tima \n\nA implementa\u00e7\u00e3o na planta do ponto \u00f3timo operacional obtido como solu\u00e7\u00e3o do \n\nproblema de otimiza\u00e7\u00e3o n\u00e3o pode, em geral, ser feita de forma instant\u00e2nea. Se \n\nhouver diferen\u00e7a significativa entre o estado vigente das vari\u00e1veis de processo e \n\naquele proposto, a implementa\u00e7\u00e3o instant\u00e2nea da nova solu\u00e7\u00e3o poderia gerar uma \n\nsevera perturba\u00e7\u00e3o sobre o processo. Para evitar que isso ocorra, a implementa\u00e7\u00e3o \n\ndo ponto \u00f3timo \u00e9 geralmente feita atrav\u00e9s de controladores preditivos multivari\u00e1veis, \n\nque realizam a implementa\u00e7\u00e3o de forma suave, distribuindo-a ao longo de certo \n\nhorizonte de tempo, levando em considera\u00e7\u00e3o (atrav\u00e9s de seu pr\u00f3prio modelo \n\nmatem\u00e1tico) as restri\u00e7\u00f5es vigentes e a eventual ocorr\u00eancia de perturba\u00e7\u00f5es. Na \n\naus\u00eancia de controladores preditivos, pode-se ainda utilizar algoritmos simples para \n\nimplementa\u00e7\u00e3o suave dos valores \u00f3timos como set-points do sistema de controle \n\nregulat\u00f3rio (Carvalho, 2007).  \n\nO conjunto de set-points encontrados para o processo pelo otimizador \u00e9 enviado de \n\nvolta para a planta. Uma vez que a planta atingiu o estado estacion\u00e1rio, um outro \n\nciclo do RTO \u00e9 realizado, para mant\u00ea-la operando da forma mais eficiente poss\u00edvel. \n\n \n\n2.3. OTIMIZA\u00c7\u00c3O DO PROCESSO - OTIMIZA\u00c7\u00c3O ECON\u00d4MICA \n\n \n\nA otimiza\u00e7\u00e3o econ\u00f4mica aplicada a um problema RTO consiste na determina\u00e7\u00e3o do \n\nponto operacional que melhor satisfaz um determinado crit\u00e9rio econ\u00f4mico da planta. \n\nNum problema de otimiza\u00e7\u00e3o de processos, normalmente, s\u00e3o consideradas as \n\ndivis\u00f5es independentemente, no qual s\u00e3o levados em conta o custo da alimenta\u00e7\u00e3o, \n\no custo operacional e as receitas de vendas de produtos. Os custos fixos, tais como \n\no custo de capital e os sal\u00e1rios, est\u00e3o exclu\u00eddos da fun\u00e7\u00e3o objetivo, uma vez que \n\nn\u00e3o se pode modificar esses custos por meio da otimiza\u00e7\u00e3o das vari\u00e1veis \n\noperacionais (Carvalho, 2007).  \n\nS\u00f3 que, considerando que o problema de otimiza\u00e7\u00e3o engloba toda a refinaria, uma \n\n\u00fanica unidade otimizada cobre apenas um subconjunto do problema e como tal, n\u00e3o \n\nnecessariamente fornece uma resposta v\u00e1lida para toda a refinaria. Se as divis\u00f5es \n\nda planta s\u00e3o todas independentes, ent\u00e3o \u00e9 comum resolver o problema de \n\notimiza\u00e7\u00e3o da planta usando uma abordagem distribu\u00edda como \u00e9 mostrado na figura \n\n\n\n28 \n \n\n2.4, em que a solu\u00e7\u00e3o de toda a planta x* \u00e9 simplesmente o conjunto das solu\u00e7\u00f5es \n\nde todas as divis\u00f5es (x1*, x2*, x3*, x4*). \n\n \n\nFigura 2.4 - Otimiza\u00e7\u00e3o modular para divis\u00f5es independentes da planta. \n\n \n          Fonte: Jose e Ungar (2000). \n\n \n\nNo entanto, em uma refinaria, isso seria um caso raro, pois as divis\u00f5es em uma \n\nplanta n\u00e3o s\u00e3o independentes, elas interagem umas com as outras atrav\u00e9s de fluxos \n\nentre processos (ver figura 2.5).  \n\n \n\nFigura 2.5 - Divis\u00f5es da planta interagem pelas correntes intermedi\u00e1rias entre processos.  \n\n \n Fonte: Jose e Ungar (2000). \n\n \n\nAinda assim a principal raz\u00e3o para fazer otimiza\u00e7\u00f5es locais (modelos reduzidos) \u00e9 \n\nque, fazer s\u00f3 um modelo de toda a refinaria \u00e9 uma tarefa complexa de ser feita e \n\n\n\n29 \n \n\npraticamente intrat\u00e1vel devido ao elevado n\u00famero de vari\u00e1veis e equa\u00e7\u00f5es que tem \n\nque ser levados em conta, e ao alto consumo de tempo computacional na sua \n\nresolu\u00e7\u00e3o, por essa raz\u00e3o que \u00e9 importante considerar uma estrutura distribu\u00edda na \n\nqual, cada divis\u00e3o busque atingir o ponto operacional que gere o m\u00e1ximo lucro \n\nposs\u00edvel da refinaria como um todo. \n\nComo o objetivo de cada divis\u00e3o \u00e9 maximizar o seu pr\u00f3prio lucro, ent\u00e3o cada divis\u00e3o \n\ndeve conhecer os pre\u00e7os dos fluxos intermedi\u00e1rios (ver figura 2.6). Uma vez que os \n\npre\u00e7os dos produtos intermedi\u00e1rios (que est\u00e3o em fun\u00e7\u00e3o da qualidade e tamb\u00e9m de \n\nconsidera\u00e7\u00f5es na programa\u00e7\u00e3o da produ\u00e7\u00e3o) sejam conhecidos, a otimiza\u00e7\u00e3o \n\nindividual de cada divis\u00e3o poderia maximizar o lucro de toda a refinaria (Friedman, \n\n1995). \n\n \n\nFigura 2.6 - Divis\u00f5es da planta necessitam conhecer os pre\u00e7os das correntes intermedi\u00e1rias. \n\n \nFonte: Jose e Ungar (2000). \n\n \n\nOs pre\u00e7os de produtos e insumos incorporados \u00e0 fun\u00e7\u00e3o objetivo de problemas de \n\notimiza\u00e7\u00e3o s\u00e3o par\u00e2metros fundamentais para RTO, pois definem a forma da fun\u00e7\u00e3o \n\ne norteiam a solu\u00e7\u00e3o a ser obtida.  \n\nEnt\u00e3o, \u00e9 pertinente definir um pre\u00e7o de transfer\u00eancia que \u00e9 um valor estabelecido em \n\ntermos monet\u00e1rios para registrar as transfer\u00eancias de bens e servi\u00e7os realizadas \n\nentre as divis\u00f5es de uma empresa ou entre empresas de um mesmo grupo (Anthony \n\ne Govindarajan, 2002). Este conceito pode ser ampliado para tratar, em termos \n\nmonet\u00e1rios, as transfer\u00eancias das correntes intermedi\u00e1rias entre as divis\u00f5es dentro \n\nde uma mesma unidade de uma refinaria.     \n\n\n\n30 \n \n\nAtkinson e Anthony (2000) diz que as empresas adotam diferentes m\u00e9todos para \n\ndeterminar o pre\u00e7o de transfer\u00eancia, os mais importantes s\u00e3o:  \n\n? Baseado no mercado. \n\n? Baseado em custos. \n\n \n\nOs pre\u00e7os baseados no mercado externo s\u00e3o bases mais apropriadas para estimar o \n\nvalor das mercadorias ou servi\u00e7os transferidos entre as divis\u00f5es de uma empresa. O \n\npre\u00e7o de mercado prov\u00ea uma estimativa independente do produto ou servi\u00e7o \n\ntransferido e indica como cada centro de lucro contribui para o total ganho pela \n\nempresa na transa\u00e7\u00e3o. Por exemplo, a divis\u00e3o de vendas, em vez de transferir a \n\nmercadoria internamente, poderia vend\u00ea-la externamente. De modo semelhante, a \n\ndivis\u00e3o de compras poderia comprar externamente em vez de receber a \n\ntransfer\u00eancia interna (Atkinson, 2000). Se os pre\u00e7os de mercado n\u00e3o est\u00e3o \n\ndispon\u00edveis, os pre\u00e7os de transfer\u00eancias internas podem ser definidos com base nos \n\ncustos. As abordagens baseadas no custo para transferir bens e servi\u00e7os s\u00e3o \n\nincompat\u00edveis com a ideia de que o mecanismo da transfer\u00eancia de valor forne\u00e7a \n\napoio ao c\u00e1lculo da receita da unidade. Jordan, Neves e Rodrigues (2003) afirmam \n\nque tendo por base os custos, as formas mais usadas de fixar os pre\u00e7os de \n\ntransfer\u00eancia interna s\u00e3o: custo real, custo padr\u00e3o e pre\u00e7o sombra (shadow price). \n\nO custo real pressup\u00f5e a determina\u00e7\u00e3o do pre\u00e7o em fun\u00e7\u00e3o dos custos efetivamente \n\ndispendidos para produzir o bem ou o servi\u00e7o. Por\u00e9m, podem existir situa\u00e7\u00f5es em \n\nque um pre\u00e7o de transfer\u00eancia interno baseado no custo real n\u00e3o deva ser utilizado, \n\npois existe uma dificuldade ao ratear os custos de v\u00e1rios produto de uma mesma \n\ndivis\u00e3o, isso implica que o pre\u00e7o de transfer\u00eancia baseado em custo real pode levar \n\na decis\u00f5es prejudiciais para a empresa e \u00e0 sub-otimiza\u00e7\u00e3o de determinada divis\u00e3o, \n\nj\u00e1 que todas as inefici\u00eancias de uma unidade podem ser passadas para outra \n\nunidade em forma de pre\u00e7o (Beuren et al., 2008). \n\nPara o custo-padr\u00e3o, segundo Martins (2003), o objetivo \u00e9 o de fixar uma base de \n\ncompara\u00e7\u00e3o entre o que ocorreu em termos de custo e o que deveria ter ocorrido. \n\nEsta afirma\u00e7\u00e3o leva a visualizar o custo-padr\u00e3o como uma t\u00e9cnica auxiliar da \n\ncontabilidade de custos e n\u00e3o outro m\u00e9todo ou crit\u00e9rio de contabiliza\u00e7\u00e3o dos custos \n\ne tomada de decis\u00f5es respeito a um problema de otimiza\u00e7\u00e3o. \n\n\n\n31 \n \n\nJ\u00e1 o pre\u00e7o sombra, conhecido internacionalmente como shadow price, utiliza o \n\nproblema de otimiza\u00e7\u00e3o para cada divis\u00e3o, no qual, identifica o valor econ\u00f4mico \n\n(pre\u00e7o) de uma unidade de recurso para cada restri\u00e7\u00e3o, ou seja, quanto a fun\u00e7\u00e3o \n\nobjetivo (maximizar lucro) aumentar\u00e1 se for relaxar uma restri\u00e7\u00e3o de desigualdade \n\nem uma unidade (Beuren et al., 2008). Ent\u00e3o pode-se dizer que a decis\u00e3o feita em \n\nbase ao pre\u00e7o sombra gere o maior lucro poss\u00edvel para cada divis\u00e3o, na qual, vai ser \n\nrelaxada uma restri\u00e7\u00e3o de escassez de produto dispon\u00edvel para ser processado e \n\nn\u00e3o assim uma restri\u00e7\u00e3o de consist\u00eancia.    \n\nEnt\u00e3o, resumindo, o principal crit\u00e9rio para atribuir um pre\u00e7o a um produto \n\nintermedi\u00e1rio \u00e9 a exist\u00eancia de pre\u00e7o de mercado para esse produto, por\u00e9m, se n\u00e3o \n\nhouver pre\u00e7o de mercado para o mesmo, ele pode ser estimado com base nos \n\ncustos do processo a partir da programa\u00e7\u00e3o matem\u00e1tica (pre\u00e7os sombra). Os pre\u00e7os \n\nsombra e pre\u00e7os de mercado s\u00e3o os dois principais recursos para estimar os pre\u00e7os \n\ndas correntes intermedi\u00e1rias para garantir decis\u00f5es que gerem o maior lucro para a \n\ndivis\u00e3o (Li, 2000). \n\nConsiderando que o problema de especificar os pre\u00e7os das correntes intermedi\u00e1rias \n\npossa ser resolvido por meio dos m\u00e9todos explicados anteriormente, ainda resta um \n\noutro problema ainda mais importante que \u00e9 a coordena\u00e7\u00e3o que tem que existir \n\nentre as divis\u00f5es da refinaria, para que garantam uma solu\u00e7\u00e3o que considere toda a \n\nrefinaria. J\u00e1 que o ponto operacional de melhor desempenho de uma divis\u00e3o \u00e9 \n\ndeterminado independentemente, n\u00e3o corresponde necessariamente ao maior lucro \n\nposs\u00edvel que uma refinaria pode gerar considerando todas suas divis\u00f5es \n\nsimultaneamente. Para resolver este problema, tem que ser considerados os \n\ncrit\u00e9rios de t\u00e9cnicas de decomposi\u00e7\u00e3o para problemas de otimiza\u00e7\u00e3o que garantam \n\nque o lucro obtido utilizando uma estrutura distribu\u00edda possa atingir um valor muito \n\npr\u00f3ximo ao da otimiza\u00e7\u00e3o de todas as unidades consideradas juntas e como \n\nconsequ\u00eancia do uso das t\u00e9cnicas possa-se precificar adequadamente as correntes \n\nintermediarias. \n\n \n\n2.4. DECOMPOSI\u00c7\u00c3O DE PROBLEMAS DE OTIMIZA\u00c7\u00c3O \n\n \n\nAtualmente, otimizadores on-line t\u00eam sido implementados em v\u00e1rias unidades nas \n\nrefinarias, operando o mais perto poss\u00edvel de suas restri\u00e7\u00f5es, para que o processo \n\n\n\n32 \n \n\nseja mais rent\u00e1vel. No entanto, o otimizador implementado em uma \u00fanica unidade s\u00f3 \n\nconsidera a economia dessa unidade, ao inv\u00e9s de levar em conta a situa\u00e7\u00e3o de toda \n\na planta. \u00c9 improv\u00e1vel que a otimiza\u00e7\u00e3o de uma \u00fanica unidade gere uma solu\u00e7\u00e3o  \n\ncompat\u00edvel com os dados de uma otimiza\u00e7\u00e3o de toda a refinaria. Isso significa que a \n\nsolu\u00e7\u00e3o da otimiza\u00e7\u00e3o em uma \u00fanica unidade pode n\u00e3o ser consistente com a \n\nestrat\u00e9gia de opera\u00e7\u00e3o ideal para toda a refinaria (Li, 2000). \n\nNaysmith e Douglas (1995) apresentam duas estruturas para fazer a otimiza\u00e7\u00e3o de \n\numa refinaria: a primeira \u00e9 a otimiza\u00e7\u00e3o com estrutura centralizada, esta \u00e9 a forma \n\nmais comum de otimiza\u00e7\u00e3o encontrada na literatura, considerando s\u00f3 um modelo \n\npara toda a planta. A segunda forma considera uma estrutura distribu\u00edda, \n\ndecompondo o problema de otimiza\u00e7\u00e3o em subproblemas com o objetivo de reduzir \n\na complexidade que apresenta a estrutura centralizada. A figura 2.7 mostra uma \n\ncompara\u00e7\u00e3o de uma otimiza\u00e7\u00e3o centralizada versus uma otimiza\u00e7\u00e3o distribu\u00edda. A \n\nabordagem distribu\u00edda quebra a otimiza\u00e7\u00e3o centralizada em v\u00e1rias otimiza\u00e7\u00f5es \n\nlocais, que s\u00e3o coordenados por um modelo coordenador (mestre). O objetivo da \n\nabordagem \u00e9 distribu\u00eddo porque decomp\u00f5e a planta de grande escala em \n\nsubsistemas, reduzindo assim a complexidade do problema de otimiza\u00e7\u00e3o original. A \n\nabordagem distribu\u00edda tamb\u00e9m \u00e9 referida como otimiza\u00e7\u00e3o modular ou hier\u00e1rquica. \n\nDarby e White (1988) afirmam que uma abordagem de otimiza\u00e7\u00e3o distribu\u00edda pode \n\nter as seguintes vantagens: \n\n? As otimiza\u00e7\u00f5es locais podem ser feitas em paralelo, reduzindo assim o \n\ngasto de tempo computacional. \n\n? Poder ser realizada como maior frequ\u00eancia do que a abordagem de \n\notimiza\u00e7\u00e3o centralizada. \n\n? Os otimizadores locais podem modelar os subsistemas de forma mais \n\nprecisa e completa do que um otimizador centralizado, tamb\u00e9m podem ter \n\nn\u00edveis diferentes de otimiza\u00e7\u00e3o. \n\n? O otimizador local permite a incorpora\u00e7\u00e3o da estima\u00e7\u00e3o de par\u00e2metros \n\non-line mais facilmente. \n\n? Podem-se utilizar diferentes softwares de otimiza\u00e7\u00e3o para cada uma das \n\ndivis\u00f5es. \n\n\n\n33 \n \n\n? O otimizador local \u00e9 mais f\u00e1cil de manter, \u00e9 menos complexo e mais f\u00e1cil \n\nde entender do que um otimizador com estrutura centralizada. \n\n? Se acontecer algum problema com um otimizador local, este pode ser \n\ndesligado (off-line) enquanto o resto dos otimizadores continuam \n\ntrabalhando. O otimizador centralizado tem que ser completamente \n\ninterrompido para ser reestruturado. \n\n \n\nFigura 2.7 - Otimiza\u00e7\u00e3o centralizada vs distribu\u00edda. \n\n \n Fonte: Naysmith e Douglas (1995). \n\n \n\nBailey et al. (1993) encontram duas grandes dificuldades para a otimiza\u00e7\u00e3o \n\ndistribu\u00edda: \n\n? A informa\u00e7\u00e3o passada entre as restri\u00e7\u00f5es dos otimizadores das unidades \n\npara evitar conflitos n\u00e3o \u00e9 t\u00e3o eficaz como em uma abordagem \n\ncentralizada. \n\n? \u00c9 poss\u00edvel encontrar inconsist\u00eancias dos par\u00e2metros quando s\u00f3 uma \n\nparte do processo \u00e9 considerada. \n\n\n\n34 \n \n\nZhang e Zhu (2000) apresentam uma metodologia para determina\u00e7\u00e3o do ponto \n\n\u00f3timo global de uma planta. Inicialmente, os autores mostram que a otimiza\u00e7\u00e3o \n\nneste n\u00edvel \u00e9 feita a partir de modelos simplificados baseados em modelos de \n\nrendimentos, j\u00e1 que a modelagem rigorosa levaria a imensas dificuldades pr\u00e1ticas. \n\nEsta simplifica\u00e7\u00e3o leva a resultados limitados, embora tenha a grande vantagem de \n\nlevar em considera\u00e7\u00e3o a utiliza\u00e7\u00e3o integrada das unidades de processo. Por outro \n\nlado, as diferentes divis\u00f5es podem ter seu ponto \u00f3timo local determinado a partir de \n\nmodelos rigorosos, capazes de determinar o ponto \u00f3timo da divis\u00e3o com grande \n\nprecis\u00e3o. Contudo, o ponto \u00f3timo encontrado pode n\u00e3o corresponder \u00e0quele que \n\nleva ao m\u00e1ximo desempenho da planta.  \n\nOutra dificuldade est\u00e1 no fato de que as divis\u00f5es em geral possuem como cargas ou \n\nprodutos correntes intermedi\u00e1rias cujos pre\u00e7os podem ser dif\u00edceis de definir (Hui, \n\n2002). Para determinar o ponto \u00f3timo global da planta, os autores prop\u00f5em uma \n\nmetodologia que se baseia na decomposi\u00e7\u00e3o do problema em duas camadas. No \n\nin\u00edcio do processo iterativo \u00e9 realizada a otimiza\u00e7\u00e3o da planta a partir do modelo \n\nsimplificado, gerando como sa\u00eddas adicionais os custos marginais das correntes do \n\nprocesso. Estes valores s\u00e3o repassados \u00e0 segunda camada, composta pelos \n\nproblemas de otimiza\u00e7\u00e3o baseados em modelos rigorosos.  \n\nA otimiza\u00e7\u00e3o de cada unidade \u00e9 computada e no ponto \u00f3timo operacional de cada \n\numa s\u00e3o determinados novos coeficientes de rendimentos que s\u00e3o repassados \u00e0 \n\nprimeira camada. O processo \u00e9 repetido at\u00e9 que haja converg\u00eancia dos custos \n\nmarginais e coeficientes de rendimento. Desta forma, seria obtida uma solu\u00e7\u00e3o \u00f3tima \n\npara a planta em perfeita sintonia com o ponto \u00f3timo de cada unidade, explorando \n\nao m\u00e1ximo a sinergia entre as unidades. Como exemplo para teste da metodologia, \n\nfoi utilizada uma refinaria contendo unidades de craqueamento catal\u00edtico flu\u00eddo, \n\ndestila\u00e7\u00e3o atmosf\u00e9rica e a v\u00e1cuo, coqueamento retardado, hidrotratamento e \n\nblending, entre outras. Os resultados obtidos no exemplo sugerem a possibilidade \n\nde ganhos significativos.  \n\nEm 2006, Zhang e Zhu propuseram uma evolu\u00e7\u00e3o desta metodologia, em que o \n\nalgoritmo de otimiza\u00e7\u00e3o que integra as duas camadas foi modificado, novos crit\u00e9rios \n\nde converg\u00eancia foram propostos e outros aspectos pr\u00e1ticos foram considerados, \n\ncomo a exist\u00eancia de poss\u00edveis correntes de reciclo (e como trat\u00e1-las dentro da \n\n\n\n35 \n \n\nestrat\u00e9gia de decomposi\u00e7\u00e3o). Novamente utilizou-se uma refinaria de petr\u00f3leo como \n\nexemplo ilustrativo (Carvalho, 2007). \n\nA otimiza\u00e7\u00e3o se preocupa, de forma geral, em aumentar o lucro da unidade \n\nprodutiva. No entanto, nem sempre a quantifica\u00e7\u00e3o do lucro \u00e9 algo palp\u00e1vel, pois \n\numa unidade industrial encontra-se sempre introduzida em um contexto mais amplo, \n\ncomposto por v\u00e1rias unidades industriais e o lucro global nem sempre \u00e9 \n\nrepresentado pelo lucro local. Os objetivos da otimiza\u00e7\u00e3o podem ser variados, de \n\nacordo com o que a programa\u00e7\u00e3o de produ\u00e7\u00e3o determina. Exemplos de objetivos \n\ncomuns de otimiza\u00e7\u00e3o de unidades industriais podem ser, al\u00e9m do lucro, o m\u00ednimo \n\nconsumo de energia, a m\u00e1xima convers\u00e3o de um produto ou v\u00e1rios, a m\u00e1xima \n\nseletividade, a m\u00e1xima ou m\u00ednima especifica\u00e7\u00e3o, entre outros (Duraiski, 2009). \n\nAs t\u00e9cnicas de decomposi\u00e7\u00e3o cl\u00e1ssicas baseiam-se em algoritmos iterativos para \n\nque os problemas de otimiza\u00e7\u00e3o possam ser decompostos e resolvidos \n\nseparadamente, realizando atualiza\u00e7\u00f5es do multiplicador de Lagrange para as \n\nrestri\u00e7\u00f5es das correntes intermediarias das divis\u00f5es, em que para fins econ\u00f4micos \n\nos multiplicadores de Lagrange representariam os pre\u00e7os sombra desses produtos \n\nintermedi\u00e1rios. Essas t\u00e9cnicas de decomposi\u00e7\u00e3o v\u00eam sendo estudadas pelo grupo \n\nde pesquisa com intuito de ser aplicadas no projeto de desenvolvimento de solu\u00e7\u00f5es \n\nRTO para a unidade de produ\u00e7\u00e3o de propeno da refinaria REPLAN da \n\nPETROBRAS.  \n\n\n\n36 \n \n\n3. T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O NA OTIMIZA\u00c7\u00c3O DE PROCESSOS \n\n \n\nM\u00e9todos de decomposi\u00e7\u00e3o s\u00e3o usados principalmente para resolver problemas de \n\notimiza\u00e7\u00e3o de grande escala que apresentam uma estrutura de subsistemas inter-\n\nrelacionados. Reduzir a dimens\u00e3o n\u00e3o \u00e9 a \u00fanica motiva\u00e7\u00e3o, outro aspecto \u00e9 que \n\nsejam tomadas decis\u00f5es localmente e que os c\u00e1lculos para resolver estes \n\nsubsistemas sejam feitos em paralelo com diferentes processadores e/ou softwares.  \n\nAs t\u00e9cnicas cl\u00e1ssicas de decomposi\u00e7\u00e3o em programa\u00e7\u00e3o matem\u00e1tica podem ter \n\numa estrutura baseada no pre\u00e7o (price-directive decomposition) ou baseada no \n\nrecurso (resource-directive decomposition). Em ambas estruturas, ter conhecimento \n\ndas condi\u00e7\u00f5es de otimalidade e de dualidade \u00e9 fundamental para entender o \n\nconceito de decomposi\u00e7\u00e3o e da resolu\u00e7\u00e3o iterativa dos problemas (Mahey, 2002).  \n\nAssim, a ideia geral das t\u00e9cnicas de decomposi\u00e7\u00e3o \u00e9 relaxar as restri\u00e7\u00f5es globais \n\n(restri\u00e7\u00f5es complicadoras), que conectam duas ou mais partes decompon\u00edveis de \n\num problema de otimiza\u00e7\u00e3o, o que pode ser alcan\u00e7ado de diversas formas.  \n\n \n\n3.1. T\u00c9CNICAS DE RELAXA\u00c7\u00c3O E DECOMPOSI\u00c7\u00c3O \n\n \n\nA otimiza\u00e7\u00e3o \u00e9 \"a ci\u00eancia do melhor\" no sentido de que ela ajuda a tomar n\u00e3o \n\napenas uma decis\u00e3o vi\u00e1vel, mas sim a melhor decis\u00e3o sujeita a certas restri\u00e7\u00f5es que \n\ndescrevem o dom\u00ednio dentro do qual a mesma tem que ser feita. Modelos de \n\nprograma\u00e7\u00e3o matem\u00e1tica fornecem o quadro apropriado para abordar essas \n\ndecis\u00f5es de otimiza\u00e7\u00e3o de forma precisa e formal. Portanto, um problema de \n\nprograma\u00e7\u00e3o matem\u00e1tica, \u00e9 representado por uma estrutura de decis\u00e3o de \n\notimiza\u00e7\u00e3o, apresentada abaixo: \n\n    Max  Fun\u00e7\u00e3o Objetivo \n\n    sujeito a:      Restri\u00e7\u00f5es  \n\nMuitos problemas derivados de situa\u00e7\u00f5es concretas apresentam determinadas \n\nestruturas descentralizadas. Portanto, um problema de programa\u00e7\u00e3o matem\u00e1tica \n\nassociada ao modelo de otimiza\u00e7\u00e3o descentralizado pode apresentar a seguinte \n\nestrutura (Conejo et al. 2006): \n\n\n\n37 \n \n\nMax    Objetivo1  + Objetivo2 \n\nSujeito a:   Restri\u00e7\u00f5es1   \n\n      Restri\u00e7\u00f5es2 \n\n                     Restri\u00e7\u00f5es Comuns1,2 \n\n \n\n \n\n \n\n \n\nNeste exemplo o bloco de restri\u00e7\u00f5es \"restri\u00e7\u00f5es 1\" est\u00e1 relacionado com o primeiro \n\ntermo da fun\u00e7\u00e3o objetivo \"objetivo 1\" e corresponde ao subproblema 1, enquanto \n\nque o segundo bloco de restri\u00e7\u00f5es \"restri\u00e7\u00f5es 2\" est\u00e1 relacionado com a segunda \n\nparte da fun\u00e7\u00e3o objetivo \"objetivo 2\" e corresponde ao subproblema 2. No entanto, o \n\nbloco de restri\u00e7\u00f5es comuns afeta os dois subproblemas (s\u00e3o restri\u00e7\u00f5es de fronteira) \n\ne complica a solu\u00e7\u00e3o do problema, pois evita que os subproblemas associados com \n\nos dois blocos sejam resolvidos separadamente. Por causa das considera\u00e7\u00f5es \n\nacima, as restri\u00e7\u00f5es comuns s\u00e3o denominadas restri\u00e7\u00f5es complicadoras. \n\nFinalmente, nota-se que teria sido poss\u00edvel considerar qualquer n\u00famero de blocos \n\ncom diferentes estruturas de fronteira, em vez de apenas dois (Conejo et al. 2006). \n\nJ\u00e1 um problema de programa\u00e7\u00e3o matem\u00e1tica que envolve vari\u00e1veis inteiras \n\napresenta a seguinte estrutura: \n\n  Max   Objetivo1  + Objetivo2 \n\n  Sujeito a:  Restri\u00e7\u00f5es1  &amp; Restri\u00e7\u00f5es Comuns1,2 (Inteiras) \n\n    Restri\u00e7\u00f5es2 &amp; Restri\u00e7\u00f5es Comuns1,2 (Inteiras) \n\nA parte comum de ambos os blocos das restri\u00e7\u00f5es est\u00e3o relacionada com decis\u00f5es \n\ninteiras enquanto as partes n\u00e3o comuns est\u00e3o relacionadas com as decis\u00f5es \n\ncont\u00ednuas. Tratar vari\u00e1veis inteiras \u00e9 muito mais complicado do que tratar as \n\nvari\u00e1veis cont\u00ednuas, por isso  tais problemas s\u00e3o denominados como problemas com \n\nvari\u00e1veis complicadoras. Al\u00e9m disso, nota-se que uma vez que as decis\u00f5es das \n\nvari\u00e1veis inteiras forem feitas, o subproblema resultante decomp\u00f5e-se por blocos, o \n\nque pode facilitar consideravelmente a sua solu\u00e7\u00e3o.  \n\nO problema estudado neste trabalho apresenta uma topologia descentralizada, que \n\n\u00e9 uma estrutura adequada para algumas estrat\u00e9gias de decomposi\u00e7\u00e3o. As vari\u00e1veis \n\nconsideradas no problema s\u00e3o cont\u00ednuas e as restri\u00e7\u00f5es das opera\u00e7\u00f5es s\u00e3o n\u00e3o-\n\nlineares, portanto devem ser consideradas t\u00e9cnicas adequadas para problemas de \n\ndecomposi\u00e7\u00e3o com restri\u00e7\u00f5es complicadoras. Os m\u00e9todos cl\u00e1ssicos sugeridos por \n\nConejo et al. (2006) s\u00e3o os de relaxa\u00e7\u00e3o Lagrangeana e Lagrangeano aumentado, \n\n\n\n38 \n \n\nmas, pelas caracter\u00edsticas do problema estudado, Jose e Ungar (2000) sugerem \n\numa t\u00e9cnica alternativa que \u00e9 Pricing Interprocess streams Using Slack Auctions j\u00e1 \n\nque as t\u00e9cnicas cl\u00e1ssicas podem apresentar uma serie de problemas na sua \n\naplica\u00e7\u00e3o. Na pr\u00f3xima se\u00e7\u00e3o ser\u00e3o apresentados detalhes das t\u00e9cnicas \n\nmencionadas. \n\n \n\n3.2. RELAXA\u00c7\u00c3O LAGRANGEANA E DUALIDADE \n\n \n\nPara poder entender os m\u00e9todos de decomposi\u00e7\u00e3o \u00e9 importante repassar os \n\nconceitos de condi\u00e7\u00f5es de otimalidade e dualidade, o que \u00e9 apresentado nas \n\npr\u00f3ximas subse\u00e7\u00f5es. \n\n \n\n3.2.1. Condi\u00e7\u00f5es de Otimalidade \n\n \n\nConceitos b\u00e1sicos das condi\u00e7\u00f5es de otimalidade podem ser encontrados em \n\nBazaraa et al. (2006), Winston (1995) e Conejo et al. (2006).  De acordo com Pinto e \n\nGut (2005), um problema de otimiza\u00e7\u00e3o pode ser classificado em: problema de \n\notimiza\u00e7\u00e3o sem restri\u00e7\u00f5es, problema de otimiza\u00e7\u00e3o com restri\u00e7\u00f5es de igualdade, \n\nproblema de otimiza\u00e7\u00e3o com restri\u00e7\u00f5es de desigualdade e por ultimo problema de \n\notimiza\u00e7\u00e3o com restri\u00e7\u00f5es de igualdade e desigualdade. A seguir s\u00e3o explicitadas \n\ncada uma destas classifica\u00e7\u00f5es. \n\na) Problema de otimiza\u00e7\u00e3o sem restri\u00e7\u00f5es: \n\nSeja o problema de otimiza\u00e7\u00e3o \n\n  Min   \u0192(x) \n\n  sujeito a:  x ? R\nn\n    \n\ncom \u0192(x) ? C\n2\n (Conjunto das fun\u00e7\u00f5es que podem ser diferenciadas duas vezes). \n\nA condi\u00e7\u00e3o necess\u00e1ria para um m\u00ednimo local \u00e9: \n\nTeorema 3.1: se \u0192(x) possui um extremo em x* (m\u00e1ximo ou m\u00ednimo), ent\u00e3o este \u00e9 \n\num ponto estacion\u00e1rio: \n\n? \u0192(x*) = 0 \n\n\n\n39 \n \n\nO que constitui um sistema com n equa\u00e7\u00f5es e n inc\u00f3gnitas, que pode ser resolvido \n\npor qualquer m\u00e9todo de resolu\u00e7\u00e3o de equa\u00e7\u00f5es alg\u00e9bricas n\u00e3o-lineares. \n\nAs condi\u00e7\u00f5es suficientes para um m\u00ednimo local s\u00e3o: \n\nPartindo da expans\u00e3o da s\u00e9rie de Taylor para um ponto extremo x*: \n\n\u0192(x) =\u0192(x*+ ?x) = \u0192(x*) + ?\nT\n \u0192(x*).?x + \u00bd.(?x\n\nT\n). ?\n\n2\n \u0192(x*).?x + ... \n\nonde ?x \u00e9 uma perturba\u00e7\u00e3o a partir do ponto extremo: x = x* + ?x. \n\nDesprezando os termos de ordem superior da s\u00e9rie e sabendo que ?f(x*) = 0, temos: \n\n\u0192(x*+ ?x) - \u0192(x*) = \u00bd.(?x\nT\n). ?\n\n2\n \u0192(x*).?x \n\nEnt\u00e3o, para que x* seja um m\u00ednimo local forte: \n\n\u0192(x*+ ?x) - \u0192(x*) > 0, ? ?x ?  ?x\nT\n. ?\n\n2\n \u0192(x*).?x > 0  \n\nou seja, a matriz Hessiano H(x) ?  ?\n2\n \u0192(x*) deve ser positiva definida em x = x*. \n\nSe H(x) for positiva semidefinida, pode haver m\u00faltiplos m\u00ednimos, j\u00e1 que \u0192(x*+ ?x) - \n\n\u0192(x*)  ? 0. \n\nPropriedades: \n\n? H(x) \u00e9 positiva definida ? autovalores de H s\u00e3o positivos. \n\n? \u0192(x) \u00e9 estritamente convexa ? H(x) \u00e9 positiva definida ? x. \n\n? Se \u0192(x) \u00e9 estritamente convexa e possui um ponto estacion\u00e1rio, ent\u00e3o este \n\nponto \u00e9 um m\u00ednimo global. \n\nb) Problema de otimiza\u00e7\u00e3o com restri\u00e7\u00f5es de igualdade \n\nSeja o problema de otimiza\u00e7\u00e3o: \n\n  Min   \u0192(x)     \n\n  sujeito a:  hm x 1 (x) = 0 com  \u0192(x), h(x) ? C\n2\n \n\n    x ? R\nn\n  \n\nCondi\u00e7\u00f5es necess\u00e1rias para um m\u00ednimo local s\u00e3o: \n\n\n\n40 \n \n\nTeorema 3.2: se \u0192(x) possui um extremo com restri\u00e7\u00f5es em x, de modo que as \n\nequa\u00e7\u00f5es hj(x) = 0, j = 1,2,...,m s\u00e3o v\u00e1lidas, ent\u00e3o ?\u0192(x) e ?hj(x) s\u00e3o linearmente \n\ndependentes neste extremo:  ?0. ?\u0192?x? +\t? ?j. ?hj(x)\n?\n??? ,\t\tcom pelo menos um ?j n\u00e3o \n\nnulo. \n\nA figura 3.1 apresenta como exemplo uma interpreta\u00e7\u00e3o geom\u00e9trica para a \n\ndepend\u00eancia linear entre ?\u0192(x) e ?hj(x) no ponto m\u00ednimo x*. A linha pontilhada sobre \n\no cone representa a regi\u00e3o vi\u00e1vel do problema. \n\n \n\nFigura 3.1- Interpreta\u00e7\u00e3o geom\u00e9trica para a depend\u00eancia linear dos gradientes. \n\n \n Fonte: Pinto e Gut (2005). \n\n \n\nConsiderando sem perda de generalidade que ?0 = 1, ent\u00e3o ?\u0192(x) = - ? ?j. ?hj(x). \n\nNeste caso, ?\u0192(x) e ?hj(x) s\u00e3o colineares. \n\nAs seguintes condi\u00e7\u00f5es: \n\n?\u0192(x) + ? ?j. ?hj(x) = 0 \n\nhj (x) = 0 \n\ns\u00e3o na verdade as condi\u00e7\u00f5es estacion\u00e1rias da fun\u00e7\u00e3o Lagrangeano, L: \n\nL(x,?) = \u0192(x) + ? ?j. hj(x) \n\nou seja, estas condi\u00e7\u00f5es equivalem a: \n\n\n\n41 \n \n\n?L (x,?) = 0  ?  ?\n\n??\n\n??\n= ?\u0192(x)\t+\t? ?j. ?hj(x)???? \t\n\n??\n\n??\n= h?x? = 0\n\n?  \n\nEsta equa\u00e7\u00e3o constitui um sistema com n + m equa\u00e7\u00f5es e n +m inc\u00f3gnitas e sua \n\nsolu\u00e7\u00e3o fornece o extremo x* e os respectivos multiplicadores de Lagrange, ?j. \n\nA condi\u00e7\u00e3o suficiente para um m\u00ednimo local \u00e9 que, Realizando uma an\u00e1lise \n\nsemelhante ao caso anterior, temos que a matriz Hessiano do Lagrangeano H(x,?) = \n\n?\n2\nL(x,?) deve ser positiva definida em x = x*. \n\nc) Problema de Otimiza\u00e7\u00e3o com Restri\u00e7\u00f5es de Desigualdade \n\nSeja o problema de otimiza\u00e7\u00e3o: \n\n  Min   \u0192(x) \n\n  sujeito a:  gr x 1 (x) ? 0 com  \u0192(x), g(x) ? C\n2\n \n\n    x ? R\nn\n  \n\nTeorema 3.3: Se \u0192(x) possui um extremo restrito em x, de modo que gj (x) ? 0 (j = \n\n1,2,...,r) ent\u00e3o ? ?j ? 0 (j= 1,2,...,r) tal que: \n\n 1) ?0. ?\u0192(x)\t+\t? ?j. ?gj(x)\n?\n??? = 0 ? dep\u00eandencia linear dos gradientes \n\n 2) ?j.gj(x) = 0 ? condi\u00e7\u00e3o de complementaridade \n\nAs restri\u00e7\u00f5es de desigualdade podem ser classificadas como: \n\n? Ativas (fortemente)  gj(x*) = 0 ?  ?j ? 0 \n\n? Ativas (fracamente) gj(x*) = 0 ?  ?j = 0 \n\n? Inativas   gj(x*)&lt;0 ?  ?j = 0 \n\nA figura 3.2 mostra um exemplo em que g1 e g2 s\u00e3o restri\u00e7\u00f5es ativas ( ?1,  ?2 > 0) e \n\ng3 \u00e9 uma restri\u00e7\u00e3o inativa (?3 = 0). Neste caso a depend\u00eancia linear dos gradientes \u00e9 \n\nexpressa como:  \n\n?0. ?\u0192(x) +  ?1. ?g1(x) +  ?2. ?g2(x)  = 0 \n\nNota-se que o gradiente de \u0192 aponta na dire\u00e7\u00e3o de \u0192 crescente e que o gradiente de \n\ngj aponta na dire\u00e7\u00e3o de amplia\u00e7\u00e3o da regi\u00e3o vi\u00e1vel. \n\n \n\n\n\n42 \n \n\nFigura 3.2 - Interpreta\u00e7\u00e3o geom\u00e9trica para a depend\u00eancia linear dos gradientes. \n\n \n Fonte: Pinto e Gut (2005). \n\n \n\nAdmitindo ?0 = 1, temos as seguintes condi\u00e7\u00f5es: \n\n?\u0192(x) + ? ?j. ?gj(x) = 0 \n\n?j.gj (x) = 0 \n\nem que ?j ? 0 (j = 1,2,...,r) s\u00e3o os multiplicadores de Karush Kuhn-Tucker \n\nNota-se que como  ?j = 0 para as restri\u00e7\u00f5es inativas, temos condi\u00e7\u00f5es semelhantes \n\n\u00e0quelas obtidas para o problema de otimiza\u00e7\u00e3o com restri\u00e7\u00f5es de igualdade, ou \n\nseja, condi\u00e7\u00f5es estacion\u00e1rias de Lagrangeano: \n\nL(x,?) = \u0192(x) + ? ?j. gj(x) ? ?L(x,\t?) = 0 \n\nA dificuldade encontra-se na identifica\u00e7\u00e3o das restri\u00e7\u00f5es ativas e inativas. \n\nO significado de multiplicadores de Karush Kuhn-Tucker \u00e9 o seguinte:  \n\n?\u0192(x)\t+\t? ?j. ?gj(x)???? = 0 \n\nSeja uma dire\u00e7\u00e3o p, tal que: \n\n?\u0192 = p\nT\n.\t?\u0192(x) \u00e9 a varia\u00e7\u00e3o de \u0192 na dire\u00e7\u00e3o p. \n\n?gj = p\nT\n.\t?gj (x) \u00e9 a varia\u00e7\u00e3o de gj na dire\u00e7\u00e3o p. \n\nMultiplicando a equa\u00e7\u00e3o de condi\u00e7\u00e3o estacion\u00e1ria acima por p\nT\n, temos: \n\n\n\n43 \n \n\np\nT\n.\t?\u0192(x) + ? ?j. ?gj(x) = 0  ?  ?\u0192 + ? ?j.\t?gj = 0 \n\n \n\nAssumindo que ?gj (j = 1,2,...,r, com j? i), ou seja que a restri\u00e7\u00e3o gi sofre a varia\u00e7\u00e3o: \n\n?\u0192 + ? ?i.\t?gi = 0 ? ?i = - ?\n?\u0192\n\n???\n?\n?????,?? ?\n\n  \n\nPortanto, o multiplicador de Karush  Kuhn-Tucker, ?i, representa a sensibilidade da \n\nfun\u00e7\u00e3o objetivo frente a uma altera\u00e7\u00e3o na restri\u00e7\u00e3o gi(x), considerando constantes \n\ntodas as outras restri\u00e7\u00f5es. \n\n? Considere uma altera\u00e7\u00e3o invi\u00e1vel ?gi > 0 (aumento de gi e consequentemente \n\namplia\u00e7\u00e3o da regi\u00e3o vi\u00e1vel). Com ?i > 0, obtemos ?\u0192 &lt;0, ou seja, o valor da \n\nfun\u00e7\u00e3o objetivo \u00e9 reduzido (favor\u00e1vel \u00e0 minimiza\u00e7\u00e3o). \n\n? Considere uma altera\u00e7\u00e3o vi\u00e1vel ?gi &lt;0 (redu\u00e7\u00e3o de gi). Como ?i > 0, obtemos \n\n?\u0192 > 0 (aumento em \u0192). \n\nd) Otimiza\u00e7\u00e3o com restri\u00e7\u00f5es de igualdade e desigualdade \n\nSeja o problema de otimiza\u00e7\u00e3o: \n\n  Min    \u0192(x) \n\n  sujeito a:  hm x 1 (x) = 0 com  \u0192(x), h(x), g(x)  ? C\n2\n  \n\n    gr x 1 (x) ? 0  \n\n    x ? R\nn\n  \n\nA condi\u00e7\u00e3o necess\u00e1ria para um m\u00ednimo local \u00e9 satisfa\u00e7\u00e3o das condi\u00e7\u00f5es de Karush  \n\nKuhn-Tucker. Estas condi\u00e7\u00f5es equivalem \u00e0 obten\u00e7\u00e3o do ponto estacion\u00e1rio da \n\nfun\u00e7\u00e3o Lagrangeano, obtida combinando restri\u00e7\u00f5es de igualdade e desigualdade e \n\nassumindo ?0 = ?0 = 1 \n\nL(x,?,?) = \u0192(x) + ? ?j. hj(x) + ? ?j. gj(x) ? ?L( x,?,?)\t= 0 \n\n? Depend\u00eancia linear dos gradientes \n\n?\u0192?x? +\t? ?j. ?hj?x????? +\t? ?j. ?gj(x)\n?\n??? = 0 \n\n ?j : multiplicadores de Lagrange \n\n\n\n44 \n \n\n ?j : multiplicadores de Karush Kuhn-Tucker \n\n? Viabilidade das restri\u00e7\u00f5es \n\n    hj (x) = 0  1 ? j ? m \n\n    gj (x) = 0  1 ? j ? r \n\n? Condi\u00e7\u00f5es de Complementaridade \n\n    ?j. gj (x) = 0  1 ? j ? r \n\n    ?j ? 0 \n\nCondi\u00e7\u00f5es de Karush Kuhn-Tucker resultam em um sistema n\u00e3o-linear de n + m + r \n\nequa\u00e7\u00f5es e inc\u00f3gnitas. Como solu\u00e7\u00e3o obtemos um ponto estacion\u00e1rio chamado \n\nponto de Karush Kuhn-Tucker. \n\nA condi\u00e7\u00e3o suficiente para um m\u00ednimo local: \n\nO Hessiano do Lagrangeano H(x,?,?) = ?\n2\n L(x,?,?) deve ser positivo definido em x = \n\nx*. \n\nSe \u0192 (x) \u00e9 convexa e a regi\u00e3o vi\u00e1vel F \u00e9 tamb\u00e9m convexa ent\u00e3o, para um m\u00ednimo \n\nlocal x*: \n\nx* \u00e9 tamb\u00e9m um m\u00ednimo global, e, as condi\u00e7\u00f5es de otimalidade de Karush Kuhn-\n\nTucker s\u00e3o necess\u00e1rias e suficientes para o m\u00ednimo global. \n\n \n\n3.2.2. Dualidade  \n\n \n\nBaseado em Conejo et al. (2006) s\u00e3o apresentados a seguir os conceitos de \n\ndualidade, que podem ser divididos em dualidade para programa\u00e7\u00e3o linear e \n\ndualidade para programa\u00e7\u00e3o n\u00e3o-linear. \n\na) Dualidade em Programa\u00e7\u00e3o Linear \n\nDado o seguinte problema de programa\u00e7\u00e3o linear em que a vari\u00e1vel de decis\u00e3o \u00e9 x: \n\n  Min   z = c\nT\n.x   (3.1) \n\n  Sujeito a: \n\n \n\n\n\n45 \n \n\n    A.x ? b   (3.2) \n\n    x ? 0 \n\ntem-se o seguinte problema dual: \n\n  Max   z = b\nT\n.y   (3.3) \n\n  Sujeito a: \n\n    A\nT\n.y ? c   (3.4) \n\n    y ? 0 \n\nem que y = (y1, y2,..., ym)\nT\n s\u00e3o chamadas de vari\u00e1veis duais. \n\nPodemos identificar o primeiro problema como o problema primal, e o segundo como \n\nsua contraparte dual. Nota-se que os mesmos elementos (a matriz A, e os vetores b \n\ne c) determinam ambos problemas. No entanto, o problema primal n\u00e3o est\u00e1 no \n\nformato padr\u00e3o, mas este formato nos permite ver mais claramente a simetria entre \n\no problema primal e seu correspondente problema dual como mostra o seguinte \n\nteorema: \n\nTeorema 3.4: A dualidade tem uma rela\u00e7\u00e3o sim\u00e9trica com o problema primal, se o \n\nproblema D \u00e9 o problema dual de P, ent\u00e3o P tamb\u00e9m \u00e9 o dual de D. \n\nComo se pode observar, cada restri\u00e7\u00e3o do problema primal tem vari\u00e1veis duais \n\nassociadas com ele, os coeficientes da fun\u00e7\u00e3o objetivo do problema primal s\u00e3o os \n\ntermos do segundo membro das restri\u00e7\u00f5es do problema dual e vice-versa, e a matriz \n\nde coeficientes das restri\u00e7\u00f5es do problema dual \u00e9 a transposta da matriz de \n\nrestri\u00e7\u00f5es do problema primal. O problema primal \u00e9 de minimiza\u00e7\u00e3o, mas seu dual \u00e9 \n\num problema de maximiza\u00e7\u00e3o. \n\nPara obter um problema dual a partir de um problema primal em sua forma padr\u00e3o, \u00e9 \n\nusada a defini\u00e7\u00e3o de dualidade para o seguinte teorema: \n\nTeorema 3.5: O problema primal na forma padr\u00e3o  \n\n  Min  z = c\nT\n.x   (3.5) \n\n  Sujeito a: \n\n    A.x = b   (3.6) \n\n    x ? 0  \n\ntem o seguinte problema dual: \n\n\n\n46 \n \n\n  Max   z = b\nT\n.y \n\n  sujeito a: \n\n    A\nT\n.y ? c \n\n    y ? 0 \n\nA import\u00e2ncia da rela\u00e7\u00e3o primal-dual \u00e9 estabelecida nos teoremas que se seguem. \n\nLema 3.1 (Lema de dualidade fraca). Seja P o problema de programa\u00e7\u00e3o linear \n\neq.(3.1) - (3.2), e D dual eq.(3.3) - (3.4). Seja x uma solu\u00e7\u00e3o vi\u00e1vel de P e y uma \n\nsolu\u00e7\u00e3o vi\u00e1vel de D. Portanto \n\nb\nT\n.y ? c\n\nT\n.x (3.7) \n\nCorol\u00e1rio 3.1. Seja b\nT\n.y = c\n\nT\n. x para alguns vetores particulares x\te y, vi\u00e1vel para P e \n\nD, respectivamente, ent\u00e3o as solu\u00e7\u00f5es \u00f3timas dos problemas duais e primais s\u00e3o y \n\ne x, respectivamente. Al\u00e9m disso, se x \u00e9 uma solu\u00e7\u00e3o \u00f3tima para o problema primal, \n\nent\u00e3o, existe uma solu\u00e7\u00e3o \u00f3tima y para o problema dual, e o valor da fun\u00e7\u00e3o objetivo \n\n\u00f3tima de ambos os problemas coincide com o valor comum b\nT\n. y = c\n\nT\n. x. Caso \n\ncontr\u00e1rio, um ou ambos os conjuntos de solu\u00e7\u00f5es vi\u00e1veis est\u00e3o vazios.  \n\nO Corol\u00e1rio 3.1 afirma que ambos problemas, o primal P e o dual D, admitem \n\nsolu\u00e7\u00f5es \u00f3timas simultaneamente.  \n\nEm resumo, uma das duas declara\u00e7\u00f5es seguintes \u00e9 afirmativa: \n\n? Ambos os problemas t\u00eam solu\u00e7\u00e3o \u00f3tima e seus valores \u00f3timos coincidem.  \n\n? Um problema n\u00e3o tem limites para o \u00f3timo e o outro tem uma regi\u00e3o vi\u00e1vel \n\nvazia. \n\nEm geral, as vari\u00e1veis duais (multiplicadores de Lagrange) est\u00e3o associados ao \n\npre\u00e7o sombra de uma restri\u00e7\u00e3o, j\u00e1 que mostram a altera\u00e7\u00e3o do valor \u00f3timo da fun\u00e7\u00e3o \n\nobjetivo por unidade de mudan\u00e7a no valor do lado direito da restri\u00e7\u00e3o, assumindo \n\nque todos os outros valores de par\u00e2metros do problema permanecem inalterados. \n\nPara muitas aplica\u00e7\u00f5es de programa\u00e7\u00e3o linear os pre\u00e7os sombra s\u00e3o, pelo menos, \n\nt\u00e3o importantes quanto \u00e0 solu\u00e7\u00e3o do problema em si; eles indicam se certas \n\nmudan\u00e7as no uso das capacidades produtivas podem afetar o valor da fun\u00e7\u00e3o \n\nobjetivo. Os pre\u00e7os sombra podem ser obtidos diretamente a partir da solu\u00e7\u00e3o do \n\nproblema primal ou determinada pela formula\u00e7\u00e3o e resolu\u00e7\u00e3o do problema dual. \n\n\n\n47 \n \n\nb) Dualidade em programa\u00e7\u00e3o n\u00e3o-linear \n\nNesta se\u00e7\u00e3o os resultados obtidos para os problemas de programa\u00e7\u00e3o linear s\u00e3o \n\ngeneralizados para problemas de programa\u00e7\u00e3o n\u00e3o-linear. Considere o seguinte \n\nproblema geral primal n\u00e3o-linear: \n\n  Minx   zP = f (x)  (3.8) \n\n  Sujeito a: \n\n    h(x) = 0  (3.9) \n\n    g(x) ? 0 \n\nem que f: R\nn\n ? R, h: R\n\nn\n ? R\n\nl\n, g: R\n\nn\n ? R\n\nm\n \n\nO problema dual requer a introdu\u00e7\u00e3o da fun\u00e7\u00e3o dual definida como: \n\n? (?,?) = Infx { f(x) + ?\nT\n.h(x) + ?\n\nT\n.g(x)}  (3.10) \n\nem que ?*, ?* s\u00e3o os multiplicadores associados com as restri\u00e7\u00f5es de igualdade e \n\ndesigualdade para a solu\u00e7\u00e3o \u00f3tima do problema x* eq.(3.8) - (3.9).  \n\nO problema dual do problema primal eq.(3.8) - (3.9) \u00e9 ent\u00e3o definido como se segue: \n\n  Max ?,?   zD = ? (?,?)  (3.11) \n\n  Sujeito a: \n\n     ? ? 0   (3.12) \n\nUsando a fun\u00e7\u00e3o Lagrangeana \n\n L(x, ?, ?) = f(x) + ?\nT\n.h(x) + ?\n\nT\n.g(x)    (3.13) \n\npode-se reescrever o problema dual como: \n\n  Max ?,?; ? ? 0    [Infx  L(x, ?, ?)]    (3.14) \n\nUm exemplo da aplica\u00e7\u00e3o do uso da fun\u00e7\u00e3o Lagrangeana no problema dual pode \n\nser encontrada em Conejo et al. (2006). \n\nObserva\u00e7\u00e3o: assumimos que f, h, e g s\u00e3o tais que o \u00ednfimo da fun\u00e7\u00e3o Lagrangeano \u00e9 \n\nsempre alcan\u00e7ado em algum x, de maneira que a opera\u00e7\u00e3o de \"\u00ednfimo\" nos \n\nproblemas eq.(3.10) e (3.14) pode ser substitu\u00edda pela opera\u00e7\u00e3o de \"m\u00ednimo\". Ent\u00e3o, \n\no problema eq.(3.14) \u00e9 referido como o problema dual max-min. Nesta situa\u00e7\u00e3o, \n\n\n\n48 \n \n\ndenotamos por x (?, ?) um ponto em que o m\u00ednimo dos Lagrangeanos \u00e9 atingido \n\n(considerado como uma fun\u00e7\u00e3o dos multiplicadores), podemos escrever \n\n? (?,?) =  f(x(?,?)) + ?\nT\n.h(x(?,?)) + ?\n\nT\n.g(x(?,?)) \n\nPor outro lado, sobre a hip\u00f3tese de convexidade de f e g, a fun\u00e7\u00e3o Lagrangeana \u00e9 \n\nconvexa em x, e, portanto, no m\u00ednimo o seu gradiente deve desaparecer \n\n?? (?,?) =  ?f(x(?,?)) + ?\nT\n.\t?h(x(?,?)) + ?\n\nT\n.\t?g(x(?,?)) = 0  (3.15) \n\nA \u00faltima identidade pode ser utilizada para derivar uma express\u00e3o para o gradiente \n\nda fun\u00e7\u00e3o dual, bem como para seu Hessiano. Mais explicitamente, de acordo com a \n\nregra da cadeia \n\n??? (?,?) =  [?f(x(?,?)) + ?\nT\n.\t?h(x(?,?)) + ?\n\nT\n.\t?g(x(?,?))]\n\nT\n . ??x (?,?) + g(x (?,?))  (3.16) \n\ne pela condi\u00e7\u00e3o eq.(3.15) \n\n     ?? (?,?) =  g(x (?,?))  (3.17) \n\n\u00c9 preciso tomar cuidado no uso da express\u00e3o eq.(3.17) por causa da \n\ndescontinuidade de express\u00e3o eq.(3.16) em rela\u00e7\u00e3o a ?. No entanto, isto n\u00e3o \u00e9 um \n\nproblema na pr\u00e1tica. \n\nDo mesmo modo, obt\u00e9m-se \n\n    ?? (?,?) =  h(x (?,?))    (3.18) \n\nNote-se que a gradiente da fun\u00e7\u00e3o dual \u00e9 o vetor de desajustes das restri\u00e7\u00f5es \n\ncorrespondentes.  \n\nEm rela\u00e7\u00e3o ao Hessiano, note que por condi\u00e7\u00f5es diferenci\u00e1veis eq.(3.17) e (3.18) \n\ncom respeito \u00e0 ? e ?, respectivamente, obtemos \n\n??\n2\n ?(?,?) = ?xg(x(?,?)) ??x(?,?) \n\ne \n\n??\n2\n ?(?,?) = ?xh(x(?,?)) ??x(?,?) \n\nPara obter uma express\u00e3o para ?? x (?, ?) e ?? x (?, ?), derivamos a express\u00e3o \n\n(3.15) em rela\u00e7\u00e3o \u00e0 ? e ?, respectivamente. Os resultados s\u00e3o \n\n\n\n49 \n \n\n?x\n2\n L(x(?,?), ?,?)  ?? x(?,?) + ?x g(x(?,?)) = 0 \n\ne uma equa\u00e7\u00e3o semelhante trocando ? por ? e h por g, isto \u00e9, \n\n?x\n2\n L(x(?,?), ?,?)  ?? x(?,?) + ?x h(x(?,?)) = 0 \n\nSubstituindo estas equa\u00e7\u00f5es em (4,69) e (4,70), respectivamente, obt\u00e9m-se \n\n??\n2\n ?(?,?) = - ?x g(x(?,?)) [?x\n\n2\n L(x(?, ?), ?, ?]\n\n-1\n ?x g(x(?,?))  \n\ne de igual forma para ??\n2\n ?(?,?) tem-se \n\n ??\n2\n ?(?,?) = - ?x h(x(?,?)) [?x\n\n2\n L(x(?, ?), ?, ?]\n\n-1\n ?x h(x(?,?)) \n\nFinalmente, se estamos interessados nas segundas derivadas parciais mistas    ? ? ?\n2\n \n\n?(?,?). \n\nC\u00e1lculos semelhantes conduzem a \n\n? ? ?\n2\n ?(?,?) = - ?x g(x(?,?)) [?x\n\n2\n L(x(?, ?), ?, ?]\n\n-1\n ?x h(x(?,?)) \n\ne similarmente \n\n? ? ?\n2\n ?(?,?) = - ?x h(x(?,?)) [?x\n\n2\n L(x(?, ?), ?, ?]\n\n-1\n ?x g(x(?,?)) \n\nO que mostra que a defini\u00e7\u00e3o de um problema dual na programa\u00e7\u00e3o n\u00e3o-linear \u00e9 \n\nequivalente \u00e0 defini\u00e7\u00e3o de dualidade apresentada para problemas de programa\u00e7\u00e3o \n\nlinear. \n\nAssim, qualquer valor da fun\u00e7\u00e3o objetivo do problema dual \u00e9 um limite inferior do \n\nvalor \u00f3timo da fun\u00e7\u00e3o objetivo do problema primal. Isto pode ser utilizado para \n\nterminar c\u00e1lculos em um algoritmo iterativo em que estes valores est\u00e3o dispon\u00edveis, \n\ncomo mostra o teorema de dualidade fraco explicado a seguir. \n\nTeorema 3.6: Dualidade fraca. \n\nPara qualquer solu\u00e7\u00e3o x vi\u00e1vel do problema primal eq.(3.8) - (3.9) e para qualquer \n\nsolu\u00e7\u00e3o vi\u00e1vel, ?, ?, do problema dual eq.(3.11) - (3.12), vale a seguinte rela\u00e7\u00e3o: \n\n    f(x) ? ?(?, ?)     (3.19) \n\n\n\n50 \n \n\nSe as regi\u00f5es vi\u00e1veis de ambos os problemas, primal e dual, s\u00e3o n\u00e3o vazias, a \n\nexpress\u00e3o eq.(3.19) implica que supremo (?) e o \u00ednfimo (f), ambos, sobre suas \n\nrespectivas restri\u00e7\u00f5es, s\u00e3o finitos. Certamente, nem o supremo nem o \u00ednfimo \n\nprecisam ser atingidos em qualquer ponto vi\u00e1vel. Se o resultado gerado da \n\nexpress\u00e3o eq.(3.19), tanto o primal quanto o dual s\u00e3o vi\u00e1veis, ent\u00e3o, ambos t\u00eam \n\nsolu\u00e7\u00f5es \u00f3timas.  \n\nCorol\u00e1rio 3.2 Otimalidade no problema primal e dual. \n\na) A seguinte rela\u00e7\u00e3o sempre \u00e9 mantida: \n\nsup {??(?,?)|? ? 0} ? inf {??(x|h(x) =0, g(x) ? 0}  (3.20) \n\nb) Se f (x*) = ? (?*, ?*) para alguma solu\u00e7\u00e3o vi\u00e1vel x* do problema primal eq.(3.8)-\n\n(3.9) e para algumas solu\u00e7\u00f5es vi\u00e1veis (?*, ?*) do problema dual eq.(3.11)-(3.12), \n\nent\u00e3o x* e (?*, ?*) s\u00e3o as solu\u00e7\u00f5es \u00f3timas dos problemas primal e dual, \n\nrespectivamente. Esta solu\u00e7\u00e3o define um ponto de sela do Lagrangeano \n\ncorrespondente a um m\u00e1ximo com rela\u00e7\u00e3o a ? e ? e um m\u00ednimo em rela\u00e7\u00e3o a x. \n\nc) Se sup{ ?(?, ?) : ? ? 0} = +\t?  , ent\u00e3o, o problema prima n\u00e3o tem uma solu\u00e7\u00e3o \n\nvi\u00e1vel. \n\nd) se inf{ f(x) : h(x) = 0, g(x) ? 0} = - ? , ent\u00e3o, ?(?, ?) = - ?  para todo ? ? R\nl\n e ? ? 0. \n\nA prova para este corol\u00e1rio pode ser encontrada em Bazaraa et al. (1993).  \n\nSe o resultado gerado na eq.(3.19), n\u00e3o \u00e9 de igualdade, ent\u00e3o acontece um gap da \n\ndualidade, esse gap \u00e9 de muito interesse para o estudo das t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o para problemas de otimiza\u00e7\u00e3o.  \n\nA diferen\u00e7a: \n\n   sup{ ?(?, ?) : ? ? 0} - inf{ f(x) : h(x) = 0, g(x) ? 0} \n\n\u00e9 definida como gap da dualidade dos problemas primal eq.(3.8) - (3.9) e dual \n\neq.(3.11) - (3.12) \n\nSe um vetor multiplicador resolve o problema dual e n\u00e3o gera um gap da dualidade, \n\nou seja, se a rela\u00e7\u00e3o eq.(3.20) \u00e9 estritamente satisfeita, ent\u00e3o as solu\u00e7\u00f5es do \n\nLagrangeano associado a este vetor multiplicador s\u00e3o solu\u00e7\u00f5es \u00f3timas do problema \n\n\n\n51 \n \n\nprimal. Esse resultado apresenta uma maneira de resolver o problema primal por \n\nmeio da resolu\u00e7\u00e3o do problema dual. O resultado principal consiste em obter \n\ncondi\u00e7\u00f5es que garantam a inexist\u00eancia de um gap da dualidade. \n\nTeorema 3.7: Teorema de Dualidade para problemas convexos \n\nConsidere um problema de programa\u00e7\u00e3o matem\u00e1tica convexa como eq.(3.8) - (3.9). \n\nSe x* \u00e9 a solu\u00e7\u00e3o do problema primal, ent\u00e3o, o vetor associado dos multiplicadores \u00e9 \n\n(?*, ?*) que s\u00e3o solu\u00e7\u00e3o do problema dual, e (?*)\nT\ng(x*) = 0. Por outro lado, se (?*, ?*) \n\n\u00e9 solu\u00e7\u00e3o do problema dual, existe uma solu\u00e7\u00e3o, x*, do Lagrangeano associada com \n\neste vetor de multiplicadores tal que (?*)\nT\ng (x*) = 0, ent\u00e3o x* \u00e9 uma solu\u00e7\u00e3o \u00f3tima do \n\nproblema primal. \n\n \n\n3.3. DECOMPOSI\u00c7\u00c3O LAGRANGEANA \n\n \n\nComo j\u00e1 foram mencionadas anteriormente, as t\u00e9cnicas de decomposi\u00e7\u00e3o baseiam-\n\nse em algoritmos iterativos para que os problemas de otimiza\u00e7\u00e3o possam ser \n\nrelaxados (considerando conceitos de otimalidade) e resolvidos separadamente, \n\natualizando os multiplicadores de Lagrange (considerando conceitos de dualidade), \n\na partir de um problema mestre.  \n\nPara fins econ\u00f4micos, os multiplicadores de Lagrange representariam os pre\u00e7os \n\nsombra dos produtos intermedi\u00e1rios e assim, poderia ser otimizada uma divis\u00e3o de \n\numa refinaria buscando gerar o maior lucro para toda a refinaria. \n\nO problema de otimiza\u00e7\u00e3o deve ter a seguinte estrutura para ser decomposto: \n\n  Minx           f(x)     (3.21) \n\n  sujeito a: \n\n    a(x) = 0    (3.22) \n\n    b(x) ? 0     \n\n    c(x) = 0     \n\n    d(x) ? 0     \n\nem que f(x) : R\nn\n ? R, a(x): R\n\nn ? \nR\n\nna\n, b(x): R\n\nn\n ? R\n\nnb\n, c(x): R\n\nn\n  ? R\n\nnc\n, d(x): R\n\nn\n ? R\n\nnd\n, \n\ne na, nb, nc e nd s\u00e3o escalares e vamos supor que as restri\u00e7\u00f5es complicadoras s\u00e3o \n\nc(x) = 0 e d(x) ? 0. Se relaxarmos as restri\u00e7\u00f5es complicadoras, a resolu\u00e7\u00e3o do \n\n\n\n52 \n \n\nproblema \u00e9 simplificada drasticamente. A fun\u00e7\u00e3o Lagrangeana do problema de \n\notimiza\u00e7\u00e3o \u00e9 definida como: \n\n   L(x, ?, ?) = \u0192(x) + ?\nT\n .c(x) + ?\n\nT\n.d(x)   (3.23) \n\nem que ? e ? s\u00e3o os vetores dos multiplicadores de Lagrange e as restri\u00e7\u00f5es \n\ncomplicadoras c(x) e d(x) s\u00e3o relaxadas. Sob a  hip\u00f3tese de regularidade e \n\nconvexidade, a fun\u00e7\u00e3o dual \u00e9 definida como: \n\n   ?(?, ?) = Minx L(x, ?, ?) \n\n   sujeito a: \n\n     a(x) = 0  \n\n     b(x) ? 0 \n\nA fun\u00e7\u00e3o dual \u00e9 c\u00f4ncava e em geral n\u00e3o diferenci\u00e1vel. Este \u00e9 um fato fundamental \n\npara ser explorado nos algoritmos de resolu\u00e7\u00e3o de problemas explicados mais para \n\nfrente. \n\nO problema dual \u00e9 definido como: \n\n  Max ?, ? ?(?, ?) \n\n  sujeito a: \n\n    ? ? 0  \n\nA decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana \u00e9 um procedimento atrativo quando a \n\nfun\u00e7\u00e3o dual \u00e9 facilmente avaliada para determinados valores ?,? dos vetores dos \n\nmultiplicadores ?, ?, respectivamente. Em outras palavras, \u00e9 chamado f\u00e1cil de \n\nresolver se o problema primal \u00e9 relaxado fornecendo os valores de ?\te\t?. Ent\u00e3o o \n\nproblema fica da seguinte forma: \n\n  Minx  L(x, ?\t,?) \n\n  sujeito a: \n\n    a(x) = 0  \n\n    b(x) ? 0 \n\nque pode ser decomposto em subproblemas: \n\n  Min??; i=1,...,n ? L\n?\n???  (xi, ?,\t,?)  \n\n  sujeito a: \n\n\n\n53 \n \n\n    ai (xi) = 0;  i=1,...,n  \n\n    bi (xi) ? 0;  i=1,...,n \n\nA decomposi\u00e7\u00e3o facilita a resolu\u00e7\u00e3o deste problema e normalmente permite que \n\nsejam realizadas interpreta\u00e7\u00f5es f\u00edsicas e econ\u00f4micas. O problema \u00e9 denominado \n\nprimal decomposto. Ent\u00e3o, obt\u00e9m-se n subproblemas que podem ser resolvidos em \n\nparalelo. Sob hip\u00f3teses de convexidade, o teorema da dualidade diz que: \n\n\u0192(x*) = ? (?*, ?*) \n\nem que x* \u00e9 a solu\u00e7\u00e3o da minimiza\u00e7\u00e3o do problema primal e (?*, ?*) \u00e9 a solu\u00e7\u00e3o da \n\nmaximiza\u00e7\u00e3o do problema dual. \n\nNum caso n\u00e3o convexo, dada uma solu\u00e7\u00e3o vi\u00e1vel para o problema primal, x, e uma \n\nsolu\u00e7\u00e3o vi\u00e1vel para o problema dual, (?, ?), a dualidade fraca implica que: \n\n\u0192(x*) ? ? (?*, ?*) \n\nNo caso convexo, a solu\u00e7\u00e3o do problema dual fornece a solu\u00e7\u00e3o do problema primal. \n\nNo caso n\u00e3o convexo, o valor da fun\u00e7\u00e3o objetivo na solu\u00e7\u00e3o \u00f3tima do problema dual \n\nfornece o limite inferior do valor da fun\u00e7\u00e3o objetivo na solu\u00e7\u00e3o do problema primal. A \n\ndiferen\u00e7a entre os valores \u00f3timos da fun\u00e7\u00e3o objetivo do problema primal e dual \u00e9 \n\nchamada de gap da dualidade como explicado anteriormente. Um exemplo ilustrativo \n\npode ser encontrado em Conejo et al. (2006).  \n\nO algoritmo de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o de processos por \n\ndecomposi\u00e7\u00e3o Lagrangeana \u00e9 apresentado \u00e0 continua\u00e7\u00e3o: \n\nPasso 0: Inicializa\u00e7\u00e3o \n\nConsiderando um problema de minimiza\u00e7\u00e3o, o algoritmo inicia dando um valor para \n\no contador de itera\u00e7\u00f5es v: \n\nv = 1 \n\nTamb\u00e9m t\u00eam que ser fornecidos os valores iniciais dos multiplicadores (?\n0\n,?\n\n0\n) para a \n\nprimeira itera\u00e7\u00e3o como mostrado a seguir:   \n\n?\n(v)\n\n = ?\n0\n e ?\n\n(v)\n = ?\n\n0\n \n\n\u00c9 importante fornecer ?, uma diferen\u00e7a aceit\u00e1vel entre os valores dos multiplicadores \n\nde itera\u00e7\u00f5es consecutivas para o crit\u00e9rio de converg\u00eancia do algoritmo. \n\n\n\n54 \n \n\nPasso 1: Solu\u00e7\u00e3o do problema primal relaxado \n\nResolver os n subproblemas gerados a partir da relaxa\u00e7\u00e3o das vari\u00e1veis \n\ncomplicadoras do problema primal, para i=1,...,n \n\n  Min??   L (x?\n(?)\n\n,?\n(v)\n\n, ?\n(v)\n\n) \n\n  sujeito a: \n\n    ai (xi) = 0;   \n\n    bi (xi) ? 0;   \n\nPasso 2: Atualiza\u00e7\u00e3o dos multiplicadores  \n\nPara atualizar os multiplicadores podem-se utilizar um dos seguintes procedimentos, \n\nque s\u00e3o resolvidos desde um problema mestre, fora dos modelos dos subproblemas \n\ne que na verdade, coordena os subproblemas para que se possa atingir o \u00f3timo do \n\nproblema primal, esses procedimentos, listados a seguir, ser\u00e3o desenvolvidos na \n\npr\u00f3xima subse\u00e7\u00e3o: \n\na) M\u00e9todo do subgradiente. \n\nb) Cutting Plane Method. \n\nc) Bundle Method. \n\nd) Trust Region Method. \n\nPasso 3: Crit\u00e9rio de converg\u00eancia \n\nO crit\u00e9rio de parada do algoritmo tem que satisfazer as seguintes equa\u00e7\u00f5es: \n\n   ??(?? ?) ? ??(?)?? ? \t?   e ??(?? ?) ? ??(?)??\t? \t?   \n\nem que ? \u00e9 definido no passo 0. Se essas equa\u00e7\u00f5es s\u00e3o respeitadas, ent\u00e3o o \n\nalgoritmo tem que parar, a solu\u00e7\u00e3o \u00f3tima foi encontrada e ent\u00e3o x* = x\n(v)\n\n. Caso \n\ncontr\u00e1rio, o algoritmo deve continuar v ? v +1 e retorna-se para o passo 1. Para \n\nilustrar o algoritmo de solu\u00e7\u00e3o de problemas por decomposi\u00e7\u00e3o Lagrangeana, na \n\nfigura 3.3 \u00e9 apresentado um fluxograma com os passos do algoritmo explicado \n\nanteriormente. \n\nA diferen\u00e7a entre o valor da fun\u00e7\u00e3o objetivo do problema primal (minimiza\u00e7\u00e3o) \u00e9 o \n\nvalor da fun\u00e7\u00e3o objetivo do problema dual (maximiza\u00e7\u00e3o) \u00e9 chamada de gap da \n\ndualidade. Uma vez que a solu\u00e7\u00e3o do problema dual \u00e9 alcan\u00e7ada, a solu\u00e7\u00e3o \n\nassociada ao problema primal poderia n\u00e3o ser vi\u00e1vel e, portanto, s\u00e3o necess\u00e1rios \n\nprocedimentos de viabilidade. O procedimento utilizado para encontrar uma poss\u00edvel  \n\n\n\n55 \n \n\nFigura 3.3 - Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo m\u00e9todo de decomposi\u00e7\u00e3o \nLagrangeana. \n \n \n \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria baseada em Conejo et al. (2006). \n\n \n\nsolu\u00e7\u00e3o quase \u00f3tima do primal altera ligeiramente os valores obtidos dos \n\nmultiplicadores num problema mestre para alcan\u00e7ar a viabilidade do problema \n\nprimal. Procedimentos de subgradientes s\u00e3o geralmente utilizados (Zhuang e \n\nGaliana, 1988). Em muitos problemas pr\u00e1ticos, o m\u00e9todo dos subgradientes \u00e9 eficaz \n\npara alcan\u00e7ar viabilidade em algumas poucas itera\u00e7\u00f5es e sem alterar \n\nsignificativamente o valor da fun\u00e7\u00e3o objetivo do problema dual de maximiza\u00e7\u00e3o. \n\n \n\n3.3.1. Atualiza\u00e7\u00e3o do Multiplicador de Lagrange \n\n \n\nMuitos procedimentos para atualizar o multiplicador s\u00e3o apresentados e comparados \n\nna literatura, nesta se\u00e7\u00e3o, v\u00e3o ser apresentados os mais destacados e utilizados. \n\nsim n\u00e3o \n\nPasso 0: Inicializa\u00e7\u00e3o \n\nv = 1; ?(v) = ?(0); ?(v) = ?(0); \n\na; b; ? \n\n \n\nPasso 1: Resolu\u00e7\u00e3o dos n subproblemas, com i = 1,...,n. \n\nmin??  L (xi\n(v),?(v), ?(v))  \n\nsujeito a: \n ai (xi) = 0;   \n bi (xi) ? 0; \n \n\nPasso 2: Atualizar os \n\nmultiplicadores, de  ?(v), ?(v) \n\npara ?\n(v+1)\n\n, ?\n(v+1)\n\n. \n\nProblema mestre: M\u00e9todos: \n\nSubgradient Method; Cutting Plane \n\nMethod; Bundle Method; Trust \n\nRegion Method. \n\nPasso 3: Crit\u00e9rio de Converg\u00eancia: \n\n??(?? ?) ? ??(?)?? ? \t?   e ??(?? ?) ? ??(?)??\t? \t? \n\nSolu\u00e7\u00e3o encontrada: \n\nxi* = x1\n(v) v ? v + 1\n\n \n\n\n\n56 \n \n\nDaqui para frente, para facilitar a nota\u00e7\u00e3o, os vetores dos multiplicadores ? e ? s\u00e3o \n\nrenomeados como ? = (?, ?). \n\nO vetor coluna das restri\u00e7\u00f5es complicadoras c(x\n(v)\n\n) e d(x\n(v)\n\n) na itera\u00e7\u00e3o v, constitui \n\num subgradiente da fun\u00e7\u00e3o dual (Bazaraa et al. 1993) como mostra-se a seguir: \n\ns\n(v)\n\n =  [c(x\n(v)\n\n), d(x\n(v)\n\n)] \n\nMais detalhes sobre o m\u00e9todo de subgradiente pode ser encontrados em Conejo et \n\nal. (2006). \n\n \n\n3.3.1.1. M\u00e9todo do Subgradiente \n\n \n\nO vetor do multiplicador \u00e9 atualizado de acordo com: \n\n?(v+1) = ?(v) + K(v) \n?(?)\n\n???(?)??\n \n\nem que \n\nlim\n?? ?\n\nK(?) ? 0 \n\ne \n\n? K(?) ? ?\n\n?\n\n???\n\n \n\nUma sele\u00e7\u00e3o t\u00edpica que satisfaz os requisitos anteriores \u00e9: \n\nK\n(v)\n\n = \n?\n\n?? ?.?\n \n\nem que a e b s\u00e3o escalares. Em outras palavras, K define o passo de atualiza\u00e7\u00e3o \n\ndos multiplicadores, seja incrementando ou diminuindo o valor dos multiplicadores \n\nde uma seguinte itera\u00e7\u00e3o, isso dependendo do sinal do subgradiente (s). \n\nNormalmente os valores dos par\u00e2metros a e b s\u00e3o constantes, na literatura podem \n\nser encontrados diferentes crit\u00e9rios para a assina\u00e7\u00e3o destes valores (Polyak, 1987). \n\nO m\u00e9todo do subgradiente \u00e9 simples de implementar e tem um gasto computacional \n\npequeno. No entanto, o progresso deste \u00e9 lento para chegar ao \u00f3timo, devido \u00e0 \n\n\n\n57 \n \n\noscila\u00e7\u00f5es nas atualiza\u00e7\u00f5es. Isto \u00e9 uma consequ\u00eancia da n\u00e3o-diferenciabilidade da \n\nfun\u00e7\u00e3o dual. Al\u00e9m disso, o comportamento oscilat\u00f3rio faz com que seja muito dif\u00edcil \n\nelaborar um apropriado crit\u00e9rio de parada do algoritmo.  Normalmente o crit\u00e9rio de \n\nparada tamb\u00e9m pode ser feito de acordo a um n\u00famero especifico de itera\u00e7\u00f5es. \n\nExemplos ilustrativos podem ser encontrados em Conejo et al. (2006) e Guignard \n\n(2003). \n\n \n\n3.3.1.2. Cutting Plane Method \n\n \n\nA atualiza\u00e7\u00e3o do vetor do multiplicador \u00e9 obtida pela resolu\u00e7\u00e3o de um problema de \n\nprograma\u00e7\u00e3o linear como se mostra a seguir: \n\n  Max z, ? ? C   z \n\n  sujeito a: \n\n     z ? ?\n(k)\n\n + s(?)\n?\n ( ? - ?\n\n(k)\n);  k= 1,...,v, \n\nem que C \u00e9 um conjunto convexo e compacto. Este \u00e9 composto pelas faixas de \n\nvaria\u00e7\u00e3o dos multiplicadores C = {?, ?dow ? ? ? ?\nup\n\n}. Deve ser notado que as \n\nrestri\u00e7\u00f5es do problema linear mostrado acima, representam os semi-espa\u00e7os no \n\nespa\u00e7o do multiplicados. Valores ?dow e ?\nup\n\n s\u00e3o, em geral, f\u00e1ceis de ser obtidos das \n\npropriedades f\u00edsicas ou econ\u00f4micas do sistema que \u00e9 modelado. \n\nO n\u00famero de restri\u00e7\u00f5es do problema de otimiza\u00e7\u00e3o linear para atualizar o \n\nmultiplicador cresce \u00e0 medida que se aumenta o n\u00famero de itera\u00e7\u00f5es, isto faz que \n\ntenham um elevado custo computacional. O crit\u00e9rio de parada deste algoritmo \u00e9 \n\nquando a norma da diferen\u00e7a entre o vetor multiplicador de duas itera\u00e7\u00f5es \n\nsucessivas \u00e9 inferior a um limite pr\u00e9-determinado. Mais detalhes deste m\u00e9todo \n\npodem ser encontrados em Conejo et al. (2006) e Guignard (2003). \n\n \n\n3.3.1.3. Bundle Method \n\n \n\nA atualiza\u00e7\u00e3o do vetor do multiplicador \u00e9 obtida resolvendo o problema de \n\nprograma\u00e7\u00e3o dual quadr\u00e1tico relaxado mostrado a seguir: \n\n \n\n\n\n58 \n \n\n  Max z, ? ? C  z - ?\n(v)\n\n ??? ? \t?(?)??\n2\n \n\n  sujeito a: \n\n     z ? ?\n(k)\n\n + ?(?)\n?\n (? - ?\n\n(k)\n)   k=1,...,v, \n\nEm que ? \u00e9 um par\u00e2metro de penalidade, ??. ?? \u00e9 a norma-2 e ?, \"o centro de \n\ngravidade\", \u00e9 um vetor do multiplicador centralizado na regi\u00e3o vi\u00e1vel, de modo que \n\nas oscila\u00e7\u00f5es sejam evitadas. Deve-se notar que o n\u00famero de restri\u00e7\u00f5es do \n\nproblema de otimiza\u00e7\u00e3o deste m\u00e9todo cresce com o numero de itera\u00e7\u00f5es. \n\nO centro de gravidade \u00e9 atualizado em cada itera\u00e7\u00e3o da seguinte forma: \n\nse     ? (?\n(v)\n\n) - ? (?\n(v-1)\n\n) ? m.?\n(v-1)\n\n \n\nent\u00e3o     ?\n(v)\n\n = ? \n(v)\n\n \n\nse n\u00e3o    ?\n(v)\n\n = ?\n(v-1)\n\n \n\nem que m \u00e9 um par\u00e2metro com um valor que est\u00e1 entre 0 e 1, e ?\n(v)\n\n \u00e9 o crescimento \n\nnominal que representa  a diferen\u00e7a entre o valor da fun\u00e7\u00e3o objetivo do problema \n\ndual relaxado na itera\u00e7\u00e3o (v) e o valor da fun\u00e7\u00e3o objetivo do problema dual nessa \n\nmesma itera\u00e7\u00e3o. Este valor pode ser calculado da seguinte forma: \n\n    ?\n(v)\n\n = z\n(v)\n\n - ?\n(v)\n\n ???\n(?)\n\n? ?(?)??\n2\n - ?(?\n\n(v)\n) \n\nSe v = 1, o valor do centro de gravidade \u00e9 considerado como o valor inicial do vetor \n\ndo multiplicador, ?\n(0)\n\n. \n\nO Bundle method \u00e9 um m\u00e9todo plano cortante, em que o procedimento de subida \u00e9 \n\nlimitado por uma penalidade na fun\u00e7\u00e3o objetivo. A meta \u00e9 centralizar o m\u00e9todo de \n\nplano cortante na regi\u00e3o de interesse. No entanto, a fim de centrar o m\u00e9todo na \n\nregi\u00e3o de interesse, \u00e9 necess\u00e1rio tomar cuidado com a penalidade e outros \n\npar\u00e2metros. O crit\u00e9rio de parada \u00e9 quando a diferen\u00e7a entre duas itera\u00e7\u00f5es \n\nsucessivas do vetor multiplicador se torna inferior a um limite pr\u00e9-determinado. \n\nCrit\u00e9rios de parada mais sofisticados s\u00e3o poss\u00edveis (Conejo et al. 2006). \n\n \n\n \n\n \n\n\n\n59 \n \n\n3.3.1.4. Trust Region Method \n\n \n\nA atualiza\u00e7\u00e3o do vetor do multiplicador \u00e9 obtida resolvendo o seguinte problema de \n\nprograma\u00e7\u00e3o linear dual relaxada: \n\n  Max z, ? ? C\n(v)\n\n  z  \n\n  sujeito a:   \n\n     z ? ?\n(k)\n\n + ?(?)\n?\n(? - ?\n\n(k)\n);  k=1,...,n; n ? ?, \n\nem que ? \u00e9 o m\u00e1ximo n\u00famero de restri\u00e7\u00f5es consideradas quando o problema \u00e9 \n\nresolvido, e C\n(v)\n\n \u00e9 atualizado dinamicamente, definindo a regi\u00e3o vi\u00e1vel dos \n\nmultiplicadores (Redondo e Conejo, 1999). Se o n\u00famero de itera\u00e7\u00f5es for maior que o \n\nn\u00famero m\u00e1ximo especificado de restri\u00e7\u00f5es consideradas, as restri\u00e7\u00f5es excedentes \n\ns\u00e3o eliminadas como \u00e9 indicado a seguir. Na itera\u00e7\u00e3o v a diferen\u00e7a entre todos os \n\nhiperplanos avaliados no vetor do multiplicador atual e o valor atual da fun\u00e7\u00e3o \n\nobjetivo para o vetor do multiplicador atual (residual) \u00e9 calculado como: \n\n?i = ?\n(i)\n\n + ?(?)\n?\n(?\n\n(V)\n - ?\n\n(i)\n) - ?\n\n(v)\n ; ?i = 1,...,n. \n\nAssim que n se torna maior que ?, o hiperplano \"mais distante\" n\u00e3o \u00e9 considerado, \n\nent\u00e3o o numero de hiperplanos fica constante e igual a ?. Deve-se notar que o \n\nres\u00edduo ?i \u00e9 sempre positivo porque a reconstitui\u00e7\u00e3o do plano cortante da fun\u00e7\u00e3o \n\ndual sobre-estima a fun\u00e7\u00e3o dual atual. Esta t\u00e9cnica que limita o numero de \n\nhiperplanos considerados tem se provado computacionalmente eficiente.  \n\nO m\u00e9todo trust region \u00e9 um m\u00e9todo de plano cortante em que o procedimento de \n\nsubida \u00e9 dinamicamente limitado por ampliar e diminuir a regi\u00e3o de viabilidade sobre \n\numa base de coordenadas. Isto \u00e9 poss\u00edvel porque a regi\u00e3o de viabilidade \u00e9 simples, \n\ns\u00e3o os limites de cada multiplicador. Atrav\u00e9s deste procedimento de \n\namplia\u00e7\u00e3o/diminui\u00e7\u00e3o \u00e9 poss\u00edvel centrar o algoritmo na \u00e1rea de interesse, o que \n\nresulta em elevada efici\u00eancia. O procedimento de amplia\u00e7\u00e3o/redu\u00e7\u00e3o n\u00e3o depende \n\ndo problema em quest\u00e3o e envolve heur\u00edsticas simples. O crit\u00e9rio de parada deste \n\nalgoritmo \u00e9 quando a diferen\u00e7a entre o vetor multiplicador de duas itera\u00e7\u00f5es \n\nsucessivas se torna inferior a um limite pr\u00e9-especificado. Uma diferen\u00e7a \n\n\n\n60 \n \n\nsuficientemente pequena entre um limite superior e um limite inferior do \u00f3timo do \n\nproblema dual tamb\u00e9m \u00e9 um crit\u00e9rio de parada apropriado (Conejo et al. 2006). \n\n \n\n3.4. LAGRANGEANO AUMENTADO \n\n \n\nLembrando que c(x) \u00e9 a restri\u00e7\u00e3o complicadora de igualdade e d(x) \u00e9 a restri\u00e7\u00e3o \n\ncomplicadora de desigualdade do problema eq.(3.21) - (3.22), a fun\u00e7\u00e3o do \n\nLagrangeano aumentado (LA) deste problema tem a seguinte forma: \n\nLA(x, z, ?, ?, ?, ?) = f(x) + ?\nT\n c(x) + \u00bd ? ?c??(x)?\n\n2\n + ? [\n\n??\n??? ?i (di(x) + zi\n\n2\n)  \n\n+ \u00bd ?(di(x) + zi\n2\n)\n2\n]         (3.24) \n\nEm que os par\u00e2metros de penalidade ? e ? s\u00e3o escalares grandes o suficiente para \n\ngarantir a convexidade local (os valores destes par\u00e2metros podem ser encontrados \n\nem Conejo et al. 2006)  e zi (i = 1, ..., nd) s\u00e3o vari\u00e1veis adicionais para transformar \n\nrestri\u00e7\u00f5es de desigualdade em restri\u00e7\u00f5es de igualdade. Deve-se notar que os termos \n\nquadr\u00e1ticos permitem que a fun\u00e7\u00e3o do Lagrangeano aumentado tenha boas \n\npropriedades de convexidade (Luenberger, 1984). Por conveni\u00eancia, definimos vi = \n\nzi\n2\n (i = 1, ..., nd), portanto a fun\u00e7\u00e3o Lagrangeana aumentada escrita acima \u00e9 \n\nequivalente a \n\nLA(x, z, ?, ?, ?, ?) = f(x) + ?\nT\n c(x) + \u00bd ? ?c??(x)?\n\n2\n + ? [\n\n??\n??? ?i (di(x) + vi)  \n\n+ \u00bd ?(di(x) + vi)\n2\n]          (3.25) \n\nO procedimento de decomposi\u00e7\u00e3o do Lagrangeano aumentado envolve a \n\nminimiza\u00e7\u00e3o da eq.(3.25). Note-se que esta minimiza\u00e7\u00e3o em rela\u00e7\u00e3o a v pode ser \n\nrealizada analiticamente de forma decomposta, levando a um problema que envolve \n\napenas a minimiza\u00e7\u00e3o em rela\u00e7\u00e3o a x. A minimiza\u00e7\u00e3o da eq.(3.25) em rela\u00e7\u00e3o a vi \u00e9 \n\nMin????  pi = ?i(di(x) + vi) + \u00bd ?(di(x) + vi)\n2\n   (3.26) \n\nem que as vari\u00e1veis vi devem ser n\u00e3o negativas.  \n\nEste problema pode ser facilmente resolvido. A derivada da fun\u00e7\u00e3o objetivo acima \n\nem rela\u00e7\u00e3o a vi \u00e9 ?i + ?(di(x) + vi). Se vi > 0, a derivada deve ser igual a zero, o que \n\n\n\n61 \n \n\nimplica vi =-di (x) - ?i / ?. Se vi = 0, isso significa que di(x) \u00e9 satisfeita como uma \n\nigualdade, o que implica que ?i > 0, e a derivada deve ser n\u00e3o negativa. Portanto, \n\nvi = Max {0, - di(x) - ?i / ?}; i = 1, ..., nd \n\nEm seguida, a fun\u00e7\u00e3o objetivo do problema eq.(3.26) \u00e9 avaliada da seguinte forma: \n\npi = ?\n\n?\n\n?\t?\n\t[(??+ \t?d?(x))\n\n? ? \t??\n?]\tse\t\tv? = 0\t\n\n?\n?\n\n?\t?\n\t??\n\n?\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tse\t\t\tv? = ? d?(x) ? \t??/?\n? \n\nEstes resultados podem ser combinados na f\u00f3rmula: \n\npi = \n?\n\n?\t?\n\t[(Max{0,??+ \t?d?(x))\n\n? ? \t??\n?] \n\nFinalmente, podemos substituir a express\u00e3o de pi (i = 1, ..., nd) em (5.50), para obter \n\numa express\u00e3o expl\u00edcita da fun\u00e7\u00e3o do Lagrangeano aumentado, \n\nLA(x, z, ?, ?, ?, ?) = f(x) + ?\nT\n c(x) + \u00bd ? ?c??(x)?\n\n2\n + \n\n?\n\n?\t?\n\t[(Max{0,??+ \t?d?(x))\n\n? ? \t??\n?]  \n\nComo alternativa, um tratamento de ponto interior n\u00e3o-linear com restri\u00e7\u00f5es de \n\ndesigualdade pode ser usado (Wu et al., 1994). Essa t\u00e9cnica requer a adi\u00e7\u00e3o de \n\nvari\u00e1veis de folga para as restri\u00e7\u00f5es de desigualdade em eq.(3.24) para convert\u00ea-las \n\nem restri\u00e7\u00f5es de igualdade. Tais vari\u00e1veis de folga s\u00e3o, ent\u00e3o, incorporadas \u00e0 \n\nfun\u00e7\u00e3o objetivo atrav\u00e9s de termos de barreira logar\u00edtmica para garantir a sua \n\npositividade. \n\nO algoritmo de decomposi\u00e7\u00e3o baseado no Lagrangeano aumentado \u00e9 semelhante \n\nao processo de decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana indicado na se\u00e7\u00e3o \n\nanterior. A diferen\u00e7a b\u00e1sica \u00e9 que os termos quadr\u00e1ticos no Lagrangeano \n\naumentado tornam o problema primal relaxado em n\u00e3o decompon\u00edvel. Para que este \n\npossa ser decomposto, dois procedimentos s\u00e3o utilizados principalmente. O primeiro \n\n\u00e9 linearizar os termos quadr\u00e1ticos da fun\u00e7\u00e3o do Lagrangeano aumentado e fixa os \n\nvalores (m\u00ednimos) das vari\u00e1veis de uma itera\u00e7\u00e3o pr\u00e9via. O segundo procedimento \u00e9 \n\nfixar diretamente na fun\u00e7\u00e3o do Lagrangeano aumentado os valores (m\u00ednimos) das \n\nvari\u00e1veis de uma itera\u00e7\u00e3o pr\u00e9via. Para mais detalhes pode ser consultado o trabalho \n\nde Cohen (1980) e exemplos de aplica\u00e7\u00f5es podem ser encontrados em Conejo et al. \n\n(2006). \n\n\n\n62 \n \n\nO algoritmo para a resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o por Lagrangeano \n\naumentado \u00e9 o seguinte: \n\nPasso 0: Inicializa\u00e7\u00e3o. \n\nInicializar com multiplicadores ? e ?, par\u00e2metros de penalidade ? e ?. Tamb\u00e9m \u00e9 \n\nimportante fornecer ?, que \u00e9 uma diferen\u00e7a aceit\u00e1vel entre os valores dos \n\nmultiplicadores de duas itera\u00e7\u00f5es consecutivas para o crit\u00e9rio de converg\u00eancia do \n\nalgoritmo. \n\nPasso 1: Solu\u00e7\u00e3o do problema primal relaxado.  \n\nResolver os subproblemas gerados a partir do problema primal, para isto deve ser \n\naplicado um procedimento para que o problema primal possa ser decomposto (ver \n\nConejo et al. 2006).  \n\nPasso 2: Atualiza\u00e7\u00e3o do multiplicador.  \n\nDe acordo com Luenberger (1984), Bertsekas (1995) e Bertsekas (1982) uma regra \n\napropriada para atualizar multiplicadores ? (para as restri\u00e7\u00f5es de igualdade) \u00e9: \n\n?\n(v+1)\n\n = ?\n(v)\n\n + ?.c(x\n(v)\n\n) \n\nPara os multiplicadores ? (das restri\u00e7\u00f5es de desigualdade) que s\u00e3o n\u00e3o negativos, a \n\natualiza\u00e7\u00e3o segue a forma: \n\n?\n(v+1)\n\n = Max {0, ?i\n(v)\n\n + ?.di(x\n(v)\n\n)};  i = 1, ..., nd \n\nOs par\u00e2metros de penalidade ? e ? tamb\u00e9m pode ser atualizados com o n\u00famero de \n\nitera\u00e7\u00e3o, de modo que a convexidade seja mantida e evitando um mau \n\ncondicionamento num\u00e9rico. \n\nPasso 3: Verifica\u00e7\u00e3o de converg\u00eancia. \n\nO crit\u00e9rio de parada do algoritmo tem que satisfazer as seguintes equa\u00e7\u00f5es: \n\n  ??(?? ?) ? ??(?)?? ? \t?  e ??(???) ? ??(?)??\t? \t?    \n\nem que ? \u00e9 definido no passo 0. Se essas equa\u00e7\u00f5es s\u00e3o satisfeitas, ent\u00e3o o \n\nalgoritmo pode parar e a solu\u00e7\u00e3o \u00f3tima foi encontrada, x* = x\n(v)\n\n. \n\n\n\n63 \n \n\nCaso contr\u00e1rio, o algoritmo deve continuar, v ? v +1 e retorna-se para o passo 1. \n\nPara ilustrar o algoritmo de solu\u00e7\u00e3o de problemas por decomposi\u00e7\u00e3o do \n\nLagrangeano aumentado, na figura 3.4 \u00e9 apresentado um fluxograma com os \n\npassos do algoritmo explicado anteriormente. \n\n \n\nFigura 3.4 - Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo m\u00e9todo de Lagrangeano \n\naumentado. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria baseada em Conejo et al. (2006). \n\n \n\nExemplos ilustrativos de decomposi\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o, tanto para a \n\nt\u00e9cnica de relaxa\u00e7\u00e3o Lagrangeana como para o Lagrangeano aumentado podem ser \n\nencontrados em Conejo et al. (2006). \n\n \n\n \n\nn\u00e3o sim \n\nPasso 0: Inicializa\u00e7\u00e3o \n\nv = 1; ?\n(v)\n\n = ?\n(0)\n\n; ?\n(v)\n\n = ?\n(0)\n\n; \n\n? , ? e ? s\u00e3o definidos \n\nPasso 1: Resolu\u00e7\u00e3o dos n subproblemas, com i = 1,...,n gerados a partir do primal. \n\nmin??  LA(x, z, ?, ?, ?, ?) = f(xi) + ?\nT\n c(xi) + \u00bd ? ?c??(x?)?\n\n2\n + \n\n?\n\n?\t?\n\t?(max{0,??+ \t?d?(x?))\n\n? ? \t??\n??  \n\nsujeito a: \n ai (xi) = 0;   \n bi (xi) ? 0; \n\nPasso 2: Atualizar os \n\nmultiplicadores, de  ?(v), ?(v) \n\npara ?(v+1), ?(v+1). \n\nProblema mestre:  \n\nPara ? : ?(v+1) = ?(v) + ?.c(x(v)); \n\nPara ?: ?\n(v+1)\n\n = max {0, ?i\n(v)\n\n + ?.di(x\n(v)\n\n)};  \n\ni = 1, ..., nd \n\nPasso 3: Crit\u00e9rio de Converg\u00eancia: \n\n  ??(?? ?) ? ??(?? ?)?? ? \t?  e ??(?? ?) ? ??(?? ?)??\t? \t?    \n\nSolu\u00e7\u00e3o encontrada: \n\nxi* = x1\n(v) \n\nv ? v + 1 \n\n\n\n64 \n \n\n3.5. PRICING INTERPROCESS STREAMS USING SLACK AUCTIONS \n\n \n\nEsta \u00e9 uma t\u00e9cnica alternativa proposta por Jose e Ungar (2000), cujos autores \n\nargumentam que a otimiza\u00e7\u00e3o da planta deve ser decomposta em subproblemas \n\ncom uma complexidade num\u00e9rica menor, nos quais cada divis\u00e3o busca maximizar \n\nseu lucro. Para que isto aconte\u00e7a, \u00e9 necess\u00e1rio conhecer os pre\u00e7os das correntes \n\nintermedi\u00e1rias entre as divis\u00f5es. A melhor forma de busca-los \u00e9 definindo uma folga \n\nentre as correntes do processo das divis\u00f5es, de forma que essas correntes possam \n\nser precificadas utilizando leil\u00f5es. Esses leil\u00f5es terminam quando os pre\u00e7os das \n\ncorrentes est\u00e3o em equil\u00edbrio, ou seja,  quando existe um equil\u00edbrio entre a demanda \n\ne a oferta de recursos das divis\u00f5es, indicando que toda a planta estaria globalmente \n\notimizada. \n\nEste m\u00e9todo (leil\u00f5es de folga) est\u00e1 relacionado as t\u00e9cnicas de decomposi\u00e7\u00e3o e pode \n\nresolver problemas comuns apresentados na pr\u00e1tica, em que t\u00e9cnicas cl\u00e1ssicas de \n\nrelaxamento podem apresentar problemas. \n\nA ideia desse m\u00e9todo baseia-se no conceito de cadeia de suprimentos que se \n\noriginou na fabrica\u00e7\u00e3o e pesquisa operacional como uma forma de gest\u00e3o dos fluxos \n\nde recursos entre empresas (Axelsson e Easton, 1992; Vollmann et al., 1997). \n\nGerenciamento da cadeia de suprimentos em todos os seus detalhes pode envolver: \n\na previs\u00e3o de demandas das empresas, decis\u00f5es sobre quais s\u00e3o os produtos a \n\nproduzir, quando faz\u00ea-los, e como envi\u00e1-los a seus clientes. A cadeia de \n\nsuprimentos t\u00edpica abrange muitas empresas e v\u00e1rios setores. No entanto, uma \n\ncadeia de suprimentos tamb\u00e9m pode ser definida sobre as divis\u00f5es em uma \u00fanica \n\nf\u00e1brica de produtos qu\u00edmicos. Neste caso as denominamos como microcadeias de \n\nsuprimentos para distingui-las a partir da variedade padr\u00e3o. \n\nAo ver uma planta como uma microcadeia de suprimentos, as intera\u00e7\u00f5es entre as \n\ndivis\u00f5es de plantas podem ser consideradas como uma competi\u00e7\u00e3o pelos recursos \n\nlimitados. Matematicamente, todos os recursos est\u00e3o associados com restri\u00e7\u00f5es da \n\nforma: \n\n    D1 + ... + Dn ? S,   (3.27) \n\n\n\n65 \n \n\nem que Di \u00e9 a demanda de recursos da divis\u00e3o i e S \u00e9 a oferta total dos recursos. \n\nDivis\u00f5es em uma cadeia de suprimentos interagem quando a soma de suas \n\ndemandas de recursos excede a oferta dispon\u00edvel. Essa intera\u00e7\u00e3o pode ser \n\ngerenciada pela forma com que os recursos s\u00e3o enviados para as divis\u00f5es, baseada \n\nna quantidade de recursos que elas precisam. Pre\u00e7os elevados reduzem a demanda \n\ndas divis\u00f5es, enquanto os pre\u00e7os baixos as incentiva a produzir maiores \n\nquantidades. Quando a divis\u00e3o i \u00e9 abastecida com base na quantidade de recursos \n\nque ele usa, o seu objetivo \u00e9 resolver o seguinte problema de otimiza\u00e7\u00e3o: \n\n \n\n  Max ??   \u0192i (xi) - p.Di(xi) \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es das Divis\u00f5es \n\nem que xi \u00e9 a vari\u00e1vel de decis\u00e3o, \u0192i (xi) \u00e9 a fun\u00e7\u00e3o objetivo nominal, p \u00e9 um vetor de \n\npre\u00e7os dos recursos, e Di(xi) \u00e9 a demanda de recursos da divis\u00e3o i. Devem ser \n\nrespeitadas as seguintes condi\u00e7\u00f5es de equil\u00edbrio \n\n? D???? i ? S      \n\n? p???? j.(Dj - Sj) = 0,    (3.28) \n\npj ? 0  j ? {1, ... , m},   (3.29) \n\nem que se tem m divis\u00f5es com m correntes intermediarias. \n\nA fim de aplicar esta abordagem orientada a pre\u00e7o para problemas de otimiza\u00e7\u00e3o em \n\ntoda a planta, deve-se definir os recursos adequados ao longo dos fluxos entre \n\nprocessos. Embora isto pare\u00e7a trivial, n\u00e3o \u00e9. O principal problema \u00e9 que os recursos \n\nem uma microcadeia de suprimentos s\u00e3o diferentes daquelas em uma cadeia t\u00edpica. \n\nNa situa\u00e7\u00e3o padr\u00e3o, cada empresa \u00e9 livre para comprar a quantidade que desejar, j\u00e1 \n\nem uma microcadeia de suprimentos isso \u00e9 imposs\u00edvel. A divis\u00e3o da planta n\u00e3o pode \n\ndispor dos recursos enviados a ela por meio de correntes intermediarias n\u00e3o tem \n\nescolha sen\u00e3o aceitar o recurso, independentemente de quanto \u00e9 realmente exigido. \n\nFluxos de correntes intermedi\u00e1rias n\u00e3o podem realmente ser vistos como recursos. \n\nMatematicamente, o problema \u00e9 que as restri\u00e7\u00f5es das correntes entre processos \n\nn\u00e3o s\u00e3o como as restri\u00e7\u00f5es de recursos, na verdade s\u00e3o restri\u00e7\u00f5es de consist\u00eancia \n\nessencialmente f\u00edsica como: \n\n\n\n66 \n \n\nCIu = CId \n\nem que CIu \u00e9 a corrente intermedi\u00e1ria da divis\u00e3o de upstream e CId \u00e9 a corrente \n\nintermediaria da divis\u00e3o de downstream. Ou seja, a restri\u00e7\u00e3o imp\u00f5e que a vaz\u00e3o de \n\nsa\u00edda de uma unidade de upstream deve ser a mesma que a vaz\u00e3o de entrada da \n\nunidade de downstream. Isso \u00e9 irrelevante para efeitos da defini\u00e7\u00e3o de recursos e \n\ntamb\u00e9m dificulta a precifica\u00e7\u00e3o dos fluxos entre os processos. A aparente forma de \n\nprecifica\u00e7\u00e3o dos fluxos entre processos em que as unidades de dowstream t\u00eam que \n\npagar pelo recurso enviado desde a unidade de upstream (ver figura 3.5) \u00e9 intuitiva, \n\nmas o racioc\u00ednio por tr\u00e1s disso \u00e9 errado, porque as unidades de dowstream n\u00e3o \n\npodem dispor da quantidade de recurso do upstream que \u00e9 enviado para eles. Isso \n\nsignifica que n\u00e3o h\u00e1 nenhuma no\u00e7\u00e3o de demanda de recursos a serem utilizados na \n\ndivis\u00e3o de dowstream. Sem uma no\u00e7\u00e3o de demandas dos recursos, n\u00e3o pode haver \n\npre\u00e7os de equil\u00edbrio. \n\n \n\nFigura 3.5 - Defini\u00e7\u00e3o impr\u00f3pria das correntes intermedi\u00e1rias entre processos. \n\n \n Fonte: Jose e Ungar (2000). \n\n \n\nAs dificuldades em definir pre\u00e7os para fluxos entre processos ocorrem porque os \n\nrecursos n\u00e3o est\u00e3o bem definidos nesse caso. Uma maneira de superar isso \u00e9 \n\nremodelar a microcadeia de modo que as restri\u00e7\u00f5es dos recursos sejam expl\u00edcitas.  \n\nConsiderando a restri\u00e7\u00e3o de consist\u00eancia: \n\nCIu = CId \n\nQue pode ser reescrita de modo que se tenha a forma de uma restri\u00e7\u00e3o de recurso: \n\nCIu - CId = 0 \n\n|CI?\t ?\n?CI?\t|\n\n? ? 0 \n\n\n\n67 \n \n\n\u00bd|CI?\t ?\n?CI?\t|\n\n? + \u00bd|CI?\t ?\n?CI?\t|\n\n? ? 0  (3.30) \n\n    Du      Dd \n\nO primeiro membro da eq.(3.31) pode ser interpretado como uma demanda \n\nagregada por recursos, sendo Du a demanda da divis\u00e3o de upstream e Dd a \n\ndemanda para a divis\u00e3o de downstream, enquanto o segundo membro pode ser \n\ninterpretado como uma oferta de recursos. Dado que |CIu - CId| \u00e9 a quantidade de \n\nfolga na eq.(3.31), podemos chamar esses novos recursos como recursos de folga. \n\nEm geral, eq.(3.31) pode ser escrita como: \n\n\u00bd|CI?\t ?\n?CI?\t|\n\n? + \u00bd|CI?\t ?\n?CI?\t|\n\n? ? S \n\nem que S>0, de modo que S pode ser considerada como uma folga de \n\nabastecimento entre as correntes intermedi\u00e1rias. Estes recursos de folga alteram a \n\nestrutura da microcadeia de suprimentos de toda a planta. Em vez de considerar \n\numa divis\u00e3o como vendedora e outra compradora, ambas s\u00e3o compradoras e, quem \n\ndefine a folga entre as correntes intermediarias \u00e9, em certo sentido, um \n\nadministrador da planta (ver Figura 3.6). \n\n \n\nFigura 3.6 - Remodelando a microcadeia de suprimentos usando recursos de folga. \n\n \n Fonte: Jose e Ungar (2000). \n\n \n\nColocar uma folga entre os recursos intermedi\u00e1rios \u00e9 a forma adequada de ver as \n\ncorrentes da microcadeia de suprimentos, porque capturam a ideia da demanda de \n\nrecursos, a oferta de recursos e a escassez de recursos. Um recurso se torna \n\nescasso, quando a demanda excede a oferta ou seja, existe uma folga entre as \n\n\n\n68 \n \n\ncorrentes intermediarias (folga de abastecimento) maior \u00e0 especificada, isto \n\nacontece quando as divis\u00f5es de upstream e downstream tem diferentes valores da \n\ncorrente intermediaria. A folga de abastecimento \u00e9 essencialmente a toler\u00e2ncia da \n\nplanta entre os diferentes valores de CIu e CId. A demanda e a oferta entre duas \n\ndivis\u00f5es pode ser controlada fornecendo \u00e0s divis\u00f5es (com base na folga \n\nespecificada entre suas correntes intermedirias) pre\u00e7os adequados, que podem ser \n\nencontrados usando leil\u00f5es de recursos. \n\nO objetivo de qualquer leil\u00e3o \u00e9 encontrar os pre\u00e7os dos recursos com respeito a um \n\nconjunto de compradores (tais como as divis\u00f5es em uma planta). Um leiloeiro ajusta \n\nos pre\u00e7os dos recursos at\u00e9 que as condi\u00e7\u00f5es de equil\u00edbrio eq. (3.28) - (3.30) sejam \n\nsatisfeitas. Quando os recursos s\u00e3o vendidos a pre\u00e7os de equil\u00edbrio, eles s\u00e3o \n\nperfeitamente alocados no sentido de que a soma dos objetivos das divis\u00f5es \u00e9 \n\nmaximizada. \n\nConsidere a folga da demanda da divis\u00e3o de upstream \n\nDu = \u00bd|CI?\t ?\n?CI?|\n\n? \n\ne da divis\u00e3o de downstream \n\nDd = \u00bd|CI?\t ?\n?CI?|\n\n? \n\nPara que a divis\u00e3o do upstream calcule essa demanda, \u00e9 preciso saber o valor do \n\nCId. Portanto, quando um leiloeiro anuncia pre\u00e7os, tamb\u00e9m deve anunciar algum \n\nvalor de refer\u00eancia da CId para que seja usado pela divis\u00e3o de upstream. \n\nDenotaremos esta refer\u00eancia como CId\n0\n e \u00e9 chamado de polo de folga da divis\u00e3o de \n\nupstream. Dado um polo de folga e um pre\u00e7o p, o problema de otimiza\u00e7\u00e3o da divis\u00e3o \n\nde upstream para calcular a folga da demanda pode ser expresso da seguinte forma: \n\n  Max ???    \u0192u (CIu) - p. \u00bd?CI?\t ?\n?CI?\n\n???  \n\n  Sujeito a: \n\n     Restri\u00e7\u00f5es da divis\u00e3o de Upstream \n\nDe maneira similar, para a divis\u00e3o de downstream o problema de otimiza\u00e7\u00e3o fica: \n\n \n\n                 Max ???    \u0192d (CId) - p. \u00bd|\tCI? ?\n?CI?\n\n?|?  \n\n\n\n69 \n \n\n  Sujeito a: \n\n   Restri\u00e7\u00f5es da divis\u00e3o de Downstream \n\nO algoritmo iterativo para resolver a decomposi\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo \n\nm\u00e9todo de leil\u00e3o da folga \u00e9 o seguinte:  \n\nPasso 0: Inicializa\u00e7\u00e3o. \n\nFornecer valores iniciais para o pre\u00e7o (p\n0\n), os valores iniciais das vari\u00e1veis CI?\n\n?, CI?\n?, a \n\nfolga entre os recursos (S) e o numero de itera\u00e7\u00e3o (v = 1) \n\nPasso 1: Resolver os subproblemas: \n\n     Max ???    \u0192u (CIu) - p\n(v)\n\n. \u00bd?CI?\t ?\n?CI?\n\n???  \n\n  Sujeito a: \n\n     Restri\u00e7\u00f5es da divis\u00e3o de Upstream \n\ne \n\n  Max ???    \u0192d (CId) - p\n(v)\n\n. \u00bd|\tCI? ?\n?CI?\n\n?|?  \n\n  Sujeito a: \n\n     Restri\u00e7\u00f5es da divis\u00e3o de Downstream \n\nObtendo como resultado os valores \u00f3timos CI?* e CI?* \n\nPasso 2: Crit\u00e9rio de Converg\u00eancia. \n\nSe |CI?\n? ? ?CI?\n\n?|? ? S, ent\u00e3o a solu\u00e7\u00e3o foi encontrada, caso contr\u00e1rio passa-se ao passo \n\n3. \n\nPasso 3: Atualizar os valores de refer\u00eancia. \n\nCI?\n? ? CI?* \n\nCI?\n? ? CI?* \n\nAjustar o pre\u00e7o p\n(v)\n\n calculando o excesso da demanda E\n(v)\n\n da seguinte forma: \n\nE\n(v)\n\n = CI?* - CI?* \n\n\n\n70 \n \n\nSe o excesso de demanda \u00e9 negativo, ent\u00e3o diminuir o pre\u00e7o p\n(v)\n\n, se o excesso de \n\ndemanda \u00e9 positivo, incrementar o pre\u00e7o p\n(v) \n\n(Jose e Ungar, 1998)  e voltar para o \n\npasso 1. Na figura 3.7 mostra-se o fluxograma do algoritmo.  \n\n \n\nFigura 3.7 - Fluxograma de resolu\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o pelo m\u00e9todo de Slack Auctions. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n  \n\n \n\n \n\n \n\n \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria com base em a Jose e Ungar (2000). \n\n \n\nExemplos ilustrativos e mais detalhes deste m\u00e9todo podem ser encontrados em \n\nJose e Ungar (2000). \n\nn\u00e3o sim \n\nPasso 0: Inicializa\u00e7\u00e3o. \n\nFornecer valores iniciais para p, \n\nCI?\n?, CI?\n\n? e a toler\u00e2ncia S. \n\nPasso 1: Resolu\u00e7\u00e3o os subproblemas. \n\nMaximizar???   \u0192u (CIu) ? p. \u00bd?CI?\t ?\n?CI?\n\n???  \n\nSujeito a: \n\n  Restri\u00e7\u00f5es da divis\u00e3o de Upstream \n\ne \n\nMaximizar???   \u0192d (CId) ? p. \u00bd|\tCI? ?\n?CI?\n\n?|?  \n\nSujeito a: \n\n Restri\u00e7\u00f5es da divis\u00e3o de Downstream \n\nPasso 2: Crit\u00e9rio de Converg\u00eancia. \n\nSe |CI?\n? ? ?CI?\n\n?|? ? S \n\nPasso 3: Atualizar os valores de referencia e o \n\npre\u00e7o. \n\nCI?\n? ? CI?* ; CI?\n\n? ? CI?* \n\nAjustar o pre\u00e7o p. \n\nCI?\n? = \tCI?\n\n? \n\nSolu\u00e7\u00e3o encontrada: \n\n\n\n71 \n \n\n4. APRESENTA\u00c7\u00c3O DO PROCESSO ESTUDADO \n\n \n\nO processo estudado \u00e9 a unidade de produ\u00e7\u00e3o de Propeno da refinaria REPLAN da \n\nPETROBRAS S.A. que foi projetada para produzir 53.000 t/ano de propeno de alta \n\npureza com grau pol\u00edmero (99.5 % molar no m\u00ednimo). A unidade \u00e9 formada por uma \n\nse\u00e7\u00e3o de carga, uma se\u00e7\u00e3o de tratamento c\u00e1ustico e tr\u00eas diferentes divis\u00f5es de \n\ndestila\u00e7\u00e3o que s\u00e3o: a Depropanizadora, a De-etanizadora e a Fracionadora de \n\nPropeno (Depropenizadora). No processo estudado ser\u00e3o consideradas as divis\u00f5es \n\nde destila\u00e7\u00e3o formadas por tr\u00eas colunas para que seja feita a otimiza\u00e7\u00e3o em \n\nsequ\u00eancia como mostra a figura 4.1, na qual pode-se observar um diagrama \n\nsimplificado da unidade de produ\u00e7\u00e3o de propeno. Por raz\u00f5es de confidencialidade \n\numa escala arbitraria de  vaz\u00f5es e pre\u00e7os foi utilizada. \n\n \n\n4.1. DESCRI\u00c7\u00c3O DO PROCESSO \n\n \n\nA corrente de carga da unidade de produ\u00e7\u00e3o de propeno \u00e9 o GLP proveniente da \n\nunidade FCC (Fluid Catalytic Cracking), que \u00e9 bombeada, ap\u00f3s tratamento para a \n\nprimeira divis\u00e3o de destila\u00e7\u00e3o (Depropanizadora). \n\nO GLP da unidade FCC alimenta a Coluna depropanizadora (T-1) cont\u00e9m 10 \n\ncomponentes dos quais os principais s\u00e3o o propano e propeno. A composi\u00e7\u00e3o \n\ndetalhada desta corrente de carga est\u00e1 apresentada na tabela 4.1.  \n\nDivis\u00e3o Depropanizadora \n\nA coluna Depropanizadora est\u00e1 equipada com 51 pratos. O produto de fundo da \n\ncoluna \u00e9 parcialmente evaporado por meio do vapor aquecido pelo reboiler da \n\ndepropanizadora (RB1), depois este produto \u00e9 esfriado no cooler (HX1) e enviado \n\npara o splitter do produto de fundo (SP1) em que 70% do produto vai para a Unidade \n\nde MTBE e o resto vai para a venda Industrial.  A especifica\u00e7\u00e3o do produto de fundo \n\n(C4\n+\n) \u00e9 de no m\u00e1ximo 1,0% molar dos componentes leves (etano, propeno e \n\npropano). O vapor de topo da T-1 passa pelo condensador total da depropanizadora \n\n(HX2). \n\n\n\n \n\n \n\nF\nig\n\nu\nra\n\n 4\n.1\n\n -\n F\n\nlu\nx\no\n\ng\nra\n\nm\na\n\n s\nim\n\np\nlif\n\nic\na\nd\n\no\n d\n\na\n u\n\nn\nid\n\na\nd\n\ne\n d\n\ne\n p\n\nro\nd\n\nu\n\u00e7\n\u00e3\n\no\n d\n\ne\n p\n\nro\np\ne\n\nn\no\n\n. \n\n  \n\n72 \n\nF\no\n\nn\nte\n\n: \nE\n\nla\nb\n\no\nra\n\n\u00e7\n\u00e3\n\no\n p\n\nr\u00f3\np\n\nri\na\n\n e\nm\n\n b\na\n\ns\ne\n\n a\n d\n\na\nd\n\no\ns\n d\n\no\n p\n\nro\nje\n\nto\n. \n\n\n\n73 \n \n\nO l\u00edquido condensado \u00e9 enviado para o splitter do refluxo, onde a maior parte \u00e9 \n\nbombeada pela B1 (bomba de refluxo da depropanizadora), como refluxo para a \n\ncoluna T-1 e a parte menor, chamada de produto intermedi\u00e1rio C3, \u00e9 bombeada pela \n\nB2 (bomba do produto intermedi\u00e1rio C3) para a segunda divis\u00e3o de destila\u00e7\u00e3o (De-\n\netanizadora). A especifica\u00e7\u00e3o do produto de topo da coluna T-1 \u00e9 de no m\u00e1ximo \n\n0,1% molar de hidrocarbonetos pesados (C4\n+\n). Os limites de opera\u00e7\u00e3o para a vaz\u00e3o \n\nde carga para a T-1 s\u00e3o, no m\u00e1ximo de 23804 kg/h e no m\u00ednimo de 17312 kg/h. \n\n  \n\nTabela 4.1 - Composi\u00e7\u00e3o da carga (GLP) para a se\u00e7\u00e3o da Depropanizadora. \n\nComponente Fra\u00e7\u00e3o Molar \n\nEtano 0.0245 \n\nPropileno 0.3712 \n\nPropano 0.1353 \n\nIsobutano 0.1197 \n\n1-Buteno 0.0640 \n\n1,3-Butadieno 0.0021 \n\nButano 0.0531 \n\nTrans-2-Buteno 0.0724 \n\nCis-2-Buteno 0.0483 \n\nIsobuteno 0.1026 \n\n      Fonte: Dados da planta. \n\n \n\nDivis\u00e3o De-etanizadora \n\nO produto intermedi\u00e1rio C3 da coluna Depropanizadora vai para a Coluna De-\n\netanizadora (T-2).  A T2 est\u00e1 equipada com 61 pratos. O produto do topo da T-2 \u00e9 \n\ncondensado no HX3 (condensador de topo da de-etanizadora). Esse condensado, \u00e9 \n\nenviado para o splitter do refluxo da De-etanizadora (SR2) onde parte deste produto,  \n\ncomposto majoritariamente por etano, \u00e9 enviado para as unidades de FCC da \n\nrefinaria, para posterior processamento, e o restante \u00e9 bombeado pela B3  (bomba \n\nde refluxo da de-etanizadora), como refluxo para a T-2.  \n\nO produto de fundo da coluna \u00e9 enviado para o splitter do reboiler da T-2 (SB2) onde \n\na parte que vai para o reboiler \u00e9 evaporada por meio do vapor aquecido do reboiler \n\ndo De-etanizador (RB2) e depois retorna \u00e0 coluna. A parte restante do produto de \n\nfundo (produto intermedi\u00e1rio) \u00e9 enviada como corrente de alimenta\u00e7\u00e3o para a \n\nFracionadora de Propeno. A especifica\u00e7\u00e3o do produto de fundo \u00e9 de no m\u00e1ximo 120 \n\n\n\n74 \n \n\nppm molar de etano. Os limites de opera\u00e7\u00e3o para a vaz\u00e3o de carga para a T-2 s\u00e3o, \n\nno m\u00e1ximo de 10866 kg/h e no m\u00ednimo de 4939 kg/h.  \n\nDivis\u00e3o Fracionadora de Propeno (Depropenizadora) \n\nO produto de fundo da coluna De-etanizadora, contendo C4 (propano e propeno), \u00e9 \n\nenviado para a fracionadora de propeno (T-3). A T-3 est\u00e1 equipada com 197 pratos. \n\nO calor necess\u00e1rio para separar o propeno do propano \u00e9 cedido \u00e0 fracionadora de \n\npropeno pelo produto de topo atrav\u00e9s dos refervedores. Esses refervedores s\u00e3o \n\ndivididos em duas unidades semelhantes em paralelo. O produto de fundo que \n\ncont\u00e9m principalmente o propano \u00e9 enviado para o splitter do reboiler (SB3), onde \n\nparte \u00e9 enviada para o reboiler (RB3) e o restante \u00e9 armazenado como produto final \n\npara venda no mercado. A especifica\u00e7\u00e3o do produto de fundo \u00e9 de no m\u00e1ximo 5% \n\nmolar de propeno.  \n\nO vapor de topo da T-3 \u00e9 misturado com o vapor do tanque de refluxo TA1 e \u00e9 \n\nconduzido para o Compressor (bomba de calor) de propeno C1. O C1 aumenta a \n\npress\u00e3o de vapor at\u00e9 14,8 kgf/cm\n2\n, condi\u00e7\u00e3o em que a condensa\u00e7\u00e3o no reboiler RB3 \n\nse torna poss\u00edvel. Ap\u00f3s a compress\u00e3o, no splitter SC1 o vapor \u00e9 dividido em duas \n\npartes, a parte maior vai para o RB3, onde essa corrente condensa-se a 35\no\nC, e \n\ndepois \u00e9 enviada para a v\u00e1lvula V5. A outra parte \u00e9 enviada para o condensador \n\nHX4, onde essa corrente \u00e9 condensada at\u00e9 35\no\nC e depois \u00e9 enviada para a v\u00e1lvula \n\nV4. A condensa\u00e7\u00e3o deste vapor mant\u00e9m a press\u00e3o da T-3 sobre controle.  \n\nO l\u00edquido a partir do RB3 e do HX4 \u00e9 flasheado nas v\u00e1lvulas V5 e V4 \n\nrespectivamente, depois estas correntes s\u00e3o misturadas no mixer M2 e enviadas \n\npara o tanque de refluxo TA1. O vapor do tanque de refluxo \u00e9 enviado para a v\u00e1lvula \n\nV6 e o l\u00edquido \u00e9 bombeado pela B4 (bomba na sa\u00edda do tanque TA1) para o splitter \n\nde refluxo SR3. Nesse splitter a corrente \u00e9 dividida em duas partes, a maior parte \n\nregressa ao T-3 como refluxo e o resto constitui o produto desejado que neste caso \n\n\u00e9 o propeno com grau polimero.  \n\nA especifica\u00e7\u00e3o do produto de topo \u00e9 de 99,5% molar em m\u00ednimo de propileno. Os \n\nlimites de opera\u00e7\u00e3o para a vaz\u00e3o de carga para a T-3 s\u00e3o no m\u00e1ximo de 10062 kg/h \n\ne no m\u00ednimo de 4574 kg/h. \n\n \n\n\n\n75 \n \n\n4.2. MODELAGEM, SIMULA\u00c7\u00c3O E OTIMIZA\u00c7\u00c3O DO PROCESSO ESTUDADO \n\n \n\nPara o desenvolvimento de uma ferramenta de otimiza\u00e7\u00e3o em tempo real, \u00e9 \n\nnecess\u00e1rio um modelo matem\u00e1tico que seja capaz de representar a opera\u00e7\u00e3o da \n\nunidade estudada. O modelo deve ser flex\u00edvel para ajustar o comportamento real \n\ndentro de uma ampla faixa nas opera\u00e7\u00f5es de processo (Chachua et al., 2009).  \n\nO modelo do processo foi baseado no trabalho publicado por Mendoza et al. (2013) \n\nde uma fracionadora de propeno. Este foi implementado em um ambiente orientado \n\na equa\u00e7\u00f5es, utilizando o software EMSO (Environment for Modeling, Simulation and \n\nOptimization) de Soares e Secchi (2003). \n\nO EMSO \u00e9 um software orientado a equa\u00e7\u00f5es, com as caracter\u00edsticas adequadas \n\npara a implementa\u00e7\u00e3o de um sistema RTO, j\u00e1 que este software tem rotinas para \n\nsolucionar problemas alg\u00e9brico-diferenciais, calcula as derivadas por diferencia\u00e7\u00e3o \n\nautom\u00e1tica, faz uma an\u00e1lise autom\u00e1tica dos graus de liberdade e cont\u00e9m m\u00f3dulos \n\nde otimiza\u00e7\u00e3o e de estima\u00e7\u00e3o de par\u00e2metros, entre outras caracter\u00edsticas \n\nimportantes. \n\nO modelo foi desenvolvido com as seguintes caracter\u00edsticas: \n\n? O modelo termodin\u00e2mico utilizado \u00e9 o de Peng-Robinson (Mendoza et al. \n\n2013), dispon\u00edvel no pacote termodin\u00e2mico do EMSO (VRTECH, 2008). \n\n? As correntes de entrada t\u00eam uma vaz\u00e3o de 440.16 kmol/h, a uma \n\ntemperatura de 343.15 K, e uma press\u00e3o de 22.264 atm. A corrente tem 10 \n\ncomponentes com a composi\u00e7\u00e3o mostrada na tabela 4.1 desta se\u00e7\u00e3o. \n\n? A primeira coluna (Depropanizadora) tem 51 pratos e a alimenta\u00e7\u00e3o \u00e9 feita no \n\nprato n\u00famero 26. A press\u00e3o no topo da coluna \u00e9 de 19.2 atm e press\u00e3o de \n\nsa\u00edda do produto intermedi\u00e1rio (P3) \u00e9 de 32.912 atm. A raz\u00e3o de refluxo \n\ndesta coluna (SR1) obedece \u00e0 equa\u00e7\u00e3o (SRA1 = fluxo 4 / fluxo 3) e \u00e9 de \n\n0.676.  O splitter do rebiler (SB1) corresponde \u00e0  equa\u00e7\u00e3o (SB1 = fluxo 7 / \n\nfluxo 6),  especificada com um valor de 0.772. A queda de press\u00e3o foi \n\nadmitida constante em cada prato e o perfil foi linearizado entre a press\u00e3o de \n\ntopo e de fundo, onde a press\u00e3o de fundo \u00e9 de 19.445 atm. \n\n? A segunda coluna (De-etanizadora) \u00e9 composta por 61 pratos e a corrente de \n\nalimenta\u00e7\u00e3o proveniente da T-1 est\u00e1 no prato n\u00famero 7. A press\u00e3o no prato \n\n\n\n76 \n \n\nn\u00famero 1 \u00e9 de 30.5 atm e a press\u00e3o no fundo da coluna \u00e9 de 31 atm. A raz\u00e3o \n\nde refluxo desta coluna (SR2) obedece \u00e0 equa\u00e7\u00e3o (SRA2 = fluxo 13 / fluxo \n\n12) \u00e9 de 0.944.  O splitter do reboiler (SB2) corresponde \u00e0 equa\u00e7\u00e3o (SB2 = \n\nfluxo 16 / fluxo 15), especificada com um valor de 0.72. A queda de press\u00e3o \n\nfoi admitida constante em cada prato e o perfil foi linearizado entre a press\u00e3o \n\nde topo e de fundo \n\n? A terceira divis\u00e3o (Fracionadora de Propeno) tem 197 pratos, esta coluna \u00e9 \n\nde alta pureza, a corrente de alimenta\u00e7\u00e3o, proveniente da T-2, est\u00e1 no prato \n\nn\u00famero 157. A press\u00e3o no topo da coluna \u00e9 de 9.67 atm. Esta se\u00e7\u00e3o possui \n\numa destila\u00e7\u00e3o com recompress\u00e3o de vapor (VRD) para o qual utiliza-se um \n\ncompressor (bomba de calor). A raz\u00e3o de refluxo desta coluna (SR3) \n\nobedece \u00e0 equa\u00e7\u00e3o (SRA3 = fluxo 26 / fluxo 24) e \u00e9 de 0.07648. O splitter na \n\nsa\u00edda do compressor (SC1) corresponde \u00e0  equa\u00e7\u00e3o (SC1 = fluxo 22 / fluxo \n\n20),  especificada com um valor de 0.209. O compressor trabalha com uma \n\npress\u00e3o de 1550 kPa. \n\n?  As v\u00e1lvulas consideradas s\u00e3o de expans\u00e3o adiab\u00e1tica. \n\n? Trocadores de calor sem perda de carga. \n\nPara a simula\u00e7\u00e3o, foram utilizadas 13620 vari\u00e1veis, 13574 equa\u00e7\u00f5es, sendo 46 \n\nvari\u00e1veis especificadas. As vari\u00e1veis especificadas foram estabelecidas de acordo \n\ncom o sistema de controle adotado na refinaria. Foi utilizado um computador Intel \n\ncore 2 QUAD CPU Q9550 @ 2.83 GHz x 4. \n\nJ\u00e1 para a otimiza\u00e7\u00e3o desta unidade foram considerados os custos operacionais \n\n(dados da planta) entre os quais est\u00e3o o consumo energ\u00e9tico (0.55 $/KW), o \n\nconsumo de vapor para os reboilers das colunas T-1 e T-2 (147 $/Ton), o consumo \n\nde \u00e1gua de resfriamento (24.228 $/Ton) e a corrente de carga da T-1 (1.6 $/kg). A \n\nfun\u00e7\u00e3o objetivo \u00e9 o lucro operacional bruto (Receita - Custos de Opera\u00e7\u00e3o - Custo da \n\ncorrente de Carga), e as restri\u00e7\u00f5es de opera\u00e7\u00e3o da unidade s\u00e3o lineares e n\u00e3o-\n\nlineares. Para otimizar se utilizou o solver para otimiza\u00e7\u00e3o n\u00e3o linear IPOPT- Interior \n\npoint OPTimizer (https://projects.coin-or.org/Ipopt.), dispon\u00edvel no EMSO.  \n\nAs vari\u00e1veis de decis\u00e3o para a otimiza\u00e7\u00e3o na primeira coluna foram a raz\u00e3o de \n\nrefluxo (SR1) e a raz\u00e3o do reboiler (SB1), a restri\u00e7\u00e3o de pureza do produto de topo \u00e9 \n\nde 0.1% molar no m\u00e1ximo hidrocarbonetos pesados (C4\n+\n) e da pureza do produto do \n\n\n\n77 \n \n\nfundo \u00e9 de 1.0% molar no m\u00e1ximo dos componentes leves (etano, propeno e \n\npropano). O produto de fundo tem dois destinos finais, 70% vai para a Unidade de \n\nMTBE (P1) a um pre\u00e7o de 1.6063 $/Kg e o restante vai para a venda Industrial (P2) \n\na um pre\u00e7o de 2.424 $/Kg. J\u00e1 o produto do topo \u00e9 enviado como produto \n\nintermedi\u00e1rio para a T-2. \n\nNa segunda divis\u00e3o (De-etanizadora), as vari\u00e1veis de decis\u00e3o s\u00e3o a raz\u00e3o de refluxo \n\n(SR2) e a raz\u00e3o de Reboiler (SB2). O produto de topo (P3) \u00e9 enviado para a unidade \n\nFCC (Fluid Catalytic Cracking) a um pre\u00e7o de mercado de 2.736 $/Kg. J\u00e1 o produto \n\nde fundo \u00e9 enviado para a se\u00e7\u00e3o onde se encontra a fracionadora de propeno. A \n\nrestri\u00e7\u00e3o de pureza desta corrente \u00e9 de 120 ppm molar no m\u00e1ximo de etano. \n\nNa T-3 as vari\u00e1veis de decis\u00e3o foram a raz\u00e3o de refluxo (SR3) e a raz\u00e3o de caudal \n\nque fornece calor para o reboiler na sa\u00edda do compressor (SC1). Os produtos desta \n\nse\u00e7\u00e3o s\u00e3o comercializados no mercado, o propeno (P5) a um pre\u00e7o de 6.273 $/Kg e \n\no propano (P4) a um pre\u00e7o de 1.6063 $/Kg. As restri\u00e7\u00f5es de pureza destes produtos \n\ns\u00e3o de 99.5% molar no m\u00ednimo de propeno para o P5, e de 5% molar no m\u00e1ximo de \n\npropeno na vaz\u00e3o do produto P4. \n\nNa tabela 4.2, os resultados da simula\u00e7\u00e3o e a otimiza\u00e7\u00e3o s\u00e3o apresentados, \n\ncomparando-se as vari\u00e1veis de decis\u00e3o, as vaz\u00f5es dos produtos finais e o lucro \n\noperacional bruto obtido na unidade de produ\u00e7\u00e3o de propeno.  \n\nNessa otimiza\u00e7\u00e3o foram consideradas 13640 vari\u00e1veis, 13634 equa\u00e7\u00f5es, 6 graus de \n\nliberdade e 22 restri\u00e7\u00f5es de desigualdade. Pelas caracter\u00edsticas e pelas dificuldades \n\nque apresenta o software EMSO referente ao arquivo de dados iniciais (n\u00e3o \u00e9 \n\nautom\u00e1tica a atualiza\u00e7\u00e3o desse arquivo) para \u00e0 otimiza\u00e7\u00e3o, o tempo computacional \n\nna resolu\u00e7\u00e3o do problema de otimiza\u00e7\u00e3o n\u00e3o ser\u00e1 considerado neste trabalho. \n\nNesta tabela pode-se observar que o lucro bruto operacional vai de 68947.75 ($/h) \n\npara 71622.92 ($/h) o que significa, que considerando uma estrutura centralizada, \n\ncom a otimiza\u00e7\u00e3o o processo incrementar\u00e1 seu lucro bruto operacional em 3.88%, \n\nesse incremento se deve ao cambio de pontos de opera\u00e7\u00e3o.  \n\n \n\n \n\n\n\n78 \n \n\nTabela 4.2 - Resultados da simula\u00e7\u00e3o e a otimiza\u00e7\u00e3o do processo estudado. \n\nFun\u00e7\u00e3o Objetivo  \nMax Lucro = Pre\u00e7o dos Produtos \u2013 Custo \n\nVaz\u00e3o de Carga \u2013 Custos de Opera\u00e7\u00e3o  \n\nColuna Vari\u00e1veis  Simula\u00e7\u00e3o (Projeto)  Otimiza\u00e7\u00e3o  \n\nT-1 \n\nVaz\u00e3o do Produto P1 (Kg/h) 8181.74 8158.40 \n\nVaz\u00e3o de Produto P2 (Kg/h) 3506.46 3496.46 \n\nVaz\u00e3o da Corrente 5 (Kg/h) 9919.08 9952.42 \n\nSplitter de Refluxo SR1  0.676000 0.671093 \n\nSplitter de Reboiler SB1 0.772000 0.770792 \n\nT-2 \n\nVaz\u00e3o do Produto P3 (Kg/h) 742.850 351.064 \n\nVaz\u00e3o da Corrente 17 (Kg/h) 9176.22 9601.36 \n\nSplitter de Refluxo SR2 0.949000 0.976064 \n\nSplitter de Reboiler SB2 0.720000 0.707796 \n\nT-3 \n\nVaz\u00e3o do Produto P5 (Kg/h) 6542.86 6921.86 \n\nPureza do Produto P5 (Propeno % \nmolar)  \n\n0.999900 0.995001 \n\nVaz\u00e3o do Produto P4 (Kg/h) 2633.36 2679.5 \n\nPureza do Produto P4 (Propeno % \nmolar)  \n\n0.028100 0.023879 \n\nSplitter de Refluxo SR3 0.076480 0.080226 \n\nSplitter SC1 0.209030 0.213737 \n\nLucro ($/h) 68947.75 71622.92 \n\nFonte: Dados da planta e resultados obtidos. \n\n \n\nDevido aos pre\u00e7os de mercado os produtos P1 e P2 diminuem suas vaz\u00f5es de \n\n8181.74 (kg/h) e 3506.46 (kg/h) para 8158.4 (kg/h) e 3496.46 (kg/h) \n\nrespectivamente. Como consequ\u00eancia, a corrente intermedi\u00e1ria 5 \u00e9 incrementada de \n\n9919.08 (kg/h) para 9952.42 (kg/h). J\u00e1 na coluna T-2 o produto P3, tamb\u00e9m devido \n\nao seu pre\u00e7o de mercado, diminui sua vaz\u00e3o de 742.85 (kg/h) para 351.064 (kg/h). A \n\ncorrente intermediaria 17 incrementa sua vaz\u00e3o de 9176.22 (kg/h) para 9601.36 \n\n(kg/h). Na coluna T-3 tanto a vaz\u00e3o do produto P5 (propeno) e P4 (propano) s\u00e3o \n\nincrementados. Esse incremento se deve a que o pre\u00e7o de mercado de propeno \u00e9 \n\nfavor\u00e1vel (maior), ent\u00e3o, na otimiza\u00e7\u00e3o tentara produzir a maior vaz\u00e3o poss\u00edvel de \n\npropeno o que significa que a restri\u00e7\u00e3o de pureza tem que bater no limite inferior \n\n(99.5%) que \u00e9 como acontece neste processo estudado. Estes valores obtidos ser\u00e3o \n\nutilizados para ser comprados com os valores das vaz\u00f5es e o lucro bruto operacional \n\na ser obtidos considerando uma estrutura distribu\u00edda.  \n\n\n\n79 \n \n\n5. APLICA\u00c7\u00c3O DAS T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O AO PROCESSO \n\nESTUDADO \n\n \n\nNesta se\u00e7\u00e3o \u00e9 apresentada a aplica\u00e7\u00e3o das t\u00e9cnicas mais promissoras para resolver \n\no problema de decomposi\u00e7\u00e3o para a otimiza\u00e7\u00e3o da unidade de produ\u00e7\u00e3o de propeno \n\ndescrita na se\u00e7\u00e3o anterior. S\u00e3o analisadas as respostas e discutidos os problemas \n\nque apresentam essas t\u00e9cnicas.  \n\n \n\n5.1. T\u00c9CNICAS DE DECOMPOSI\u00c7\u00c3O APLICADAS AO PROCESSO ESTUDADO \n\n \n\nO problema pode ser decomposto em subproblemas para cada uma das divis\u00f5es, \n\nsendo S-1 para a divis\u00e3o da Depropanizador, S-2 para a divis\u00e3o da De-etanizadora \n\ne S-3 para a divis\u00e3o da fracionadora de propeno. Na figura 5.1 pode-se observar \n\numa estrutura que pode ser decomposta em tr\u00eas subproblemas, no entanto \u00e9 preciso \n\nadicionar e/ou substituir novas vari\u00e1veis e equa\u00e7\u00f5es ao modelo descrito na se\u00e7\u00e3o 4. \n\nEstas vari\u00e1veis correspondem aos produtos intermedi\u00e1rios de cada uma das \n\ndivis\u00f5es.  \n\nEnt\u00e3o o problema de otimiza\u00e7\u00e3o para o processo estudado tem a seguinte estrutura: \n\nMaximizar    Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3   \n\nsujeito a: \n\n  Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\n  Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\n  Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\n    5S1 = 5S2 \n\n            17S2 = 17S3 \n\nOnde Pr1, Pr2, Pr3, Pr4 e Pr5 s\u00e3o os pre\u00e7os de mercado dos produtos P1, P2, P3, P4 e \n\nP5 respectivamente. Pc \u00e9 o custo da vaz\u00e3o de carga F e Cops-1, Cops-2 e Cops-3 s\u00e3o \n\nos custos operacionais das divis\u00f5es S-1, S-2 e S-3 respectivamente. \n\n \n\n \n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nF\nig\n\nu\nra\n\n 5\n.1\n\n -\n F\n\nlu\nx\no\n\ng\nra\n\nm\na\n\n s\nim\n\np\nlif\n\nic\na\nd\n\no\n d\n\na\n u\n\nn\nid\n\na\nd\n\ne\n d\n\ne\n p\n\nro\nd\n\nu\n\u00e7\n\u00e3\n\no\n d\n\ne\n p\n\nro\np\ne\n\nn\no\n d\n\ne\nc\no\n\nm\np\n\no\ns\nta\n\n \n\ne\nm\n\n t\nr\u00ea\n\ns\n s\n\nu\nb\n\np\nro\n\nb\nle\n\nm\na\n\ns\n. \n\n80 \n\nF\no\n\nn\nte\n\n: \nE\n\nla\nb\n\no\nra\n\n\u00e7\n\u00e3\n\no\n p\n\nr\u00f3\np\n\nri\na\n\n e\nm\n\n b\na\n\ns\ne\n a\n\n d\na\n\nd\no\ns\n d\n\no\n p\n\nro\nje\n\nto\n. \n\n\n\n81 \n \n\nNa aplica\u00e7\u00e3o desta t\u00e9cnica foram utilizados os mesmos valores da otimiza\u00e7\u00e3o com \n\nestrutura centralizada descrita na se\u00e7\u00e3o 4 para: os pre\u00e7os de mercado dos produtos \n\nfinais, a vaz\u00e3o de carga da T-1, o consumo energ\u00e9tico, o consumo de \u00e1gua de \n\nresfriamento e o consumo de vapor para os reboilers. \n\nAs vari\u00e1veis 5S1 e 5S2 representam a corrente intermedi\u00e1ria entre S-1 e S-2 \n\nrespectivamente, e 17S2 E 17S3 e 17S3 s\u00e3o as vaz\u00f5es da corrente intermediaria \n\nentre S-2 e S-3 como mostra a figura 5.1. \n\nPor meio das t\u00e9cnicas de decomposi\u00e7\u00e3o, o problema primal foi decomposto em tr\u00eas \n\nsubproblemas correspondentes a cada uma das divis\u00f5es. Pretende-se atingir o \n\nmaior lucro poss\u00edvel da unidade de produ\u00e7\u00e3o de propeno, otimizando \n\nseparadamente cada uma das divis\u00f5es. \n\n \n\n5.1.1. Decomposi\u00e7\u00e3o Lagrangeana aplicada ao Processo Estudado \n\n \n\nDe acordo com esta t\u00e9cnica, identificadas as restri\u00e7\u00f5es complicadoras, o problema \n\nprimal \u00e9 relaxado, levando as restri\u00e7\u00f5es complicadoras para a fun\u00e7\u00e3o objetivo. Como \n\nexistem duas restri\u00e7\u00f5es complicadoras, e por conceitos de dualidade ser\u00e3o \n\nadicionados dois multiplicadores de Lagrange,  ?1 para a restri\u00e7\u00e3o 5S1 = 5S2 e ?2 \n\npara a restri\u00e7\u00e3o 17S2 = 17S3. \n\nA fun\u00e7\u00e3o Lagrangeana fica: \n\nL= Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3 \n\n     +?1.(5S1-5S2) + ?2.( 17S2-17S3) \n\nEnt\u00e3o o problema de otimiza\u00e7\u00e3o relaxado fica: \n\nMax   Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3             \n\n+ ?1.(5S1-5S2) + ?2.( 17S2-17S3) \n\nsujeito a: \n\n        Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\n        Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\n        Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\n\n\n82 \n \n\nAssim, seguindo o algoritmo mostrado no capitulo 3 da t\u00e9cnica de decomposi\u00e7\u00e3o por \n\nrelaxa\u00e7\u00e3o Lagrangeana, considerando tr\u00eas subproblemas para cada se\u00e7\u00e3o da \n\nunidade, t\u00eam-se: \n\nPasso 0: Inicializa\u00e7\u00e3o \n\n  v = 1 \n\n  ?1\n(v)\n\n = ?1\n0\n = 1.62 $/kg \n\n  ?2\n(v)\n\n  = ?2\n0\n = 2.52 $/kg \n\n  a = 1 \n\n  b = 0.1 \n\n  ? = 0.01 \n\nOs valores de ?1\n0\n e ?2\n\n0\n foram designados arbitrariamente com base nos pre\u00e7os de \n\nmercado dos co-produtos da se\u00e7\u00e3o S-1 e S-2. Para os par\u00e2metros a e b, foram \n\nconsiderados valores sugeridos pela literatura (Conejo et al., 2006). A diferen\u00e7a \n\naceit\u00e1vel entre os multiplicadores de duas itera\u00e7\u00f5es consecutivas \u00e9 de 0.01. \n\nPasso 1: Resolver o problema primal relaxado decomposto em tr\u00eas subproblemas \n\ncomo se mostra a seguir: \n\nSubproblema para a divis\u00e3o da deporpanizadora (S-1): \n\n  Max   Pr1.P1 + Pr2.P2 - Pc.F - Cops-1 + ?1\n(v)\n\n.5S1\n(v)\n\n    \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\nSubproblema para a divis\u00e3o da De-etanizadora (S-2): \n\n  Max   Pr3.P3 - Cops-2 - ?1\n(v)\n\n.5S2\n(v)\n\n + ?2\n(v)\n\n.17S2\n(v)\n\n    \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\nSubproblema para a divis\u00e3o da fracionadora de propeno (S-3): \n\n  Max  Pr4.P4 + Pr5.P5 - Cops-3  - ?2\n(v)\n\n.17S3\n(v)\n\n    \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\n\n\n83 \n \n\ncujas solu\u00e7\u00f5es ser\u00e3o denotadas como: 5S1\n(v)\n\n, 5S2\n(v)\n\n, 17S2\n(v)\n\n, 17S3\n(v)\n\n. \n\nPasso 2: Atualiza\u00e7\u00e3o do Multiplicador. \n\nPara atualizar o multiplicador, ser\u00e1 utilizado o m\u00e9todo do sub-gradiente, \n\nprovavelmente a sugest\u00e3o mais cl\u00e1ssica da literatura. \n\nFazendo  k\n(v)\n\n = \n?\n\n?? ?.?\n  onde k \u00e9 a constante de relaxa\u00e7\u00e3o. \n\nPara primeiro multiplicador ?1 \n(v+1)\n\n  \n\n?1\n (v+1)\n\n = ?1\n (v)\n\n + k\n(v)\n\n \n??\n\n(?)\n\n????\n(?)??\n\n \n\nem que \n\nS1\n(v)\n\n = 5S2\n(v)  \n\n- 5S1\n(v)\n\n \n\nPara segundo multiplicador ?2 \n(v+1)\n\n  \n\n?2\n (v+1)\n\n = ?2\n (v)\n\n + k\n(v)\n\n \n??\n\n(?)\n\n????\n(?)??\n\n \n\nem que \n\nS2\n(v)\n\n  = 17S3\n(v) \n\n- 17S2\n(v)\n\n \n\nPasso 3: Revis\u00e3o de Converg\u00eancia (Crit\u00e9rio de parada). \n\nNeste passo, se: \n\n|?1\n (v+1)\n\n - ?1\n (v)\n\n | ? ? \n\ne \n\n|?2\n (v+1)\n\n - ?2\n (v)\n\n | ? ? \n\nent\u00e3o as desigualdades est\u00e3o satisfeitas e pode-se parar o algoritmo j\u00e1 que a \n\nsolu\u00e7\u00e3o \u00f3tima foi encontrada, neste caso, a solu\u00e7\u00e3o \u00e9: 5S1*= 5S1\n(v)\n\n, 5S2*= 5S2\n(v)\n\n, \n\n17S2*= 17S2\n(v)\n\n, 17S3*= 17S3\n(v)\n\n. Caso contr\u00e1rio, voltar ao passo 1. \n\nPara a aplica\u00e7\u00e3o desta t\u00e9cnica foram modeladas, simuladas e otimizadas as tr\u00eas \n\ndivis\u00f5es de forma separada e com as mesmas caracter\u00edsticas do computador citados \n\nna se\u00e7\u00e3o 4. A divis\u00e3o da Depropanizadora para a otimiza\u00e7\u00e3o conta com 2393 \n\n\n\n84 \n \n\nvari\u00e1veis, 2391 equa\u00e7\u00f5es de igualdade e 8 equa\u00e7\u00f5es de desigualdade pelo que esta \n\ndivis\u00e3o tem 2 graus de liberdade. As duas vari\u00e1veis de decis\u00e3o s\u00e3o o splitter do \n\nrefluxo (SR1) e o splitter do reboiler (SB1).  \n\nA divis\u00e3o da De-etanizadora, para a otimiza\u00e7\u00e3o s\u00e3o utilizadas 2746 vari\u00e1veis, 2743 \n\nequa\u00e7\u00f5es de igualdade e   10 equa\u00e7\u00f5es de desigualdade, pelo que esta divis\u00e3o tem  \n\n3 graus de liberdade. As tr\u00eas vari\u00e1veis de decis\u00e3o s\u00e3o a corrente de carga da \n\nsegunda divis\u00e3o (5S2), o splitter do refluxo (SR2) e o splitter do reboiler (SB2). \n\nA terceira divis\u00e3o (fracionadora de propeno) para a otimiza\u00e7\u00e3o foram utilizadas 8510 \n\nvari\u00e1veis, 8507 equa\u00e7\u00f5es de igualdade e 10 equa\u00e7\u00f5es de desigualdade, pelo que \n\neste problema de otimiza\u00e7\u00e3o tem 3 graus de liberdade. As tr\u00eas vari\u00e1veis de decis\u00e3o \n\ns\u00e3o a corrente de alimenta\u00e7\u00e3o para a T-3 (17S3), o splitter do refluxo (SR3)   o \n\nsplitter que esta na sa\u00edda do compressor (SC1). \n\nOs resultados das itera\u00e7\u00f5es da decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana s\u00e3o \n\nmostrados na seguinte tabela: \n\n \n\nTabela 5.1 - Respostas da relaxa\u00e7\u00e3o Lagrangeana. \n\nItera\u00e7\u00e3o # ?1 ?2 \n5S1 \n\n(kg/h) \n5S2 \n\n(kg/h) \n17S2 \n(kg/h) \n\n17S3 \n(kg/h) \n\nP5 \n(kg/h) \n\n1 1.620 2.520 9885.44 10772.40 10061.80 10061.80 7261.30 \n\n2 3.256 2.520 9964.36 4939.00 4613.64 10061.80 7261.30 \n\n3 1.756 4.020 9885.48 10772.50 10061.80 10061.80 7261.32 \n\n4 3.141 4.020 9964.62 10429.28 10061.80 10061.80 7261.32 \n\n5 4.427 4.020 9963.90 4939.00 4766.86 10061.80 7261.32 \n\n6 3.227 5.220 9964.76 10429.32 10061.80 4573.60 3300.30 \n\n7 4.352 4.095 9964.76 4939.02 4767.00 10061.80 7262.76 \n\n8 3.293 5.154 9964.54 10429.26 10061.80 4573.60 3299.06 \n\n9 4.293 4.154 9964.74 4939.00 4766.98 10061.80 7262.80 \n\n10 3.346 5.101 9964.74 10429.26 10061.80 4573.60 3300.44 \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria em base as respostas obtidas. \n\n \n\nNesta t\u00e9cnica, com os valores iniciais de ?1 e ?2, os subproblemas podem ser \n\nresolvidos separadamente para determinar os valores das correntes intermedi\u00e1rias \n\n5S1, 5S2, 17S2 e 17S3. Os multiplicadores de Lagrange s\u00e3o ajustados \n\nrepetidamente at\u00e9 que a restri\u00e7\u00e3o de consist\u00eancia seja satisfeita. Embora esta seja \n\numa t\u00e9cnica amplamente empregada, n\u00e3o pode resolver este problema espec\u00edfico: \n\nn\u00e3o h\u00e1 ?1 e ?2 capazes de garantir que a restri\u00e7\u00e3o complicadora de consist\u00eancia  \n\n\n\n85 \n \n\nseja satisfeita, pelo que tem um comportamento oscilat\u00f3rio (ver Figura 5.2) e n\u00e3o \n\nconsegue convergir. \n\n \n\nFigura 5.2 - Problema de converg\u00eancia da decomposi\u00e7\u00e3o Lagrangeana. \n\n \n Fonte: Elabora\u00e7\u00e3o Pr\u00f3pria. \n\n \n\nS\u00f3 foram realizadas 10 itera\u00e7\u00f5es j\u00e1 que estas s\u00e3o suficientes para mostrar o \n\ncomportamento oscilat\u00f3rio dos valores dos multiplicadores de Lagrange e das \n\nvaz\u00f5es de carga das divis\u00f5es S1 e S2, este comportamento acontece devido as \n\nseguintes causas (Jose e Ungar, 2000): \n\nCausa 1: Divis\u00f5es indiferentes. \n\nQuando uma ou mais divis\u00f5es s\u00e3o indiferentes ao valor de um estado de fluxo entre \n\nprocessos, a substitui\u00e7\u00e3o de Lagrange falhar\u00e1. Esta falha pode ser explicada \n\nutilizando o m\u00e9todo dos multiplicadores de Lagrange. Considere o seguinte \n\nproblema de otimiza\u00e7\u00e3o \n\n  Maxx1,x2  \u0192(x1,x2)  \n\n  sujeito a:   \n\n     Restri\u00e7\u00f5es x1 \n\n     Restri\u00e7\u00f5es x2 \n\n     g(x1,x2) &lt;0 \n\nA solu\u00e7\u00e3o para este problema pode ser encontrada atrav\u00e9s da representa\u00e7\u00e3o gr\u00e1fica \n\nda restri\u00e7\u00e3o g(x) = 0 e os conjuntos de n\u00edvel de f(x) em um \u00fanico gr\u00e1fico. A solu\u00e7\u00e3o \n\n1.0\n\n2.0\n\n3.0\n\n4.0\n\n5.0\n\n1 2 3 4 5 6 7 8 9 10\n\nM\nu\nlt\nip\n\nlic\na\nd\no\n\nre\ns\n d\n\ne\n L\n\na\ng\nra\n\nn\ng\ne\n\nItera\u00e7\u00e3o #\n\n?1\n\n?2\n\n\n\n86 \n \n\nocorre onde a fun\u00e7\u00e3o objetivo \u00e9 tangente \u00e0 curva da restri\u00e7\u00e3o no ponto \u00f3timo, o que \n\nsignifica que neste ponto, os gradientes da fun\u00e7\u00e3o objetivo e da restri\u00e7\u00e3o s\u00e3o \n\nlinearmente dependentes. Uma ilustra\u00e7\u00e3o desse fato est\u00e1 apresentada na figura 5.3, \n\nem que x1 e x2 s\u00e3o as vari\u00e1veis independentes, f(x) \u00e9 a fun\u00e7\u00e3o objetivo, C1, C2 e C3 \n\ns\u00e3o os valores da fun\u00e7\u00e3o objetivo com C1 &lt;C2 &lt;C3 e g(x) \u00e9 a restri\u00e7\u00e3o ativa de \n\ndesigualdade. Esta condi\u00e7\u00e3o de depend\u00eancia linear pode ser definida como: \n\n?\u0192(x*) = ?.\t?g(x*) \n\nem que ? \u00e9 o multiplicador de Lagrange e x* \u00e9 a solu\u00e7\u00e3o \u00f3tima. \n\n \n\nFigura 5.3 - Depend\u00eancia linear dos gradientes. \n\n \n Fonte: Jose e Ungar (2000). \n\n \n\nAgora, considerando um problema similar, mas menos complexo que o problema \n\nestudado, tem-se: \n\n  Maxx1,x2  \u0192(x1,x2)  \n\n  sujeito a: \n\n     Restri\u00e7\u00f5es x1 \n\n     Restri\u00e7\u00f5es x2 \n\n     h(x1,x2) =  0 \n\nFazendo um gr\u00e1fico para a restri\u00e7\u00e3o x1 - x2 = 0 e os conjuntos de n\u00edvel da fun\u00e7\u00e3o \n\nobjetivo, como mostra a figura 5.4, pode-se observar que os conjuntos de n\u00edvel da \n\nfun\u00e7\u00e3o objetivo e as restri\u00e7\u00f5es nunca s\u00e3o tangentes. A condi\u00e7\u00e3o ?f = ?.?h \n\n(depend\u00eancia linear) \u00e9 verdadeira apenas quando ?f = 0 e ? = 0. Esta pode ser a \n\nresposta correta para o problema antes que ele seja decomposto, mas depois da \n\n\n\n \n\ndecomposi\u00e7\u00e3o um multiplicador de Lagrange igual a\n\nmultiplicador desse tipo implica que a restri\u00e7\u00e3o de consist\u00ea\n\nAssim, a decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana n\u00e3o pode ser aplicada neste \n\ntipo de problema. \n\n \n\nFigura 5.4 - Depend\u00eancia\n\n Fonte: Jose e Ungar (2000).\n\nCausa 2: Divis\u00f5es com objetivos lineares\n\nConsidere o seguinte problema de otimiza\u00e7\u00e3o\n\n  Maxx1,x2  \n\n  Sujeito a: \n\n     \n\n     \n\n     \n\nem que k1, k2 ? 0 e x1, x2  \n\nLagrangeana obt\u00e9m-se os seguintes \n\n  Maxx1   \n\n  Sujeito a: \n\n     \n\ne \n\n  Maxx2   \n\n  Sujeito a:  \n\n     \n\num multiplicador de Lagrange igual a zero \u00e9 in\u00fatil\n\nimplica que a restri\u00e7\u00e3o de consist\u00eancia pode ser ignorada\n\ndecomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana n\u00e3o pode ser aplicada neste \n\nDepend\u00eancia linear dos gradientes para o problema estudado\n\n \ngar (2000). \n\n \n\nivis\u00f5es com objetivos lineares. \n\nConsidere o seguinte problema de otimiza\u00e7\u00e3o \n\n k1.x1 + k2.x2 \n\n Restri\u00e7\u00f5es da divis\u00e3o 1 \n\n Restri\u00e7\u00f5es da divis\u00e3o 2 \n\n x1 = x2 \n\n  ? R. Aplicando a t\u00e9cnica de decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o\n\nos seguintes subproblemas \n\n k1.x1 + ?.x1 \n\n Restri\u00e7\u00f5es da divis\u00e3o 1 \n\n k2.x2 - ?.x2 \n\n \n\n Restri\u00e7\u00f5es da divis\u00e3o 2 \n\n87 \n\nzero \u00e9 in\u00fatil, pois um \n\nncia pode ser ignorada. \n\ndecomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana n\u00e3o pode ser aplicada neste \n\nlinear dos gradientes para o problema estudado. \n\nde decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o \n\n\n\n88 \n \n\nSe ? > - k1, a divis\u00e3o 1 prop\u00f5e o seu valor m\u00e1ximo poss\u00edvel de x1; se ? &lt;- k1, a \n\ndivis\u00e3o 1 prop\u00f5e a seu m\u00ednimo valor poss\u00edvel. Da mesma forma, se ? > k2, a divis\u00e3o \n\n2 prop\u00f5e seu valor m\u00ednimo poss\u00edvel de x2; se ? &lt;k2, a divis\u00e3o 2 prop\u00f5e o seu valor \n\nm\u00e1ximo poss\u00edvel.  Uma vez que, em geral, todas estas poss\u00edveis propostas s\u00e3o \n\ndiferentes, n\u00e3o h\u00e1 um ? capaz de garantir que a restri\u00e7\u00e3o x1 = x2 seja satisfeita. \n\nAssim, o problema de decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana n\u00e3o ir\u00e1 convergir. \n\nA resposta obtida do caso estudado \u00e9 mostrada nas seguintes figuras. \n\nPode-se observar na figura 5.5 que as vaz\u00f5es, dependendo do valor do multiplicador \n\nde Lagrange, s\u00e3o dadas por um limite de capacidade. Para o subproblema da T-1 \n\n(5S1) n\u00e3o existe muita varia\u00e7\u00e3o j\u00e1 que a corrente de entrada \u00e9 fixada e tamb\u00e9m por \n\nque os limites de pureza de topo e fundo s\u00e3o muito fortes (99.9 % e 1% molar \n\nrespectivamente). \n\n \n\nFigura 5.5 - Vaz\u00e3o corrente intermedi\u00e1ria 5S1-5S2. \n\n \n     Fonte: Elabora\u00e7\u00e3o pr\u00f3pria. \n\n \n\nNa figura 5.6 mostra-se que a causa do valor do multiplicador de Lagrange (?2) para \n\na corrente intermediaria 17S3 \u00e9 mantida constante no limite m\u00e1ximo de capacidade \n\noperacional da coluna T-3 durante as 5 primeiras itera\u00e7\u00f5es, isso se deve a que o \n\nvalor de ?2 \u00e9 menor ao pre\u00e7o de mercado do produto P5 o que significa que essa \n\ndivis\u00e3o consegue gerar lucro e por conseguinte processar\u00e1 a m\u00e1xima vaz\u00e3o \n\nposs\u00edvel. \n\n4000\n\n5000\n\n6000\n\n7000\n\n8000\n\n9000\n\n10000\n\n11000\n\n1 2 3 4 5 6 7 8 9 10\n\nV\na\nz\n\u00e3\no\n\nItera\u00e7\u00e3o #\n\n5D_1\n\n5D_2\n\nEstruc. Cent.\n\n\n\n89 \n \n\nDe acordo com o valor do multiplicador e os pre\u00e7os de mercado dos coprodutos, h\u00e1 \n\noscila\u00e7\u00f5es entre uma produ\u00e7\u00e3o m\u00e1xima ou m\u00ednima.  Portanto, como a corrente de \n\nentrada da T-1, \u00e9 fixada as vaz\u00f5es de carga das colunas T-2 e T-3 tem que \n\nconvergir num ponto intermedi\u00e1rio e n\u00e3o em um m\u00e1ximo ou m\u00ednimo de capacidade, \n\nent\u00e3o o problema de decomposi\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana n\u00e3o ir\u00e1 convergir.   \n\n \n\nFigura 5.6 - Vaz\u00e3o corrente intermediaria 17S2-17S3. \n\n \n\n     Fonte: Elabora\u00e7\u00e3o pr\u00f3pria. \n\n \n\nDevido a n\u00e3o existir converg\u00eancia dos multiplicadores de Lagrange devido \u00e0s causas \n\napresentadas, a decomposi\u00e7\u00e3o pelo m\u00e9todo de relaxa\u00e7\u00e3o Lagrangeana n\u00e3o \u00e9 \n\nrecomendada para este tipo de problemas.  \n\nComo o m\u00e9todo de Lagrangeano aumentado \u00e9 baseado no m\u00e9todo de relaxa\u00e7\u00e3o \n\nLagrangeana, este tamb\u00e9m vai apresentar os mesmos problemas pelo que n\u00e3o ser\u00e1 \n\nrealizada a aplica\u00e7\u00e3o desta t\u00e9cnica. \n\n \n\n5.1.2. Pricing Interprocess Streams Using Slack Auctions Aplicada ao \n\nProcesso Estudado \n\n \n\nDe acordo com esta t\u00e9cnica, uma vez identificadas as restri\u00e7\u00f5es complicadoras, o \n\nproblema de otimiza\u00e7\u00e3o global \u00e9 relaxado, colocando assim as restri\u00e7\u00f5es \n\ncomplicadoras multiplicadas pelo pre\u00e7o (p). Como existem duas restri\u00e7\u00f5es \n\n4000\n\n5000\n\n6000\n\n7000\n\n8000\n\n9000\n\n10000\n\n11000\n\n1 2 3 4 5 6 7 8 9 10\n\nV\na\nz\n\u00e3\no\n\nItera\u00e7\u00e3o #\n\n17D_2\n\n17D_3\n\nEstruc. Cent.\n\n\n\n90 \n \n\ncomplicadoras, ser\u00e3o adicionados dois multiplicadores : p1 para a restri\u00e7\u00e3o 5S1 = \n\n5S2 e p2 para a restri\u00e7\u00e3o 17S2 = 17S3. \n\nEnt\u00e3o seguindo o algoritmo mostrado na se\u00e7\u00e3o 3 da t\u00e9cnica de decomposi\u00e7\u00e3o por \n\npricing interprocess streams using slack auctions, considerando tr\u00eas subproblemas \n\npara cada se\u00e7\u00e3o da unidade, tem-se: \n\nPasso 0: Inicializa\u00e7\u00e3o. \n\nFornecer valores iniciais para \n\nv = 1 \n\np\n(v)\n\n1 =  1.62 $/kg \n\np\n(v)\n\n2 =  2.52 $/kg \n\n5S1\n0\n = 9919 kg/h \n\n5S2\n0\n = 9919 kg/h \n\n17S2\n0\n = 9176.22 kg/h \n\n17S3\n0\n = 9176.22 kg/h \n\nS1 = 0.01 kg/h (Folga de recursos Restri\u00e7\u00e3o complicadora 1) \n\nS2 = 0.01 kg/h (Folga de recursos Restri\u00e7\u00e3o complicadora 2) \n\nPasso 1: Resolver os subproblemas. \n\nO subproblema para a divis\u00e3o da depropanizadora (S-1): \n\n Max   Pr1.P1 + Pr2.P2 \u2013 p1\n(v)\n\n.\u00bd .|5S1\n(v) \n\n\u2013 5S2\n0\n| - Prc.F - CopS-1    \n\n sujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\nO subproblema para a divis\u00e3o da De-etanizadora (S-2): \n\n Max  Pr3.P3 \u2013 p1\n(v)\n\n.| 5S2\n(v)\n\n \u2013 5S1\n0 \n\n| - p2\n(v)\n\n.|17S2\n (v) \n\n\u2013 17S3\n0\n| - CopS-2\n\n    \n\n sujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\nO subproblema para a divis\u00e3o da Fracionadora de Propeno (S-3): \n\n Max   Pr4.P4 + Pr5.P5  \u2013 p2\n(v)\n\n.| 17S3\n (v) \n\n\u2013 17S2\n0\n| - CopS-3    \n\n\n\n91 \n \n\n sujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\nem que as solu\u00e7\u00f5es ser\u00e3o denotadas como: 5S1\n(v)\n\n, 5S2\n(v)\n\n, 17S2\n(v)\n\n, 17S3\n(v)\n\n. \n\nPasso 2: Crit\u00e9rio de Converg\u00eancia. \n\nSe |5S1\n(v)\n\n \u2013 5S2\n(v)\n\n| ? S1 , e, |17S2\n(v)\n\n, 17S3\n(v)\n\n| ? S2 ent\u00e3o a solu\u00e7\u00e3o foi encontrada, \n\ncaso contr\u00e1rio passa-se ao passo 3. \n\nPasso 3: Atualizar os valores de refer\u00eancia. \n\n  5S1\n0\n  ? 5S2\n\n(v)\n \n\n  5S2\n0\n  ? 5S1\n\n(v)\n \n\n  17S2\n0\n ? 17S3\n\n(v) \n\n  17S3\n0\n ? 17S2\n\n(v)\n \n\nPara ajustar os pre\u00e7os de p1\n(v)\n\n e p2\n(v)\n\n por leil\u00e3o \u00e9 utilizado o excesso de demanda \n\nE1\n(v)\n\n e E2\n(v)\n\n:  \n\nSe E1\n(v) \n\n= 5S2\n(v)\n\n - 5S1\n(v)\n\n &lt;0 ent\u00e3o p1\n(v)\n\n tem que baixar seu valor de pre\u00e7o, se E1\n(v) \n\n= \n\n5S2\n(v)\n\n - 5S1\n(v)\n\n > 0 ent\u00e3o p1\n(v)\n\n tem que incrementar seu valor de pre\u00e7o. \n\nSe E2\n(v) \n\n= 17S3\n(v)\n\n- 17S2\n(v)\n\n &lt;0 ent\u00e3o p2\n(v)\n\n tem que baixar seu valor de pre\u00e7o, se E1\n(v) \n\n= \n\n17S3\n(v) \n\n- 17S2\n(v)\n\n > 0 ent\u00e3o p2\n(v)\n\n tem que incrementar seu valor de pre\u00e7o. \n\nE por ultimo voltar para o passo 1. \n\nOs resultados das itera\u00e7\u00f5es desta t\u00e9cnica s\u00e3o mostrados na tabela 5.2. Na \n\notimiza\u00e7\u00e3o com estrutura distribu\u00edda utilizando este m\u00e9todo de decomposi\u00e7\u00e3o foram \n\nconsiderados, para a divis\u00e3o S-1, 2393 vari\u00e1veis, 2391 equa\u00e7\u00f5es e 6 restri\u00e7\u00f5es de \n\ndesigualdade, o que significa que essa divis\u00e3o tem 2 graus de liberdade. Na divis\u00e3o \n\nS-2 foram utilizadas 2746 vari\u00e1veis, 2743 equa\u00e7\u00f5es e 10 restri\u00e7\u00f5es de desigualdade, \n\ndando lugar a 3 graus de liberdade para essa divis\u00e3o. J\u00e1 na divis\u00e3o S-3 foram \n\nutilizadas 8510 vari\u00e1veis, 8507 equa\u00e7\u00f5es e 10 restri\u00e7\u00f5es de desigualdade. Essa \n\ndivis\u00e3o tem 3 graus de liberdade.  \n\nNa tabela pode-se observar que a um pre\u00e7o (p1) de 7.02 $/kg atinge-se a maior \n\nvaz\u00e3o do produto intermedi\u00e1rio 5S1, j\u00e1 que a restri\u00e7\u00e3o de pureza de topo \u00e9 ativa \n\n(0.1% molar dos produtos pesados C4\n+\n) e a restri\u00e7\u00e3o de pureza de fundo \u00e9 inativa j\u00e1 \n\n\n\n92 \n \n\nque se procura produzir mais C3 como produto intermedi\u00e1rio. Isto acontece porque o \n\npeso na fun\u00e7\u00e3o objetivo para reduzir a diferen\u00e7a das vaz\u00f5es das correntes \n\nintermedi\u00e1rias entre as duas divis\u00f5es (S-1 e S-2) \u00e9 maior do que o pre\u00e7o dos \n\ncoprodutos P1 e P2. O pre\u00e7o adotado no leil\u00e3o n\u00e3o tem sentido econ\u00f4mico concreto, \n\nj\u00e1 que \u00e9 muito elevado, sendo inclusive maior do que o pre\u00e7o do produto principal \n\n(propeno) na S-3.  \n\nTabela 5.2 - Respostas pricing interprocess streams using slack auctions. \n\nItera\u00e7\u00e3o \n# \n\np1 \n($/kg) \n\np2    \n($/kg) \n\n5S1   \n(kg/h) \n\n5S2   \n(kg/h) \n\n17S2 \n(kg/h) \n\n17S3 \n(kg/h) \n\nP5   \n(kg/h) \n\n1 1.62 2.52 9880.1 9686.62 9046.68 10061.8 7259.84 \n\n2 3.42 4.32 9885.56 10772.92 10061.16 10061.8 7259.84 \n\n3 5.22 6.12 9952.32 10773.54 10061.74 10061.8 7259.84 \n\n4 7.02 7.92 9962.44 10405.92 9890.08 10061.8 7259.82 \n\n5 7.02 9.72 9960.80 10615.50 10061.80 10061.34 7259.52 \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria em base as respostas obtidas. \n\n \n\nA seguir mostra-se a formula\u00e7\u00e3o do problema de otimiza\u00e7\u00e3o para esta divis\u00e3o. \n\n Max   Pr1.P1 + Pr2.P2 \u2013 p1\n(v)\n\n.\u00bd .|5S1\n(v) \n\n\u2013 5S2\n0\n| - Prc.F - CopS-1    \n\n sujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\nEm que Pr1 e Pr2  s\u00e3o os pre\u00e7os de mercado dos produtos finais da S-1 que s\u00e3o \n\n1.6063 e 2.424 $/kg respectivamente, Prc \u00e9 o pre\u00e7o da vaz\u00e3o da carga (1.6063 $/kg) \n\ne CopS-1 \u00e9 o custo operacional desta se\u00e7\u00e3o. Como se pode observar, o algoritmo \n\nsempre vai tentar zerar a diferen\u00e7a |5S1\n(v) \n\n\u2013 5S2\n0\n| colocando um peso p1\n\n(v)\n, fazendo \n\ncom que o pre\u00e7o do produto intermedi\u00e1rio n\u00e3o tenha um significado econ\u00f4mico \n\nv\u00e1lido. \n\nJ\u00e1 na se\u00e7\u00e3o S-2 acontece o mesmo problema, j\u00e1 que para os valores apresentados \n\nnos pre\u00e7os de leil\u00e3o, que s\u00e3o superiores ao pre\u00e7o de mercado do propeno, sempre \n\ntenta-se produzir a maior vaz\u00e3o poss\u00edvel de etano. Isso fazcom que a restri\u00e7\u00e3o de \n\ntopo da T-2 seja ativa (35% molar de propano e propeno), o que significa que \n\nexistiria demasiado produto principal (propeno) saindo na vaz\u00e3o do etano. O \n\nproblema de otimiza\u00e7\u00e3o para esta se\u00e7\u00e3o \u00e9 mostrado a seguir: \n\n Max   Pr3.P3 \u2013 p1\n(v)\n\n.| 5S2\n(v)\n\n \u2013 5S1\n0 \n\n| - p2\n(v)\n\n.|17S2\n (v) \n\n\u2013 17S3\n0\n| - CopS-2\n\n  \n\n\n\n93 \n \n\nsujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\nEm que Pr3 \u00e9 o pre\u00e7o de mercado do produto final da S-2 (etano) que \u00e9 de 2.736 \n\n$/kg, CopS-2 \u00e9 o custo operacional desta se\u00e7\u00e3o. A situa\u00e7\u00e3o \u00e9 an\u00e1loga \u00e0 anterior, com \n\nas diferen\u00e7as | 5S2\n(v)\n\n \u2013 5S1\n0 \n\n| e |17S2\n (v) \n\n\u2013 17S3\n0\n| no qual o algoritmo sempre tenta \n\nzerar essas diferen\u00e7as. \n\nNa se\u00e7\u00e3o S-3, o problema que apresenta \u00e9 muito parecido \u00e0 t\u00e9cnica de relaxa\u00e7\u00e3o \n\nLagrangeana, isto devido a que os produtos finais tem um pre\u00e7o elevado, ent\u00e3o \n\nsempre vai tentar produzir a maior quantidade poss\u00edvel. A \u00fanica forma de se ter uma \n\nprodu\u00e7\u00e3o com uma quantidade intermedi\u00e1ria \u00e9 elevando o pre\u00e7o do leil\u00e3o, mas se \n\neste pre\u00e7o \u00e9 maior do que os dos produtos finais ent\u00e3o a divis\u00e3o teria um preju\u00edzo \n\npor causa da corrente intermedi\u00e1ria. O problema de otimiza\u00e7\u00e3o para esta divis\u00e3o \u00e9 \n\nmostrado a seguir: \n\n Max   Pr4.P4 + Pr5.P5  \u2013 p2\n(v)\n\n.| 17S3\n (v) \n\n\u2013 17S2\n0\n| - CopS-3    \n\n sujeito a: \n\n   Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\nEm que Pr4 e Pr5  s\u00e3o os pre\u00e7os de mercado dos produtos finais da S-3 que s\u00e3o \n\n1.6063; 6.273 $/kg respectivamente e CopS-3 \u00e9 o custo operacional desta se\u00e7\u00e3o. \n\nDesta vez apenas a diferen\u00e7a | 17S3\n (v) \n\n\u2013 17S2\n0\n| \u00e9 que tende a ser zerada atrav\u00e9s de \n\num peso p2\n(v)\n\n. \n\nNesta t\u00e9cnica os valores iniciais para o leil\u00f5es dos pre\u00e7os s\u00e3o incrementados at\u00e9 \n\nencontrar converg\u00eancia entre as correntes intermedi\u00e1rias, ou seja, que a diferen\u00e7a \n\nentre estas correntes seja menor a uma folga determinada no inicio do algoritmo. \n\nContudo, considerando que \u00e9 um processo com uma entrada e duas sa\u00eddas \n\n(produ\u00e7\u00e3o conjunta), esta t\u00e9cnica tenta maximizar a vaz\u00e3o de sa\u00edda do produto final \n\nde cada se\u00e7\u00e3o e n\u00e3o do produto intermedi\u00e1rio, perdendo assim a sensibilidade da \n\nprodu\u00e7\u00e3o com respeito ao pre\u00e7o. Isto ocorre porque ao colocar um peso (pre\u00e7o de \n\nleil\u00e3o) para a restri\u00e7\u00e3o complicadora, tenta-se zerar a diferen\u00e7a entre as correntes \n\nintermedi\u00e1rias das duas divis\u00f5es (ver figura 5.7). \n\n \n\n \n\n\n\n94 \n \n\nFigura 5.7 - Pricing interprocess streams using slack auctions aplicado ao processo de produ\u00e7\u00e3o \nconjunta - fun\u00e7\u00e3o objetivo dos subproblemas. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria. \n\n \n\nFeita a an\u00e1lise da aplica\u00e7\u00e3o deste m\u00e9todo pode-se determinar que n\u00e3o \u00e9 eficaz para \n\no tipo de problema estudado, ou seja, os pre\u00e7os de leil\u00e3o apresentados n\u00e3o fazem \n\nsentido econ\u00f4mico para problemas com produ\u00e7\u00e3o conjunta, ou seja onde existam \n\ncoprodutos. Normalmente este m\u00e9todo \u00e9 aplicado a processos que s\u00f3 tenham uma \n\nentrada e uma sa\u00edda, fazendo com que n\u00e3o exista a escolha de vaz\u00f5es de produtos \n\nfinais entre duas divis\u00f5es. \n\n \n\n5.1.3. Proposta modifica\u00e7\u00e3o do algoritmo de relaxa\u00e7\u00e3o Lagrangeana \n\n \n\nDepois de fazer uma analise dos problemas que apresentam as t\u00e9cnicas de \n\ndecomposi\u00e7\u00e3o estudadas, foi desenvolvida uma proposta de modifica\u00e7\u00e3o do \n\nalgoritmo a ser avaliada para resolu\u00e7\u00e3o de problemas de decomposi\u00e7\u00e3o na \n\notimiza\u00e7\u00e3o da unidade de produ\u00e7\u00e3o de propeno (figura 5.8) que \u00e9 apresentada a \n\ncontinua\u00e7\u00e3o: \n\n \n\n \n\nPr2*P3 \n\n \n\nT?1 - Prc*F \n\n - p1\n(v)\n\n* \u00bd *|5S1\n(v) \n\n\u2013 5S2\n0\n| \n\nPr1*P1 \n\nPr2*P2 \n\n- p1\n(v)\n\n*| 5S2\n(v)\n\n \u2013 5S1\n0 \n|  \n\n \n\nT?2 \n\n- p2\n(v)\n\n*|17S2\n (v) \n\n\u2013 17S3\n0\n| \n\n\u2013 p2\n(v)\n\n*| 17S3\n (v) \n\n\u2013 17S2\n0\n| \n\n \n\nT?3 \n\nPr5*P5 \n\nPr4*P4 \n\n\n\n95 \n \n\nFigura 5.8 - Fluxograma simplificado da unidade de produ\u00e7\u00e3o de propeno - algoritmo proposto. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \nFonte: Elabora\u00e7\u00e3o pr\u00f3pria. \n\n \n\nPara ilustrar a modifica\u00e7\u00e3o no algoritmo de resolu\u00e7\u00e3o de problemas por \n\ndecomposi\u00e7\u00e3o Lagrangeana, mostrado na figura 5.9 \u00e9 apresentado um fluxograma \n\ncom os passos do algoritmo que ser\u00e3o explicados a continua\u00e7\u00e3o: \n\nPasso 0: Inicializa\u00e7\u00e3o. \n\nConsiderando que o problema \u00e9 de maximiza\u00e7\u00e3o, o algoritmo inicia dando um valor \n\npara o contador de itera\u00e7\u00f5es v: \n\nv = 1 \n\nOs valores iniciais dos multiplicadores (?1\n0\n, ?2\n\n0\n) s\u00e3o fornecidos para a primeira \n\nitera\u00e7\u00e3o como \u00e9 mostrado a seguir: \n\n?1\n(v)\n\n = ?1\n(0)\n\n; ?2\n(v)\n\n = ?2\n(0) \n\nonde ?1\n0\n = 1.62 $/kg e ?2\n\n0\n = 2.52 $/kg. Estes valores foram atribu\u00eddos arbitrariamente \n\ncom base nos pre\u00e7os de mercados dos produtos finais em cada divis\u00e3o. \n\nAl\u00e9m de fornecer valores iniciais para os multiplicadores, \u00e9 preciso fornecer valores \n\niniciais para os limites de produ\u00e7\u00e3o dispon\u00edvel, estes valores iniciais s\u00e3o a \n\ncapacidade m\u00e1xima de produ\u00e7\u00e3o de cada divis\u00e3o. \n\n \n\n \n\nT?1 - Prc*F \n\n ?1*5S1\n(v) \n\n \n\nPr1*P1 \n\nPr2*P2 \n\n-?1*5S2\n(v)\n\n  \n\n \n\nT?2 \n\nPr2*P3 \n\n?2*17S2\n (v)\n\n \n\n-?2*17S3\n \n\n \n\nT?3 \n\nPr5*P5 \n\nPr4*P4 \n\n\n\n96 \n \n\nFigura 5.9 - Fluxograma do algoritmo proposto. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria. \n\n \n\nOnde: \n\nLPD1\n(0)\n\n = Capacidade de produ\u00e7\u00e3o da T-2 = 10772 kg/h. \n\nLPD2\n(0)\n\n = Capacidade de produ\u00e7\u00e3o da T-3 = 10061 kg/h. \n\n5S1(V) \n\n17S2(V) \n\nPasso 0: Inicializa\u00e7\u00e3o \n\nv = 1; ?1\n(v) = ?1\n\n(0); ?2\n(v) = ?2\n\n(0); a; b; ? \u00e9 definido; \n\nLPD1\n(v)\n\n = LPD1\n(0)\n\n; LPD2\n(v)\n\n = LPD2\n(0)\n\n;  \n\n \n\nPasso 2: Atualizar os multiplicadores: \n\nde  ?1\n(v)\n\n, ?2\n(v)\n\n para ?1\n(v+1)\n\n, ?2\n(v+1)\n\n; \n\nAtualizar os limites de produ\u00e7\u00e3o \n\ndispon\u00edvel: \n\nde  LPD1\n(v), LPD 2\n\n(v) para LPD 1\n(v+1), LPD 2\n\n(v+1); \n\n \n\nProblema mestre: M\u00e9todo do \n\nSubgradiente: \n\n?1\n(v+1) = ?1\n\n(v) + \n?\n\n?\t? \t?.?\n . \n(???(?)? ???(?))\n\n????(?)? ???(?)?\n \n\n?2\n(v+1)\n\n = ?2\n(v)\n\n + \n?\n\n?\t? \t?.?\n . \n(????(?)? ????(?))\n\n?????(?)? ????(?)?\n \n\nPara os limites de produ\u00e7\u00e3o dispon\u00edvel: \n\nLPD1\n(v+1)\n\n ? 5S1\n(v)\n\n; \n\nLPD2\n(v+1)\n\n ? 17S2\n(v)\n\n; \n\n \n\nPasso 3: Crit\u00e9rio de Converg\u00eancia: \n\n???\n(?? ?)\n\n? ??\n(?)\n\n?\t? ? ; ???\n(?? ?)\n\n? ??\n(?)\n\n?\t? ? \n\nSolu\u00e7\u00e3o encontrada: \n\n5S1* = 5S1\n(v)\n\n; 5S2* = 5S2\n(v)\n\n \n\n17S2* = 17S2(v); 17S3* = 17S3(v) \n\nv ? v + 1 \nsim n\u00e3o \n\nLPD1\n(0)\n\n ? Capacidade M\u00e1xima de S2; \n\nLPD2\n(0) ? Capacidade M\u00e1xima de S3; \n\n \n\nPasso 1: Resolu\u00e7\u00e3o dos 3 subproblemas. \n\nMax    Pr1.P1 + Pr2.P2 + ?1.5S1\n(v) \u2013 Prc.F \u2013 Cops?1 \n\nsujeito a: \n Restri\u00e7\u00f5es de S?1 \n\nMax    Pr3.P3 + ?2.17S2\n(v) ? ?1.5S2\n\n(v) \u2013 Cops?2 \nsujeito a: \n Restri\u00e7\u00f5es de S?2 \n 5S2 ? LPD1\n\n(v) \n\nMax    Pr4.P4 + Pr5.P5 \u2013 ?2.17S3\n(v) \u2013 Cops?3 \n\nsujeito a: \n Restri\u00e7\u00f5es de S?3 \n 17S3 ? LPD2\n\n(v) \n\n\n\n97 \n \n\nEsse limite de produ\u00e7\u00e3o dispon\u00edvel (LPD) \u00e9 a modifica\u00e7\u00e3o realizada no algoritmo, \n\ncom essas restri\u00e7\u00f5es j\u00e1 existe um sentido de disponibilidade (escassez) do produto a \n\nser processado. \n\n\u00c9 importante fornecer ?, uma diferen\u00e7a aceit\u00e1vel entre os valores dos multiplicadores \n\nde itera\u00e7\u00f5es consecutivas para o crit\u00e9rio de converg\u00eancia do algoritmo. Para este \n\nproblema, tanto para |?1\n(v+1)\n\n - ?1\n(v)\n\n| como para |?2\n(v+1)\n\n - ?2\n(v)\n\n|, o valor atribu\u00eddo para  ? \u00e9 \n\nde 0.01. \n\nPasso 1: Solu\u00e7\u00e3o do problema primal relaxado. \n\nResolver os 3 subproblemas gerados a partir da relaxa\u00e7\u00e3o das vari\u00e1veis \n\ncomplicadoras do problema primal. \n\nSubproblema para a divis\u00e3o da depropanizadora (S-1): \n\n  Max   Pr1.P1 + Pr2.P2 + ?1\n(v)\n\n.5S1\n(v) \n\n- Prc.F - CopS-1    \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-1 \n\nSubproblema para a divis\u00e3o da De-etanizadora (S-2): \n\n  Max   Pr3.P3 + ?2\n(v)\n\n.17S2\n(v) \n\n- ?1\n(v)\n\n.5S2\n(v)\n\n - CopS-2   \n\n  sujeito a: \n\n    Restri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-2 \n\n    5S2 ? LPD1\n(v)\n\n \n\nSubproblema para a divis\u00e3o da fracionadora de propeno (S-3): \n\n  Max   Pr4.P4 + Pr5.P5  - ?2\n(v)\n\n.17S3\n(v)\n\n - CopS-3   \n\n  sujeito a: \n\n     \n\nRestri\u00e7\u00f5es de Opera\u00e7\u00e3o da Divis\u00e3o S-3 \n\n    17S3 ? LPD2\n(v)\n\n \n\ncujas solu\u00e7\u00f5es ser\u00e3o denotadas como: 5S1\n(v)\n\n, 5S2\n(v)\n\n, 17S2\n(v)\n\n, 17S3\n(v)\n\n. Tamb\u00e9m \n\nforam adicionadas as restri\u00e7\u00f5es de produ\u00e7\u00e3o dispon\u00edvel para a corrente de carga \n\ndas divis\u00f5es S-2 e S-3, isto para garantir que o produto a ser processado esteja \n\ndispon\u00edvel. \n\n\n\n98 \n \n\nPasso 2: Atualiza\u00e7\u00e3o do multiplicador  \n\nPara atualizar o multiplicador pode-se utilizar um dos seguintes procedimentos: \n\nm\u00e9todo do subgradiente, cutting plane method, bundle method e thrust region \n\nmethod. A atualiza\u00e7\u00e3o do multiplicador \u00e9 feita desde um problema mestre, que est\u00e1 \n\nfora dos subproblemas e que na verdade, coordena os subproblemas para que \n\npossa-se atingir o \u00f3timo do problema primal. O m\u00e9todo utilizado neste caso \u00e9 o de \n\nsubgradiente, isto por que \u00e9 um dos m\u00e9todos mas utilizados na literatura de \n\nproblemas de decomposi\u00e7\u00e3o e que apresenta bons resultados. O procedimento \n\ncl\u00e1ssico do m\u00e9todo subgradiente \u00e9: \n\n?1\n(v+1)\n\n = ?1\n(v)\n\n + \n?\n\n?\t? \t?.?\n . \n\n(???(?)? ???(?))\n\n????(?)????(?)?\n \n\n?2\n(v+1)\n\n = ?2\n(v)\n\n + \n?\n\n?\t? \t?.?\n . \n\n(????(?)? ????(?))\n\n?????(?)?????(?)?\n \n\n \n\nonde os valores dos par\u00e2metros a e b s\u00e3o 1 e 0.1 respectivamente. Esses valores \n\nforam obtidos da literatura (Conejo et al. 2006). \n\n \n\nTamb\u00e9m tem que ser atualizado o limite de produ\u00e7\u00e3o dispon\u00edvel (LPD) da seguinte \n\nforma: \n\nLPD1\n(v)\n\n ? 5S1\n(v)\n\n; \n\nLPD2\n(v)\n\n ? 17S2\n(v)\n\n; \n\nEssa atualiza\u00e7\u00e3o garante que a vaz\u00e3o a ser processada esteja dispon\u00edvel, ou seja \n\nque a corrente de carga da T-2 e T-3 n\u00e3o pode ser maior as correntes dos produtos \n\nintermedi\u00e1rios 5S1 E 17S2 respectivamente. \n\nPasso 3: Crit\u00e9rio de converg\u00eancia \n\nO crit\u00e9rio de parada do algoritmo tem que satisfazer as seguintes equa\u00e7\u00f5es: \n\n|?1\n(v+1)\n\n - ?1\n(v)\n\n| ? \t? \n\n|?2\n(v+1)\n\n - ?2\n(v)\n\n| ? \t? \n\nem que ? \u00e9 definido no passo 0. Se essas equa\u00e7\u00f5es de desigualdade s\u00e3o \n\nrespeitadas, ent\u00e3o o algoritmo tem que parar e a solu\u00e7\u00e3o \u00f3tima foi encontrada, ent\u00e3o \n\n5S1* = 5S1\n(v)\n\n, 5S2* = 5S2\n(v)\n\n, 17S2* = 17S2\n(v)\n\n, 17S3* = 17S3\n(v)\n\n. Caso contr\u00e1rio, o \n\nalgoritmo deve continuar, com v ? v +1 e retornar para o passo 1.  \n\n\n\n99 \n \n\nOs resultados das itera\u00e7\u00f5es da modifica\u00e7\u00e3o no algoritmo da decomposi\u00e7\u00e3o por \n\nrelaxa\u00e7\u00e3o Lagrangeana s\u00e3o mostrados na tabela a seguir: \n\n \n\n \n\nTabela 5.3 - Respostas da proposta de modifica\u00e7\u00e3o do algoritmo de relaxa\u00e7\u00e3o Lagrangeana. \n\nItera\u00e7\u00e3o # ?1 ?2 \n5S1 \n\n(kg/h) \n5S2 \n\n(kg/h) \n17S2 \n(kg/h) \n\n17S3 \n(kg/h) \n\nP5 \n(kg/h) \n\n1 1.620 2.520 9885.44 10772.40 10061.80 10061.80 7261.30 \n\n2 3.256 2.520 9964.36 4939.00 4613.64 10061.80 7261.30 \n\n3 1.756 4.020 9885.48 9964.36 9619.60 4613.64 3329.02 \n\n4 3.141 2.635 9964.68 4939.00 4613.64 9619.60 6941.70 \n\n5 1.855 3.921 9964.68 9964.68 9609.36 4613.64 3331.38 \n\n6 1.855 2.721 9964.68 9964.68 9603.00 9609.36 6942.94 \n\n7 1.855 3.846 9964.68 9964.68 9606.24 9603.00 6942.08 \n\n8 1.855 2.787 9964.68 9964.68 9606.24 9606.24 6940.20 \n\n9 1.855 2.787 9964.68 9964.68 9606.24 9606.24 6940.20 \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria em base \u00e1s respostas obtidas. \n\n \n\n \n\nCom a modifica\u00e7\u00e3o no algoritmo de resolu\u00e7\u00e3o da relaxa\u00e7\u00e3o Lagarangeana, \n\nfornecendo os valores iniciais para ?1, ?2, LPD1 e LPD2 os subproblemas podem ser \n\nresolvidos separadamente determinando assim as vaz\u00f5es das correntes \n\nintermedi\u00e1rias 5S1, 5S2, 17S2 e 17S3. Os multiplicadores de Lagrange e os limites \n\nde produ\u00e7\u00e3o dispon\u00edvel s\u00e3o ajustados a cada itera\u00e7\u00e3o at\u00e9 que o crit\u00e9rio de \n\nconverg\u00eancia seja cumprido. Como se pode observar, o crit\u00e9rio de converg\u00eancia \u00e9 \n\ncumprido ap\u00f3s 9 itera\u00e7\u00f5es, isto significa que a modifica\u00e7\u00e3o do algoritmo consegue \n\nresolver os problemas que apresenta a t\u00e9cnica cl\u00e1ssica. como \u00e9 mostrado na figura \n\n5.10. \n\nAs duas causas pelas que a t\u00e9cnica de relaxa\u00e7\u00e3o Lagrangeana \u00e9 ineficaz foram \n\nsuperadas ao modificar o algoritmo de resolu\u00e7\u00e3o. A primeira causa que \u00e9 a \n\nexist\u00eancia de divis\u00f5es indiferentes, \u00e9 superada j\u00e1 que ao momento de incrementar \n\numa restri\u00e7\u00e3o desigualdade \"limite de produ\u00e7\u00e3o dispon\u00edvel\" faz que exista um ponto \n\nno qual o gradiente da fun\u00e7\u00e3o objetivo e o gradiente da restri\u00e7\u00e3o de desigualdade \n\n(limite de produ\u00e7\u00e3o dispon\u00edvel) sejam linearmente dependentes quando essa \n\nrestri\u00e7\u00e3o \u00e9 ativa, cumprindo assim as condi\u00e7\u00f5es de otimalidade mencionadas na \n\nse\u00e7\u00e3o 3. \n\n \n \n\n\n\n100 \n \n\nFigura 5.10 - Converg\u00eancia do algoritmo proposto. \n\n \n     Fonte: Elabora\u00e7\u00e3o Pr\u00f3pria. \n\n \n\nJ\u00e1 a segunda causa que \u00e9 a exist\u00eancia de objetivos lineares, na qual a restri\u00e7\u00e3o de \n\ncapacidade operacional m\u00e1xima ou m\u00ednima de cada subproblema sempre \u00e9 ativa, foi \n\nsuperada devido a que a restri\u00e7\u00e3o de \"limite de produ\u00e7\u00e3o dispon\u00edvel\" \u00e9 atualizado a \n\ncada itera\u00e7\u00e3o, garantindo que a restri\u00e7\u00e3o de capacidade operacional seja vari\u00e1vel \n\nconforme a disponibilidade de produto a ser processado, assim, a restri\u00e7\u00e3o de limite \n\nde produto dispon\u00edvel ser\u00e1 ativa sempre que os pre\u00e7os de mercado sejam \n\nfavor\u00e1veis, se os pre\u00e7os de mercado s\u00e3o muito baixos para um determinado produto \n\na restri\u00e7\u00e3o ativa ser\u00e1 a capacidade m\u00ednima que pode ser processada em cada \n\ndivis\u00e3o, garantindo assim que ser\u00e1 maximizada a vaz\u00e3o do produto com maior pre\u00e7o \n\nde mercado como \u00e9 mostrado nas figuras 5.11 e 5.12. \n\nPode-se observar na figura 5.11 que as vaz\u00f5es da corrente intermediaria entre as \n\ndivis\u00f5es da coluna T-1 (5S1) e T-2(5S2), dependendo do valor do multiplicador de \n\nLagrange, s\u00e3o dadas por um limite operacional de capacidade ou de disponibilidade \n\nde produto. Para o subproblema da T-1 (5S1) n\u00e3o existe muita varia\u00e7\u00e3o j\u00e1 que a \n\ncorrente de entrada \u00e9 fixada e tamb\u00e9m por que os limites de pureza de topo e fundo \n\ns\u00e3o muito fortes (0.999 e 0.001% molar respectivamente). J\u00e1 a vaz\u00e3o de carga da \n\ncoluna 2 consegue convergir a partir da itera\u00e7\u00e3o numero 5, nesta figura pode se \n\nobservar que os valores das vaz\u00f5es intermediarias 5S1 e 5S2 (9964.68 kg/h) \n\nalcan\u00e7am um valor similar ao da vaz\u00e3o da corrente intermediara 5 considerando a \n\notimiza\u00e7\u00e3o com estrutura centralizada (9952.42 kg/h).   \n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\n4.5\n\n1 2 3 4 5 6 7 8 9\n\nM\nu\n\nlt\nip\n\nlic\na\n\nd\no\n\nr \nd\n\ne\n L\n\na\ng\n\nra\nn\n\ng\ne\n\nItera\u00e7\u00e3o #\n\n?1\n\n?2\n\n\n\n101 \n \n\nFigura 5.11 - Vaz\u00e3o da corrente intermedi\u00e1ria 5S1-5S2 utilizando o algoritmo proposto. \n\n \n\n     Fonte: Elabora\u00e7\u00e3o Pr\u00f3pria. \n\n \n\nNa figura 5.12 mostra-se que a vaz\u00e3o da corrente 17S2 sofreu uma varia\u00e7\u00e3o no \n\nlimite m\u00e1ximo da vaz\u00e3o do produto de fundo da T-2, isto a causa que a corrente de \n\nentrada da coluna T-2 tamb\u00e9m sofreu uma varia\u00e7\u00e3o no  limite m\u00e1ximo de carga \n\n(5S2) para essa coluna. A vaz\u00e3o de carga da coluna T-3 tamb\u00e9m atualizo o limite de \n\nproduto dispon\u00edvel a ser processado, com estas modifica\u00e7\u00f5es pode se observar que \n\nse alcan\u00e7a converg\u00eancia ap\u00f3s 9 itera\u00e7\u00f5es. \n\n \nFigura 5.12 - Vaz\u00e3o da corrente intermedi\u00e1ria 17S2-17S3 utilizando o algoritmo proposto. \n\n \n\n Fonte: Elabora\u00e7\u00e3o Pr\u00f3pria. \n\n4300\n\n5300\n\n6300\n\n7300\n\n8300\n\n9300\n\n10300\n\n11300\n\n1 2 3 4 5 6 7 8 9\n\nV\na\n\nz\n\u00e3\n\no\n\nItera\u00e7\u00e3o #\n\n5D_1\n\n5D_2\n\nEstruc. Cent. \n\n4300.000\n\n5300.000\n\n6300.000\n\n7300.000\n\n8300.000\n\n9300.000\n\n10300.000\n\n11300.000\n\n1 2 3 4 5 6 7 8 9\n\nV\na\n\nz\n\u00e3\n\no\n (\n\nk\ng\n\n/h\n)\n\nItera\u00e7\u00e3o #\n\n17D_2\n\n17D_3\n\nEstruc. Cent.\n\n\n\n102 \n \n\nDevido a que existe converg\u00eancia dos multiplicadores de Lagrange, com a \n\nmodifica\u00e7\u00e3o do algoritmo de resolu\u00e7\u00e3o pelo m\u00e9todo de relaxa\u00e7\u00e3o Lagrangeana se \n\nconseguiu decompor eficazmente o problema estudado. Considerando a otimiza\u00e7\u00e3o \n\numa estrutura centralizada se conseguiu um lucro de 71622.92 $/h, j\u00e1 considerando \n\numa estrutura distribu\u00edda, decompondo o problema em tr\u00eas subproblemas que \n\npodem ser resolvidos independentemente, se obteve um lucro de 71754.71 $/h, o \n\nque significa que existe uma diferen\u00e7a de 0.184 % no lucro das duas estruturas de \n\nproblemas de otimiza\u00e7\u00e3o consideradas no problema (tabela 5.4). \n\n \n\nTabela 5.4 - Respostas dos problemas considerando uma estrutura centralizada e distribu\u00edda. \n\n \nFun\u00e7\u00e3o Objetivo \n\nMax Lucro = Pre\u00e7o dos Produtos \u2013 \nCusto Vaz\u00e3o de Carga \u2013 Custos de \n\nOpera\u00e7\u00e3o \n\nColuna Vari\u00e1veis \nSimula\u00e7\u00e3o \n(Projeto) \n\nOtimiza\u00e7\u00e3o \nAlgoritmo \nProposto \n\nT-1 \n\nVaz\u00e3o do Produto P1 (Kg/h) 8181.74 8158.40 8149.8 \n\nVaz\u00e3o de Produto P2 (Kg/h) 3506.46 3496.46 3492.6 \n\nVaz\u00e3o da Corrente 5 (Kg/h) 9919.08 9952.42 9964.72 \n\nSplitter de Refluxo SR1 0.676000 0.671093 0.676971 \n\nSplitter de Reboiler SB1 0.772000 0.770792 0.774288 \n\nT-2 \n\nVaz\u00e3o do Produto P3 (Kg/h) 742.85 351.064 358.48 \n\nVaz\u00e3o da Corrente 17 (Kg/h) 9176.22 9601.36 9606.24 \n\nSplitter de Refluxo SR2 0.949000 0.976064 0.973200 \n\nSplitter de Reboiler SB2 0.720000 0.707796 0.693593 \n\nT-3 \n\nVaz\u00e3o do Produto P5 (Kg/h) 6542.86 6921.86 6940.20 \n\nPureza do Produto P5 (Propeno % \nmolar) \n\n0.999900 0.995000 0.995001 \n\nVaz\u00e3o do Produto P4 (Kg/h) 2633.36 2679.5 2666.04 \n\nPureza do Produto P4 (Propeno % \nmolar) \n\n0.028100 0.023879 0.015298 \n\nSplitter de Refluxo SR3 0.076480 0.080226 0.074642 \n\nSplitter SC1 0.209030 0.213737 0.204296 \n\n \nLucro Operacional Bruto ($/h) 68947.75 71622.92 71754.71 \n\nFonte: Elabora\u00e7\u00e3o pr\u00f3pria em base \u00e1s respostas obtidas. \n\n \n\nEssa diferen\u00e7a entre o lucro bruto operacional da estrutura centralizada e distribu\u00edda \n\nse deve a que o problema estudado \u00e9 altamente n\u00e3o linear, o que significa que as \n\nrespostas encontradas s\u00e3o consideradas como \u00f3timos locais, ou seja, pode ter \n\nacontecido ao resolver os subproblemas tenha-se encontrado melhores \u00f3timos \n\n\n\n103 \n \n\nlocais que na resolu\u00e7\u00e3o do problema considerando uma estrutura centralizada, como \n\n\u00e9 mostrado na tabela 5.4 na qual pode-se observar que as respostas obtidas a partir \n\nde uma estrutura distribu\u00edda apresenta um pequeno incremento nas correntes \n\nintermediarias e por consequ\u00eancia um incremento nas vaz\u00f5es dos produtos finais e \n\nno lucro bruto operacional da unidade. Outras das raz\u00f5es pelas quais pode existir \n\nessa pequena diferencia \u00e9 que no c\u00e1lculo do software, foram consideradas \n\ndiferentes toler\u00e2ncias fazendo que exista uma diferencia de decimas como \u00e9 nosso \n\ncaso.  \n\nPara a otimiza\u00e7\u00e3o utilizando essa proposta de estrutura distribu\u00edda foram utilizadas \n\nna divis\u00e3o S-1, 2393 vari\u00e1veis, 2391 equa\u00e7\u00f5es e 6 restri\u00e7\u00f5es de desigualdade, essa \n\ndivis\u00e3o tem 2 graus de liberdade. Na divis\u00e3o S-2 foram utilizadas 2746 vari\u00e1veis, \n\n2743 equa\u00e7\u00f5es e 11 restri\u00e7\u00f5es de desigualdade, o que significa que a divis\u00e3o S-2 \n\ntem 3 graus de liberdade. J\u00e1 na divis\u00e3o S-3 foram utilizadas 8510 vari\u00e1veis, 8507 \n\nequa\u00e7\u00f5es e 11 restri\u00e7\u00f5es de desigualdade, dando lugar a 3 graus de liberdade. \n\nPelo explicado anteriormente, pode-se concluir que a modifica\u00e7\u00e3o no algoritmo de \n\nresolu\u00e7\u00e3o do m\u00e9todo de relaxa\u00e7\u00e3o Lagrangeana \u00e9 eficaz para resolver o problema \n\nde otimiza\u00e7\u00e3o com estrutura distribu\u00edda do processo apresentado no se\u00e7\u00e3o 4 deste \n\ntrabalho. \n\n\n\n104 \n \n\n6. CONCLUS\u00d5ES E SUGEST\u00d5ES PARA TRABALHOS FUTUROS \n\n \n\nNeste trabalho descrevemos como a otimiza\u00e7\u00e3o de toda a unidade de produ\u00e7\u00e3o de \n\npropeno da REPLAN - Petrobr\u00e1s poderia ser decomposta em subproblemas \n\nutilizando t\u00e9cnicas de decomposi\u00e7\u00e3o e como consequ\u00eancia do uso dessas t\u00e9cnicas, \n\nos pre\u00e7os das correntes intermedi\u00e1rias podem ser determinados adequadamente, \n\nconsiderando assim uma estrutura distribu\u00edda. Para este prop\u00f3sito foram estudadas \n\nas principais t\u00e9cnicas de decomposi\u00e7\u00e3o para problemas de otimiza\u00e7\u00e3o, estas s\u00e3o a \n\nrelaxa\u00e7\u00e3o Lagrangeana e o Lagrangeano Aumentado. Al\u00e9m dessas t\u00e9cnicas \n\ncl\u00e1ssicas, foi estudada uma outra t\u00e9cnica alternativa que \u00e9 Pricing Interprocess \n\nStreams Using Slack Auctions. O principal objetivo destas \u00e9 decompor o problema \n\noriginal em subproblemas menores coordenados por um problema mestre, \n\natualizando o multiplicador de Lagrange que, nestes casos, \u00e9 considerado como o \n\npre\u00e7o sombra da corrente intermedi\u00e1ria. Estas tr\u00eas t\u00e9cnicas foram fundamentadas \n\nteoricamente, fazendo-se uma an\u00e1lise e explica\u00e7\u00e3o dos seus algoritmos para \n\naplica\u00e7\u00e3o na decomposi\u00e7\u00e3o de problemas de otimiza\u00e7\u00e3o de divis\u00f5es posicionadas \n\nem s\u00e9rie, em que o procedimento iterativo \u00e9 usado para garantir a converg\u00eancia para \n\numa solu\u00e7\u00e3o global. \n\nEssas t\u00e9cnicas foram aplicadas a um problema de otimiza\u00e7\u00e3o de grande porte, que \u00e9 \n\ntoda a unidade de produ\u00e7\u00e3o de propeno da refinaria REPLAN \u2013 Petrobr\u00e1s. Essa \n\nunidade \u00e9 composta por tr\u00eas divis\u00f5es: Depropanizadora, De-etanizadora e a \n\nFracionadora de Propeno. A estrat\u00e9gia \u00e9 a redu\u00e7\u00e3o da complexidade na resolu\u00e7\u00e3o \n\ndo problema de otimiza\u00e7\u00e3o com estrutura centralizada para gera\u00e7\u00e3o dos pre\u00e7os dos \n\nprodutos intermedi\u00e1rios adequados, determinado pelas t\u00e9cnicas de decomposi\u00e7\u00e3o \n\npara a tomada de decis\u00f5es de produ\u00e7\u00e3o e tamb\u00e9m para a obten\u00e7\u00e3o dos set-points.  \n\nCom este fim, numa primeira etapa (se\u00e7\u00e3o 4 da disserta\u00e7\u00e3o) foram consideradas as \n\ntr\u00eas divis\u00f5es num s\u00f3 modelo (baseado no trabalho de Mendoza et al., 2013), para \n\nassim poder simular e otimizar a unidade completa, obtendo os set-points requeridos \n\npelo RTO. Os resultados obtidos mostram que a otimiza\u00e7\u00e3o da unidade pode \n\nincrementar (comparada com as condi\u00e7\u00f5es atuais) em 3.88% no lucro da toda a \n\nunidade, o que significa 2675.17 $/h. O principal problema encontrado na \n\nmodelagem foi a necessidade do EMSO de um arquivo de inicializa\u00e7\u00e3o vi\u00e1vel, o que \n\nfez com que a constru\u00e7\u00e3o do modelo fosse trabalhoso. Em rela\u00e7\u00e3o \u00e0 simula\u00e7\u00e3o do \n\n\n\n105 \n \n\nprocesso, o software apresenta as caracter\u00edsticas de um ambiente orientado a \n\nequa\u00e7\u00f5es, como velocidade na converg\u00eancia, robustez e flexibilidade nas \n\nespecifica\u00e7\u00f5es das vari\u00e1veis do processo. \n\nNuma segunda etapa foram modeladas, simuladas e otimizadas separadamente as \n\ntr\u00eas divis\u00f5es que formam parte da unidade de produ\u00e7\u00e3o de propeno (se\u00e7\u00e3o 5 da \n\ndisserta\u00e7\u00e3o). A constru\u00e7\u00e3o dos modelos  apresentou menor complexidade do que a \n\nmodelagem da unidade com estrutura centralizada, j\u00e1 que cada uma dessas divis\u00f5es \n\npossui menor n\u00famero de vari\u00e1veis e equa\u00e7\u00f5es, mas os mesmos problemas e \n\ncaracter\u00edsticas do software mencionados anteriormente se fizeram presentes. Pelas \n\ncaracter\u00edsticas do EMSO, neste trabalho n\u00e3o ser\u00e1 desenvolvida uma an\u00e1lise do \n\ngasto computacional na resolu\u00e7\u00e3o dos problemas de otimiza\u00e7\u00e3o mas, pelo menor \n\nn\u00famero de vari\u00e1veis e equa\u00e7\u00f5es, a otimiza\u00e7\u00e3o feita em paralelo das tr\u00eas divis\u00f5es \n\nconsideradas separadas, deveria poder ser resolvida num menor tempo \n\ncomputacional. \n\nA aplica\u00e7\u00e3o das t\u00e9cnicas de decomposi\u00e7\u00e3o mencionadas anteriormente ao processo \n\nestudado apresentou uma s\u00e9rie de problemas (mencionado na se\u00e7\u00e3o 5 da \n\ndisserta\u00e7\u00e3o). Nas t\u00e9cnicas da relaxa\u00e7\u00e3o Lagrangeana e Lagrangeano Aumentado os \n\nproblemas encontrados foram os seguintes: exist\u00eancia de divis\u00f5es indiferentes, ou \n\nseja, casos em que n\u00e3o existe depend\u00eancia linear entre a fun\u00e7\u00e3o objetivo e as \n\nrestri\u00e7\u00f5es complicadoras das divis\u00f5es estudadas; tamb\u00e9m encontraram-se \n\nproblemas com objetivos lineares das divis\u00f5es, ou seja, a restri\u00e7\u00e3o de \n\nprocessamento m\u00e1ximo ou m\u00ednimo das divis\u00f5es S2 e S3 sempre ser\u00e3o ativas \n\nfazendo com que n\u00e3o exista converg\u00eancia do problema mestre com qualquer valor \n\ndo multiplicador de Lagrange. \n\nA t\u00e9cnica de Pricing Interprocess Streams Using Slack Auctions tamb\u00e9m apresentou \n\nproblemas. Nessa t\u00e9cnica, \u00e9 a coloca\u00e7\u00e3o de um peso na fun\u00e7\u00e3o objetivo tentando \n\nminimizar a diferen\u00e7a entre as vaz\u00f5es das restri\u00e7\u00f5es complicadoras, mas esta \n\nt\u00e9cnica n\u00e3o considera a produ\u00e7\u00e3o conjunta, j\u00e1 que se n\u00e3o houver um pre\u00e7o de leil\u00e3o \n\nsuficientemente alto, sempre tenta-se produzir a maior vaz\u00e3o do coproduto e n\u00e3o da \n\ncorrente intermedi\u00e1ria, fazendo que o pre\u00e7o do leil\u00e3o n\u00e3o tenha um significado \n\necon\u00f4mico v\u00e1lido para este tipo de processos, isso porque os pre\u00e7os dos produtos \n\nintermedi\u00e1rios seriam maiores que os pre\u00e7os de mercado dos produtos finais.   \n\n\n\n106 \n \n\nTamb\u00e9m foi realizado uma proposta de mudan\u00e7a no algoritmo de resolu\u00e7\u00e3o de \n\nproblemas de otimiza\u00e7\u00e3o por relaxa\u00e7\u00e3o Lagrangeana, demonstrando que essa \n\nproposta garante uma solu\u00e7\u00e3o global para o problema de otimiza\u00e7\u00e3o considerando \n\numa estrutura distribu\u00edda, atingindo assim um \u00f3timo geral para todo o processo, \n\nmas, como o problema estudado \u00e9 n\u00e3o linear e foram consideradas toler\u00e2ncias \n\ndiferentes nos c\u00e1lculos do software, existe uma diferen\u00e7a entre de 0.184% entre a \n\notimiza\u00e7\u00e3o centralizada (\u00f3timo de 71622.92 $/h) e a otimiza\u00e7\u00e3o distribu\u00edda (71754.71 \n\n$/h) da unidade. \n\nEnt\u00e3o \u00e9 importante que a aplica\u00e7\u00e3o de t\u00e9cnicas de decomposi\u00e7\u00e3o para problemas \n\nde otimiza\u00e7\u00e3o de unidades em s\u00e9rie sejam tomadas em conta para ser acopladas a \n\num sistema de otimiza\u00e7\u00e3o em tempo real, j\u00e1 que assim os novos pontos \n\noperacionais encontrados com o RTO sejam sens\u00edveis a mudan\u00e7as nos pre\u00e7os dos \n\nprodutos finais e intermedi\u00e1rios, garantido assim uma solu\u00e7\u00e3o global considerando \n\numa estrutura distribu\u00edda. \n\nComo sugest\u00f5es para trabalhos futuros, a proposta sugerida deve ser testada em \n\noutras unidades de processo, com produ\u00e7\u00e3o conjunta de dois ou mais produtos. \n\nOutros m\u00e9todos de atualiza\u00e7\u00e3o dos multiplicadores de devem ser utilizados, para \n\nanalisar se \u00e9 poss\u00edvel alcan\u00e7ar a converg\u00eancia em um menor n\u00famero de itera\u00e7\u00f5es. \n\nJ\u00e1 para a otimiza\u00e7\u00e3o do processo, \u00e9 preciso desenvolver uma plataforma \n\ncomputacional para o EMSO e assim possa ser feita uma an\u00e1lise do gasto \n\ncomputacional requerido na resolu\u00e7\u00e3o dos problemas de otimiza\u00e7\u00e3o, tanto para a \n\notimiza\u00e7\u00e3o considerando uma estrutura centralizada como para uma estrutura \n\ndistribu\u00edda.  Tamb\u00e9m seria interessante utilizar softwares comerciais diferentes como \n\nAspen e ROMeo para poder implementar as t\u00e9cnicas de decomposi\u00e7\u00e3o nas \n\nunidades que atualmente utilizam estas plataformas computacionais, visando \n\nalcan\u00e7ar solu\u00e7\u00f5es que abarquem toda a refinaria. \n\n\n\n107 \n \n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS \n\n \n\nANTHONY, R. N.; GOVINDARAJAN, V. Sistemas de controle gerencial, S\u00e3o \n\nPaulo, 2002. \n\nARORA, N.; BIEGLER, L. T. Redescending estimators for data reconciliation and \n\nparameter estimation. Computers &amp; Chemical Engineering, v. 25, n. 11, p. 1585\u2013\n\n1599, 2001. \n\nATKINSON, A. A.; CHENOY CASTRO, A. O. M. DU. Contabilidade gerencial. [S.l: \n\ns.n.], 2000. \n\nAXELSSON, B.; EASTON, G. Industrial networks: a new view of reality, \n\nRoutledge, New York, 1992. \n\nBAILEY, J.K.; HYRMAK, A.N.; TREIBER, S.S.; HAWKINS R.B. Nonlinear \n\noptimization of a hydrocracker fractionation plant. Computers &amp; chemical \n\nengineering, v. 17, n. 2, p. 123\u2013138, 1993. \n\nBAZARAA, M. S.; SHERALI, H. D.; SHETTY, C. M. Nonlinear programming theory \n\nand algorithms. John Wiley &amp; Sons, New York, 1993. \n\nBERTSEKAS, D. P. Constrained optimization and Lagrange multiplier methods. \n\nComputer Science and Applied Mathematics, Boston: Academic Press, v. 1, \n\n1982. \n\nBERTSEKAS, D. P. Nonlinear programming. Athena Scientific, Belmont MA, 1995. \n\nBEUREN, I.; GRUNOW, M. A.; HEIN, N. M\u00e9todos de pre\u00e7o de transfer\u00eancia interna \n\nutilizados nas maiores ind\u00fastrias do Brasil. Congresso USP, S\u00e3o Paulo, Brasil, \n\n2008.  \n\nBIEGLER, L. T.; GROSSMANN, I. E. Retrospective on optimization. Computers &amp; \n\nChemical Engineering, v. 28, n. 8, p. 1169\u20131192, 2004. \n\nCAMOLESI, V. J.;; MORO, L. L. F.; ZANIN, A. C. Implanta\u00e7\u00e3o de um otimizador em \n\ntempo real (RTO) no conversor de uma unidade de craqueamento catal\u00edtico. Sba: \n\nControle &amp; Automa\u00e7\u00e3o Sociedade Brasileira de Automatica, v. 19, n. 2, p. 128\u2013\n\n137, 2008. \n\nCARVALHO M. Otimiza\u00e7\u00e3o sequencial por aproxima\u00e7\u00f5es: Uma aplica\u00e7\u00e3o em \n\ntempo real para o refino de petr\u00f3leo. Tese (Doutorado em coordena\u00e7\u00e3o de \n\nprogramas de p\u00f3s-gradua\u00e7\u00e3o em engenharia el\u00e9trica) - Universidade Federal do Rio \n\nde Janeiro, 2007. \n\nCHACHUAT, B.;; SRINIVASAN, B.; BONVIN, D. Adaptation strategies for real-time \n\noptimization. Computers &amp; Chemical Engineering, v. 33, n. 10, p. 1557\u20131567, \n\n2009. \n\n\n\n108 \n \n\nCOHEN, G. Auxiliary problem principle and decomposition of optimization problems. \n\nJournal of optimization Theory and Applications, v. 32, n. 3, p. 277\u2013305, 1980. \n\nCONEJO, E.; CASTILLO, R.; MINGUEZ R.; GARCIA-BERTRAND, R. \n\nDecomposition Techniques in Mathematical Programming: Engineering and \n\nScience Applications. [S.l.]: Springer, 2006.  \n\nDARBY, M. L.; WHITE, D. C. On-line optimization of complex process units. \n\nChemical Engineering Progress, v. 84, n. 10, p. 51\u201359, 1988. \n\nDURAISKI, R. G. Otimiza\u00e7\u00e3o din\u00e2mica em tempo real utilizando modelos n\u00e3o-\n\nlineares simplificados. Tese de Doutorado - Universidade Federal do Rio Grande \n\ndo Sul, 2009. \n\nEDGAR, T.F.; HIMMELBLAU, D. M.; LASDON, L.S. Optimization of chemical \n\nprocesses, McGraw-Hill, New York, 2001. \n\nFRIEDMAN, Y. Z. What\u2019s wrong with unit closed loop optimization? Hydrocarbon \n\nProcessing-Section 1, v. 74, n. 10, p. 107\u2013116, 1995. \n\nGUERRA, O. J.; LE ROUX, G. A. C. Improvements in Petroleum Refinery Planning: \n\n1. Formulation of Process Models. Industrial &amp; Engineering Chemistry Research, \n\nv. 50, n. 23, p. 13403\u201313418, doi:10.1021/ie200303m, 2011. \n\nGUIGNARD, M. Lagrangean relaxation. Top, v. 11, n. 2, p. 151\u2013200, 2003. \n\nGUNNERUD, V.; FOSS, B. Oil production optimization\u2014A piecewise linear model, \n\nsolved with two decomposition strategies. Computers &amp; Chemical Engineering, v. \n\n34, n. 11, p. 1803\u20131812, 2010.. \n\nHANMANDLU, M.;; PURKAYASTHA, P.; PAL, J. K. On the use of nonlinear \n\nprogramming in real time control in process industries. Annual Review in Automatic \n\nProgramming, v. 13, p. 71\u201378, 1985. \n\nHARTMANN, J. C. M. Distinguish between scheduling and planning models. \n\nHydrocarbon processing, v. 77, n. 7, p. 93\u2013100, 1998. \n\nHUI, C.-W. Determining marginal values of intermediate materials and utilities using a \n\nsite model. Computers &amp; Chemical Engineering, v. 24, n. 2, p. 1023\u20131029, 2000. \n\nJANG, S.;; JOSEPH, B.; MUKAI, H. On?line optimization of constrained multivariable \n\nchemical processes. AIChE journal, v. 33, n. 1, p. 26\u201335, 1987. \n\nJIANT T.; CHEN, B.; HE, X.; STUART, P. Application of steady-state detection \n\nmethod based on wavelet transform. Computers &amp; chemical engineering, v. 27, n. \n\n4, p. 569\u2013578, 2003. \n\n\n\n109 \n \n\nJORDAN, H.;; NEVES, J. C.; RODRIGUES, A. O controle de gest\u00e3o: ao servi\u00e7o \n\nda estrat\u00e9gia e dos gestores. [S.l: s.n.], 2003. \n\nJOSE, R. A.; UNGAR, L. H. Auction-driven coordination for plantwide optimization. \n\nProc. Foundations of Computer-Aided Process Operation FOCAPO, 1998. \n\nJOSE, R. A.; UNGAR, L. H. Pricing interprocess streams using slack auctions. \n\nAIChE journal, v. 46, n. 3, p. 575\u2013587, 2000. \n\nKREIPL, S.; PINEDO, M. Planning and scheduling in supply chains: an overview of \n\nissues in practice. Production and Operations management, v. 13, n. 1, p. 77\u201392, \n\n2004. \n\nLATOUR, P. R. ONLINE COMPUTER OPTIMIZATION. 2. BENEFITS AND \n\nIMPLEMENTATION. Hydrocarbon Processing, v. 58, n. 7, p. 219\u2013223, 1979. \n\nLI, X. Refinery-wide optimization. PHD Dissertation. Texas Technical University, \n\n2000. \n\nLUENBERGER, D.G. Linear and nonlinear programming. Addison Wesley, \n\nReading, MA, 1984. \n\nMAHEY, P. Decomposition methods for mathematical programming. Handbook of \n\napplied optimization, p. 337\u2013351, 2002. \n\nMARTINS, E. Contabilidade de custos. S\u00e3o Paulo: Atlas, 2003. \n\nMENDOZA, D. F.; PALACIO, L. M.; GRACIANO, J. E. A.; et al. Real-Time \n\nOptimization of an Industrial-Scale Vapor Recompression Distillation Process. Model \n\nValidation and Analysis. Industrial &amp; Engineering Chemistry Research, v. 52, n. \n\n16, p. 5735\u20135746, 2013. \n\nMORO, L. F. L.;; ZANIN, A. C.; PINTO, J. M. A planning model for refinery diesel \n\nproduction. Computers &amp; Chemical Engineering, v. 22, p. S1039\u2013S1042, 1998. \n\nNAYSMITH, M. R.; DOUGLAS, P. L. Review of real time optimization in the chemical \n\nprocess industries. Developments in Chemical Engineering and Mineral \n\nProcessing, v. 3, n. 2, p. 67\u201387, 1995. \n\nNEIRO, S. M. S. Integrated planning of production-distribution in petroleum \n\nsupply chains. . [S.l.]: Ph. D. Thesis, University of S\u00e3o Paulo, SP, Brazil, 2004. \n\nPINTO, J. M.; GUT, J. A. W. Otimiza\u00e7\u00e3o de processos qu\u00edmicos. Apostila do curso \n\nPQI5779-Otimiza\u00e7\u00e3o de Processos Qu\u00edmicos IUniversidade de S\u00e3o Paulo, S\u00e3o \n\nPaulo, 2005. \n\nPOLYAK, B. T. Introduction to optimization. Optimization Software, Inc., New \n\nYork, 1987. \n\n\n\n110 \n \n\nREDONDO, N. J.; CONEJO, A. J. Short-term hydro-thermal coordination by \n\nLagrangian relaxation: solution of the dual problem. Power Systems, IEEE \n\nTransactions on, v. 14, n. 1, p. 89\u201395, 1999. \n\nROMAGNOLI, J.A.; SANCHEZ, M.C. Data processing and reconciliation for \n\nchemical process operations, first ed. Academic Press Inc., San Diego, USA, \n\n2000. \n\nSEQUEIRA, S. E.;; GRAELLS, M.; PUIGJANER, L. Real-time evolution for on-line \n\noptimization of continuous processes. Industrial &amp; engineering chemistry \n\nresearch, v. 41, n. 7, p. 1815\u20131825, 2002. \n\nSOARES, R. P.; SECCHI, A. R. EMSO: A new environment for modelling, simulation \n\nand optimisation. Computer Aided Chemical Engineering, v. 14, p. 947\u2013952, 2003. \n\nSOARES, R. P. User\u2019s and programming manual; http://www.enq. \n\nufrgs.br/alsoc/download/emso/docs/Manual.pdf (accessed Sept 27, 2013). \n\nVOLLMANN, T.;; CORDON, C.; RAABE, H. Supply chain management. The \n\ncomplete MBA companion, Pitman, London, 1997. \n\nVRTECH. VRTherm manual do usu\u00e1rio. www.vrtech.com.br (accessed Sept 27, \n\n2013). \n\nWHITE, D. C. Online optimization: what, where and estimating ROI: Process \n\noptimization: Process control and instrumentation. Hydrocarbon Processing, v. 76, \n\nn. 6, p. 43\u201351, 1997. \n\nWINSTON, W.L. Introduction to mathematical programming: Applications and \n\nalgorithms, 2\nnd\n\n ed, Duxbury Press, California, 1995. \n\nWU, Y.-C.;; DEBS, A. S.; MARSTEN, R. E. A direct nonlinear predictor-corrector \n\nprimal-dual interior point algorithm for optimal power flows. Power Systems, IEEE \n\nTransactions on, v. 9, n. 2, p. 876\u2013883, 1994. \n\nZHANG, J.;; ZHU, X. X.; TOWLER, G. P. A simultaneous optimization strategy for \n\noverall integration in refinery planning. Industrial &amp; engineering chemistry \n\nresearch, v. 40, n. 12, p. 2640\u20132653, 2001. \n\nZHANG, N.; ZHU, X. X. A novel modelling and decomposition strategy for overall \n\nrefinery optimisation. Computers &amp; Chemical Engineering, v. 24, n. 2, p. 1543\u2013\n\n1548, 2000. \n\nZHANG, N.; ZHU, X. X. Novel modelling and decomposition strategy for total site \n\noptimisation. Computers &amp; chemical engineering, v. 30, n. 5, p. 765\u2013777, 2006. \n\nZHANG, Y.; FRASER FORBES, J. Extended design cost: a performance criterion for \n\nreal-time optimization systems. Computers &amp; Chemical Engineering, v. 24, n. 8, p. \n\n1829\u20131841, 2000. \n\n\n\n111 \n \n\nZHUANG, F.; GALIANA, F. D. Towards a more rigorous and practical unit \n\ncommitment by Lagrangian relaxation. Power Systems, IEEE Transactions on, v. \n\n3, n. 2, p. 763\u2013773, 1988."}]}}}