{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20550"}, {"@name": "filename", "#text": "4127_001073423.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \nESCOLA DE ENGENHARIA \n\nDEPARTAMENTO DE ENGENHARIA QU\u00cdMICA \nPROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA QU\u00cdMICA \n\n \n\n \n\n \n\n \n\nNOVA METODOLOGIA PARA ESTIMA\u00c7\u00c3O DE \nPAR\u00c2METROS DE MODELOS COM \n\nBIFURCA\u00c7\u00c3O HOPF  \n\nDISSERTA\u00c7\u00c3O DE MESTRADO \n\n \n\nRicardo Fran\u00e7a Rodrigues \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nPorto Alegre \n2018  \n\n\n\n \n\n \n\n \n\n \n\n \n\nNOVA METODOLOGIA PARA ESTIMA\u00c7\u00c3O DE \nPAR\u00c2METROS DE MODELOS COM \n\nBIFURCA\u00c7\u00c3O HOPF  \n\nRicardo Fran\u00e7a Rodrigues  \n\nDisserta\u00e7\u00e3o de Mestrado apresentada como requisito \nparcial para obten\u00e7\u00e3o do t\u00edtulo de Mestre em \nEngenharia. \n\n\u00c1rea de concentra\u00e7\u00e3o: Pesquisa e Desenvolvimento \nde Processos. \n\nLinha de Pesquisa: Projeto, Simula\u00e7\u00e3o, Modelagem, \nControle e Otimiza\u00e7\u00e3o de Processo Qu\u00edmicos e \nBioprocessos. \n\nOrientadores: \n\nProf. Dr. Marcelo Farenzena \n\nProf. Dr. Jorge Ot\u00e1vio Trierweiller \n\n \n\n \n\n \n\nPorto Alegre \n2018  \n\n\n\n\n\n\n\n \n \n\n \n \n \n\nAgradecimentos \n \n\nAos meus pais, Bete e S\u00e9rgio, pelo apoio, amor e carinho, hoje e sempre. \n\nAos irm\u00e3os que encontrei e que me acompanharam nessa jornada, no melhor e \nno pior: Lopes, Richard, Renan, V\u00edtor, Bruno, Pedro. \n\n\u00c0 fam\u00edlia que a UFRGS me proporcionou na forma de uma turma com os \nmelhores colegas e amigos que eu poderia ter pedido. \n\nAo Farenzena e ao Jorge pelo apoio, compreens\u00e3o e orienta\u00e7\u00e3o que levaram a \nesse trabalho do qual me orgulho. \n\nAo GIMSCOP pelo espa\u00e7o e acolhimento. \n\n\u00c0 Petrobras pelo apoio financeiro. \n\n \n\n \n\n  \n\n\n\nii \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\u201cI learned that courage was not the absence of fear, but the triumph over it. \nThe brave man is not he who does not feel afraid, but he who conquers that fear.\u201d \n\n (Nelson Mandela) \n\n\n\niii \n \n\n \n \n\nResumo \n \n\nA crescente import\u00e2ncia da extra\u00e7\u00e3o de petr\u00f3leo e g\u00e1s natural na economia \nbrasileira tem resultado em relevantes investimentos no setor, resultando nos \n\u00faltimos anos recordes hist\u00f3ricos de produ\u00e7\u00e3o. Em contrapartida, \u00e0 medida que um \nreservat\u00f3rio de petr\u00f3leo amadurece, come\u00e7am a ser observadas instabilidades na \nprodu\u00e7\u00e3o. A principal fonte desse fen\u00f4meno \u00e9 o escoamento em golfadas \n(slugging). Seu surgimento \u00e9 indesejado por causar dificuldades de opera\u00e7\u00e3o e \nperdas na produ\u00e7\u00e3o. \n\nEstudos sobre supress\u00e3o das golfadas s\u00e3o realizados desde 1930. Dentre as \nmedidas poss\u00edveis, o uso de controle autom\u00e1tico no sistema de eleva\u00e7\u00e3o tem \nrecebido especial aten\u00e7\u00e3o em anos recentes. A metodologia mais comum consiste \nem controlar uma medida de press\u00e3o na tubula\u00e7\u00e3o atrav\u00e9s da manipula\u00e7\u00e3o da \nv\u00e1lvula choke de produ\u00e7\u00e3o. A incorpora\u00e7\u00e3o de um modelo simplificado d\u00e1 ao \ncontrolador recursos de antecipa\u00e7\u00e3o para as medidas de controle. \n\nContudo, a qualidade de predi\u00e7\u00e3o do modelo \u00e9 limitada pelos par\u00e2metros de \najuste utilizados. Os m\u00e9todos de obten\u00e7\u00e3o dos par\u00e2metros s\u00e3o complexos e \ngeralmente requerem tentativa e erro. Poucos autores propuseram metodologias \nde estima\u00e7\u00e3o desses par\u00e2metros com base em algoritmos de otimiza\u00e7\u00e3o. O grande \nobst\u00e1culo para essa linha \u00e9 inerente aos dados de refer\u00eancia utilizados por \napresentarem ciclo limite est\u00e1vel. \n\nAssim, o presente trabalho prop\u00f5e uma nova metodologia para estima\u00e7\u00e3o de \npar\u00e2metros de modelos com ciclo limite. Seu uso est\u00e1 condicionado a uma \nmetodologia de tratamento dos dados que visa concentrar as informa\u00e7\u00f5es de \nm\u00faltiplos ciclos em um \u00fanico ciclo representativo atrav\u00e9s de superposi\u00e7\u00e3o de \ndados. Al\u00e9m disso, crit\u00e9rios de estabilidade foram estabelecidos devido \u00e0 natureza \ndos modelos. O m\u00e9todo foi aplicado a dois modelos da literatura, cujos resultados \npublicados foram comparados estatisticamente aos aqui obtidos. \n\nOs par\u00e2metros obtidos com a nova metodologia apresentaram ajustes melhores \nnos dois casos estudados. Dado que a capacidade preditiva de uma estrutura de \ncontrole baseada em modelos depende justamente da representatividade do \nmodelo utilizado, a obten\u00e7\u00e3o de bons ajustes se traduz em resultados melhores \npara o controlador. Assim, a metodologia proposta neste trabalho se comprova \ncomo um importante acess\u00f3rio na melhoria da efici\u00eancia de recupera\u00e7\u00e3o dos \nsistemas de eleva\u00e7\u00e3o. \n\n  \n\n\n\niv \n \n\n \n\n \n\n \n \n\nAbstract \n \n\nThe rising importance of the oil and gas industry for the Brazilian economy has \nbrought significant investments to this sector. Recent years have registered record \nlevels of production. On the other hand, as a reservoir reaches advanced stages of \nits life cycle, production instabilities begin to arise due to the slugging phenomenon. \nThis causes operation problems as well as production losses that justify researching \nmethods of suppression. \n\nSlugging suppression has been investigated as early as the 1930s. Among the \nanti-slugging measures is the usage of automated control in oil elevation systems. \nThe most common methodology revolves around controlling a pressure measure in \nthe production line by manipulating the production choke valve. The addition of \nsimplified slugging models incorporates a predictive response to the control system. \n\nHowever, the quality of model predictions is limited by the parameters used. \nMethods of obtaining these parameters are complex and often require trial and error. \nFew authors have proposed parameter estimation methods based on optimization \nalgorithms. The main issue for this approach is the limit cycle behavior of the \nreference data required to adjust these models. \n\nTherefore, the present work proposes a new objective function for parameter \nestimation of limit cycle models. Its usage is conditioned to a data treatment \nmethodology that aims at representing multiple cycles in a reference data set into a \nsingle mean cycle. Furthermore, stability criteria were established due to the dual \nnature of these models, which may present steady state or limit cycle responses. \nThe proposed method was applied to two published models, whose results were \nstatistically compared to those obtained hereafter. \n\nThe parameters estimated using the new method presented better model fits for \nboth case studies. Given that the predictive capacity of a control structure based on \nmodels heavily depends on the quality of the employed models, obtaining better fits \nwill present better results for the controller. Therefore, the proposed method is \nproven to be an important accessory in the road to improving the recovery efficiency \nof elevation systems. \n\n  \n\n\n\nv \n \n\nLISTA DE FIGURAS \n \n \n \nFigura 1.1: Participa\u00e7\u00f5es estimadas do setor de petr\u00f3leo e da Petrobras no PIB a \npre\u00e7os de mercado (PIBpm) brasileiro de 1955 a 2003. (ARAG\u00c3O, 2004) ............ 1 \nFigura 1.2: Ilustra\u00e7\u00e3o da influ\u00eancia das instabilidades oriundas do regime de \ngolfadas na produ\u00e7\u00e3o de petr\u00f3leo em malha aberta. Adaptado de Hu (2004) e Di \nMeglio et al. (2012). ................................................................................................ 2 \nFigura 2.1: Representa\u00e7\u00e3o de sistema de eleva\u00e7\u00e3o offshore. Adaptado de Di \nMeglio et al. (2012). ................................................................................................ 6 \nFigura 2.2: Representa\u00e7\u00e3o de um sistema gas-lift. Adaptado de Aamo et al. \n(2005). .................................................................................................................... 6 \nFigura 2.3: Tipos de escoamento horizontal. Adaptado de Jahanshahi (2013). ..... 8 \nFigura 2.4: Tipos de escoamento vertical. Adaptado de Jahanshahi (2013). ......... 8 \nFigura 2.5: Mapa de regimes para escoamento vertical. Zonas tracejadas indicam \nregi\u00f5es de transi\u00e7\u00e3o. Adaptado de Weisman e Kang (1981). ................................ 9 \nFigura 2.6: Exemplo de ciclo das golfadas por acidente em sistemas pipeline-riser \nsendo a fase l\u00edquida representada em azul. Adaptado de Storkaas (2005). ........ 10 \nFigura 2.7: Bifurca\u00e7\u00e3o Hopf gerada a partir do exemplo. (SEYDEL, 2010) .......... 11 \nFigura 2.8: Representa\u00e7\u00e3o do modelo de tr\u00eas estados. (DI MEGLIO et al., 2012)\n ............................................................................................................................. 13 \nFigura 2.9: Representa\u00e7\u00e3o do modelo de seis estados. (DIEHL et al., 2017) ...... 17 \nFigura 2.10: Ciclo completo de uma golfada obtido com o simulador OLGA. \nAdaptado de Diehl et al. (2017). ........................................................................... 21 \nFigura 4.1: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis, da fun\u00e7\u00e3o objetivo \nde m\u00ednimos quadrados para o exemplo. .............................................................. 32 \nFigura 4.2: Fun\u00e7\u00f5es senoidais utilizadas como exemplo. .................................... 32 \nFigura 4.3: Ciclos de refer\u00eancia para compara\u00e7\u00e3o ponto a ponto. ....................... 33 \nFigura 4.4: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis. da fun\u00e7\u00e3o objetivo \nproposta por Nabavi e Williams para o exemplo. ................................................. 33 \nFigura 4.5: Influ\u00eancia da taxa de amostragem na resposta da fun\u00e7\u00e3o objetivo \nproposta por Nabavi e Williams. ........................................................................... 34 \nFigura 4.6: Medi\u00e7\u00f5es reais de press\u00e3o de um po\u00e7o de petr\u00f3leo. ......................... 34 \nFigura 4.7: Ilustra\u00e7\u00e3o passo a passo do m\u00e9todo proposto: (a) identifica\u00e7\u00e3o de \npicos e vales; (b) identifica\u00e7\u00e3o de todos os ciclos; (c) separa\u00e7\u00e3o dos ciclos; (d,e) \navalia\u00e7\u00e3o da diferen\u00e7a entre os ciclos; (f,g) interpola\u00e7\u00e3o atrav\u00e9s de splines; (h,i) \nverifica\u00e7\u00e3o da amostragem; (j) sobreposi\u00e7\u00e3o dos ciclos; (h) ciclo m\u00e9dio com \nvari\u00e2ncia. .............................................................................................................. 36 \nFigura 4.8: Resultados da otimiza\u00e7\u00e3o do exemplo (azul) usando: WLS (vermelho); \nLS (verde)............................................................................................................. 37 \nFigura 4.9: (a) Superf\u00edcie de otimiza\u00e7\u00e3o do exemplo para M\u00ednimos Quadrados, e \n(b) curvas de n\u00edvel da fun\u00e7\u00e3o objetivo. ................................................................. 38 \nFigura 4.10: (a) Superf\u00edcie de otimiza\u00e7\u00e3o do exemplo para M\u00ednimos Quadrados \nPonderados, e (b) curvas de n\u00edvel da fun\u00e7\u00e3o objetivo. ......................................... 38 \nFigura 4.11: Resposta da press\u00e3o na base do riser, , do modelo de Meglio, \nKaasa e Petit (2009) para diferentes aberturas de v\u00e1lvula choke, . Os pontos \nrepresentam a m\u00e9dia (quando o valor de choke \u00e9 inferior ao valor cr\u00edtico) ou os \npicos e vales (quando esse valor \u00e9 superior ao cr\u00edtico). A linha tracejada cinza \nrepresenta o diagrama de bifurca\u00e7\u00e3o do sistema. ................................................ 39 \nFigura 4.12: Representa\u00e7\u00e3o de um oscilador harm\u00f4nico com amortecimento. .... 40 \nFigura 4.13: Resposta da posi\u00e7\u00e3o de um oscilador harm\u00f4nico com amortecimento \npara diferentes valores de . ................................................................................ 41 \n\n\n\nvi \n \n\n \n\nFigura 4.14: (a) Exemplo de ajuste da parcela exponencial de um oscilador \nharm\u00f4nico subamortecido para valores de abertura de choke inferiores ao cr\u00edtico o \nmodelo de Meglio, Kaasa e Petit. (b) Quando os par\u00e2metros  e  s\u00e3o ajustados \npara picos ou vales (linhas cheias), o lado rec\u00edproco apresenta um ajuste ruim \n(linhas tracejadas). ............................................................................................... 42 \nFigura 5.1: Dados utilizados para estima\u00e7\u00e3o de par\u00e2metros: (a) modelo Meglio \n(azul) com erro normalmente distribu\u00eddo, todos os picos (vermelho) e vales \n(verde) detectados, e varia\u00e7\u00e3o da press\u00e3o do separador  (roxo); (b) resultado \nda reconstru\u00e7\u00e3o (vermelho) dos dados (azul) baseada na diferen\u00e7a entre a m\u00e9dia \ndos vales dos ciclos sem dist\u00farbio (verde tracejado) e os valores da spline dos \nvales dos ciclos com dist\u00farbio (verde cheio). ....................................................... 45 \nFigura 5.2: Compara\u00e7\u00e3o entre ciclo representativo dos dados reconstru\u00eddos \n(vermelho) e dos dados sem reconstru\u00e7\u00e3o (azul). ................................................ 46 \nFigura 5.3: Resultados das estima\u00e7\u00f5es (a) sem reconstru\u00e7\u00e3o e (b) com \nreconstru\u00e7\u00e3o. ........................................................................................................ 46 \nFigura 5.4: Compara\u00e7\u00e3o entre ciclo dos dados reconstru\u00eddos (pontos vermelhos), \nciclo do modelo estimado com dados reconstru\u00eddos (linha vermelha) e ciclo do \nmodelo estimado sem reconstru\u00e7\u00e3o (linha azul). ................................................. 47 \nFigura 5.5: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis de M\u00ednimos \nQuadrados para os par\u00e2metros  e . .................................................. 49 \nFigura 5.6: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis da fun\u00e7\u00e3o objetivo \nproposta por Diehl et al. (2017) para os par\u00e2metros  e . ................... 49 \nFigura 5.7: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis da fun\u00e7\u00e3o objetivo \nproposta neste trabalho para os par\u00e2metros  e . .............................. 49 \nFigura 5.8: Regi\u00f5es de confian\u00e7a para um grau de confian\u00e7a   dos \npar\u00e2metros obtidos com reconstru\u00e7\u00e3o dos dados: regi\u00e3o el\u00edptica (vermelho) e \nregi\u00e3o de m\u00e1xima verossimilhan\u00e7a (azul)............................................................. 50 \nFigura 5.9: Dados obtidos do artigo de Di Meglio et al. (2012). ............................ 51 \nFigura 5.10: Ciclos representativos: dados de refer\u00eancia (azul); modelo Meglio \nconforme publicado (vermelho). ........................................................................... 52 \nFigura 5.11: Ciclos representativos: dados originais (azul); modelo Meglio original \n(vermelho); modelo Meglio estimado com base na press\u00e3o  (verde). ........... 53 \nFigura 5.12: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \ncom . ............................................................................................................. 53 \nFigura 5.13: Valores preditos e valores observados de  e  do modelo \nMeglio estimado com . .................................................................................. 54 \nFigura 5.14: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo de \nDi Meglio et al. (2009) estimado com . Valores \u00f3timos s\u00e3o representados em \nvermelho. .............................................................................................................. 55 \nFigura 5.15: Ciclos representativos: dados originais (azul); modelo Meglio original \n(vermelho); modelo Meglio estimado com base na press\u00e3o  (verde). ........... 55 \nFigura 5.16: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \ncom . .............................................................................................................. 56 \nFigura 5.17: Valores preditos e valores observados de  e  do modelo \nMeglio estimado com . ................................................................................... 57 \nFigura 5.18: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo \nMeglio estimado com . Valores \u00f3timos s\u00e3o representados em vermelho. ..... 57 \n\n\n\nvii \n \nFigura 5.19: Ciclos representativos: dados originais (azul); modelo Meglio original \n(vermelho); modelo Meglio estimado com base nas press\u00f5es  e  (verde).\n ............................................................................................................................. 59 \nFigura 5.20: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \ncom  e . .................................................................................................. 59 \nFigura 5.21: Valores preditos e valores observados de  e  do modelo \nMeglio estimado com  e . ....................................................................... 60 \nFigura 5.22: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo \nMeglio estimado com  e . Valores \u00f3timos s\u00e3o representados em \nvermelho............................................................................................................... 61 \nFigura 5.23: Dados de refer\u00eancia para o Real Well A. ......................................... 62 \nFigura 5.24: Compara\u00e7\u00e3o entre ciclos obtidos para o modelo FOWM. ................ 64 \nFigura 5.25: Valores preditos e observados da press\u00e3o : (a) dados originais, \n(b) cen\u00e1rio 1, (c) cen\u00e1rio 2 e (d) cen\u00e1rio 3. .......................................................... 67 \nFigura 5.26: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 1. ................... 68 \nFigura 5.27: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 2. ................... 69 \nFigura 5.28: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 3. ................... 70 \nFigura 5.29: Ciclos m\u00e9dios das press\u00f5es (a) , (b)  e (c) , \nconsiderando a refer\u00eancia e os resultados de diferentes valores de . Os \nresultados foram obtidos utilizando somente  como refer\u00eancia. ................. 71 \nFigura 5.30: Evolu\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o do modelo FOWM \ncom base em tr\u00eas press\u00f5es. ................................................................................ 72 \nFigura 5.31: Compara\u00e7\u00e3o entre as press\u00f5es (a) , (b)  e (c)  para a \nrefer\u00eancia e os diferentes conjuntos de par\u00e2metros obtidos para o modelo FOWM.\n ............................................................................................................................. 73 \nFigura 5.32: Compara\u00e7\u00e3o entre as press\u00f5es (a) , (b)  e (c)  para a \nrefer\u00eancia e o conjunto de par\u00e2metros estimado para o modelo FOWM. ............ 74 \nFigura 5.33: Valores preditos e observados da (a) , (b)  e (c)  do \nmodelo FOWM estimado com tr\u00eas press\u00f5es........................................................ 77 \nFigura 5.34: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o modelo FOWM estimado \ncom tr\u00eas press\u00f5es. ............................................................................................... 78 \n \n  \n\n\n\nviii \n \n\n \n\n \n \n\nLISTA DE TABELAS \n \nTabela 1: Compara\u00e7\u00e3o entre os resultados das estima\u00e7\u00f5es de par\u00e2metros do \nmodelo de Meglio et al. (2010). ............................................................................ 47 \nTabela 2: Teste Chi Quadrado entre os resultados com e sem reconstru\u00e7\u00e3o dos \ndados. ................................................................................................................... 47 \nTabela 3: Teste F entre os resultados com e sem reconstru\u00e7\u00e3o dos dados. ....... 48 \nTabela 4: Matriz de correla\u00e7\u00f5es dos resultados com reconstru\u00e7\u00e3o dos dados. ... 48 \nTabela 5: Compara\u00e7\u00e3o entre os par\u00e2metros estimados para o modelo Meglio.... 51 \nTabela 6: Limites de otimiza\u00e7\u00e3o para os par\u00e2metros do modelo Meglio. ............. 51 \nTabela 7: Teste Chi quadrado para o modelo Meglio original. ............................. 52 \nTabela 8: Teste Chi Quadrado para o modelo Meglio estimado com a press\u00e3o \n\n. ..................................................................................................................... 53 \nTabela 9: Matriz de correla\u00e7\u00f5es do modelo Meglio estimado com a press\u00e3o .\n ............................................................................................................................. 54 \nTabela 10: Teste F do modelo Meglio estimado com a press\u00e3o . ................. 54 \nTabela 11: Teste Chi Quadrado do modelo Meglio estimado com a press\u00e3o .\n ............................................................................................................................. 56 \nTabela 12: Matriz de correla\u00e7\u00f5es do modelo Meglio estimado com a press\u00e3o .\n ............................................................................................................................. 56 \nTabela 13: Teste F do modelo Meglio estimado com a press\u00e3o ................... 57 \nTabela 14: Teste Chi Quadrado para o modelo Meglio estimado com as press\u00f5es \n\n e . .......................................................................................................... 59 \nTabela 15: Teste F do modelo Meglio estimado com as press\u00f5es  e . ... 60 \nTabela 16: Matriz de correla\u00e7\u00f5es para as medidas de  do modelo Meglio \nestimado com as press\u00f5es  e . ............................................................... 60 \nTabela 17: Matriz de correla\u00e7\u00f5es para as medidas de  do modelo Meglio \nestimado com as press\u00f5es  e . ............................................................... 60 \nTabela 18: Compara\u00e7\u00e3o entre resultados originais e resultados obtidos com a \nnova metodologia. ................................................................................................ 63 \nTabela 19: Teste Chi Quadrado para o modelo FOWM baseado em dados reais.\n ............................................................................................................................. 64 \nTabela 20: Coeficientes de correla\u00e7\u00e3o obtidos do resultado original e dos cen\u00e1rios \npara o modelo FOWM. ......................................................................................... 64 \nTabela 21: Teste F para o modelo FOWM entre os cen\u00e1rios. .............................. 65 \nTabela 22: Teste F para o modelo FOWM entre os cen\u00e1rios e o resultado original.\n ............................................................................................................................. 65 \nTabela 23: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 1. ................... 66 \nTabela 24: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 2. ................... 66 \nTabela 25: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 3. ................... 66 \nTabela 26: Compara\u00e7\u00e3o entre par\u00e2metros estimados do modelo FOWM para o \nReal Well A. .......................................................................................................... 72 \nTabela 27: Coeficientes de correla\u00e7\u00e3o para os conjuntos de par\u00e2metros \nestudados para o modelo FOWM. ........................................................................ 73 \nTabela 28: Teste Chi Quadrado para o modelo FOWM estimado com tr\u00eas \npress\u00f5es. .............................................................................................................. 74 \n\n\n\nix \n \nTabela 29: Teste F para o modelo FOWM entre os diferentes conjuntos de \npar\u00e2metros obtidos para o Real Well A. ............................................................... 75 \nTabela 30: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \npress\u00f5es. .............................................................................................................. 75 \nTabela 31: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \npress\u00f5es. .............................................................................................................. 76 \nTabela 32: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \npress\u00f5es. .............................................................................................................. 76 \n\n \n\n\n\nx \n \n\n \n\nNOTA\u00c7\u00c3O E SIMBOLOGIA \n \n\n Abertura de v\u00e1lvula \n Abertura de v\u00e1lvula \n Acelera\u00e7\u00e3o da gravidade \n\n \n\u00c1rea da se\u00e7\u00e3o transversal da \n\ntubula\u00e7\u00e3o subsea \n Coeficiente de correla\u00e7\u00e3o do modelo \n Coeficiente de fluxo da v\u00e1lvula choke \n\n Coeficiente de fluxo da v\u00e1lvula virtual \n\n \nCoeficiente de fluxo do casco anular \n\npara o tubing \n Coeficiente de fluxo do manifold \n\n Coeficiente de fluxo do reservat\u00f3rio \n Comprimento do casco anular \n Comprimento do flowline \n Comprimento do riser \n Constante pi \n Constante universal dos gases \n Di\u00e2metro da tubula\u00e7\u00e3o subsea \n Di\u00e2metro do casco anular \n Di\u00e2metro do tubing \n\n Dist\u00e2ncia vertical do manifold at\u00e9 a \nv\u00e1lvula de gas-lift \n\n Dist\u00e2ncia vertical do manifold at\u00e9 o reservat\u00f3rio \n\n Dist\u00e2ncia vertical do manifold at\u00e9 o \nsensor PDG \n\n Distribui\u00e7\u00e3o Chi Quadrado \n Distribui\u00e7\u00e3o F de Fisher \n\n Distribui\u00e7\u00e3o t de Student \nEDO Equa\u00e7\u00f5es Diferenciais Ordin\u00e1rias \nEDP Equa\u00e7\u00f5es Diferenciais Parciais \n\n Fase \nFOWM Fast Offshore Wells Model \n\n Fator de corre\u00e7\u00e3o de volume \n\n Fluxo m\u00e1ssico de g\u00e1s da v\u00e1lvula \nchoke \n\n \nFluxo m\u00e1ssico de g\u00e1s da v\u00e1lvula de \n\ngas-lift \n \n\n\n\nxi \n \n\n Fluxo m\u00e1ssico de g\u00e1s da v\u00e1lvula \nvirtual \n\n Fluxo m\u00e1ssico de g\u00e1s entrante no \ncasco anular \n\n Fluxo m\u00e1ssico de g\u00e1s no manifold \n\n Fluxo m\u00e1ssico de l\u00edquido da v\u00e1lvula choke \n Fluxo m\u00e1ssico de l\u00edquido no manifold \n\n Fluxo m\u00e1ssico do reservat\u00f3rio \n\n \nFra\u00e7\u00e3o de g\u00e1s que entra diretamente \n\nno riser \n Fra\u00e7\u00e3o m\u00e1ssica de g\u00e1s do reservat\u00f3rio \n Fra\u00e7\u00e3o m\u00e1ssica de g\u00e1s do tubing \n\n Fra\u00e7\u00e3o m\u00e1ssica de g\u00e1s na tubula\u00e7\u00e3o \nsubsea \n\n \nFra\u00e7\u00e3o m\u00e1ssica de l\u00edquido na \n\ntubula\u00e7\u00e3o subsea \n Fun\u00e7\u00e3o objetivo \n\n Grau de confian\u00e7a \n Inclina\u00e7\u00e3o m\u00e9dia do riser \n\n Massa de g\u00e1s na bolha alongada \n Massa de g\u00e1s no casco anular \n Massa de g\u00e1s no riser \n Massa de g\u00e1s no tubing \n Massa de l\u00edquido no riser \n Massa de l\u00edquido no tubing \n\n Massa de l\u00edquido sempre presente no \nriser \n\n Massa espec\u00edfica da mistura no reservat\u00f3rio \n Massa espec\u00edfica da mistura no tubing \n\n \nMassa espec\u00edfica de g\u00e1s no casco \n\nanular \n Massa espec\u00edfica de g\u00e1s no tubing \n\n Massa espec\u00edfica de l\u00edquido \n Massa molar de g\u00e1s \n Matriz de correla\u00e7\u00f5es dos par\u00e2metros \n Matriz de covari\u00e2ncias dos par\u00e2metros \n Matriz de vari\u00e2ncias de predi\u00e7\u00e3o \n Matriz dos erros experimentais \n\nLS M\u00ednimos Quadrados \nWLS M\u00ednimos Quadrados Ponderados \n\n N\u00famero de Experimentos \n N\u00famero de graus de liberdade \n\n\n\nxii \n \n\n \n\n N\u00famero de par\u00e2metros \n Press\u00e3o Anular \n Press\u00e3o Bolha Alongada \n Press\u00e3o Bottomhole \n\n Press\u00e3o do reservat\u00f3rio \n Press\u00e3o do Separador \n\n Press\u00e3o Permanent Downhole Gauge \n Press\u00e3o Riser Base \n Press\u00e3o Riser Top \n\n Press\u00e3o Temperature and Pressure Transmitter \n Press\u00e3o Tubing Base \n Press\u00e3o Tubing Top \n\nPIBpm Produto Interno Bruto a pre\u00e7o de mercado \n Temperatura \n Tempo \n Vari\u00e2ncia \n Vaz\u00e3o volum\u00e9trica de l\u00edquido \n Velocidade superficial de l\u00edquido \n Velocidade superficial de g\u00e1s \n Vetor de par\u00e2metros \n Voluma da tubula\u00e7\u00e3o subsea \n Volume da bolha alongada \n Volume de g\u00e1s no tubing \n Volume do casco anular \n Volume total do tubing \n\n \n  \n\n\n\nxiii \n \n\nSUM\u00c1RIO \n \n\n Introdu\u00e7\u00e3o ................................................................................... 1 \n1.1 Motiva\u00e7\u00e3o ................................................................................................................. 2 \n1.2 Objetivos .................................................................................................................. 3 \n1.3 Estrutura da disserta\u00e7\u00e3o........................................................................................ 3 \n\n Revis\u00e3o bibliogr\u00e1fica ................................................................. 5 \n2.1 Sistemas de eleva\u00e7\u00e3o de petr\u00f3leo ....................................................................... 5 \n2.2 Escoamento multif\u00e1sico ......................................................................................... 7 \n2.3 Regime de golfadas ............................................................................................... 9 \n\n2.3.1 Golfadas por acidente .................................................................................................. 9 \n2.3.2 Golfadas por casing-heading ....................................................................................10 \n2.3.3 Golfadas por ondas de densidade ...........................................................................10 \n\n2.4 Ciclo limite e bifurca\u00e7\u00e3o Hopf ............................................................................. 11 \n2.5 Modelagem aplicada a automa\u00e7\u00e3o e controle ................................................. 12 \n2.6 Modelo de Di Meglio, Kaasa e Petit (2009) ...................................................... 12 \n\n2.6.1 Descri\u00e7\u00e3o do modelo ..................................................................................................13 \n2.6.2 Ajuste de par\u00e2metros .................................................................................................15 \n\n2.7 Modelo de Diehl et al. (2017).............................................................................. 16 \n2.7.1 Descri\u00e7\u00e3o do modelo ..................................................................................................16 \n2.7.2 Ajuste de par\u00e2metros .................................................................................................20 \n\n2.8 Estima\u00e7\u00e3o de par\u00e2metros para modelos com bifurca\u00e7\u00e3o Hopf .................... 22 \n Fundamentos de avalia\u00e7\u00e3o estat\u00edstica para modelos ........... 24 \n\n3.1 Qualidade dos modelos ....................................................................................... 24 \n3.2 Qualidade dos par\u00e2metros .................................................................................. 25 \n\n3.2.1 Intervalos de confian\u00e7a ..............................................................................................27 \n3.2.2 Regi\u00f5es de confian\u00e7a .................................................................................................27 \n3.2.3 Compara\u00e7\u00e3o entre conjuntos de par\u00e2metros .........................................................29 \n\n3.3 Qualidade de predi\u00e7\u00e3o do modelo ..................................................................... 29 \n Metodologia .............................................................................. 30 \n\n4.1 Fun\u00e7\u00f5es objetivo ................................................................................................... 30 \n4.1.1 Modelos com ciclo limite ............................................................................................30 \n4.1.2 Modelos com ciclo limite e alta variabilidade ..........................................................34 \n4.1.3 Crit\u00e9rios de converg\u00eancia para modelos com bifurca\u00e7\u00e3o Hopf ...........................38 \n\n4.2 Recursos computacionais ................................................................................... 43 \n Estudos de caso ....................................................................... 44 \n\n5.1 Modelo Meglio com dist\u00farbio .............................................................................. 44 \n5.2 Modelo Meglio aplicado a dados reais .............................................................. 50 \n\n5.2.1 Resultados originais ...................................................................................................52 \n5.2.2 Estima\u00e7\u00e3o com base em  ..................................................................................52 \n5.2.3 Estima\u00e7\u00e3o com base em  ...................................................................................55 \n5.2.4 Estima\u00e7\u00e3o com base em  e  ......................................................................58 \n\n5.3 Modelo FOWM com dados reais ........................................................................ 61 \n5.3.1 Influ\u00eancia do par\u00e2metro  .......................................................................................63 \n5.3.2 Estima\u00e7\u00e3o de par\u00e2metros com outras refer\u00eancias ................................................71 \n\n Conclus\u00f5es e Trabalhos futuros ............................................. 79 \n6.1 Conclus\u00f5es quanto \u00e0 metodologia .................................................................... 79 \n6.2 Estrat\u00e9gia de otimiza\u00e7\u00e3o do modelo FOWM.................................................... 79 \n6.3 Sugest\u00f5es de trabalhos futuros ......................................................................... 80 \n\n\n\nxiv \n \n\n \n\nRefer\u00eancias ......................................................................................................... 81 \nAp\u00eandice A \u2013 C\u00f3digos implementados em Python ...................................... 87 \n\n \n \n\n\n\n1.1 Motiva\u00e7\u00e3o \n 1 \n\n \n \n\n  Introdu\u00e7\u00e3o \nA extra\u00e7\u00e3o de petr\u00f3leo e g\u00e1s natural representam uma significativa parcela do \n\nPIB nacional. Ap\u00f3s o decreto da chamada Lei do Petr\u00f3leo, em 1998, foi criada a \nAg\u00eancia Nacional do Petr\u00f3leo, G\u00e1s Natural e Biocombust\u00edveis (ANP) e instituiu-se \no fim do monop\u00f3lio de extra\u00e7\u00e3o da Petrobras. Isso causou o in\u00edcio da crescente \nparticipa\u00e7\u00e3o do setor de petr\u00f3leo no PIB nacional, como pode ser observado na \nFigura 1.1: \n\n \nFigura 1.1: Participa\u00e7\u00f5es estimadas do setor de petr\u00f3leo e da Petrobras no PIB a \n\npre\u00e7os de mercado (PIBpm) brasileiro de 1955 a 2003. (ARAG\u00c3O, 2004) \n\nSomente no per\u00edodo entre 1998 e 2003, essa participa\u00e7\u00e3o cresceu de 2,5% para \n6,9% (ARAG\u00c3O, 2004). Estima-se que em 2017 a participa\u00e7\u00e3o tenha sido de 13% \ndo PIB nacional, representando 50% da oferta interna de energia do pa\u00eds. A \nprodu\u00e7\u00e3o de barris por dia de petr\u00f3leo cresceu 268% s\u00f3 entre o per\u00edodo de 1998 a \n2017, aumentando de 970 mil para 2,6 milh\u00f5es de barris por dia. J\u00e1 a produ\u00e7\u00e3o de \ng\u00e1s natural cresceu 370%, de 30 milh\u00f5es para 111 milh\u00f5es de metros c\u00fabicos por \ndia (ANP, 2018). Um fator que contribuiu para o aumento da participa\u00e7\u00e3o do setor \nfoi a descoberta da camada pr\u00e9-sal em 2007, que em julho de 2017 representou \n76% da produ\u00e7\u00e3o total de barris por dia (PETROBRAS, 2017). \n\n \n\n\n\n2 Introdu\u00e7\u00e3o \n \n\n \n\n1.1 Motiva\u00e7\u00e3o \n\u00c0 medida que um po\u00e7o alcan\u00e7a um est\u00e1gio maduro de sua vida \u00fatil, torna-se \n\nnecess\u00e1rio o emprego de t\u00e9cnicas de eleva\u00e7\u00e3o artificial que aumentem a \nrecupera\u00e7\u00e3o de produto do po\u00e7o. A t\u00e9cnica mais comum para essa etapa \u00e9 \nconhecida como gas-lift e representava em 2009 uma parcela de 72% das t\u00e9cnicas \nde eleva\u00e7\u00e3o artificial alocadas \u00e0 produ\u00e7\u00e3o da Petrobras. (RIZZO FILHO, 2011) \n\nA popularidade do gas-lift se d\u00e1 pela versatilidade: pode ser aplicado em po\u00e7os \ncom at\u00e9 2.600 metros de profundidade em fluidos que apresentem alto teor de areia \ne elevada raz\u00e3o g\u00e1s-l\u00edquido. Consiste basicamente na aera\u00e7\u00e3o do sistema de \neleva\u00e7\u00e3o pela inje\u00e7\u00e3o de g\u00e1s natural. A contrapartida do m\u00e9todo de gas-lift consiste \nno surgimento do regime de escoamento chamado de golfadas ou slug. (THOMAS, \n2001) \n\nSob esse regime, o sistema de eleva\u00e7\u00e3o de petr\u00f3leo apresenta per\u00edodos \nintermitentes de produ\u00e7\u00e3o de \u00f3leo e g\u00e1s, configurando um ciclo limite. O excesso \nde produ\u00e7\u00e3o de \u00f3leo pode fazer com que o separador transborde, ocasionando shut \ndown do mesmo. J\u00e1 um per\u00edodo de alta produ\u00e7\u00e3o de g\u00e1s causa dificuldades \noperacionais durante o flaring. Al\u00e9m disso, as altas oscila\u00e7\u00f5es de press\u00e3o no \nsistema diminuem a produ\u00e7\u00e3o total obtida. (JANSEN, F.E.; SHOHAM; TAITEL, \n1996) \n\nAs origens dessas flutua\u00e7\u00f5es podem ser relacionadas tanto a aberturas maiores \nda v\u00e1lvula choke de produ\u00e7\u00e3o (Figura 1.2a) quanto a vaz\u00f5es menores de gas-lift \n(Figura 1.2b), configurando um sistema com bifurca\u00e7\u00e3o Hopf. \u00c9 vis\u00edvel que existe \numa margem consider\u00e1vel para aumento da efici\u00eancia de recupera\u00e7\u00e3o de petr\u00f3leo \nse as instabilidades puderem ser atenuadas. Com isso em mente, uma das \nsolu\u00e7\u00f5es poss\u00edveis consiste no emprego de m\u00e9todos de automa\u00e7\u00e3o e controle. \n(FOSS, 2012) \n\n \nFigura 1.2: Ilustra\u00e7\u00e3o da influ\u00eancia das instabilidades oriundas do regime de \n\ngolfadas na produ\u00e7\u00e3o de petr\u00f3leo em malha aberta. Adaptado de Hu (2004) e Di \nMeglio et al. (2012). \n\n \n\n\n\n1.2 Objetivos 3 \n\nAlguns autores apresentaram resultados promissores utilizando um controlador \nPI com uma medida de press\u00e3o do fundo da tubula\u00e7\u00e3o (DALSMO; HALVORSEN; \nSLUPPHAUG, 2002; GODHAVN; FARD; FUCHS, 2005; HAVRE; STORNES; \nSTRAY, 2000). Contudo, medidas desse tipo nem sempre est\u00e3o dispon\u00edveis. Al\u00e9m \ndisso, um controlador t\u00e3o simples pode apresentar dificuldades de aplica\u00e7\u00e3o para \nfaixas maiores de pontos operacionais porque n\u00e3o incorpora termos de antecipa\u00e7\u00e3o \n(DI MEGLIO et al., 2012). \n\n1.2 Objetivos \nEsses obst\u00e1culos impulsionaram o desenvolvimento de modelos simplificados \n\nque pudessem descrever sistemas em regime de golfadas para melhorar a \nefici\u00eancia dos m\u00e9todos de controle. Modelos baseados em Equa\u00e7\u00f5es Diferenciais \nOrdin\u00e1rias s\u00e3o suficientes para capturar as principais caracter\u00edsticas das golfadas \n(DI MEGLIO; KAASA; PETIT, 2009; DIEHL et al., 2017; JANSEN, B\u00c5RD et al., \n1999; STORKAAS, E, 2005). Contudo, a obten\u00e7\u00e3o dos par\u00e2metros de ajuste \ndesses modelos \u00e9 complexa devido ao surgimento de ciclo limite. A literatura sobre \na estima\u00e7\u00e3o dos par\u00e2metros utilizando algoritmos de otimiza\u00e7\u00e3o tamb\u00e9m \u00e9 escassa \n(APIO; BOTELHO; TRIERWEILER, 2018; DIEHL et al., 2017). \n\nDessa forma, o objetivo prim\u00e1rio do presente trabalho \u00e9 melhorar a performance \nde algoritmos de otimiza\u00e7\u00e3o para estima\u00e7\u00e3o de par\u00e2metros de modelos com \nbifurca\u00e7\u00e3o Hopf atrav\u00e9s de uma nova metodologia baseada em M\u00ednimos \nQuadrados Ponderados. Foram estudados dois modelos simplificados para \nsistemas de eleva\u00e7\u00e3o de petr\u00f3leo. A nova metodologia foi aplicada em tr\u00eas casos \nde estudo: um caso te\u00f3rico com dist\u00farbio e discrep\u00e2ncia de modelo; e dois casos \ncom dados reais de opera\u00e7\u00e3o. O objetivo secund\u00e1rio do trabalho \u00e9 comparar \nestatisticamente os resultados obtidos com as metodologias dispon\u00edveis na \nliteratura.   \n\n1.3 Estrutura da disserta\u00e7\u00e3o \nO Cap\u00edtulo 2 apresenta os conhecimentos necess\u00e1rios para o melhor \n\nentendimento do trabalho. S\u00e3o apresentados os sistemas de eleva\u00e7\u00e3o de petr\u00f3leo, \nbem como as misturas multif\u00e1sicas envolvidas e as origens principais do regime de \ngolfadas. Tamb\u00e9m s\u00e3o discutidos os conceitos de ciclo limite e bifurca\u00e7\u00e3o Hopf, \nassim como as metodologias dispon\u00edveis na literatura para estima\u00e7\u00e3o de \npar\u00e2metros de modelos com esse tipo de bifurca\u00e7\u00e3o. Os principais m\u00e9todos de \ncontrole autom\u00e1tico baseado em modelo s\u00e3o comentados. Por fim, s\u00e3o \napresentados os modelos estudados e os m\u00e9todos de ajuste dos par\u00e2metros \nsugeridos pelos respectivos autores. \n\nO Cap\u00edtulo 3 mostra a influ\u00eancia do ciclo limite na estima\u00e7\u00e3o de par\u00e2metros com \nM\u00ednimos Quadrados. A nova fun\u00e7\u00e3o objetivo \u00e9 descrita em detalhes e suas \nvantagens s\u00e3o ilustradas com uma fun\u00e7\u00e3o senoidal. Para sua aplica\u00e7\u00e3o em \nmodelos de golfadas foi necess\u00e1ria a determina\u00e7\u00e3o de crit\u00e9rios de estabilidade dos \nconjuntos de dados estudados.  \n\nO Cap\u00edtulo 4 apresenta os recursos estat\u00edsticos empregados na avalia\u00e7\u00e3o dos \nresultados. A fundamenta\u00e7\u00e3o te\u00f3rica \u00e9 baseada na literatura e visa explicar as \nm\u00e9tricas utilizadas tanto para os resultados obtidos quanto para os resultados de \noutros trabalhos para comparar metodologias. \n\n \n\n\n\n4 Introdu\u00e7\u00e3o \n \n\n \n\nNo Cap\u00edtulo 5 s\u00e3o apresentados os resultados para tr\u00eas estudos de caso com \nbase em dois modelos. Para o primeiro modelo, s\u00e3o estudados tr\u00eas cen\u00e1rios em \nque diferentes refer\u00eancias s\u00e3o utilizadas na estima\u00e7\u00e3o; para o segundo, estudaram-\nse tr\u00eas cen\u00e1rios relacionados a um dos par\u00e2metros do modelo e tamb\u00e9m um \ncen\u00e1rio em que tr\u00eas refer\u00eancias s\u00e3o usadas em uma mesma estima\u00e7\u00e3o. \n\nO Cap\u00edtulo 6 apresenta as conclus\u00f5es e as sugest\u00f5es de trabalhos futuros. \nComenta-se a qualidade dos resultados obtidos e tamb\u00e9m poss\u00edveis estrat\u00e9gias \npara a estima\u00e7\u00e3o de par\u00e2metros de um dos modelos, baseadas nos resultados \napresentados. Outras aplica\u00e7\u00f5es da metodologia s\u00e3o sugeridas com base na \nversatilidade da obten\u00e7\u00e3o de um ciclo representativo de um conjunto de dados em \nciclo limite. \n\nPor fim, o Ap\u00eandice A \u2013 apresenta os principais c\u00f3digos implementados para a \nobten\u00e7\u00e3o dos resultados. S\u00e3o apresentados tanto c\u00f3digos autorais quanto c\u00f3digos \ndispon\u00edveis de forma gratuita. \n\n \n\n\n\n2.1 Sistemas de eleva\u00e7\u00e3o de petr\u00f3leo  5 \n \n\n \n\n  Revis\u00e3o bibliogr\u00e1fica \nNeste cap\u00edtulo ser\u00e3o descritos os sistemas de eleva\u00e7\u00e3o de petr\u00f3leo que utilizam \n\ngas-lift como fonte de eleva\u00e7\u00e3o artificial. S\u00e3o descritos os escoamentos multif\u00e1sicos \napresentados por esses sistemas, bem como as condi\u00e7\u00f5es para o surgimento do \nregime de golfadas. Tamb\u00e9m s\u00e3o definidos os conceitos de ciclo limite e bifurca\u00e7\u00e3o \nHopf. Comenta-se a metodologia de automa\u00e7\u00e3o e controle baseada em modelos \npara atenua\u00e7\u00e3o de golfadas. Por fim, s\u00e3o apresentados os modelos utilizados para \na obten\u00e7\u00e3o dos resultados deste trabalho. \n\n2.1 Sistemas de eleva\u00e7\u00e3o de petr\u00f3leo \nNa produ\u00e7\u00e3o de petr\u00f3leo, os sistemas de eleva\u00e7\u00e3o de po\u00e7os offshore s\u00e3o um \n\nconjunto de v\u00e1lvulas e longos tubos que transportam uma mistura complexa de \n\u00e1gua, areia, g\u00e1s e \u00f3leo proveniente de um reservat\u00f3rio para suas instala\u00e7\u00f5es de \nprocessamento de superf\u00edcie, conforme ilustrado na Figura 2.1. As se\u00e7\u00f5es do \nsistema podem ser divididas em reservat\u00f3rio, po\u00e7o, flowline, riser e instala\u00e7\u00f5es de \nsuperf\u00edcie. Os po\u00e7os transportam a mistura do reservat\u00f3rio at\u00e9 o fundo do mar. \nM\u00faltiplos po\u00e7os podem ser ligados a uma \u00fanica linha de produ\u00e7\u00e3o por um conjunto \nde v\u00e1lvulas chamado de manifold ou \"\u00e1rvore de Natal\". Do manifold, a mistura \nsegue pelo flowline conforme a disposi\u00e7\u00e3o da tubula\u00e7\u00e3o em rela\u00e7\u00e3o ao terreno. \nFinalmente, a tubula\u00e7\u00e3o inclina at\u00e9 a plataforma de produ\u00e7\u00e3o, na se\u00e7\u00e3o do riser. \n(DI MEGLIO et al., 2012) \n\nContudo, certas condi\u00e7\u00f5es de temperatura e press\u00e3o podem favorecer o \nsurgimento de um sistema bif\u00e1sico, um sistema trif\u00e1sico ou at\u00e9 um sistema com \nemuls\u00f5es. Ainda, muitos po\u00e7os apresentam o sistema gas-lift como fonte de \neleva\u00e7\u00e3o natural. Como ilustrado na Figura 2.2, esse sistema consiste em uma \ncasca externa ao po\u00e7o que injeta o g\u00e1s produzido na superf\u00edcie de volta \u00e0 linha de \nprodu\u00e7\u00e3o para diminuir a press\u00e3o hidrodin\u00e2mica e facilitar o fluxo da mistura. O uso \nde gas-lift \u00e9 comum porque aumenta a recupera\u00e7\u00e3o de produtos conforme o \nreservat\u00f3rio se aproxima do fim de sua vida \u00fatil, o que diminui sua press\u00e3o (RIZZO \nFILHO, 2011). \n\n\n\n6 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n \nFigura 2.1: Representa\u00e7\u00e3o de sistema de eleva\u00e7\u00e3o offshore. Adaptado de Di \n\nMeglio et al. (2012). \n\n \n\n \nFigura 2.2: Representa\u00e7\u00e3o de um sistema gas-lift. Adaptado de Aamo et al. \n\n(2005). \n\n\n\n2.2 Escoamento multif\u00e1sico 7 \n\n2.2 Escoamento multif\u00e1sico \nA natureza da mistura obtida dos reservat\u00f3rios faz com que o processo de \n\ndeslocar os produtos at\u00e9 plataformas de processamento envolva complexos \nescoamentos multif\u00e1sicos. A disposi\u00e7\u00e3o espacial das fases nos dutos pode \ncaracterizar regimes ou padr\u00f5es de escoamento com propriedades bem diferentes \nem rela\u00e7\u00e3o \u00e0 cl\u00e1ssica abordagem monof\u00e1sica para escoamentos (BAKER, 1954). \nA classifica\u00e7\u00e3o e as caracter\u00edsticas de escoamentos l\u00edquido-g\u00e1s s\u00e3o bem \nconhecidas e documentadas em revis\u00f5es sobre escoamento multif\u00e1sico (WALLIS, \n1969; WEISMAN, 1983). A partir da configura\u00e7\u00e3o da tubula\u00e7\u00e3o (vertical ou \nhorizontal), a maior influ\u00eancia no regime se d\u00e1 pela velocidade superficial de cada \nfase: \n\n (2.1) \n\n (2.2) \n\nonde  \u00e9 a velocidade superficial,   \u00e9 a taxa de fluxo volum\u00e9trico,  \u00e9 a \u00e1rea da \nse\u00e7\u00e3o transversal e os sub\u00edndices  e  representam l\u00edquido e g\u00e1s, \nrespectivamente. Regimes comuns s\u00e3o ilustrados na Figura 2.3 e na Figura 2.4. As \nclassifica\u00e7\u00f5es gerais de regime s\u00e3o (JAHANSHAHI, 2013): \n\n? Escoamento estratificado: somente poss\u00edvel para geometria horizontal. \nApresenta duas fases distintas de g\u00e1s e l\u00edquido em que o g\u00e1s permanece \nacima do l\u00edquido por diferen\u00e7a de massa espec\u00edfica. \n\n? Escoamento em bolha alongada: apresenta bolhas alongadas com tr\u00eas \nregi\u00f5es distintas: nariz, corpo e cauda. \n\n? Escoamento em golfadas: caracterizado por bolhas intermitentes cuja se\u00e7\u00e3o \ntransversal tende a ocupar toda a \u00e1rea dispon\u00edvel para escoamento da \ntubula\u00e7\u00e3o. \n\n? Escoamento em bolhas: apresenta bolhas de g\u00e1s dispersas no meio l\u00edquido. \n\n? Escoamento anular: a fase g\u00e1s \u00e9 predominante enquanto um filme de l\u00edquido \nescoa nas paredes do tubo. \n\nEstudos foram feitos para relacionar as velocidades superficiais de g\u00e1s e l\u00edquido \ncom os regimes de escoamento observados (BAKER, 1954; JANSEN, F.E.; \nSHOHAM; TAITEL, 1996; SCHMIDT; BRILL; BEGGS, 1980, 1979; WEISMAN; \nKANG, 1981). Os resultados foram usados para gerar mapas de escoamento que \nrepresentassem essas rela\u00e7\u00f5es graficamente, como ilustrado na Figura 2.5. Al\u00e9m \ndisso, esses estudos incluem esfor\u00e7os feitos na tentativa de matematicamente \nprever as regi\u00f5es de transi\u00e7\u00e3o. Apesar disso, os experimentos realizados \nrestringem a validade dos modelos preditivos por serem feitos utilizando tubula\u00e7\u00f5es \nde di\u00e2metro espec\u00edfico e misturas bif\u00e1sicas com caracter\u00edsticas f\u00edsico-qu\u00edmicas \ndistintas das misturas reais (BRENNEN, 2005). \n\n\n\n8 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n \nFigura 2.3: Tipos de escoamento horizontal. Adaptado de Jahanshahi (2013). \n\n \nFigura 2.4: Tipos de escoamento vertical. Adaptado de Jahanshahi (2013). \n\n\n\n2.3 Regime de golfadas 9 \n\n \nFigura 2.5: Mapa de regimes para escoamento vertical. Zonas tracejadas indicam \n\nregi\u00f5es de transi\u00e7\u00e3o. Adaptado de Weisman e Kang (1981). \n\n2.3 Regime de golfadas \nDentre os padr\u00f5es de escoamento multif\u00e1sicos observados, o regime de \n\ngolfadas \u00e9 um grande obst\u00e1culo para a produ\u00e7\u00e3o de petr\u00f3leo. Seu surgimento \ndecorre de uma distribui\u00e7\u00e3o n\u00e3o-homog\u00eanea de g\u00e1s e l\u00edquido em tubula\u00e7\u00f5es de \ntransporte de petr\u00f3leo, podendo causar significativas perdas na produ\u00e7\u00e3o e, \nconsequentemente, no lucro obtido. (DI MEGLIO et al., 2012) \n\nSob regime de golfadas, o sistema alterna entre per\u00edodos de alta produ\u00e7\u00e3o de \ng\u00e1s e baixa produ\u00e7\u00e3o de l\u00edquido e per\u00edodos com baixa produ\u00e7\u00e3o de g\u00e1s e alta \nprodu\u00e7\u00e3o de l\u00edquido. Existem seis tipos distintos de mecanismos para golfadas em \nsistemas de eleva\u00e7\u00e3o (JAHANSHAHI, 2013), tr\u00eas dos quais t\u00eam recebido maior \ninteresse na \u00e1rea de modelagem: golfadas por acidente, golfadas por casing-\nheading e golfadas por ondas de densidade. \n\n2.3.1 Golfadas por acidente \n\nEsse tipo de mecanismo ocorre quando acidentes na disposi\u00e7\u00e3o espacial da \ntubula\u00e7\u00e3o favorecem o ac\u00famulo de l\u00edquido em um ponto m\u00ednimo ou acidente. Seu \nsurgimento \u00e9 mais frequente no limite entre pipeline e riser. O mecanismo pode ser \ndescrito por um ciclo em quatro etapas, ilustrados pela Figura 2.6 (STORKAAS, \n2005): \n\n1. L\u00edquido acumula em um ponto de m\u00ednimo, bloqueando a passagem de \ng\u00e1s; \n\n2. G\u00e1s acumula \u00e0 montante do acidente em uma bolha; \n3. A press\u00e3o da bolha vence a press\u00e3o \u00e0 jusante, g\u00e1s come\u00e7a a fluir e \n\nl\u00edquido \u00e9 abruptamente expulso da tubula\u00e7\u00e3o; \n4. A press\u00e3o de g\u00e1s no acidente \u00e9 insuficiente para manter o fluxo atrav\u00e9s \n\ndo ponto de m\u00ednimo e l\u00edquido volta a acumular. \n\n\n\n10 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n \nFigura 2.6: Exemplo de ciclo das golfadas por acidente em sistemas pipeline-riser \n\nsendo a fase l\u00edquida representada em azul. Adaptado de Storkaas (2005). \n \n\n2.3.2 Golfadas por casing-heading \n\nOcorre em sistemas gas-lift, quando a v\u00e1lvula de inje\u00e7\u00e3o de g\u00e1s opera fora da \nzona supers\u00f4nica. Nessas condi\u00e7\u00f5es, varia\u00e7\u00f5es na diferen\u00e7a de press\u00e3o entre \ncasco e tubing t\u00eam impacto direto sobre a vaz\u00e3o de gas-lift para o tubing. O \nsurgimento das golfadas se d\u00e1 quando a vaz\u00e3o de g\u00e1s da superf\u00edcie \u00e9 insuficiente \npara manter a press\u00e3o do casco constante frente \u00e0s flutua\u00e7\u00f5es de vaz\u00e3o do g\u00e1s \ninjetado por causa das varia\u00e7\u00f5es de press\u00e3o no tubing. O processo pode ser \ndescrito como um ciclo com as seguintes etapas (AAMO et al., 2005): \n\n1. Conforme o g\u00e1s do casco anular flui para o tubing, a press\u00e3o do tubing \ndiminui, acelerando a entrada de g\u00e1s;  \n\n2. G\u00e1s empurra o l\u00edquido para fora do tubing, enquanto a press\u00e3o do casco \ndiminui drasticamente; \n\n3. A press\u00e3o do casco \u00e9 insuficiente para permitir o fluxo de g\u00e1s. L\u00edquido \ncome\u00e7a a acumular no tubing, e g\u00e1s, no casco; \n\n4. Eventualmente, o ac\u00famulo de g\u00e1s no casco permite a reentrada de g\u00e1s \nno tubing, e o ciclo recome\u00e7a. \n\n2.3.3 Golfadas por ondas de densidade \n\nEsse mecanismo ocorre em sistemas gas-lift quando a v\u00e1lvula de inje\u00e7\u00e3o opera \nem condi\u00e7\u00f5es supers\u00f4nicas. Nessa situa\u00e7\u00e3o, a taxa de inje\u00e7\u00e3o de gas-lift depende \napenas da press\u00e3o do casco, e n\u00e3o da diferen\u00e7a de press\u00e3o entre casco e tubing. \nPode-se descrever o processo c\u00edclico com as seguintes etapas (SINEGRE; PETIT; \nMENEGATTI, 2006): \n\n\n\n2.4 Ciclo limite e bifurca\u00e7\u00e3o Hopf 11 \n\n1. A produ\u00e7\u00e3o de \u00f3leo na superf\u00edcie \u00e9 nula, mas a press\u00e3o de fundo do \ntubing \u00e9 menor do que a press\u00e3o do reservat\u00f3rio. Assim, h\u00e1 fluxo de \u00f3leo \ndo reservat\u00f3rio para o sistema e a press\u00e3o de fundo do tubing aumenta; \n\n2. A press\u00e3o de fundo do tubing se torna constante e a entrada de \u00f3leo \ncessa. Contudo, a vaz\u00e3o de gas-lift \u00e9 constante, fazendo com que o \u00f3leo \nproduzido na etapa 1 alcance a superf\u00edcie. \n\n3. A produ\u00e7\u00e3o de \u00f3leo na etapa 2 causa uma queda de press\u00e3o no po\u00e7o. A \npress\u00e3o de fundo do tubing diminui, permitindo novamente a entrada de \n\u00f3leo no sistema. \n \n\n2.4 Ciclo limite e bifurca\u00e7\u00e3o Hopf \nAs perturba\u00e7\u00f5es causadas pelas golfadas se apresentam nos sistemas como \n\num ciclo limite est\u00e1vel. Ciclo limite \u00e9 uma solu\u00e7\u00e3o peri\u00f3dica de um sistema din\u00e2mico \nn\u00e3o linear quando para uma vari\u00e1vel  existe um tempo  tal que \n\n para todo . Para modelos, se a varia\u00e7\u00e3o de um par\u00e2metro  faz com que \no sistema migre de um estado de equil\u00edbrio para um ciclo limite a partir de um valor \n\n, ent\u00e3o o sistema apresenta bifurca\u00e7\u00e3o Hopf, onde  \u00e9 o ponto de bifurca\u00e7\u00e3o. \n(SEYDEL, 2010) \n\nUm exemplo de sistema com bifurca\u00e7\u00e3o Hopf \u00e9 dado pelas Equa\u00e7\u00f5es (2.3) e \n(2.4). Quando , o sistema apresenta equil\u00edbrio. A partir de , o sistema \nsempre apresenta ciclo limite. As duas condi\u00e7\u00f5es independem dos valores iniciais \nde  e , caracterizando a bifurca\u00e7\u00e3o Hopf (Figura 2.7). \n\n (2.3) \n (2.4) \n\n \nFigura 2.7: Bifurca\u00e7\u00e3o Hopf gerada a partir do exemplo. (SEYDEL, 2010) \n\n  \n\n\n\n12 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n2.5 Modelagem aplicada a automa\u00e7\u00e3o e controle \nDadas as instabilidades descritas anteriormente, torna-se interessante o uso de \n\nm\u00e9todos que atenuem as oscila\u00e7\u00f5es geradas pelo regime de golfadas. A solu\u00e7\u00e3o \nmais simples consiste na diminui\u00e7\u00e3o da abertura da v\u00e1lvula de produ\u00e7\u00e3o \n(SCHMIDT; BRILL; BEGGS, 1980, 1979). Isso elimina as oscila\u00e7\u00f5es, \ncaracterizando um sistema com bifurca\u00e7\u00e3o Hopf: valores menores do que o valor \ncr\u00edtico de abertura apresentam resposta amortecida, enquanto valores maiores \napresentam oscila\u00e7\u00f5es em ciclo limite est\u00e1vel. Contudo, a produ\u00e7\u00e3o total depende \ndiretamente da abertura da v\u00e1lvula. Assim, o aumento de produ\u00e7\u00e3o sem influ\u00eancia \nde golfadas se torna dependente do desenvolvimento de outros m\u00e9todos. \n\nConsiderando-se que os sistemas de eleva\u00e7\u00e3o est\u00e3o submersos, a manuten\u00e7\u00e3o \nde qualquer equipamento representa um custo elevado de dinheiro e tempo. Al\u00e9m \ndisso, o n\u00famero de instrumentos e de medidas dispon\u00edveis \u00e9 geralmente m\u00ednimo \ndevido a restri\u00e7\u00f5es impostas ao projeto do sistema (PEDERSEN; DURDEVIC; \nYANG, 2017). Com isso em mente, muitos autores t\u00eam proposto solu\u00e7\u00f5es pouco \ncustosas para aumento de produ\u00e7\u00e3o nessas condi\u00e7\u00f5es (BAILEY et al., 2014; DI \nMEGLIO et al., 2012; GODHAVN; FARD; FUCHS, 2005; HAVRE; DALSMO, 2002; \nJANSEN, F.E.; SHOHAM; TAITEL, 1996; SARICA; TENGESDAL, 2000; \nSKOGESTAD; JAHANSHAHI; HANSEN, 2012; STORNES; HAVRE; STRAY, \n2000). \n\nDentre os m\u00e9todos estudados est\u00e1 o controle preditivo baseado em modelos. \nEsse tipo de medida anti-golfada utiliza medidas de press\u00e3o do sistema de \neleva\u00e7\u00e3o para manipular a v\u00e1lvula de produ\u00e7\u00e3o. Contudo, a aplica\u00e7\u00e3o desse \nm\u00e9todo \u00e9 condicionada a modelos de baixa complexidade, que apresentem pouco \ncusto computacional. Modelos como o OLGA (BENDIKSEN et al., 1991), baseados \nem Equa\u00e7\u00f5es Diferenciais Parciais (EDP), apresentam alta precis\u00e3o ao custo de \num grande tempo computacional que impossibilita sua aplica\u00e7\u00e3o online.  \n\nJ\u00e1 modelos baseados em Equa\u00e7\u00f5es Diferenciais Ordin\u00e1rias apresentam baixo \ncusto computacional, gerando resultados numa pequena fra\u00e7\u00e3o do tempo de \nsimula\u00e7\u00e3o de modelos com EDP. Em contrapartida, esses modelos s\u00e3o baseados \nem simplifica\u00e7\u00f5es do sistema que requerem par\u00e2metros de ajuste de complexa \ndetermina\u00e7\u00e3o anal\u00edtica e de dif\u00edcil estima\u00e7\u00e3o num\u00e9rica (AAMO et al., 2005; DI \nMEGLIO; KAASA; PETIT, 2009; DIEHL et al., 2017; EIKREM; AAMO; FOSS, 2008; \nJAHANSHAHI, ESMAEIL; SKOGESTAD, 2011; SKOGESTAD; JAHANSHAHI; \nHANSEN, 2012; STORKAAS, ESPEN, 2005). \n\n2.6 Modelo de Di Meglio, Kaasa e Petit (2009) \nEm seu trabalho, Di Meglio, Kaasa e Petit (2009), tendo em vista os modelos \n\ndesenvolvidos at\u00e9 a data, propuseram um modelo simples que pudesse reproduzir \nas golfadas severas observadas na se\u00e7\u00e3o do riser. A grande contribui\u00e7\u00e3o dos \nautores est\u00e1 em utilizar fen\u00f4menos f\u00edsicos em conjunto com um mecanismo artificial \npara a simula\u00e7\u00e3o das golfadas. \n\n  \n\n\n\n2.6 Modelo de Di Meglio, Kaasa e Petit (2009) 13 \n\n2.6.1 Descri\u00e7\u00e3o do modelo \n\nConsidere a se\u00e7\u00e3o ilustrada na Figura 2.8. \u00c9 considerado que a geometria da \ntubula\u00e7\u00e3o favorece a obstru\u00e7\u00e3o e o ac\u00famulo de g\u00e1s. O fluxo de g\u00e1s atrav\u00e9s dessa \nobstru\u00e7\u00e3o \u00e9 modelado por uma v\u00e1lvula virtual. \u00c9 suposto que \u00e0 montante da v\u00e1lvula \nexiste um volume fixo de g\u00e1s, denominado de bolha alongada. Assumindo que a \nv\u00e1lvula n\u00e3o permite fluxo inverso, enquanto a press\u00e3o da bolha n\u00e3o excede a \npress\u00e3o hidrodin\u00e2mica do riser, n\u00e3o existe fluxo de g\u00e1s atrav\u00e9s da v\u00e1lvula, gerando \no ac\u00famulo de g\u00e1s que causa as instabilidades observadas.  \n\n \n\nFigura 2.8: Representa\u00e7\u00e3o do modelo de tr\u00eas estados. (DI MEGLIO et al., 2012) \n\nO modelo pressup\u00f5e ent\u00e3o a exist\u00eancia de tr\u00eas se\u00e7\u00f5es de ac\u00famulo distintas: \ndois volumes de g\u00e1s separados pela v\u00e1lvula virtual e um volume de l\u00edquido. Assim, \nas vari\u00e1veis de estado s\u00e3o a massa de g\u00e1s na bolha alongada, , a massa de \ng\u00e1s no riser, , e a massa de l\u00edquido no riser, . Do balan\u00e7o de massa, obt\u00e9m-\nse: \n\n (2.5) \n\n (2.6) \n\n (2.7) \n\nonde  e  s\u00e3o as taxas de vaz\u00e3o m\u00e1ssica entrando ( ) e saindo ( ) do \nriser para o l\u00edquido ( ) e para o g\u00e1s ( ),  \u00e9 a taxa de vaz\u00e3o m\u00e1ssica do g\u00e1s atrav\u00e9s \nda v\u00e1lvula virtual e  corresponde \u00e0 fra\u00e7\u00e3o do g\u00e1s que entra diretamente no \nriser, sendo o restante acumulado na bolha alongada de volume fixo . Dada a \nvaz\u00e3o m\u00e1ssica total , as seguintes suposi\u00e7\u00f5es s\u00e3o feitas: \n\n (2.8) \n\n\n\n14 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n (2.9) \n\nou seja, considera-se que . Originalmente, os autores propuseram que \nambas as v\u00e1lvulas virtual e de produ\u00e7\u00e3o fossem modeladas como v\u00e1lvulas lineares \nem rela\u00e7\u00e3o \u00e0s diferen\u00e7as de press\u00e3o, sem permitir fluxo inverso: \n\n (2.10) \n\n (2.11) \n\nonde  \u00e9 a press\u00e3o da bolha alongada,  \u00e9 a press\u00e3o na sa\u00edda da v\u00e1lvula \nvirtual,  \u00e9 a abertura da v\u00e1lvula de produ\u00e7\u00e3o,  \u00e9 a constante da v\u00e1lvula \nvirtual,  \u00e9 a constante da v\u00e1lvula de produ\u00e7\u00e3o e  \u00e9 a press\u00e3o do separador na \nsa\u00edda da v\u00e1lvula de produ\u00e7\u00e3o. Contudo, em trabalhos recentes a v\u00e1lvula de \nprodu\u00e7\u00e3o foi modificada de modo a melhor representar o fluxo bif\u00e1sico (DI MEGLIO \net al., 2010, 2012): \n\n (2.12) \n\nO volume de g\u00e1s no riser  \u00e9 considerado como todo o volume que n\u00e3o \u00e9 \nocupado pelo l\u00edquido no riser: \n\n (2.13) \n\n (2.14) \nonde  \u00e9 o volume do riser,  \u00e9 o comprimento da tubula\u00e7\u00e3o,  \u00e9 a \u00e1rea da se\u00e7\u00e3o \ntransversal,  \u00e9 a massa espec\u00edfica da fase l\u00edquida e  representa a massa de \nl\u00edquido sempre presente no riser que n\u00e3o \u00e9 afetada pela din\u00e2mica do sistema. Para \no c\u00e1lculo das press\u00f5es, o sistema \u00e9 considerado como dominado pelo efeito da \ngravidade, sendo a perda de carga desconsiderada. Al\u00e9m disso, assume-se que a \nLei dos Gases Ideais \u00e9 capaz de corretamente descrever o comportamento das \nfases gasosas: \n\n (2.15) \n\n (2.16) \n\n (2.17) \n\nonde  \u00e9 a press\u00e3o no riser,  \u00e9 a constante universal dos gases,  \u00e9 a \ntemperatura,  \u00e9 a massa molar da fase gasosa,  \u00e9 a acelera\u00e7\u00e3o da gravidade e \n\n \u00e9 a inclina\u00e7\u00e3o do riser. \nAssim, o modelo apresenta onze par\u00e2metros fixos relacionados \u00e0s \n\ncaracter\u00edsticas f\u00edsico-qu\u00edmicas e geom\u00e9tricas do sistema:  \n ; e cinco par\u00e2metros de ajuste -  e . Procedimentos \n\nde obten\u00e7\u00e3o dos par\u00e2metros foram propostos (DI MEGLIO et al., 2010; DI MEGLIO; \nKAASA; PETIT, 2009). Contudo, trabalhos que inclu\u00edram o modelo para fins de \n\n\n\n2.6 Modelo de Di Meglio, Kaasa e Petit (2009) 15 \n\ncompara\u00e7\u00e3o tentaram utilizar esses procedimentos e n\u00e3o obtiveram resultados \nsatisfat\u00f3rios, sendo que os par\u00e2metros foram ent\u00e3o ajustados por tentativa e erro \n(JAHANSHAHI, E. et al., 2014; JAHANSHAHI, 2013). \n\n2.6.2 Ajuste de par\u00e2metros \n\nEm seu trabalho, Di Meglio et al. (2010) descrevem m\u00e9todos de obten\u00e7\u00e3o dos \npar\u00e2metros. Contudo, diversas considera\u00e7\u00f5es s\u00e3o feitas para a determina\u00e7\u00e3o \nanal\u00edtica ou num\u00e9rica dos par\u00e2metros. Primeiramente, o modelo assume que as \nvaz\u00f5es de entrada s\u00e3o constantes. Isso facilita os c\u00e1lculos das equa\u00e7\u00f5es \ndiferenciais, mas os autores notam que esses valores n\u00e3o s\u00e3o constantes nem s\u00e3o \nmedidos nos sistemas reais. Assim, s\u00e3o utilizadas as pr\u00f3prias vaz\u00f5es m\u00e9dias de \nsa\u00edda, obtidas com medidores multif\u00e1sicos de vaz\u00e3o ou com simuladores como o \nOLGA. \n\nSegundo os autores, \u00e9 matematicamente dif\u00edcil de se estudar os impactos da \nconstante da v\u00e1lvula virtual  sobre a din\u00e2mica do sistema, de modo que \u00e9 \nsugerido um valor de  (kg.s.m-1). J\u00e1 a constante da v\u00e1lvula de produ\u00e7\u00e3o  \u00e9 \ngeralmente fornecida pelo fabricante. Por\u00e9m, a Equa\u00e7\u00e3o (2.12) assume que a \nmassa espec\u00edfica da mistura \u00e9 constante, o que significa que a press\u00e3o de topo na \ncondi\u00e7\u00e3o de equil\u00edbrio n\u00e3o representa o sistema para todos os valores de abertura.  \n\nA partir das vaz\u00f5es de entrada, os autores prop\u00f5em que a constante de v\u00e1lvula \nda sa\u00edda, , seja calculada em uma condi\u00e7\u00e3o de equil\u00edbrio utilizando-se uma \npress\u00e3o de topo medida   para uma \u00fanica abertura  tal que  , onde  \u00e9 \no ponto de bifurca\u00e7\u00e3o Hopf do sistema: \n\n \n(2.18) \n\nO par\u00e2metro  \u00e9 obtido para uma medida real da press\u00e3o de fundo   \npara a mesma abertura  : \n\n (2.19) \n\n (2.20) \n\n (2.21) \n\n (2.22) \n\nO volume da bolha alongada  \u00e9 determinado a partir da matriz Jacobiana do \nsistema na condi\u00e7\u00e3o cr\u00edtica, . Com o aux\u00edlio de um algoritmo de otimiza\u00e7\u00e3o, o \nvalor de  deve satisfazer a seguinte equa\u00e7\u00e3o: \n\n (2.23) \nonde  \u00e9 um dos dois autovalores complexos conjugados de . Por fim, a \nobten\u00e7\u00e3o do par\u00e2metro  depende da disponibilidade de medidas da press\u00e3o de \nfundo do riser. Quando essa medida existe, \u00e9 poss\u00edvel calcular o valor do par\u00e2metro \ncom o pico de press\u00e3o, : \n\n\n\n16 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n (2.24) \n\nSem essa medida, o valor deve ser obtido por tentativa e erro de forma a ajustar \na magnitude das oscila\u00e7\u00f5es da press\u00e3o de topo. \n\n2.7 Modelo de Diehl et al. (2017) \nDe forma a modelar o sistema de eleva\u00e7\u00e3o completo, ilustrado na Figura 2.9, \n\nDiehl et al. (2017) uniram e aprimoraram os trabalhos de Jahanshahi et al. (2012) \ne Di Meglio et al. (2012). O Fast Offshore Wells Model (FOWM) inclui as din\u00e2micas \nde reservat\u00f3rio, gas-lift, po\u00e7o e riser. \n\n2.7.1 Descri\u00e7\u00e3o do modelo \n\nPrimeiramente, considera-se que a principal for\u00e7a-motriz do processo \u00e9 a \npress\u00e3o do reservat\u00f3rio, , assumida constante. A taxa m\u00e1ssica de produ\u00e7\u00e3o do \nreservat\u00f3rio, , \u00e9 dada pelo modelo n\u00e3o-linear proposto por Vogel (1968): \n\n (2.25) \n\nonde  \u00e9 o coeficiente de fluxo do reservat\u00f3rio e  \u00e9 a press\u00e3o no fundo do po\u00e7o \n(bottomhole). Do reservat\u00f3rio em diante, as din\u00e2micas do sistema s\u00e3o modeladas \npor balan\u00e7o de massa. Considera-se que a mistura produzida pelo reservat\u00f3rio \u00e9 \ncomposta de uma fase g\u00e1s e uma fase l\u00edquida cuja fra\u00e7\u00e3o gasosa \u00e9 dada por . \nAs varia\u00e7\u00f5es de massa das fases no po\u00e7o s\u00e3o ent\u00e3o equacionadas por: \n\n (2.26) \n\n (2.27) \n\nonde   e   s\u00e3o as taxas de varia\u00e7\u00e3o m\u00e1ssica no tubing do g\u00e1s e do l\u00edquido, \n \u00e9 a taxa de vaz\u00e3o m\u00e1ssica de gas-lift do casco anular para o tubing e  \u00e9 a \n\ntaxa de vaz\u00e3o m\u00e1ssica do topo do po\u00e7o (wellhead) para o flowline. \u00c9 suposto que \no casco anular recebe uma vaz\u00e3o m\u00e1ssica de gas-lift constante, . A varia\u00e7\u00e3o \nm\u00e1ssica no casco \u00e9 equacionada por: \n\n (2.28) \n\nPor fim, a se\u00e7\u00e3o flowline-riser apresenta os tr\u00eas balan\u00e7os de massa de Di Meglio \net al.: \n\n (2.29) \n\n (2.30) \n\n (2.31) \n \n\n\n\n2.7 Modelo de Diehl et al. (2017) 17 \n\n \nFigura 2.9: Representa\u00e7\u00e3o do modelo de seis estados. (DIEHL et al., 2017) \n\n  \n\n\n\n18 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\nAs taxas de vaz\u00e3o m\u00e1ssica remanescentes s\u00e3o dadas por: \n\n (2.32) \n\n (2.33) \n\n (2.34) \n\n (2.35) \n\n (2.36) \n\n (2.37) \n\nonde  e  s\u00e3o as taxas m\u00e1ssicas da v\u00e1lvula virtual e da v\u00e1lvula de produ\u00e7\u00e3o, \nrespectivamente,  \u00e9 a massa espec\u00edfica no casco anular,  \u00e9 a massa \nespec\u00edfica m\u00e9dia do l\u00edquido, considerada constante,  \u00e9 a fra\u00e7\u00e3o de g\u00e1s no tubing \ne  \u00e9 a fra\u00e7\u00e3o de g\u00e1s no riser.  \n\nConsidera-se que a press\u00e3o de sa\u00edda do manifold \u00e9 a pr\u00f3pria press\u00e3o na base \ndo riser, ou seja, as din\u00e2micas do flowline s\u00e3o desconsideradas.  e  \ns\u00e3o constantes das equa\u00e7\u00f5es de v\u00e1lvula do sistema, enquanto  \u00e9 a fra\u00e7\u00e3o de \nabertura da v\u00e1lvula de produ\u00e7\u00e3o. Assume-se que n\u00e3o ocorre fluxo inverso em \nnenhum momento, o que \u00e9 equacionado pela fun\u00e7\u00e3o . A partir da Lei dos Gases \nideais, s\u00e3o obtidas as equa\u00e7\u00f5es: \n\n (2.38) \n\n (2.39) \n\n (2.40) \n\n (2.41) \n\n (2.42) \n\n (2.43) \n\n (2.44) \n\n (2.45) \n\n (2.46) \n\n\n\n2.7 Modelo de Diehl et al. (2017) 19 \n\n (2.47) \n\n (2.48) \n\nonde  \u00e9 a massa molar do g\u00e1s,  \u00e9 a constante universal dos gases,  \u00e9 a \ntemperatura,  \u00e9 a acelera\u00e7\u00e3o da gravidade,  \u00e9 a inclina\u00e7\u00e3o m\u00e9dia do riser,  \u00e9 o \nvolume do casco,  \u00e9 o comprimento do casco,  \u00e9 a press\u00e3o no casco,  \u00e9 a \npress\u00e3o de topo no tubing,  \u00e9 a press\u00e3o de fundo no tubing,  \u00e9 a press\u00e3o na \nposi\u00e7\u00e3o PDG (permanent downhole gauge),  \u00e9 a press\u00e3o de fundo no riser e  \n\u00e9 a press\u00e3o de topo no riser. A massa espec\u00edfica do reservat\u00f3rio  \u00e9 \nconsiderada constante.  \n\nAs dist\u00e2ncias verticais a partir do manifold at\u00e9 a v\u00e1lvula de gas-lift, o transmissor \nda PDG e a press\u00e3o de fundo no po\u00e7o s\u00e3o representadas respectivamente por \n\n e . Os par\u00e2metros geom\u00e9tricos do sistema s\u00e3o dados por:  \n\n (2.49) \n\n (2.50) \n\n (2.51) \n\n (2.52) \n\nonde  e  s\u00e3o respectivamente os di\u00e2metros da tubula\u00e7\u00e3o subsea, do casco \ne do tubing,  e  s\u00e3o a \u00e1rea da se\u00e7\u00e3o transversal e o volume da tubula\u00e7\u00e3o \nsubsea e  \u00e9 o volume do tubing.  \n\nAs massas espec\u00edficas de g\u00e1s e da mistura no tubing,  e , assim como o \nvolume de g\u00e1s do tubing  s\u00e3o dados por: \n\n (2.53) \n\n (2.54) \n\n (2.55) \n\nAssim, o modelo FOWM utiliza nove par\u00e2metros de ajuste: os cinco par\u00e2metros \ndo modelo de Di Meglio, Kaasa e Petit (  e ) e quatro par\u00e2metros \nadicionais (  e ). O par\u00e2metro  \u00e9 utilizado para ajuste do \nvolume da tubula\u00e7\u00e3o subsea. Como o sistema \u00e9 baseado em par\u00e2metros \nconcentrados, esse par\u00e2metro compensaria essa simplifica\u00e7\u00e3o de modo a melhor \najustar os resultados do modelo. Contudo, os autores recomendam o ajuste desse \npar\u00e2metro como \u00faltimo recurso, quando a otimiza\u00e7\u00e3o n\u00e3o apresenta resultados \nsatisfat\u00f3rios. \n\n  \n\n\n\n20 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n2.7.2 Ajuste de par\u00e2metros \n\nPara que o modelo consiga descrever o comportamento de diferentes sistemas, \nos algoritmos de otimiza\u00e7\u00e3o global Direct (FINKEL, 2005) e Particle Swarm \nOptimization (POLI; KENNEDY; BLACKWELL, 2007) s\u00e3o empregados. Como os \nsistemas reais apresentam bifurca\u00e7\u00e3o Hopf, uma fun\u00e7\u00e3o objetivo baseada em \nm\u00ednimos quadrados foi proposta de forma a penalizar condi\u00e7\u00f5es de equil\u00edbrio em \nfavor de situa\u00e7\u00f5es de ciclo limite. O conjunto de dados \u00e9 dividido em  janelas com \n\n pontos: \n\n (2.56) \n\nonde  \u00e9 a fun\u00e7\u00e3o objetivo,  \u00e9 o valor medido de press\u00e3o e  \u00e9 o valor simulado \nde press\u00e3o. Dado que a otimiza\u00e7\u00e3o do problema costuma atingir um m\u00ednimo local \nem que o sistema est\u00e1 em equil\u00edbrio, os par\u00e2metros  e  foram adicionados \ncomo um peso para cada ponto amostral  e para cada janela : \n\n (2.57) \n\n (2.58) \n\nonde  \u00e9 a m\u00e9dia dos dados simulados na janela ,  \u00e9 o desvio padr\u00e3o dos \ndados simulados na janela  e  \u00e9 o coeficiente de correla\u00e7\u00e3o de Pearson entre \ndados reais e simulados na janela . Assim,  \u00e9 um coeficiente normalizado, de \nmodo que ,  e  representam perfeita correla\u00e7\u00e3o negativa, \nnenhuma correla\u00e7\u00e3o e perfeita correla\u00e7\u00e3o positiva, respectivamente (DIEHL et al., \n2017). \n\nContudo, a hipersuperf\u00edcie de otimiza\u00e7\u00e3o \u00e9 complexa. Os autores notam que \nmesmo um algoritmo global pode ser incapaz de encontrar uma solu\u00e7\u00e3o adequada \nsem um ajuste cuidadoso dos limites de estima\u00e7\u00e3o dos par\u00e2metros. Por isso, \ntamb\u00e9m \u00e9 sugerida uma metodologia de ajuste dos par\u00e2metros com base em dados \nde projeto, dados de opera\u00e7\u00e3o ou dados de simuladores rigorosos. Os par\u00e2metros \n\n e  podem ser diretamente calculados com as Equa\u00e7\u00f5es (2.59) a (2.61), \nsabendo-se as vaz\u00f5es m\u00e1ssicas  e : \n\n \n(2.59) \n\n \n(2.60) \n\n \n(2.61) \n\n\n\n2.7 Modelo de Diehl et al. (2017) 21 \n\nA massa de l\u00edquido  pode ser determinada pelo m\u00e9todo proposto por Di \nMeglio et al. (2010). O par\u00e2metro  \u00e9 ajustado baseado em experi\u00eancia com o \nmodelo e requer um processo de tentativa e erro, embora  kg s m-1 seja \nconsiderado um valor inicial adequado para qualquer problema. A constante de \nprodu\u00e7\u00e3o  pode ser obtida atrav\u00e9s das informa\u00e7\u00f5es fornecidas pelo fabricante \nou atrav\u00e9s da Equa\u00e7\u00e3o (2.62): \n\n \n(2.62) \n\nJ\u00e1 os demais par\u00e2metros requerem dados de um simulador rigoroso. As \ninforma\u00e7\u00f5es de interesse nesse caso s\u00e3o as vaz\u00f5es m\u00e1ssicas de g\u00e1s no manifold \ne na sa\u00edda da v\u00e1lvula de produ\u00e7\u00e3o. A Figura 2.10 ilustra o comportamento desses \ndados, obtidos com o simulador OLGA. Os tempos  e  caracterizam os in\u00edcios \ndas fases de forma\u00e7\u00e3o e produ\u00e7\u00e3o da golfada de g\u00e1s, respectivamente  (FABRE et \nal., 1990). A fra\u00e7\u00e3o de g\u00e1s que entra pelo meio l\u00edquido pode ser ent\u00e3o calculada \npor: \n\n (2.63) \n\nO g\u00e1s acumulado \u00e9 considerado como a massa de g\u00e1s da bolha alongada. \nAssumindo-se uma massa espec\u00edfica m\u00e9dia da bolha, , o volume da bolha \u00e9 dado \npor: \n\n (2.64) \n\n \n\n \nFigura 2.10: Ciclo completo de uma golfada obtido com o simulador OLGA. \n\nAdaptado de Diehl et al. (2017). \n\n  \n\n\n\n22 Revis\u00e3o bibliogr\u00e1fica \n \n\n \n\n2.8 Estima\u00e7\u00e3o de par\u00e2metros para modelos com \nbifurca\u00e7\u00e3o Hopf \n\nPara melhor compreender as metodologias dispon\u00edveis para estima\u00e7\u00e3o de \npar\u00e2metros de modelos com ciclo limite, \u00e9 interessante destacar a import\u00e2ncia do \nM\u00e9todo de M\u00ednimos Quadrados. Esse m\u00e9todo baseia a fun\u00e7\u00e3o objetivo do problema \nde otimiza\u00e7\u00e3o em duas hip\u00f3teses. A primeira \u00e9 a Hip\u00f3tese do Modelo Perfeito. \nConsidere um modelo  dado pela fun\u00e7\u00e3o  com  estados e  par\u00e2metros: \n\n (2.65) \nAssumindo que o modelo descreve exatamente as rela\u00e7\u00f5es entre as vari\u00e1veis \n\ndo problema, o modelo \u00e9 dito perfeito. Isso significa que as medidas experimentais \n apresentam desvios em rela\u00e7\u00e3o ao modelo somente devido aos erros \n\nexperimentais : \n\n. (2.66) \n\nA segunda hip\u00f3tese \u00e9 a Hip\u00f3tese do Experimento Bem Feito. Se os erros de \nmedi\u00e7\u00e3o durante os experimentos equivalem ao m\u00ednimo erro admiss\u00edvel no \nprocesso de medi\u00e7\u00e3o, os experimentos s\u00e3o ditos bem feitos. Assim, os erros \nexperimentais n\u00e3o devem apresentar tend\u00eancia ou polariza\u00e7\u00e3o (m\u00e9dia zero). Em \ndecorr\u00eancia disso, \u00e9 poss\u00edvel avaliar a vari\u00e2ncia dos erros experimentais, , na \nforma: \n\n (2.67) \n\nonde  \u00e9 o n\u00famero de graus de liberdade e  \u00e9 o n\u00famero de experimentos. Dado \nque a vari\u00e2ncia  \u00e9 uma m\u00e9trica dos erros experimentais, torna-se interessante \nminimiz\u00e1-la. Como  \u00e9 constante, \u00e9 poss\u00edvel definir a fun\u00e7\u00e3o objetivo  como: \n\n (2.68) \n\nMinimizar a Equa\u00e7\u00e3o (2.68) corresponde ao M\u00e9todo de M\u00ednimos Quadrados. \nSua import\u00e2ncia se d\u00e1 pela interpreta\u00e7\u00e3o estat\u00edstica associada \u00e0 fun\u00e7\u00e3o objetivo \nrelativa \u00e0 vari\u00e2ncia dos erros experimentais. Contudo, sua aplica\u00e7\u00e3o em modelos \ncom bifurca\u00e7\u00e3o Hopf n\u00e3o \u00e9 capaz de produzir resultados que consigam representar \na periodicidade dos sistemas (APIO, 2017). \n\nNa literatura, metodologias t\u00eam sido desenvolvidas para estima\u00e7\u00e3o de \npar\u00e2metros de modelos com ciclo limite baseada no ponto de bifurca\u00e7\u00e3o (APIO; \nBOTELHO; TRIERWEILER, 2018; CEDERSUND; KNUDSEN, 2005; ELMAN et al., \n2012; GUCKENHEIMER; MYERS; STURMFELS, 1997; HYNNE; DAN\u00d8; \nS\u00d8RENSEN, 2001; HYNNE; GRAAE S\u00d8RENSEN; M\u00d8LLER, 1993; \nMEERBERGEN; SPENCE, 2010). Dentre essas, Apio (2017) prop\u00f4s uma fun\u00e7\u00e3o \nobjetivo baseada em m\u00ednimos quadrados com a soma de uma parcela relacionada \nao ponto de bifurca\u00e7\u00e3o: \n\n\n\n2.8 Estima\u00e7\u00e3o de par\u00e2metros para modelos com bifurca\u00e7\u00e3o Hopf 23 \n\n (2.69) \n\nonde  \u00e9 um peso cujo valor decai com o n\u00famero de itera\u00e7\u00f5es da otimiza\u00e7\u00e3o,  \n\u00e9 o fator de amortecimento associado ao modelo linearizado no seu estado \nestacion\u00e1rio e  \u00e9 o conjunto de par\u00e2metros estimado. \n\nContudo, m\u00e9todos baseados no ponto de bifurca\u00e7\u00e3o requerem a determina\u00e7\u00e3o \nexata desse ponto. Apesar de apresentarem resultados te\u00f3ricos eficientes, esses \nm\u00e9todos tamb\u00e9m apresentam dificuldades de aplica\u00e7\u00e3o pratica. A localiza\u00e7\u00e3o exata \ndo ponto de bifurca\u00e7\u00e3o nem sempre \u00e9 conhecida e pode mudar conforme as \ncondi\u00e7\u00f5es do sistema. \n\nCom isso em mente, alguns autores t\u00eam proposto modifica\u00e7\u00f5es \u00e0 fun\u00e7\u00e3o \nobjetivo como alternativa para melhorar a performance de algoritmos de otimiza\u00e7\u00e3o \nem sistemas com ciclo limite (DIEHL et al., 2017; GEREVINI, 2017; H\u00dcFFNER, \n2018). Diehl et al. (2017) propuseram uma fun\u00e7\u00e3o objetivo baseada em m\u00ednimos \nquadrados que divide o conjunto de dados em  janelas e utiliza pesos  e  \npara melhor ajustar dados em ciclo limite: \n\n (2.70) \n\n(2.71) \n\n(2.72) \n\nonde  e  s\u00e3o respectivamente a m\u00e9dia e o desvio padr\u00e3o das medidas \nsimuladas da janela , e  \u00e9 o coeficiente de correla\u00e7\u00e3o de Pearson entre as \nmedidas e o modelo. Gerevini (2017) prop\u00f4s uma fun\u00e7\u00e3o objetivo baseada em \nm\u00ednimos quadrados com a soma de uma parcela relacionada ao per\u00edodo e \u00e0 \nderivada em cada ponto experimental: \n\n (2.73) \n\nonde  \u00e9 o per\u00edodo. As derivadas s\u00e3o calculadas numericamente atrav\u00e9s de \ndiferen\u00e7as finitas: \n\n (2.74) \n\nH\u00fcffner (2018) prop\u00f4s uma fun\u00e7\u00e3o objetivo baseada na soma de diferen\u00e7as \nquadr\u00e1ticas relacionadas ao per\u00edodo, ao n\u00famero de oscila\u00e7\u00f5es e \u00e0 m\u00e9dia: \n\n (2.75) \n\nonde  \u00e9 o per\u00edodo,  \u00e9 o n\u00famero de oscila\u00e7\u00f5es e   \u00e9 a m\u00e9dia das medidas de \npress\u00e3o. \n\n \n\n\n\n3.1 Qualidade dos modelos \n 24 \n \n\n \n\n  Fundamentos de avalia\u00e7\u00e3o \nestat\u00edstica para modelos \n\nPara se quantificar a qualidade dos resultados obtidos, \u00e9 necess\u00e1rio o uso de \nrecursos estat\u00edsticos. As se\u00e7\u00f5es a seguir descrevem a metodologia adotada para \nfazer essa avalia\u00e7\u00e3o dos resultados. Todos os m\u00e9todos foram baseados no livro de \nSchwaab e Pinto (2007). \n\n3.1 Qualidade dos modelos \nPara comprovar a qualidade representativa dos modelos em rela\u00e7\u00e3o aos dados \n\nde refer\u00eancia utilizados, dois crit\u00e9rios estat\u00edsticos s\u00e3o empregados. O primeiro \ncrit\u00e9rio \u00e9 um teste Chi Quadrado com o valor \u00f3timo da fun\u00e7\u00e3o objetivo: \n\n (3.1) \n\n (3.2) \n\n (3.3) \n\nonde  \u00e9 a fun\u00e7\u00e3o objetivo de M\u00ednimos Quadrados Ponderados,  \u00e9 o \nconjunto de par\u00e2metros obtidos na estima\u00e7\u00e3o,  \u00e9 a fun\u00e7\u00e3o Chi Quadrado,  \u00e9 o \ngrau de confian\u00e7a e  \u00e9 o n\u00famero de graus de liberdade, definido pela diferen\u00e7a \nentre o n\u00famero de experimentos e o n\u00famero de par\u00e2metros. Caso a desigualdade \nseja satisfeita, o modelo representa suficientemente bem os dados experimentais. \nCaso contr\u00e1rio, duas situa\u00e7\u00f5es podem ocorrer: \n\n? : o modelo reproduz os dados experimentais melhor do \nque o esperado; \n\n? : o modelo n\u00e3o explica os erros experimentais de forma \nsatisfat\u00f3ria. \n\n \n\n\n\n3.2 Qualidade dos par\u00e2metros 25 \n\nA primeira situa\u00e7\u00e3o indica que h\u00e1 algo errado, porque um modelo n\u00e3o pode levar \na previs\u00f5es melhores do que os dados usados para ger\u00e1-lo. Portanto, o modelo \nest\u00e1 provavelmente superparametrizado e pode ser simplificado. Tamb\u00e9m \u00e9 \nposs\u00edvel que os erros experimentais estejam superestimados, abrindo margem para \nse reavaliar a precis\u00e3o das informa\u00e7\u00f5es de refer\u00eancia. J\u00e1 a segunda situa\u00e7\u00e3o indica \nque os erros de predi\u00e7\u00e3o s\u00e3o significativamente maiores do que os erros \nexperimentais, indicando que o modelo pode ser aperfei\u00e7oado. Analogamente \u00e0 \nprimeira situa\u00e7\u00e3o, \u00e9 poss\u00edvel que os erros experimentais estejam subestimados, \ntamb\u00e9m sugerindo a reavalia\u00e7\u00e3o dos dados de refer\u00eancia. \n\nO segundo crit\u00e9rio \u00e9 definido a partir de um coeficiente de correla\u00e7\u00e3o entre os \nvalores experimentais e os valores calculados, , definido como: \n\n (3.4) \n\nonde  \u00e9 o n\u00famero de experimentos,  s\u00e3o as amostras do ciclo obtido para os \ndados experimentais,  s\u00e3o as amostras do ciclo obtido para os dados simulados \ne   \u00e9 o valor m\u00e9dio. Esse crit\u00e9rio quantifica o quanto os dados simulados \nacompanham a tend\u00eancia dos dados experimentais. Se o valor obtido \u00e9 superior a \n\n, o modelo \u00e9 satisfat\u00f3rio e os valores preditos variam linear e proporcionalmente \ncom os valores experimentais. Assim, um modelo representativo e um conjunto de \ndados de boa qualidade satisfazem os dois crit\u00e9rios. \n\n3.2 Qualidade dos par\u00e2metros \nPara se determinar a qualidade dos par\u00e2metros, \u00e9 necess\u00e1rio que se calcule a \n\nmatriz de covari\u00e2ncia dos par\u00e2metros, . Contudo, solu\u00e7\u00f5es anal\u00edticas para esse \nc\u00e1lculo s\u00f3 existem para modelos lineares. Dada a n\u00e3o-linearidade dos modelos \nestudados, \u00e9 conveniente que se obtenha a matriz  de forma num\u00e9rica. \nConsiderando a aus\u00eancia de erros de medida nas vari\u00e1veis independentes, \u00e9 \nposs\u00edvel definir a matriz  a partir da matriz Hessiana  para  par\u00e2metros: \n\n (3.5) \n\n (3.6) \n\nDefinindo-se a fun\u00e7\u00e3o objetivo como: \n\n (3.7) \n\n\n\n26 Fundamentos de avalia\u00e7\u00e3o estat\u00edstica para modelos \n \n\n \n\n (3.8) \n\n\u00c9 poss\u00edvel reescrever os elementos  da matriz Hessiana  como: \n\n (3.9) \n\nSupondo que as diferen\u00e7as entres os valores preditos e os valores observados \ns\u00e3o pequenas e que flutuam ao redor do zero de forma aleat\u00f3ria (hip\u00f3tese do \nmodelo perfeito e hip\u00f3tese do experimento bem feito), o termo  pode ser \ndesconsiderado. Assim, a matriz Hessiana pode ser calculada atrav\u00e9s da matriz de \nsensibilidade : \n\n (3.10) \n\n (3.11) \n\nEsse resultado \u00e9 chamado de Aproxima\u00e7\u00e3o de Gauss e sua import\u00e2ncia surge \npelo fato de que a matriz  pode ent\u00e3o ser calculada utilizando-se apenas \nderivadas primeiras dos valores preditos em rela\u00e7\u00e3o aos par\u00e2metros: \n\n (3.12) \nAs derivadas podem ser obtidas numericamente atrav\u00e9s de diferen\u00e7as finitas \n\ncentrais para um passo  com um erro de ordem : \n\n (3.13) \n\nAssim, obt\u00e9m-se uma matriz que cont\u00e9m as vari\u00e2ncias de cada par\u00e2metro bem \ncomo a covari\u00e2ncia entre cada par de par\u00e2metros. Para facilitar a interpreta\u00e7\u00e3o das \ncovari\u00e2ncias, \u00e9 interessante definir o coeficiente de correla\u00e7\u00e3o param\u00e9trica entre \num par de par\u00e2metros  e : \n\n \n(3.14) \n\nEssa defini\u00e7\u00e3o leva a uma matriz de correla\u00e7\u00f5es  da forma: \n\n\n\n3.2 Qualidade dos par\u00e2metros 27 \n\n (3.15) \n\nEssa matriz cont\u00e9m todas as correla\u00e7\u00f5es entre todos os pares de par\u00e2metros e \nsua interpreta\u00e7\u00e3o \u00e9 facilitada, visto que os coeficientes de correla\u00e7\u00e3o sempre \napresentam valores entre  e . Valores positivos ou negativos indicam \ncorrela\u00e7\u00f5es positivas ou negativas, ou seja, o aumento de um par\u00e2metro causa um \naumento ou uma diminui\u00e7\u00e3o em seu par em quest\u00e3o, respectivamente.  \n\nValores pr\u00f3ximos de zero aumentam a efici\u00eancia dos procedimentos de \nestima\u00e7\u00e3o. Por outro lado, valores absolutos de correla\u00e7\u00e3o acima de 0.9 indicam \ncorrela\u00e7\u00e3o alta. O resultado disso \u00e9 que os par\u00e2metros n\u00e3o podem ser obtidos \nindependentemente e que, ao inv\u00e9s de um intervalo de confian\u00e7a, torna-se \nnecess\u00e1ria uma regi\u00e3o de confian\u00e7a para avaliar a faixa de validade dos \npar\u00e2metros. \n\n3.2.1 Intervalos de confian\u00e7a \n\nDefine-se como intervalo de confian\u00e7a o conjunto de resultados que concentra \n% dos resultados poss\u00edveis, dada uma distribui\u00e7\u00e3o de probabilidades. Em outras \n\npalavras, intervalos de confian\u00e7a s\u00e3o faixas de valores dentro das quais qualquer \nvalor do par\u00e2metro em quest\u00e3o mant\u00e9m a qualidade do ajuste do modelo aos dados \nexperimentais com grau de confian\u00e7a . Se os erros s\u00e3o normalmente distribu\u00eddos, \no intervalo de confian\u00e7a toma a forma: \n\n (3.16) \n\nonde   \u00e9 o par\u00e2metro \u00f3timo,  \u00e9 o desvio padr\u00e3o do par\u00e2metro,  \u00e9 o valor da \ndistribui\u00e7\u00e3o normal para uma probabilidade  e  \u00e9 o grau de confian\u00e7a \nutilizado. Qualquer par\u00e2metro  que satisfa\u00e7a a desigualdade \u00e9 capaz de manter a \nqualidade do modelo. \n\nPor\u00e9m, a Equa\u00e7\u00e3o (3.16) assume que o erro dos par\u00e2metros segue a \ndistribui\u00e7\u00e3o normal, ou seja, muitas medidas experimentais est\u00e3o dispon\u00edveis. Para \num n\u00famero pequeno de graus de liberdade, torna-se conveniente utilizar a \ndistribui\u00e7\u00e3o t de Student. Isso causa o aumento do intervalo de confian\u00e7a frente \u00e0 \nlimita\u00e7\u00e3o dos graus de liberdade, modificando a desigualdade: \n\n (3.17) \n\nOnde  \u00e9 a estimativa do desvio padr\u00e3o do par\u00e2metro e  \u00e9 o valor da distribui\u00e7\u00e3o \nt para uma probabilidade  com  graus de liberdade. \n\n3.2.2 Regi\u00f5es de confian\u00e7a \n\nQuando existem altas correla\u00e7\u00f5es entre par\u00e2metros, os intervalos de confian\u00e7a \nn\u00e3o representam adequadamente a faixa de validade dos par\u00e2metros. Ao inv\u00e9s de \num intervalo, utiliza-se uma regi\u00e3o dentro da qual os valores dos par\u00e2metros \nmant\u00eam a qualidade do modelo. Assumindo que a vari\u00e2ncia experimental \u00e9 \nconhecida com precis\u00e3o e que os par\u00e2metros seguem a distribui\u00e7\u00e3o normal, \u00e9 \nposs\u00edvel aproximar a fun\u00e7\u00e3o objetivo por uma s\u00e9rie de Taylor truncada no termo \nquadr\u00e1tico em torno do ponto \u00f3timo, obtendo-se duas rela\u00e7\u00f5es em termos da \ndistribui\u00e7\u00e3o Chi Quadrado: \n\n\n\n28 Fundamentos de avalia\u00e7\u00e3o estat\u00edstica para modelos \n \n\n \n\n (3.18) \n\n (3.19) \n\nonde  \u00e9 o n\u00famero de par\u00e2metros e  \u00e9 o valor da fun\u00e7\u00e3o Chi Quadrado com \n graus de liberdade e grau de confian\u00e7a .  \nQuando a vari\u00e2ncia experimental n\u00e3o \u00e9 precisamente conhecida, \u00e9 poss\u00edvel \n\nreescrever as rela\u00e7\u00f5es anteriores em termos da distribui\u00e7\u00e3o F de Fisher: \n\n (3.20) \n\n (3.21) \n\nonde  \u00e9 o n\u00famero de amostras e  \u00e9 o valor da fun\u00e7\u00e3o F com  e \n graus de liberdade para um grau de confian\u00e7a . Esse formato leva a regi\u00f5es \n\nde confian\u00e7a maiores, mas isso representa o custo por n\u00e3o se conhecer a vari\u00e2ncia \nexperimental. As Equa\u00e7\u00f5es (3.18) e (3.20) levam a regi\u00f5es el\u00edpticas. J\u00e1 as \nEqua\u00e7\u00f5es (3.19) e (3.21) n\u00e3o for\u00e7am o formato el\u00edptico, o que para modelos n\u00e3o-\nlineares pode levar a resultados distintos e mais corretos, mas sua obten\u00e7\u00e3o \nrepresenta um alto custo computacional porque requer muitas avalia\u00e7\u00f5es da fun\u00e7\u00e3o \nobjetivo. \n\nA regi\u00e3o de confian\u00e7a torna-se mais complexa quanto maior o n\u00famero de \npar\u00e2metros. Quando esse n\u00famero \u00e9 maior do que tr\u00eas, a visualiza\u00e7\u00e3o gr\u00e1fica s\u00f3 \u00e9 \nposs\u00edvel atrav\u00e9s da proje\u00e7\u00e3o da sombra da hiper-regi\u00e3o para cada par de \npar\u00e2metros. Para o formato el\u00edptico, \u00e9 conveniente decompor a matriz  em \nautovetores e autovalores: \n\n (3.22) \n\nonde  s\u00e3o os autovetores e  s\u00e3o os autovalores. Al\u00e9m disso, definindo-se: \n (3.23) \n\nDa Equa\u00e7\u00e3o (3.18), obt\u00e9m-se: \n\n (3.24) \n\nQue tem a forma expl\u00edcita: \n\n (3.25) \n\nA partir da Equa\u00e7\u00e3o (3.25), torna-se trivial o uso de m\u00e9todos impl\u00edcitos de \nplotagem de elipses. Considerando-se dois par\u00e2metros  e , qualquer par de \n\nparcelas da forma  representa uma proje\u00e7\u00e3o da sombra da hiper-\n\nelipse. Considerando que , a visualiza\u00e7\u00e3o da sombra requer a obten\u00e7\u00e3o dos \n\n\n\n3.3 Qualidade de predi\u00e7\u00e3o do modelo 29 \n\ncomprimentos do semi-eixo principal, , e do semi-eixo secund\u00e1rio, , assim como \ndo \u00e2ngulo de inclina\u00e7\u00e3o, : \n\n (3.26) \n\n (3.27) \n\n (3.28) \n\n3.2.3 Compara\u00e7\u00e3o entre conjuntos de par\u00e2metros \n\nPara avaliar os par\u00e2metros obtidos neste trabalho frente a outros par\u00e2metros, \num teste F bilateral \u00e9 empregado. Primeiro, obt\u00e9m-se um ciclo caracter\u00edstico do \nmodelo para cada conjunto de par\u00e2metros. A partir do valor da Fun\u00e7\u00e3o Objetivo \n\n, dividindo-se pelo n\u00famero de graus de liberdade , obt\u00e9m-se a vari\u00e2ncia dos \nmodelos: \n\n   (3.29) \n\nA hip\u00f3tese nula  \u00e9 de que n\u00e3o h\u00e1 diferen\u00e7a entre as duas vari\u00e2ncias para um \nn\u00edvel de confian\u00e7a : \n\n  (3.30) \n\nonde  \u00e9 o valor da distribui\u00e7\u00e3o de Fisher. Se a hip\u00f3tese nula \u00e9 aceita, n\u00e3o \u00e9 \nposs\u00edvel comprovar estatisticamente com grau de confian\u00e7a  que existe diferen\u00e7a \nna qualidade de ajuste entre os conjuntos de par\u00e2metros avaliados.  \n\n3.3 Qualidade de predi\u00e7\u00e3o do modelo \nNa Se\u00e7\u00e3o 3.1, comentou-se sobre a avalia\u00e7\u00e3o da qualidade do modelo. Os \n\ncrit\u00e9rios dessa avalia\u00e7\u00e3o s\u00e3o relacionados \u00e0s caracter\u00edsticas gerais do modelo e \nquantificam a qualidade do ajuste aos dados. Por outro lado, torna-se interessante \ntamb\u00e9m quantificar os erros de predi\u00e7\u00e3o do modelo, que mostram explicitamente a \ninflu\u00eancia da propaga\u00e7\u00e3o dos erros param\u00e9tricos sobre a capacidade preditiva. \nAtrav\u00e9s da Aproxima\u00e7\u00e3o de Gauss, \u00e9 poss\u00edvel calcular as vari\u00e2ncias de predi\u00e7\u00e3o: \n\n (3.31) \n\nonde  \u00e9 a matriz das vari\u00e2ncias de predi\u00e7\u00e3o. O eixo diagonal de  \u00e9 composto \ndos valores das vari\u00e2ncias de predi\u00e7\u00e3o   para cada ponto experimental . A \npartir disso \u00e9 poss\u00edvel plotar os valores preditos com os valores observados e suas \nrespectivas vari\u00e2ncias, o que mostra graficamente a influ\u00eancia dos desvios \nexperimentais e dos desvios de predi\u00e7\u00e3o sobre o resultado do modelo.  \n\nModelos bons com dados de refer\u00eancia adequados apresentam diferen\u00e7as entre \nvalores preditos e valores observados condizentes com os desvios envolvidos. \nQuando isso n\u00e3o ocorre, \u00e9 poss\u00edvel que o modelo seja ruim ou que os desvios \nexperimentais est\u00e3o subestimados. Al\u00e9m disso, se os valores apresentam uma \ntend\u00eancia fora da linha central dos valores observados, \u00e9 poss\u00edvel que o modelo \nn\u00e3o apresente desempenho uniforme na regi\u00e3o dos dados de refer\u00eancia.\n\n\n\n4.1 Fun\u00e7\u00f5es objetivo \n 30 \n \n\n \n\n Metodologia \nCom base nos procedimentos de ajuste de par\u00e2metros dos modelos de \n\ninteresse, fica evidente a possibilidade de melhorias frente aos m\u00e9todos propostos. \nNeste cap\u00edtulo ser\u00e3o abordadas as dificuldades de estima\u00e7\u00e3o de par\u00e2metros para \nmodelos com ciclo limite, em particular os que apresentam bifurca\u00e7\u00e3o Hopf. Uma \nnova fun\u00e7\u00e3o objetivo \u00e9 proposta de forma a melhorar o desempenho de algoritmos \nde otimiza\u00e7\u00e3o utilizando tratamento e sobreposi\u00e7\u00e3o de dados. \n\n4.1 Fun\u00e7\u00f5es objetivo \nO alicerce de um problema de otimiza\u00e7\u00e3o \u00e9 a boa formula\u00e7\u00e3o da fun\u00e7\u00e3o objetivo \n\na ser minimizada. A fun\u00e7\u00e3o mais simples consiste na soma dos m\u00ednimos quadrados. \nAs se\u00e7\u00f5es a seguir visam ilustrar a resposta desta e outras fun\u00e7\u00f5es objetivo para \nmodelos com ciclo limite. \n\n4.1.1 Modelos com ciclo limite \n\nEm seu trabalho, Nabavi e Williams (2012) propuseram uma nova fun\u00e7\u00e3o \nobjetivo para sistemas biol\u00f3gicos oscilat\u00f3rios. O cerne da metodologia est\u00e1 em \nutilizar um conjunto de dados din\u00e2micos em ciclo limite para se obter um \u00fanico ciclo \nrepresentativo a ser usado na estima\u00e7\u00e3o de par\u00e2metros. A motiva\u00e7\u00e3o desse \nm\u00e9todo \u00e9 o comportamento da soma de m\u00ednimos quadrados para modelos \noscilat\u00f3rios frente a par\u00e2metros que tenham impacto direto na frequ\u00eancia do \nsistema. Para ilustrar o problema em quest\u00e3o, m\u00ednimos quadrados foram aplicados \nentre uma fun\u00e7\u00e3o seno de refer\u00eancia e uma fun\u00e7\u00e3o seno estimada em rela\u00e7\u00e3o ao \nper\u00edodo, da forma: \n\n (4.1) \n\n (4.2) \n\n (4.3) \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 31 \n \n \nonde  \u00e9 a fun\u00e7\u00e3o de refer\u00eancia,  \u00e9 a fun\u00e7\u00e3o estimada,  \u00e9 o conjunto de \npar\u00e2metros de ajuste da fun\u00e7\u00e3o estimada (representando per\u00edodo e fase) e  \u00e9 \na fun\u00e7\u00e3o objetivo de m\u00ednimos quadrados. Como mostra a Figura 4.1, a varia\u00e7\u00e3o do \nper\u00edodo faz com que a fun\u00e7\u00e3o objetivo oscile ao redor do \u00f3timo, criando m\u00ednimos \nlocais. Al\u00e9m disso, a condi\u00e7\u00e3o inicial do sistema, dada pela fase, tamb\u00e9m causa \noscila\u00e7\u00f5es da fun\u00e7\u00e3o objetivo. Isso inviabiliza a utiliza\u00e7\u00e3o de algoritmos locais de \notimiza\u00e7\u00e3o, enquanto algoritmos globais t\u00eam sua performance prejudicada porque \na regi\u00e3o convexa ao redor do \u00f3timo \u00e9 extremamente restrita. \n\nCom isso em mente, Nabavi e Williams utilizaram tratamento de dados para \ntornar a fun\u00e7\u00e3o objetivo mais convexa. Para ilustrar o m\u00e9todo, considere tr\u00eas \nfun\u00e7\u00f5es senoidais id\u00eanticas \u00e0 equa\u00e7\u00e3o (4.2) de per\u00edodos ,  e \n\n (Figura 4.2), com fase . Assumindo que um ciclo \n\u00e9 constitu\u00eddo por todos os pontos entre dois vales consecutivos, obt\u00e9m-se um ciclo \ncaracter\u00edstico para cada conjunto de dados. Para a soma de m\u00ednimos quadrados \nutiliza-se o ciclo de refer\u00eancia, , e o ciclo estimado,  (Figura 4.3). \n\nOs autores prop\u00f5em, dada uma diferen\u00e7a de per\u00edodos entre ciclos, que a falta \nde amostras entre conjuntos de dados seja suprida preenchendo-se o menor ciclo \ncom zeros. Assim, as equa\u00e7\u00f5es dos ciclos s\u00e3o dadas por: \n\n (4.4) \n\n (4.5) \n\nonde  \u00e9 o ciclo de refer\u00eancia,   \u00e9 o ciclo estimado,   \u00e9 o vetor dos \npar\u00e2metros estimados,  \u00e9 o per\u00edodo de refer\u00eancia e   \u00e9 o per\u00edodo estimado. \nQuando condi\u00e7\u00f5es peri\u00f3dicas n\u00e3o s\u00e3o identificadas, nenhuma altera\u00e7\u00e3o aos dados \n\u00e9 feita: \n\n (4.6) \n\n (4.7) \n\nEssas modifica\u00e7\u00f5es resultam em uma fun\u00e7\u00e3o objetivo convexa, como ilustra a \nFigura 4.4. Contudo, a convexidade obtida \u00e9 altamente dependente da taxa de \namostragem  utilizada. Para taxas suficientemente pequenas, as equa\u00e7\u00f5es \nsenoidais apresentam o resultado anterior, mostrando comportamento de fun\u00e7\u00f5es \ncont\u00ednuas. Conforme a taxa de amostragem aumenta, a fun\u00e7\u00e3o objetivo come\u00e7a a \napresentar uma tend\u00eancia convexa com comportamento tipo serrote ao redor do \n\u00f3timo, como mostrado na Figura 4.5. Al\u00e9m disso, o m\u00e9todo requer o uso de um \nciclo caracter\u00edstico para cada conjunto de dados (refer\u00eancia e estimativa).  \n\n\n\n32 Metodologia \n \n\n \n\n \nFigura 4.1: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis, da fun\u00e7\u00e3o objetivo \n\nde m\u00ednimos quadrados para o exemplo. \n\n \nFigura 4.2: Fun\u00e7\u00f5es senoidais utilizadas como exemplo. \n\n \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 33 \n \n \n\n \nFigura 4.3: Ciclos de refer\u00eancia para compara\u00e7\u00e3o ponto a ponto. \n\n \nFigura 4.4: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis. da fun\u00e7\u00e3o objetivo \n\nproposta por Nabavi e Williams para o exemplo. \n\nPara sistemas perfeitamente peri\u00f3dicos como a fun\u00e7\u00e3o seno, a obten\u00e7\u00e3o de um \nciclo representativo \u00e9 direta e n\u00e3o requer nenhuma modifica\u00e7\u00e3o adicional. Na \npr\u00e1tica, sistemas sob regime de golfadas n\u00e3o s\u00e3o perfeitamente peri\u00f3dicos e ainda \npodem apresentar flutua\u00e7\u00f5es relevantes nas medi\u00e7\u00f5es. Assim, o objetivo deste \ntrabalho foi estender a aplica\u00e7\u00e3o da fun\u00e7\u00e3o objetivo de Nabavi e Williams a \nsistemas quase peri\u00f3dicos com varia\u00e7\u00f5es nas medi\u00e7\u00f5es. A Figura 4.6 apresenta \ndados de processo da press\u00e3o de um po\u00e7o de petr\u00f3leo e ilustra esse tipo de \ncomportamento.  \n\n\n\n34 Metodologia \n \n\n \n\n \nFigura 4.5: Influ\u00eancia da taxa de amostragem na resposta da fun\u00e7\u00e3o objetivo \n\nproposta por Nabavi e Williams. \n\n \nFigura 4.6: Medi\u00e7\u00f5es reais de press\u00e3o de um po\u00e7o de petr\u00f3leo. \n\n4.1.2 Modelos com ciclo limite e alta variabilidade \n\nPara ilustrar a aplica\u00e7\u00e3o do m\u00e9todo, erro com distribui\u00e7\u00e3o normal foi adicionado \na uma fun\u00e7\u00e3o seno de per\u00edodo vari\u00e1vel, dado por: \n\n (4.8) \n\n (4.9) \n\nonde  \u00e9 o vetor da vari\u00e1vel dependente,  \u00e9 o vetor da vari\u00e1vel independente e  \n\u00e9 o vetor do erro com distribui\u00e7\u00e3o normal. Primeiramente, \u00e9 necess\u00e1ria a \nidentifica\u00e7\u00e3o dos picos e vales nos dados de refer\u00eancia (Figura 4.7a). Isso \u00e9 feito \natrav\u00e9s de um algoritmo de detec\u00e7\u00e3o de picos (BERGMAN, 2016) e permite a \nsepara\u00e7\u00e3o de todos os ciclos identificados: todos os pontos entre e incluindo dois \nvales consecutivos configuram um ciclo (Figura 4.7b e Figura 4.7c). \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 35 \n \n \n\nOs ciclos identificados s\u00e3o ent\u00e3o deslocados a um novo espa\u00e7o amostral a partir \ndo tempo  (Figura 4.7d e Figura 4.7e). Contudo, fica claro que os ciclos \nobtidos n\u00e3o apresentam o mesmo n\u00famero de pontos por ciclo. Assim, para cada \nciclo os dados s\u00e3o regularmente interpolados atrav\u00e9s de splines sem suaviza\u00e7\u00e3o \n(Figura 4.7f e Figura 4.7g). Um novo tempo amostral \u00e9 criado de modo a permitir a \ncompara\u00e7\u00e3o ponto a ponto: \n\n (4.10) \n\n (4.11) \n\nonde  \u00e9 um tempo amostral com   amostras de igual frequ\u00eancia de amostragem \ndo ciclo ,  \u00e9 o novo tempo amostral m\u00e9dio,   \u00e9 a m\u00e9dia de amostras por ciclo \ne   \u00e9 o per\u00edodo m\u00e9dio dos dados de refer\u00eancia, obtido por autocorrela\u00e7\u00e3o \n(GERHARD, 2003).  \n\nAplicando o espa\u00e7o amostral  para cada spline, s\u00e3o obtidos  pontos para \ncada ciclo, mas \u00e9 considerado que o espa\u00e7o amostral real \u00e9 dado por . Isso faz \ncom que os ciclos sejam expandidos ou reduzidos a um mesmo tempo amostral, \ncomo se todas as medidas fossem tomadas \u00e0 mesma taxa amostral (Figura 4.7h e \nFigura 4.7i). Assim, torna-se poss\u00edvel a compara\u00e7\u00e3o ponto a ponto (Figura 4.7j) que \nresulta em um ciclo m\u00e9dio com uma vari\u00e2ncia experimental correspondente para \ncada amostra (Figura 4.7k). Esse \u00e9 o ciclo experimental de refer\u00eancia utilizado \nent\u00e3o para a estima\u00e7\u00e3o de par\u00e2metros. \n\nPara interpretar os passos descritos, \u00e9 conveniente considerar como se cada \nciclo fosse um \u00fanico experimento. Como ser\u00e1 mostrado posteriormente nos \nresultados, a obten\u00e7\u00e3o de um ciclo m\u00e9dio \u00e9 particularmente \u00fatil quando os dados \nde refer\u00eancia apresentam uma tend\u00eancia clara com muita variabilidade das \namostras. Para a otimiza\u00e7\u00e3o, cada itera\u00e7\u00e3o aplica o m\u00e9todo proposto aos dados \nsimulados de modo a atenuar erros num\u00e9ricos relacionados \u00e0 toler\u00e2ncia do solver. \nIsso diminui consideravelmente o tempo de otimiza\u00e7\u00e3o por possibilitar o uso de \ntoler\u00e2ncias mais brandas. A fun\u00e7\u00e3o spline obtida gera ent\u00e3o o ciclo m\u00e9dio baseado \nno tempo amostral da refer\u00eancia. \n\nCaso o per\u00edodo do modelo seja menor do que o per\u00edodo da refer\u00eancia, a \nabordagem de Nabavi e Williams de preenchimento dos dados \u00e9 aplicada utilizando \no valor m\u00e9dio do ciclo ao inv\u00e9s de zeros. As press\u00f5es de fundo das tubula\u00e7\u00f5es s\u00e3o \nda ordem de 200 bar, de modo que o preenchimento com zeros gera um erro alto \npara o algoritmo de otimiza\u00e7\u00e3o. Finalmente, M\u00ednimos Quadrados Ponderados \n(WLS) s\u00e3o aplicados entre o ciclo de refer\u00eancia e o ciclo do modelo, utilizando a \nvari\u00e2ncia experimental  obtida pelo m\u00e9todo: \n\n (4.12) \n\n\n\n36 Metodologia \n \n\n \n\n \nFigura 4.7: Ilustra\u00e7\u00e3o passo a passo do m\u00e9todo proposto: (a) identifica\u00e7\u00e3o de \n\npicos e vales; (b) identifica\u00e7\u00e3o de todos os ciclos; (c) separa\u00e7\u00e3o dos ciclos; (d,e) \navalia\u00e7\u00e3o da diferen\u00e7a entre os ciclos; (f,g) interpola\u00e7\u00e3o atrav\u00e9s de splines; (h,i) \n\nverifica\u00e7\u00e3o da amostragem; (j) sobreposi\u00e7\u00e3o dos ciclos; (k) ciclo m\u00e9dio com \nvari\u00e2ncia. \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 37 \n \n \n\nPara comparar a fun\u00e7\u00e3o objetivo de M\u00ednimos Quadrados (LS) com a fun\u00e7\u00e3o \nobjetivo proposta por este trabalho, os par\u00e2metros de uma fun\u00e7\u00e3o seno foram \nestimados: \n\n (4.13) \n\nonde   \u00e9 o seno estimado e  \u00e9 o vetor dos par\u00e2metros. Para ajuste gr\u00e1fico, \u00e9 \nconveniente definir um valor de fase  para melhor observar os resultados. A \nEqua\u00e7\u00e3o (4.14) define esse valor de modo que o modelo apresente um vale no \nvalor de  em que \u00e9 identificado o in\u00edcio do primeiro ciclo, : \n\n (4.14) \n\nA escolha de um seno com per\u00edodo constante est\u00e1 baseada no fato de que os \nmodelos simplificados de golfadas apresentam ciclo limite de per\u00edodo \naproximadamente constante para valores fixos de abertura de choke. O resultado \npara as duas estima\u00e7\u00f5es est\u00e1 representado na Figura 4.8. \u00c9 poss\u00edvel observar que \no modelo obtido com WLS representa as principais caracter\u00edsticas do ciclo limite \nmelhor do que o modelo obtido com LS. Al\u00e9m disso, a Figura 4.9 e a Figura 4.10 \nmostram as superf\u00edcies de otimiza\u00e7\u00e3o para os dois m\u00e9todos. Fica evidente como a \nsuperf\u00edcie se torna convexa com o m\u00e9todo proposto mesmo para dados ruidosos, \nembora apresente o comportamento tipo serrote mencionado anteriormente. \n\n \nFigura 4.8: Resultados da otimiza\u00e7\u00e3o do exemplo (azul) usando: WLS (vermelho); \n\nLS (verde). \n\n \n\n\n\n38 Metodologia \n \n\n \n\n \nFigura 4.9: (a) Superf\u00edcie de otimiza\u00e7\u00e3o do exemplo para M\u00ednimos Quadrados, e \n\n(b) curvas de n\u00edvel da fun\u00e7\u00e3o objetivo. \n\n \nFigura 4.10: (a) Superf\u00edcie de otimiza\u00e7\u00e3o do exemplo para M\u00ednimos Quadrados \n\nPonderados, e (b) curvas de n\u00edvel da fun\u00e7\u00e3o objetivo. \n\n4.1.3 Crit\u00e9rios de converg\u00eancia para modelos com bifurca\u00e7\u00e3o Hopf \n\nO m\u00e9todo desenvolvido para dados com ciclo limite \u00e9 restrito a essas condi\u00e7\u00f5es \nperi\u00f3dicas ou quase peri\u00f3dicas. Caso essas condi\u00e7\u00f5es n\u00e3o sejam identificadas, a \nfun\u00e7\u00e3o objetivo de M\u00ednimos Quadrados cl\u00e1ssica \u00e9 aplicada. Um peso arbitr\u00e1rio  \u00e9 \nadicionado para penalizar dados convergentes: \n\n (4.15) \n\nOs par\u00e2metros estimados podem fazer com que o sistema lentamente entre em \nequil\u00edbrio, como ilustrado pela Figura 4.11. Essa condi\u00e7\u00e3o em particular apresenta \num comportamento similar a um oscilador harm\u00f4nico subamortecido. Para se obter \na distin\u00e7\u00e3o entre as condi\u00e7\u00f5es de equil\u00edbrio, estado transiente e ciclo limite, alguns \ncrit\u00e9rios s\u00e3o utilizados para se determinar a converg\u00eancia dos dados: \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 39 \n \n \n\n \nFigura 4.11: Resposta da press\u00e3o na base do riser, , do modelo de Meglio, \nKaasa e Petit (2009) para diferentes aberturas de v\u00e1lvula choke, . Os pontos \n\nrepresentam a m\u00e9dia (quando o valor de choke \u00e9 inferior ao valor cr\u00edtico) ou os \npicos e vales (quando esse valor \u00e9 superior ao cr\u00edtico). A linha tracejada cinza \n\nrepresenta o diagrama de bifurca\u00e7\u00e3o do sistema. \n\n1. O conjunto de dados deve apresentar pelo menos tr\u00eas ciclos de forma que: \n (4.16) \n\n2. As \u00faltimas amostras de um conjunto devem apresentar uma vari\u00e2ncia maior \ndo que uma dada toler\u00e2ncia : \n\n (4.17) \n\n3. A equa\u00e7\u00e3o limitante do modelo de um oscilador harm\u00f4nico subamortecido \nn\u00e3o pode representar adequadamente os picos ou vales do conjunto de \ndados. \n\nA primeira condi\u00e7\u00e3o identifica o ciclo limite e visa produzir um ciclo m\u00e9dio de \nmodo a atenuar os erros num\u00e9ricos relacionados ao solver, anteriormente \nmencionados. A segunda condi\u00e7\u00e3o \u00e9 uma medida simples para determinar se um \nconjunto de dados varia significativamente com o tempo, o que indica a presen\u00e7a \nou n\u00e3o de equil\u00edbrio. A \u00faltima condi\u00e7\u00e3o \u00e9 mais complexa e \u00e9 implementada de modo \na identificar condi\u00e7\u00f5es que caracterizem o estado transiente.  \n\nComo dito anteriormente, nessas condi\u00e7\u00f5es o sistema se comporta \nanalogamente a um oscilador harm\u00f4nico subamortecido. Esses modelos s\u00e3o \nrepresentados por um sistema de massa-mola-amortecedor, como ilustrado no \nexemplo da Figura 4.12 onde o objeto de massa  encontra-se suspenso por uma \nmola de constante el\u00e1stica  e tamb\u00e9m por um amortecedor de coeficiente de \namortecimento viscoso . O equacionamento da posi\u00e7\u00e3o do objeto em rela\u00e7\u00e3o ao \ntempo  pode ser obtido atrav\u00e9s da Segunda Lei de Newton e, dada a aus\u00eancia \nde for\u00e7as externas, \u00e9 descrito por uma Equa\u00e7\u00e3o Diferencial: \n\n (4.18) \n\n\n\n40 Metodologia \n \n\n \n\n \nFigura 4.12: Representa\u00e7\u00e3o de um oscilador harm\u00f4nico com amortecimento. \n\nque pode ser reescrita da forma: \n\n (4.19) \n\nonde  \u00e9 a raz\u00e3o de amortecimento e  \u00e9 a frequ\u00eancia angular n\u00e3o-amortecida, \nrespectivamente dados por: \n\n (4.20) \n\n (4.21) \n\nO valor de  indica o tipo de sistema em quest\u00e3o (Figura 4.13): \n\n? : sistema superamortecido \n\n? : sistema criticamente amortecido \n\n? : sistema subamortecido \nPara sistemas subamortecidos, a solu\u00e7\u00e3o da Equa\u00e7\u00e3o (4.19) \u00e9 uma fun\u00e7\u00e3o seno \n\nmultiplicada por um fator exponencial respons\u00e1vel pela dissipa\u00e7\u00e3o da energia do \nmovimento, da forma: \n\n (4.22) \n\n (4.23) \n\nonde  \u00e9 a amplitude,  \u00e9 a fase,  \u00e9 a frequ\u00eancia angular n\u00e3o-amortecida e  \u00e9 \na frequ\u00eancia angular amortecida. Dada a similaridade da resposta com modelos de \ngolfadas em estado transiente, \u00e9 poss\u00edvel que a parcela exponencial do sistema \nsubamortecido consiga adequadamente prever os picos e vales dos modelos. \nTorna-se necess\u00e1ria a obten\u00e7\u00e3o dos par\u00e2metros da parcela exponencial. A \ndetermina\u00e7\u00e3o da frequ\u00eancia n\u00e3o-amortecida  \u00e9 feita encontrando-se a frequ\u00eancia \nfundamental  do sistema atrav\u00e9s da Transformada Discreta de Fourier e \nutilizando a Equa\u00e7\u00e3o (4.24): \n\n (4.24) \n\n\n\n4.1 Fun\u00e7\u00f5es objetivo 41 \n \n \n\n \nFigura 4.13: Resposta da posi\u00e7\u00e3o de um oscilador harm\u00f4nico com amortecimento \n\npara diferentes valores de . \n\nOs picos e vales do sistema ocorrem quando a parcela senoidal da equa\u00e7\u00e3o \u00e9 \nm\u00e1xima ou m\u00ednima, respectivamente. Dessa forma, \u00e9 poss\u00edvel obter os par\u00e2metros \n e  atrav\u00e9s de manipula\u00e7\u00f5es da Equa\u00e7\u00e3o (4.22) utilizando-se a m\u00e9dia dos valores \n\ndos par\u00e2metros para todos os pares de  picos ou vales: \n\n (4.25) \n\n (4.26) \n\nComo ilustra a Figura 4.14, a refer\u00eancia de picos ou vales tem grande influ\u00eancia \nna equa\u00e7\u00e3o de contorno obtida quando os dados de refer\u00eancia prov\u00eam de um \nmodelo de golfadas. Isso se d\u00e1 porque o sistema n\u00e3o \u00e9 perfeitamente descrito como \num oscilador harm\u00f4nico subamortecido, mas a equa\u00e7\u00e3o de contorno \u00e9 capaz de \ncorretamente predizer os valores dos picos ou dos vales.  \n\nPara modelos de golfadas, quando o sistema se encontra em equil\u00edbrio, n\u00e3o \nexistem picos a serem identificados; no caso do ciclo limite, a rela\u00e7\u00e3o entre picos \u00e9 \numa reta de valor constante porque o modelo \u00e9 perfeitamente peri\u00f3dico. Para \ncompara\u00e7\u00e3o, neste caso, utiliza-se como refer\u00eancia uma reta constante composta \ndo valor m\u00e9dio dos picos. Assim, caso a equa\u00e7\u00e3o de contorno exponencial consiga \nrepresentar os picos melhor do que uma equa\u00e7\u00e3o de reta, o sistema \u00e9 dito em \nestado transiente.  \n\n\n\n42 Metodologia \n \n\n \n\n \nFigura 4.14: (a) Exemplo de ajuste da parcela exponencial de um oscilador \n\nharm\u00f4nico subamortecido para valores de abertura de choke inferiores ao cr\u00edtico o \nmodelo de Meglio, Kaasa e Petit. (b) Quando os par\u00e2metros  e  s\u00e3o ajustados \npara picos ou vales (linhas cheias), o lado rec\u00edproco apresenta um ajuste ruim \n\n(linhas tracejadas). \n\nEssa diferencia\u00e7\u00e3o \u00e9 feita atrav\u00e9s de um teste F, com a hip\u00f3tese nula  de que \na vari\u00e2ncia do modelo exponencial \u00e9 menor do que a vari\u00e2ncia do modelo linear. \nAs Equa\u00e7\u00f5es (4.27) a (4.36) mostram os c\u00e1lculos necess\u00e1rio para o teste F: \n\n (4.27) \n\n (4.28) \n\n (4.29) \n\n (4.30) \n\n(4.31) \n\n (4.32) \n\n(4.33) \n\n(4.34) \n\n\n\n4.2 Recursos computacionais 43 \n \n \n\n(4.35) \n\n(4.36) \n\nonde   \u00e9 o modelo exponencial,   \u00e9 o modelo linear,  \u00e9 a vari\u00e2ncia \nestimada,  \u00e9 a soma dos m\u00ednimos quadrados,  \u00e9 o n\u00famero de graus de \nliberdade,  \u00e9 o n\u00famero de picos/vales de refer\u00eancia,  \u00e9 o n\u00edvel de confian\u00e7a e \n\n \u00e9 o valor da distribui\u00e7\u00e3o de Fisher para um n\u00edvel de confian\u00e7a  com  e  \ngraus de liberdade. Se a hip\u00f3tese  for aceita, o sistema n\u00e3o apresenta ciclo limite. \n\n4.2 Recursos computacionais \nTodos os resultados foram obtidos no ambiente Python 2.7.1. Utilizou-se o \n\nalgoritmo de otimiza\u00e7\u00e3o global Particle Swarm Optimization (POLI; KENNEDY; \nBLACKWELL, 2007) a partir da implementa\u00e7\u00e3o Pyswarm, dispon\u00edvel sob licen\u00e7a \nBSD (LEE, 2014). Os par\u00e2metros de ajuste escolhidos para o algoritmo foram de \n\n e  (CLERC; KENNEDY, 2002). As rotinas de \notimiza\u00e7\u00e3o foram realizadas com 50 part\u00edculas e um m\u00e1ximo de 2000 itera\u00e7\u00f5es, o \nque significa que a fun\u00e7\u00e3o objetivo \u00e9 avaliada at\u00e9 100.050 vezes. \n\nOs modelos foram simulados com a plataforma open source JModelica. Suas \nimplementa\u00e7\u00f5es est\u00e3o dispon\u00edveis nas se\u00e7\u00f5es A.1 e A.2 do Ap\u00eandice A. Para o \nmodelo de Di Meglio et al. (2009), utilizou-se o solver CVode com um passo m\u00ednimo \nde ; para o de Diehl et al. (2017), o solver Radau5ODE. \n\nO algoritmo de detec\u00e7\u00e3o de picos utilizado foi o Peakdetect, dispon\u00edvel sob \nlicen\u00e7a WTFPL (BERGMAN, 2016). O c\u00f3digo \u00e9 mostrado na se\u00e7\u00e3o A.3 do Ap\u00eandice \nA. Essa implementa\u00e7\u00e3o \u00e9 derivada do algoritmo de dom\u00ednio p\u00fablico Peakdet, \nproposto em MATLAB (BILLAUER, 2012). \n\nUm exemplo de implementa\u00e7\u00e3o da fun\u00e7\u00e3o objetivo \u00e9 mostrado na se\u00e7\u00e3o A.9 do \nAp\u00eandice A. \n\nValores extra\u00eddos de artigos foram obtidos diretamente dos gr\u00e1ficos onde os \nresultados s\u00e3o apresentados atrav\u00e9s do software Pega Ponto 1.0 (OLIVEIRA; \nGAMBETTA; PINTO, 2006). \n\n\n\n5.1 Modelo Meglio com dist\u00farbio \n 44 \n \n\n \n\n Estudos de caso  \nEste cap\u00edtulo apresenta os resultados obtidos para a estima\u00e7\u00e3o de par\u00e2metros \n\ndos modelos estudados utilizando a nova metodologia proposta para tr\u00eas cen\u00e1rios \ndistintos: um cen\u00e1rio com dist\u00farbio n\u00e3o medido e discrep\u00e2ncia de modelo e dois \ncen\u00e1rios com dados de po\u00e7os reais. Os modelos e seus par\u00e2metros s\u00e3o ent\u00e3o \nanalisados estatisticamente. Tamb\u00e9m \u00e9 apresentada uma compara\u00e7\u00e3o entre a \nqualidade de ajuste entre os par\u00e2metros estimados pelo novo m\u00e9todo e os \npar\u00e2metros originalmente ajustados pelos autores. \n\n5.1 Modelo Meglio com dist\u00farbio \nO modelo de Di Meglio, Kaasa e Petit (2009), a partir daqui denominado de \n\nmodelo Meglio, foi simulado para uma abertura fixa de  com os par\u00e2metros \npropostos no artigo de Di Meglio et al. (2010). A press\u00e3o do separador , \ninicialmente 6,6 bar, foi lentamente reduzida at\u00e9 5 bar. Passado um per\u00edodo de \ntempo, a press\u00e3o foi novamente elevada at\u00e9 6,6 bar. Aos resultados da press\u00e3o de \nfundo  foram adicionados valores de erro com distribui\u00e7\u00e3o normal, m\u00e9dia  \ne desvio padr\u00e3o  (Figura 5.1a). \n\nO objetivo para este conjunto de dados \u00e9 a estima\u00e7\u00e3o dos par\u00e2metros do \nmodelo Meglio baseado em uma press\u00e3o de separa\u00e7\u00e3o fixa  bar, \nconsiderando que a varia\u00e7\u00e3o de press\u00e3o que gerou os dados seja um dist\u00farbio n\u00e3o \nmedido. Contudo, a aplica\u00e7\u00e3o direta do m\u00e9todo desenvolvido cria um ciclo m\u00e9dio \nintermedi\u00e1rio entre os ciclos de  bar e os de  bar.  \n\nPara melhorar o resultado obtido, considerou-se que os seis primeiros ciclos \npodem ser usados como refer\u00eancia para incluir os outros ciclos presentes na rotina \nde otimiza\u00e7\u00e3o (Figura 5.1b). A partir do valor m\u00e9dio dos sete primeiros vales, , \ntodas as amostras a partir do \u00faltimo vale foram ajustadas atrav\u00e9s da Equa\u00e7\u00e3o (5.1): \n\n (5.1) \n(5.2) \n\n  \n\n\n\n5.1 Modelo Meglio com dist\u00farbio 45 \n \n \n\n \nFigura 5.1: Dados utilizados para estima\u00e7\u00e3o de par\u00e2metros: (a) modelo Meglio \n\n(azul) com erro normalmente distribu\u00eddo, todos os picos (vermelho) e vales \n(verde) detectados, e varia\u00e7\u00e3o da press\u00e3o do separador  (roxo); (b) resultado da \n\nreconstru\u00e7\u00e3o (vermelho) dos dados (azul) baseada na diferen\u00e7a entre a m\u00e9dia \ndos vales dos ciclos sem dist\u00farbio (verde tracejado) e os valores da spline dos \n\nvales dos ciclos com dist\u00farbio (verde cheio). \n\nonde  \u00e9 o valor da fun\u00e7\u00e3o spline de todos os vales a partir do \u00faltimo \nconsiderado est\u00e1vel aplicada no ponto ,  \u00e9 a diferen\u00e7a de press\u00e3o entre \nrefer\u00eancia e o valor da fun\u00e7\u00e3o spline,  \u00e9 o valor original de press\u00e3o e  \u00e9 o \nvalor reconstru\u00eddo de press\u00e3o. \n\nEsse processo de reconstru\u00e7\u00e3o apresenta um ciclo mais representativo com \nmenor vari\u00e2ncia (Figura 5.2). Os par\u00e2metros obtidos s\u00e3o mostrados na Tabela 1. \nFica evidente como os resultados da estima\u00e7\u00e3o sem reconstru\u00e7\u00e3o (Figura 5.3a) \napresentam menor ader\u00eancia aos dados do que os resultados obtidos a partir da \nreconstru\u00e7\u00e3o (Figura 5.3b). A Figura 5.4 mostra a compara\u00e7\u00e3o entre os ciclos. \n\nA ader\u00eancia pode ser comprovada pelo teste Chi Quadrado entre os dois \nresultados, apresentado na Tabela 2. Os par\u00e2metros obtidos com reconstru\u00e7\u00e3o \napresentam resultados muito bons, o que \u00e9 esperado se considerando que os \ndados foram gerados a partir do modelo. J\u00e1 os par\u00e2metros obtidos sem \nreconstru\u00e7\u00e3o n\u00e3o conseguem justificar os erros experimentais introduzidos. \n\n\n\n46 Estudos de caso \n \n\n \n\n \nFigura 5.2: Compara\u00e7\u00e3o entre ciclo representativo dos dados reconstru\u00eddos \n\n(vermelho) e dos dados sem reconstru\u00e7\u00e3o (azul). \n\n \nFigura 5.3: Resultados das estima\u00e7\u00f5es (a) sem reconstru\u00e7\u00e3o e (b) com \n\nreconstru\u00e7\u00e3o. \n\n\n\n5.1 Modelo Meglio com dist\u00farbio 47 \n \n \n\n \nFigura 5.4: Compara\u00e7\u00e3o entre ciclo dos dados reconstru\u00eddos (pontos vermelhos), \n\nciclo do modelo estimado com dados reconstru\u00eddos (linha vermelha) e ciclo do \nmodelo estimado sem reconstru\u00e7\u00e3o (linha azul). \n\nTabela 1: Compara\u00e7\u00e3o entre os resultados das estima\u00e7\u00f5es de par\u00e2metros do \nmodelo de Meglio et al. (2010). \n\nPar\u00e2metro Di Meglio et al. (2010) \nDados sem \n\nreconstru\u00e7\u00e3o \nDados com \n\nreconstru\u00e7\u00e3o \n    \n\n    \n    \n    \n\n    \n \n\nTabela 2: Teste Chi Quadrado entre os resultados com e sem reconstru\u00e7\u00e3o dos \ndados. \n\n    \n\nDados originais \n \n\n \n \n\nDados reconstru\u00eddos  \n \n  \n\n\n\n48 Estudos de caso \n \n\n \n\nA qualidade do ajuste tamb\u00e9m pode ser quantificada pelo teste F (Tabela 3): \n\nTabela 3: Teste F entre os resultados com e sem reconstru\u00e7\u00e3o dos dados. \n\n    \n\nSem (1) e com \nreconstru\u00e7\u00e3o (2) \n\n \n \n\n \nDi Meglio (1) e \n\nreconstru\u00e7\u00e3o (2)  \n\n \n\nA Tabela 3 mostra que o ajuste obtido com reconstru\u00e7\u00e3o apresenta vari\u00e2ncia \nestimada de predi\u00e7\u00e3o menor do que o ajuste sem reconstru\u00e7\u00e3o. Os par\u00e2metros \noriginais apresentam resultado pior do que o esperado porque o ciclo de refer\u00eancia \nutilizado leva em considera\u00e7\u00e3o os dist\u00farbios n\u00e3o medidos. Tamb\u00e9m \u00e9 poss\u00edvel \nobter uma matriz de correla\u00e7\u00f5es (Tabela 4). Fica evidente a alta correla\u00e7\u00e3o entre \npar\u00e2metros (  e ;  e ) que \u00e9 uma das fontes de dificuldade para \nestima\u00e7\u00e3o desses par\u00e2metros. \n\nA Figura 5.5, a Figura 5.6 e a Figura 5.7 mostram as superf\u00edcies de otimiza\u00e7\u00e3o \nentre os par\u00e2metros  e  considerando M\u00ednimos Quadrados, a fun\u00e7\u00e3o \nobjetivo de Diehl et al. (2017) e a fun\u00e7\u00e3o objetivo proposta neste trabalho, \nrespectivamente. Destaca-se a diminui\u00e7\u00e3o da n\u00e3o-convexidade, atingindo a quase \ntotal convexidade para a fun\u00e7\u00e3o proposta. O degrau apresentado \u00e9 referente ao \ncomportamento tipo serrote comentado na Se\u00e7\u00e3o 4.1.1 (Figura 4.5). J\u00e1 a Figura 5.8 \nmostra como as regi\u00f5es de confian\u00e7a dos par\u00e2metros s\u00e3o complexas. As regi\u00f5es \nel\u00edpticas s\u00e3o pouco representativas frente \u00e0s regi\u00f5es de m\u00e1xima verossimilhan\u00e7a, \nobtidas a partir das avalia\u00e7\u00f5es da fun\u00e7\u00e3o objetivo com o algoritmo PSO. \n\nTabela 4: Matriz de correla\u00e7\u00f5es dos resultados com reconstru\u00e7\u00e3o dos dados. \n\n      \n \n\n \n \n \n\n \n \n\nAssim, \u00e9 poss\u00edvel concluir que a fun\u00e7\u00e3o objetivo proposta foi capaz de estimar \npar\u00e2metros adequados. O tratamento dos dados auxilia na obten\u00e7\u00e3o de um ciclo \nde refer\u00eancia mais representativo, o que leva a um ajuste melhor do modelo. \nTamb\u00e9m fica expl\u00edcita a alta correla\u00e7\u00e3o entre par\u00e2metros do modelo e a melhor \nrepresentatividade da regi\u00e3o de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a. \n\n\n\n5.1 Modelo Meglio com dist\u00farbio 49 \n \n \n\n \nFigura 5.5: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis de M\u00ednimos \n\nQuadrados para os par\u00e2metros  e . \n\n \nFigura 5.6: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis da fun\u00e7\u00e3o objetivo \n\nproposta por Diehl et al. (2017) para os par\u00e2metros  e . \n\n \nFigura 5.7: (a) Superf\u00edcie de otimiza\u00e7\u00e3o e (b) curvas de n\u00edveis da fun\u00e7\u00e3o objetivo \n\nproposta neste trabalho para os par\u00e2metros  e . \n\n\n\n50 Estudos de caso \n \n\n \n\n \nFigura 5.8: Regi\u00f5es de confian\u00e7a para um grau de confian\u00e7a   dos \n\npar\u00e2metros obtidos com reconstru\u00e7\u00e3o dos dados: regi\u00e3o el\u00edptica (vermelho) e \nregi\u00e3o de m\u00e1xima verossimilhan\u00e7a (azul). \n\n5.2 Modelo Meglio aplicado a dados reais \nOs dados reais de press\u00e3o de topo  e de press\u00e3o de fundo  foram obtidos \n\nda Figura 7 do artigo de Di Meglio et al. (2012). O software Pega Ponto gerou os \ndados representados na Figura 5.9. As leituras de  apresentam uma baixa \nfrequ\u00eancia de amostragem que foi reproduzida manualmente para as leituras de \n\n. Por outro lado, os dados de  obtidos apresentam pouca variabilidade; \nassim, suas vari\u00e2ncias foram consideradas constates e removidas do c\u00e1lculo da \nfun\u00e7\u00e3o objetivo quando a  \u00e9 usada como refer\u00eancia. Isso aumenta \nsignificativamente a performance da otimiza\u00e7\u00e3o. \n\nOs par\u00e2metros originais s\u00e3o id\u00eanticos aos apresentados anteriormente. Sabe-\nse que a press\u00e3o de separa\u00e7\u00e3o \u00e9 de  bar, mas \u00e9 assumido que a abertura \nde v\u00e1lvula \u00e9 de . Discrep\u00e2ncias nesse valor devem ser compensadas pelo \najuste do par\u00e2metro .  \n\nPrimeiramente, o modelo foi simulado nessas condi\u00e7\u00f5es com os par\u00e2metros \npublicados para se determinar a qualidade original com base nas m\u00e9tricas \nanteriormente discutidas. Os par\u00e2metros foram ent\u00e3o estimados em tr\u00eas cen\u00e1rios: \nutilizando como refer\u00eancia somente ; somente ; e a combina\u00e7\u00e3o de  e \n\n. A Tabela 5 mostra a compara\u00e7\u00e3o entre os par\u00e2metros obtidos nesses cen\u00e1rios. \n\n \n\n\n\n5.2 Modelo Meglio aplicado a dados reais 51 \n \n \n\n \n\n \n\n \nFigura 5.9: Dados obtidos do artigo de Di Meglio et al. (2012). \n\nTabela 5: Compara\u00e7\u00e3o entre os par\u00e2metros estimados para o modelo Meglio. \nPar\u00e2metro Di Meglio et al. Somente  Somente   e  \n\n     \n     \n     \n     \n\n     \n \n\nOs limites superior e inferior da otimiza\u00e7\u00e3o s\u00e3o mostrados na Tabela 6. Os \nlimites dos par\u00e2metros ,  e  foram estabelecidos por experi\u00eancia com a \nresposta do modelo: limites mais largos prejudicam muito a otimiza\u00e7\u00e3o. J\u00e1 os \npar\u00e2metros  e  foram limitados com uma diferen\u00e7a de uma ordem de \ngrandeza em rela\u00e7\u00e3o \u00e0 grandeza original. \n\nA m\u00e9dia de tempo por avalia\u00e7\u00e3o da fun\u00e7\u00e3o objetivo foi de 576 ms, obtida com \naux\u00edlio da fun\u00e7\u00e3o \u201c%%timeit\u201d do Python. Contudo, esse tempo \u00e9 avaliado com os \npar\u00e2metros \u00f3timos, que apresentam ciclo limite. Como os valores iniciais dos \nestados nunca s\u00e3o atualizados, um conjunto de par\u00e2metros que cause dificuldades \niniciais de converg\u00eancia pode aumentar o tempo de avalia\u00e7\u00e3o para mais de 1 s. \n\nTabela 6: Limites de otimiza\u00e7\u00e3o para os par\u00e2metros do modelo Meglio. \nPar\u00e2metro Limite inferior Di Meglio et al. Limite superior \n\n    \n    \n    \n    \n\n    \n \n\n\n\n52 Estudos de caso \n \n\n \n\n \n\n5.2.1 Resultados originais \n\nA Figura 5.10 mostra a compara\u00e7\u00e3o entre os ciclos representativos dos dados \ne do modelo original. Os coeficientes de correla\u00e7\u00e3o obtidos para as press\u00f5es  e \n\n foram  e , respectivamente. A Tabela 7 mostra o teste \nChi Quadrado para esses dados. Fica evidente que o modelo por si s\u00f3 n\u00e3o \u00e9 capaz \nde predizer satisfatoriamente os dados experimentais.  \n\n \nFigura 5.10: Ciclos representativos: dados de refer\u00eancia (azul); modelo Meglio \n\nconforme publicado (vermelho). \n\nTabela 7: Teste Chi quadrado para o modelo Meglio original. \n\n    \n\n \n \n\n \n \n\n  \n\n5.2.2 Estima\u00e7\u00e3o com base em  \n\nA Figura 5.11 mostra os resultados obtidos para a estima\u00e7\u00e3o baseada em , \nenquanto a Figura 5.12 mostra a evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o global das part\u00edculas \ncom as itera\u00e7\u00f5es. O n\u00famero total de itera\u00e7\u00f5es foi de 1373. Os coeficientes de \ncorrela\u00e7\u00e3o obtidos foram de  . A Tabela 8 mostra os \nresultados do teste Chi Quadrado. O modelo consegue acompanhar as tend\u00eancias \nda , mas n\u00e3o consegue justificar os erros experimentais nem para  nem para \n\n embora apresente claras melhorias na representatividade dos dados de . \n\n\n\n5.2 Modelo Meglio aplicado a dados reais 53 \n \n \n\n \nFigura 5.11: Ciclos representativos: dados originais (azul); modelo Meglio original \n\n(vermelho); modelo Meglio estimado com base na press\u00e3o  (verde). \n\nTabela 8: Teste Chi Quadrado para o modelo Meglio estimado com a press\u00e3o . \n\n    \n\n \n \n\n \n \n\n  \n\nA matriz de correla\u00e7\u00f5es obtida \u00e9 mostrada na Tabela 9. Fica evidente a alta \ncorrela\u00e7\u00e3o entre os par\u00e2metros. Como pode ser observado na Figura 5.13, o \nmodelo resultante tem dificuldade de prever os picos de press\u00e3o da . J\u00e1 a  \nest\u00e1 totalmente desajustada em rela\u00e7\u00e3o aos dados. \n\n \nFigura 5.12: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \n\ncom . \n\n\n\n54 Estudos de caso \n \n\n \n\nTabela 9: Matriz de correla\u00e7\u00f5es do modelo Meglio estimado com a press\u00e3o . \n      \n\n 1 -0.90911 -0.91422 0.968896 -0.96352\n -0.90911 1 0.74841 -0.93961 0.878606\n -0.91422 0.74841 1 -0.86222 0.906134\n 0.968896 -0.93961 -0.86222 1 -0.9875\n\n -0.96352 0.878606 0.906134 -0.9875 1\n \n\nA Figura 5.14 mostra as regi\u00f5es de m\u00e1xima verossimilhan\u00e7a resultantes. Como \nfoi observado para o modelo te\u00f3rico com dist\u00farbio, as regi\u00f5es el\u00edpticas s\u00e3o pouco \nrepresentativas e dificultam a representa\u00e7\u00e3o das regi\u00f5es de m\u00e1xima \nverossimilhan\u00e7a; portanto, n\u00e3o foram plotadas. Com essas regi\u00f5es \u00e9 poss\u00edvel \nobservar graficamente a alta correla\u00e7\u00e3o entre os par\u00e2metros. A Tabela 10 mostra \no teste F entre o modelo original e o modelo estimado. Os par\u00e2metros s\u00e3o melhores \npara representar , mas n\u00e3o apresentam diferen\u00e7a quanto \u00e0 estima\u00e7\u00e3o da .  \n\nTabela 10: Teste F do modelo Meglio estimado com a press\u00e3o . \n\n    \n\n estimada (1)  \n original (2) \n\n \n \n\n \n estimada (1)  \n original (2) \n\n \n\n \nFigura 5.13: Valores preditos e valores observados de  e  do modelo Meglio \n\nestimado com . \n\n\n\n5.2 Modelo Meglio aplicado a dados reais 55 \n \n \n\n \nFigura 5.14: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo de \nDi Meglio et al. (2009) estimado com . Valores \u00f3timos s\u00e3o representados em \n\nvermelho. \n\n5.2.3 Estima\u00e7\u00e3o com base em  \n\nOs resultados da estima\u00e7\u00e3o baseada em  s\u00e3o mostrados na Figura 5.15. \nForam avaliadas 155 itera\u00e7\u00f5es. A evolu\u00e7\u00e3o da fun\u00e7\u00e3o objetivo \u00e9 apresentada na \nFigura 5.16. Os coeficientes de correla\u00e7\u00e3o obtidos foram de  \n\n. A Tabela 11 mostra os resultados do teste Chi Quadrado. O modelo \napresenta dificuldades de acompanhar as tend\u00eancias de  e , embora o teste \nChi Quadrado recomende o uso do modelo para a estima\u00e7\u00e3o da . A Tabela 12 \nmostra a matriz de correla\u00e7\u00f5es obtida. \n\n \nFigura 5.15: Ciclos representativos: dados originais (azul); modelo Meglio original \n\n(vermelho); modelo Meglio estimado com base na press\u00e3o  (verde). \n\n\n\n56 Estudos de caso \n \n\n \n\n \nFigura 5.16: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \n\ncom . \n\nO modelo claramente n\u00e3o consegue ajustar os valores de  e a  estimada \nn\u00e3o \u00e9 adequada para todos os pontos experimentais, como ilustrado na Figura 5.17. \nApesar disso, os resultados obtidos apresentam correla\u00e7\u00f5es menores entre os \npar\u00e2metros, o que \u00e9 representado pelas regi\u00f5es de confian\u00e7a menos \ncorrelacionadas e mais abrangentes do que os resultados anteriores (Figura 5.18). \nA Tabela 13 mostra o teste F entre o modelo original e o modelo estimado. Os \npar\u00e2metros originais representam melhor a , enquanto os par\u00e2metros estimados \nrepresentam melhor a . \n\nTabela 11: Teste Chi Quadrado do modelo Meglio estimado com a press\u00e3o . \n\n    \n\n \n \n\n \n \n\n  \n \n\nTabela 12: Matriz de correla\u00e7\u00f5es do modelo Meglio estimado com a press\u00e3o . \n      \n\n \n \n \n \n\n \n \n\n\n\n5.2 Modelo Meglio aplicado a dados reais 57 \n \n \n\n \nTabela 13: Teste F do modelo Meglio estimado com a press\u00e3o . \n\n    \n\n estimada (1)  \n original (2) \n\n \n \n\n \n estimada (1)  \n original (2) \n\n \n\n \nFigura 5.17: Valores preditos e valores observados de  e  do modelo Meglio \n\nestimado com . \n\n \nFigura 5.18: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo \n\nMeglio estimado com . Valores \u00f3timos s\u00e3o representados em vermelho. \n\n\n\n58 Estudos de caso \n \n\n \n\n5.2.4 Estima\u00e7\u00e3o com base em  e  \n\nDe modo a aumentar a performance dos par\u00e2metros estimados, incluiu-se como \nrefer\u00eancia tanto  quanto  na mesma estima\u00e7\u00e3o. O c\u00e1lculo da fun\u00e7\u00e3o objetivo \nfoi modificado da forma: \n\n (5.3) \nonde  \u00e9 a fun\u00e7\u00e3o objetivo e  \u00e9 a fun\u00e7\u00e3o de M\u00ednimos Quadrados \nPonderados aplicada aos dados de .  \u00e9 a fun\u00e7\u00e3o de M\u00ednimos Quadrados \nPonderados aplicada aos dados de , considerando uma vari\u00e2ncia unit\u00e1ria para \nos experimentos porque as vari\u00e2ncias da  s\u00e3o muito menores do que da . \n\nEssa modifica\u00e7\u00e3o pode ser interpretada como a inclus\u00e3o de mais pontos \nexperimentais ao conjunto de dados. Contudo, considere um caso experimental \nhipot\u00e9tico em que s\u00e3o medidas as fra\u00e7\u00f5es molares  e  de uma mistura bin\u00e1ria \nqualquer. Como  e  est\u00e3o matematicamente correlacionados, tem-se de fato \nduas medidas experimentais de uma \u00fanica vari\u00e1vel independente, e n\u00e3o duas \nmedidas de duas vari\u00e1veis como pode parecer \u00e0 primeira vista.  \n\nAnalogamente, se os par\u00e2metros do modelo Meglio fossem capazes de \nrepresentar adequadamente os valores de  e  simultaneamente para \nqualquer resultado da otimiza\u00e7\u00e3o, a modifica\u00e7\u00e3o da fun\u00e7\u00e3o objetivo seria \nredundante. Por\u00e9m, como observado nos resultados anteriores, a refer\u00eancia \nutilizada tem um impacto profundo nas capacidades preditivas do modelo.  \n\nIsso levou \u00e0 investiga\u00e7\u00e3o da estima\u00e7\u00e3o com mais de um conjunto de dados. A \nFigura 5.19 ilustra os resultados obtidos. A Figura 5.20 mostra a evolu\u00e7\u00e3o da fun\u00e7\u00e3o \nobjetivo. Os coeficientes de correla\u00e7\u00e3o obtidos foram de  . \nAs  Tabela 14 e Tabela 15 mostram os resultados do teste Chi Quadrado e do teste \nF, respectivamente. O teste Chi Quadrado foi feito considerando a fun\u00e7\u00e3o objetivo \nmodificada, enquanto o teste F levou em conta os resultados de  e  \nseparadamente. \n\nO teste Chi Quadrado recomenda o uso do modelo e o teste F mostra que os \npar\u00e2metros obtidos s\u00e3o mais adequados do que os par\u00e2metros originais para  \ne para . Fica evidente que a inclus\u00e3o dos dois conjuntos de dados auxiliou na \nobten\u00e7\u00e3o de par\u00e2metros mais representativos para as duas press\u00f5es. Al\u00e9m disso, \nas Tabela 16 e Tabela 17 mostram uma significativa redu\u00e7\u00e3o na correla\u00e7\u00e3o entre \nos par\u00e2metros. A Figura 5.21 ilustra como os resultados dos valores preditos est\u00e3o \nmais pr\u00f3ximos do eixo dos valores observados para  e . Em contrapartida, a \nFigura 5.22 mostra como tamb\u00e9m diminu\u00edram as regi\u00f5es de confian\u00e7a para os \npar\u00e2metros. \n\nEsse resultado \u00e9 de suma import\u00e2ncia. Em seu artigo, Di Meglio et al. (2012) \nestudaram quatro poss\u00edveis estruturas de controle para um sistema pipeline-riser. \nA solu\u00e7\u00e3o mais est\u00e1vel \u00e9 baseada na diferen\u00e7a de press\u00e3o entre  e , \naplicando uma lei de controle que utiliza a estima\u00e7\u00e3o das press\u00f5es dada pelo \nmodelo. Portanto, fica claro que um bom ajuste das press\u00f5es apresentar\u00e1 melhores \nresultados para a estrutura de controle. \n\n\n\n5.2 Modelo Meglio aplicado a dados reais 59 \n \n \n\n \nFigura 5.19: Ciclos representativos: dados originais (azul); modelo Meglio original \n(vermelho); modelo Meglio estimado com base nas press\u00f5es  e  (verde). \n\n \nFigura 5.20: Evolu\u00e7\u00e3o da melhor posi\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o \n\ncom  e . \n \n\nTabela 14: Teste Chi Quadrado para o modelo Meglio estimado com as press\u00f5es \n e . \n\n    \n\n e     \n \n\n\n\n60 Estudos de caso \n \n\n \n\nTabela 15: Teste F do modelo Meglio estimado com as press\u00f5es  e . \n\n    \n\n estimada (1)  \n original (2) \n\n \n0,194 \n\n \n estimada (1)  \n original (2) \n\n0,023 \n\n \nTabela 16: Matriz de correla\u00e7\u00f5es para as medidas de  do modelo Meglio \n\nestimado com as press\u00f5es  e . \n      \n\n \n \n \n \n\n \n \n\nTabela 17: Matriz de correla\u00e7\u00f5es para as medidas de  do modelo Meglio \nestimado com as press\u00f5es  e . \n\n      \n \n\n \n \n \n\n \n\n \nFigura 5.21: Valores preditos e valores observados de  e  do modelo Meglio \n\nestimado com  e . \n\n\n\n5.3 Modelo FOWM com dados reais 61 \n \n \n\n \nFigura 5.22: Regi\u00f5es de confian\u00e7a de m\u00e1xima verossimilhan\u00e7a para o modelo \n\nMeglio estimado com  e . Valores \u00f3timos s\u00e3o representados em vermelho. \n\n5.3 Modelo FOWM com dados reais \nOs par\u00e2metros do modelo FOWM foram estimados com base nos dados do \n\npo\u00e7o Real Well A, apresentados no artigo de Diehl et al. (2017) e ilustrados na \nFigura 5.23. Considera-se uma abertura m\u00e9dia de v\u00e1lvula de  e uma vaz\u00e3o \nm\u00e9dia de entrada de gas-lift de  kg/s.  \n\nAlcan\u00e7ar 2000 itera\u00e7\u00f5es da fun\u00e7\u00e3o objetivo leva em torno de 24 h. O tempo \ncomputacional com o solver Radau5ODE para um conjunto de par\u00e2metros com f\u00e1cil \nconverg\u00eancia do modelo \u00e9 de aproximadamente 870 ms. O tempo para o solver \nCVode, com passo m\u00ednimo de , nas mesmas condi\u00e7\u00f5es, \u00e9 de 1,5 s. Ambos \nos tempos foram medidos com a fun\u00e7\u00e3o %%timeit do Python. \n\nPrimeiramente, foram estimados tr\u00eas conjuntos de par\u00e2metros baseados na \n considerando tr\u00eas cen\u00e1rios para o par\u00e2metro , que modifica \n\nmultiplicativamente o volume da tubula\u00e7\u00e3o subsea, . O estudo de diferentes \ncen\u00e1rios possibilita a melhor compreens\u00e3o dos efeitos do par\u00e2metro sobre a \nestima\u00e7\u00e3o. Em seguida, foram estimados par\u00e2metros do modelo com base nas \npress\u00f5es ,  (que no modelo \u00e9 dada por ) e . Esses par\u00e2metros \nforam comparados com os obtidos por Diehl et al. (2017), Apio (2017) e Huffner \n(2018), que tamb\u00e9m estimaram par\u00e2metros para o modelo FOWM utilizando as \nmesmas tr\u00eas press\u00f5es. \n\n\n\n62 Estudos de caso \n \n\n \n\n \n\nFigura 5.23: Dados de refer\u00eancia para o Real Well A. \n\n\n\n5.3 Modelo FOWM com dados reais 63 \n \n \n5.3.1 Influ\u00eancia do par\u00e2metro  \n\nComo o par\u00e2metro  representa a modifica\u00e7\u00e3o de um par\u00e2metro geom\u00e9trico \ndo sistema, \u00e9 interessante estudar sua influ\u00eancia nos outros par\u00e2metros. No \nprimeiro cen\u00e1rio,  \u00e9 fixo e n\u00e3o \u00e9 incluso na estima\u00e7\u00e3o de par\u00e2metros. Isso \nrepresenta um custo computacional menor e, possivelmente, a diminui\u00e7\u00e3o de \ncorrela\u00e7\u00f5es entre os par\u00e2metros. No segundo cen\u00e1rio, os limites de busca do \nalgoritmo de otimiza\u00e7\u00e3o para  s\u00e3o definidos entre 1 e 1,8 para avaliar o aumento \ndo volume real de tubula\u00e7\u00e3o na resposta do modelo. O terceiro cen\u00e1rio estende o \nlimite superior at\u00e9 2,2 somente para demonstrar a influ\u00eancia do limite desse \npar\u00e2metro. \n\nA Tabela 18 mostra a compara\u00e7\u00e3o entre os par\u00e2metros originais e os \npar\u00e2metros estimados com a nova fun\u00e7\u00e3o objetivo. A Figura 5.24 ilustra os ciclos \nm\u00e9dios dos dados, dos par\u00e2metros originais e dos novos par\u00e2metros. \u00c9 preciso \nnotar que n\u00e3o foi poss\u00edvel reproduzir o modelo como apresentado no artigo \nprovavelmente devido \u00e0 diferen\u00e7a de integrador utilizado. Os dados de refer\u00eancia \napresentam um comportamento similar, mas uma m\u00e9dia maior do que o visto no \nartigo; os dados originais n\u00e3o estavam dispon\u00edveis. Trata-se do mesmo po\u00e7o, mas \nprovavelmente em condi\u00e7\u00f5es diferentes das utilizadas na publica\u00e7\u00e3o. O resultado \napresentado em vermelho na Figura 5.24 foi extra\u00eddo com o software Pega Ponto. \n\nTabela 18: Compara\u00e7\u00e3o entre resultados originais e resultados obtidos com a \nnova metodologia. \n\nPar\u00e2metro \nReal Well A \n\nDiehl et al. Cen\u00e1rio 1 \n \n\nCen\u00e1rio 2 \n \n\nCen\u00e1rio 3 \n \n\n      \n      \n\n      \n      \n      \n      \n      \n\n      \n      \n\n \n\n\n\n64 Estudos de caso \n \n\n \n\n \nFigura 5.24: Compara\u00e7\u00e3o entre ciclos obtidos entre os cen\u00e1rios para o modelo \n\nFOWM. \n\nOs testes Chi Quadrado para os resultados s\u00e3o mostrados na Tabela 19. A \nTabela 20 mostra os coeficientes de correla\u00e7\u00e3o obtidos. Como pode ser observado, \nos par\u00e2metros originais apresentam tend\u00eancia similar \u00e0 refer\u00eancia, mas o uso do \nmodelo n\u00e3o \u00e9 recomendado pelo teste. J\u00e1 os par\u00e2metros estimados se adequam \nbem \u00e0 tend\u00eancia e o modelo satisfaz o teste. \n\nO teste F para os cen\u00e1rios mostra que n\u00e3o existe diferen\u00e7a significativa entre \nos ajustes obtidos (Tabela 21). Assim, os resultados obtidos em cada cen\u00e1rio s\u00e3o \nigualmente capazes de representar os dados de refer\u00eancia. J\u00e1 o teste F entre os \ncen\u00e1rios e os resultados originais mostra que os par\u00e2metros estimados apresentam \nmelhores resultados do que os originais (Tabela 22), embora isso fosse previsto \ndado que a refer\u00eancia n\u00e3o \u00e9 a mesma para os dois modelos. \n\nTabela 19: Teste Chi Quadrado para o modelo FOWM baseado em dados reais. \n\n    \n\nOriginal \n\n \n\n \n\n \nCen\u00e1rio 1  \nCen\u00e1rio 2  \nCen\u00e1rio 3  \n\n \nTabela 20: Coeficientes de correla\u00e7\u00e3o obtidos do resultado original e dos cen\u00e1rios \n\npara o modelo FOWM. \nConjunto  \n\nDiehl et al.  \nCen\u00e1rio 1  \nCen\u00e1rio 2  \nCen\u00e1rio 3  \n\n \n\n\n\n5.3 Modelo FOWM com dados reais 65 \n \n \n\nTabela 21: Teste F para o modelo FOWM entre os cen\u00e1rios. \n\n    \n\nCen\u00e1rio 1 (1)  \ne Cen\u00e1rio 2 (2) \n\n \n \n\n \nCen\u00e1rio 1 (1)  \n\ne Cen\u00e1rio 3 (2) \n \n\n \n\nTabela 22: Teste F para o modelo FOWM entre os cen\u00e1rios e o resultado original. \n\n    \n\nCen\u00e1rio 1 (1)  \ne par\u00e2metros originais (2) \n\n \n\n \n\n \nCen\u00e1rio 2 (1)  \n\ne par\u00e2metros originais (2) \n \n\nCen\u00e1rio 3 (1)  \ne par\u00e2metros originais (2) \n\n \n\n \n\nAs Tabela 23, Tabela 24 e Tabela 25 mostram as matrizes de correla\u00e7\u00f5es dos \ncen\u00e1rios 1, 2 e 3, respectivamente. Como n\u00e3o foi poss\u00edvel reproduzir o modelo \noriginal, tamb\u00e9m n\u00e3o \u00e9 poss\u00edvel obter a matriz de correla\u00e7\u00f5es original. Fica evidente \nque o par\u00e2metro  tem uma alta influ\u00eancia nas correla\u00e7\u00f5es entre os par\u00e2metros. \nO cen\u00e1rio 3, que apresenta o  mais elevado, \u00e9 tamb\u00e9m o que apresenta o maior \nn\u00famero de correla\u00e7\u00f5es altas. Dado que n\u00e3o h\u00e1 diferen\u00e7a estat\u00edstica entre os ajustes \nobtidos, a necessidade de inclus\u00e3o de  na estima\u00e7\u00e3o de par\u00e2metros se torna \nquestion\u00e1vel. \n\nA Figura 5.25 mostra a compara\u00e7\u00e3o entre os valores preditos e os valores \nobservados. Considera-se a vari\u00e2ncia de predi\u00e7\u00e3o do modelo original como igual \u00e0 \nvari\u00e2ncia experimental obtida, dado que representa a vari\u00e2ncia m\u00ednima associada \n\u00e0 predi\u00e7\u00e3o. Os erros observados para os resultados s\u00e3o justificados pela vari\u00e2ncia \nexperimental e pela de predi\u00e7\u00e3o. J\u00e1 os erros relacionados ao modelo original \nsimplesmente refor\u00e7am a ideia de que esse conjunto de par\u00e2metros \u00e9 inadequado. \n\nA Figura 5.26, a Figura 5.27 e a Figura 5.28 mostram as regi\u00f5es de confian\u00e7a \nde m\u00e1xima verossimilhan\u00e7a para os cen\u00e1rios 1, 2 e 3, respectivamente. O algoritmo \nde otimiza\u00e7\u00e3o tende a priorizar valores-limite dos par\u00e2metros, como mostrado na \nTabela 18. Isso gera regi\u00f5es menores a menos que se fa\u00e7a uma varredura manual \ncom alto custo computacional alto e foi desconsiderado. Assim, foram obtidos bons \najustes com a metodologia proposta.  \n\nA distin\u00e7\u00e3o entre os resultados dos cen\u00e1rios requer novos pontos experimentais. \nPara tanto, pode-se incluir dados de outras aberturas de v\u00e1lvula choke, ou dados \nde outras press\u00f5es de forma an\u00e1loga \u00e0 realizada para o modelo Meglio. Sem outros \ndados para compara\u00e7\u00e3o, os modelos obtidos possuem igual capacidade de \npredi\u00e7\u00e3o da press\u00e3o  nas condi\u00e7\u00f5es operacionais simuladas.  \n\n\n\n66 Estudos de caso \n \n\n \n\nTabela 23: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 1. \n         \n\n \n \n \n \n\n \n \n \n \n\n \n\nTabela 24: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 2. \n          \n\n \n \n \n \n\n \n \n \n \n \n\n \n\nTabela 25: Matriz de correla\u00e7\u00f5es do modelo FOWM para cen\u00e1rio 3. \n          \n\n \n \n \n \n\n \n \n \n \n \n\n \n\n\n\n5.3 Modelo FOWM com dados reais 67 \n \n \n\n \nFigura 5.25: Valores preditos e observados da press\u00e3o : (a) dados originais, \n\n(b) cen\u00e1rio 1, (c) cen\u00e1rio 2 e (d) cen\u00e1rio 3. \n\n  \n\n\n\n68 Estudos de caso \n \n\n \n\n \nFigura 5.26: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 1. \n\n\n\n5.3 Modelo FOWM com dados reais 69 \n \n \n\n \nFigura 5.27: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 2. \n\n \n\n\n\n70 Estudos de caso \n \n\n \n\n \nFigura 5.28: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o cen\u00e1rio 3. \n\n\n\n5.3 Modelo FOWM com dados reais 71 \n \n \n5.3.2 Estima\u00e7\u00e3o de par\u00e2metros com outras refer\u00eancias \n\nAnalisando a Figura 5.29, que mostra o comportamento das press\u00f5es  \ne  dos modelos estimados com a , \u00e9 poss\u00edvel notar que o uso da  como \n\u00fanica refer\u00eancia n\u00e3o garante a ader\u00eancia do modelo \u00e0s outras press\u00f5es. Assim, \nanalogamente ao que foi feito com o modelo de Di Meglio et al. (2009), foram \nestimados os par\u00e2metros do modelo FOWM utilizando tr\u00eas conjuntos de dados de \nrefer\u00eancia: ,  e . Foi necess\u00e1rio considerar o in\u00edcio e o fim do ciclo da  \ncom base nos picos ao inv\u00e9s dos vales porque s\u00e3o mais facilmente identificados. \nOs resultados foram ent\u00e3o comparados com os obtidos por Diehl et al. (2017), Apio \n(2017) e H\u00fcffner (2018). A Figura 5.30 mostra a evolu\u00e7\u00e3o da fun\u00e7\u00e3o objetivo, \nenquanto a Tabela 26 mostra a compara\u00e7\u00e3o entre os par\u00e2metros obtidos. \n\n \nFigura 5.29: Ciclos m\u00e9dios das press\u00f5es (a) , (b)  e (c) , considerando \n\na refer\u00eancia e os resultados de diferentes valores de . Os resultados foram \nobtidos utilizando somente  como refer\u00eancia. \n\n \n\n\n\n72 Estudos de caso \n \n\n \n\n \nFigura 5.30: Evolu\u00e7\u00e3o da fun\u00e7\u00e3o objetivo para a estima\u00e7\u00e3o do modelo FOWM \n\ncom base em tr\u00eas press\u00f5es. \n\nTabela 26: Compara\u00e7\u00e3o entre par\u00e2metros estimados do modelo FOWM para o \nReal Well A. \n\nPar\u00e2metro Diehl et al. (2017) \nApio  \n\n(2017) \nH\u00fcffner \n(2018) Rodrigues \n\n      \n      \n\n      \n      \n      \n      \n      \n\n      \n      \n\n \n\nComo o trabalho de Diehl et al. (2017) n\u00e3o apresenta os resultados do modelo \npara a , foram utilizados somente dados simulados para a avalia\u00e7\u00e3o dos \nresultados. A Figura 5.31 mostra os ciclos m\u00e9dios das tr\u00eas press\u00f5es para a \nrefer\u00eancia e os quatro conjuntos de par\u00e2metros do modelo FOWM. Os par\u00e2metros \nde Diehl et al., Apio e H\u00fcffner apresentam baixa ader\u00eancia (Tabela 27) e n\u00e3o s\u00e3o \nrecomendados pelo teste Chi Quadrado (Tabela 28). Os par\u00e2metros obtidos com a \nnova fun\u00e7\u00e3o objetivo, por outro lado, apresentam maior ader\u00eancia, mas tamb\u00e9m \nn\u00e3o s\u00e3o recomendados pelo teste. Contudo, a representatividade dos dados \u00e9 \nmaior com os par\u00e2metros estimados (Figura 5.32). Isso indica que h\u00e1 margem para \nmelhorias no equacionamento do modelo. \n\n\n\n5.3 Modelo FOWM com dados reais 73 \n \n \n\n  \nFigura 5.31: Compara\u00e7\u00e3o entre as press\u00f5es (a) , (b)  e (c)  para a \n\nrefer\u00eancia e os diferentes conjuntos de par\u00e2metros obtidos para o modelo FOWM. \n\nTabela 27: Coeficientes de correla\u00e7\u00e3o para os conjuntos de par\u00e2metros \nestudados para o modelo FOWM. \n\n    \nDiehl et al. (2017)    \n\nApio (2017)    \nH\u00fcffner (2018)    \n\nRodrigues    \n \n\n  \n\n\n\n74 Estudos de caso \n \n\n \n\nTabela 28: Teste Chi Quadrado para o modelo FOWM estimado com tr\u00eas \npress\u00f5es. \n\n    \n\nDiehl et al. (2017) \n\n \n\n \n\n \nApio (2017)  \n\nH\u00fcffner (2018)  \nRodrigues  \n\n \nFigura 5.32: Compara\u00e7\u00e3o entre as press\u00f5es (a) , (b)  e (c)  para a \n\nrefer\u00eancia e o conjunto de par\u00e2metros estimado para o modelo FOWM. \n\n  \n\n\n\n5.3 Modelo FOWM com dados reais 75 \n \n \n\nO teste F \u00e9 mostrado na Tabela 29. As Tabela 30, Tabela 31 e Tabela 32 \nmostram as matrizes de correla\u00e7\u00e3o das press\u00f5es ,  e , \nrespectivamente. A Figura 5.33 mostra a compara\u00e7\u00e3o entre valores preditos e \nobservados. Por fim, a Figura 5.34 mostra as regi\u00f5es de confian\u00e7a de m\u00e1xima \nverossimilhan\u00e7a para os par\u00e2metros considerando a estima\u00e7\u00e3o com a nova fun\u00e7\u00e3o \nobjetivo. \n\nPara cada refer\u00eancia foram observados conjuntos de at\u00e9 tr\u00eas par\u00e2metros que \nn\u00e3o apresentam correla\u00e7\u00f5es altas ( ). No caso da , s\u00e3o os \npar\u00e2metros ,  e ; para a , os par\u00e2metros ,  e ; para a , \nos par\u00e2metros  e . Isso significa, por exemplo, que utilizar a  como \nrefer\u00eancia facilita a estima\u00e7\u00e3o de ,  e .  \n\nAl\u00e9m disso, \u00e9 poss\u00edvel afirmar com 95% de confian\u00e7a que os par\u00e2metros \nestimados ajustam melhor o modelo aos dados do que os trabalhos anteriores. O \nmodelo tamb\u00e9m nem sempre consegue justificar os erros experimentais \nobservados, embora os valores preditos sejam pr\u00f3ximos dos valores observados \nna maior parte dos pontos experimentais. \n\nTabela 29: Teste F para o modelo FOWM entre os diferentes conjuntos de \npar\u00e2metros obtidos para o Real Well A. \n\n    \n\nRodrigues (1) e \nDiehl et al. (2017) (2) \n\n \n\n \n\n \nRodrigues (1) e \nApio (2017) (2) \n\n \n\nRodrigues (1) e \nH\u00fcffner (2018) (2) \n\n \n\n \nTabela 30: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \n\npress\u00f5es. \n         \n\n \n \n \n \n\n \n \n \n \n\n \n\n\n\n76 Estudos de caso \n \n\n \n\nTabela 31: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \npress\u00f5es. \n\n         \n \n\n \n \n \n\n \n \n \n \n\n \n\nTabela 32: Matriz de correla\u00e7\u00f5es da  do modelo FOWM estimado com tr\u00eas \npress\u00f5es. \n\n         \n \n\n \n \n \n\n \n \n \n \n\n \n\n\n\n5.3 Modelo FOWM com dados reais 77 \n \n \n\n \n Figura 5.33: Valores preditos e observados da (a) , (b)  e (c)  do \n\nmodelo FOWM estimado com tr\u00eas press\u00f5es. \n\n\n\n78 Estudos de caso \n \n\n \n\n \nFigura 5.34: Regi\u00f5es de m\u00e1xima verossimilhan\u00e7a para o modelo FOWM estimado \n\ncom tr\u00eas press\u00f5es. \n\n\n\n6.1 Conclus\u00f5es quanto \u00e0 metodologia \n 79 \n \n\n \n\n Conclus\u00f5es e Trabalhos \nfuturos \n\nNeste cap\u00edtulo s\u00e3o apresentadas as conclus\u00f5es a respeito dos resultados. \nTamb\u00e9m s\u00e3o feitas sugest\u00f5es de trabalhos futuros tendo em vista outras aplica\u00e7\u00f5es \ndo m\u00e9todo proposto. \n\n6.1 Conclus\u00f5es quanto \u00e0 metodologia \nA nova metodologia desenvolvida neste trabalho prop\u00f5e que se obtenha um \n\nciclo representativo para todo o conjunto de dados em ciclo limite que incorpore a \nvariabilidade dos dados. Isso facilita as avalia\u00e7\u00f5es feitas a respeito dos dados, \nconsiderando que um grande n\u00famero de amostras pode ser condensado em um \nconjunto menor sem perdas de informa\u00e7\u00e3o. A interpreta\u00e7\u00e3o estat\u00edstica tamb\u00e9m se \ntorna mais direta porque se aproveita da natureza peri\u00f3dica dos dados como se \nfossem realizados v\u00e1rios experimentos seguidos. \n\nComo foi mostrado no Cap\u00edtulo 5 \u2013, a nova abordagem foi capaz de apresentar \nresultados mais significativos para os dois modelos estudados. As vari\u00e2ncias \nexperimentais foram essenciais na estima\u00e7\u00e3o de par\u00e2metros quando a refer\u00eancia \napresenta alta variabilidade. Isso foi comprovado estatisticamente atrav\u00e9s dos \ntestes F e Chi Quadrado. \n\n6.2 Estrat\u00e9gia de otimiza\u00e7\u00e3o do modelo FOWM \nConsiderando a alta correla\u00e7\u00e3o entre par\u00e2metros apresentada nos resultados \n\npara o modelo FOWM, sugere-se a avalia\u00e7\u00e3o da necessidade da inclus\u00e3o de todos \nos par\u00e2metros na rotina de otimiza\u00e7\u00e3o. A determina\u00e7\u00e3o da sensibilidade dos \npar\u00e2metros pode auxiliar na decis\u00e3o de se obter um valor fixo ou um valor estimado. \nIsso teria uma influ\u00eancia direta na correla\u00e7\u00e3o entre os par\u00e2metros, que precisaria \nser novamente estudada. As estima\u00e7\u00f5es mostram que o par\u00e2metro  muda \ndramaticamente as regi\u00f5es de confian\u00e7a dos par\u00e2metros. Contudo, n\u00e3o existe \nmelhora significativa quanto ao ajuste do modelo. Assim, esse par\u00e2metro poderia \nser fixado em  at\u00e9 que n\u00e3o seja poss\u00edvel obter um ajuste adequado com a \nestima\u00e7\u00e3o dos demais par\u00e2metros. \n\n\n\n80 Conclus\u00f5es e Trabalhos futuros \n \n\n \n\nAl\u00e9m disso, seria interessante a estima\u00e7\u00e3o simult\u00e2nea com diferentes aberturas \nde v\u00e1lvulas. Isso melhoraria a capacidade preditiva do modelo e a \nrepresentatividade de m\u00faltiplos conjuntos de dados. Analogamente como foi feito \nao modelo Meglio, outras press\u00f5es, como a  e a , tamb\u00e9m poderiam ser \ninclusas na otimiza\u00e7\u00e3o.  \n\n6.3 Sugest\u00f5es de trabalhos futuros \nA compara\u00e7\u00e3o entre diferentes conjuntos de par\u00e2metros \u00e9 feita atrav\u00e9s do teste \n\nF. Contudo, o teste assume que os erros seguem a distribui\u00e7\u00e3o normal. Determinar \nse essa suposi\u00e7\u00e3o \u00e9 v\u00e1lida ou n\u00e3o atrav\u00e9s de um teste Kolmogorov\u2013Smirnov (KS) \npermitiria decidir se h\u00e1 necessidade de outro teste para compara\u00e7\u00e3o entre \nconjuntos de par\u00e2metros. \n\nA obten\u00e7\u00e3o de um ciclo m\u00e9dio para um espa\u00e7o amostral gera uma base de \ncompara\u00e7\u00e3o para dados similares. Da mesma forma que o modelo \u00e9 comparado \ncom a refer\u00eancia na fun\u00e7\u00e3o objetivo, refer\u00eancias diferentes podem ser avaliadas a \nfim de determinar a presen\u00e7a ou n\u00e3o de diferen\u00e7as significativas. \n\nNo segmento de eleva\u00e7\u00e3o de petr\u00f3leo, pode-se aplicar o m\u00e9todo de modo a \nauditar dados de press\u00e3o e produ\u00e7\u00e3o em diferentes condi\u00e7\u00f5es operacionais. A \ncria\u00e7\u00e3o de uma base de dados para cada condi\u00e7\u00e3o auxiliaria na identifica\u00e7\u00e3o de \ndist\u00farbios do sistema. \n\nNo segmento de automa\u00e7\u00e3o, v\u00e1lvulas de controle podem apresentar \nagarramento. Nesses casos, surge uma condi\u00e7\u00e3o de ciclo limite devido \u00e0 \nresist\u00eancia ao movimento da haste da v\u00e1lvula (DAMBROS, 2016). Como as \noscila\u00e7\u00f5es prejudicam a performance da malha de controle, v\u00e1rios autores estudam \nm\u00e9todos de detec\u00e7\u00e3o de agarramento. Um ciclo representativo das oscila\u00e7\u00f5es \npoderia auxiliar essa linha de pesquisa. \n\n \n\n \n\n \n\n \n\n \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros \n 81 \n \n\n \n\nRefer\u00eancias  \nAAMO, O.M. et al. Observer design for multiphase flow in vertical pipes with gas-\nlift\u2013\u2013theory and experiments. Journal of Process Control, v. 15, n. 3, p. 247\u2013257, \nApr. 2005. Dispon\u00edvel em: \n<http://linkinghub.elsevier.com/retrieve/pii/S0959152404000848>. Acesso em: 21 \nfeb. 2017. \n\nANP. Especial ANP 20 anos. Dispon\u00edvel em: \n<http://www.anp.gov.br/wwwanp/institucional/especial-anp-20-anos>.  \n\nAPIO, Andressa. Estima\u00e7\u00e3o de par\u00e2metros em modelos com ciclo limite. 2017. \nDispon\u00edvel em:&lt;http://www.lume.ufrgs.br/handle/10183/163746>. Acesso em: 18 \nfeb. 2018. \n\nAPIO, Andressa; BOTELHO, Viviane R.; TRIERWEILER, Jorge O. Parameter \nestimation of models with limit cycle based on the reformulation of the objective \nfunction. Computers &amp; Chemical Engineering, v. 109, p. 236\u2013248, 4 Jan. 2018. \nDispon\u00edvel em:&lt;http://linkinghub.elsevier.com/retrieve/pii/S0098135417304106>. \nAcesso em: 9 jan. 2018. \n\nARAG\u00c3O, Amanda Pereira. Estimativa Da Contribui\u00e7\u00e3o Do Setor Petr\u00f3leo Ao \nProduto Interno Bruto Brasileiro: 1955/2004. p. 165, 2004. \n\nBAILEY, R et al. From Market Basket Analysis to Wellhead Monitoring: Using \nEvents to Increase Oil Recovery. SPE Intelligent Energy Conference &amp; Exhibition. \n[S.l.]: Society of Petroleum Engineers. Dispon\u00edvel em: \n<http://www.onepetro.org/doi/10.2118/167836-MS>. , 2014 \n\nBAKER, D. Simultaneous flow of oil and gas. Oil and Gas J., v. 53, p. 183\u2013195, \n1954. \n\nBENDIKSEN, Kjell H et al. The Dynamic Two-Fluid Model OLGA: Theory and \nApplication. Society of Petroleum Engineers, 1991. \n\nBERGMAN, Sixten. Peakdetect. 2016. Dispon\u00edvel em: \n\n\n\n82  \n \n\n \n\n<https://gist.github.com/sixtenbe/1178136>. \n\nBILLAUER, Eli. Peakdet. 2012. Dispon\u00edvel em:&lt;http://billauer.co.il/peakdet.html>. \n\nBRENNEN, Cristopher E. Fundamentals of Multiphase Flows. Pasadena, \nCalifornia: Cambridge University Press, 2005.  \n\nCEDERSUND, G; KNUDSEN, C. Improved parameter estimation for systems with \nan experimentally located Hopf bifurcation. IEE Proceedings - Systems Biology, v. \n152, n. 3, p. 161\u2013168, Sep. 2005. Dispon\u00edvel em: \n<http://link.aip.org/link/?BDJ/152/161/1>. \n\nCLERC, M; KENNEDY, J. The particle swarm - explosion, stability, and \nconvergence in a multidimensional complex space. IEEE Transactions on \nEvolutionary Computation, v. 6, n. 1, p. 58\u201373, 2002. Dispon\u00edvel em: \n<http://ieeexplore.ieee.org/document/985692/>. \n\nDALSMO, M; HALVORSEN, E; SLUPPHAUG, O. Active Feedback Control of \nUnstable Wells at the Brage Field. . [S.l.]: Society of Petroleum Engineers. , 2002 \n\nDAMBROS, J. W. V. Detec\u00e7\u00e3o do agarramento em v\u00e1lvulas de controle para \nsinais com refer\u00eancia vari\u00e1vel. 2016. Universidade Federal do Rio Grande do Sul, \n2016. Dispon\u00edvel em:&lt;http://hdl.handle.net/10183/149795>.  \n\nDI MEGLIO, Florent et al. Reproducing slugging oscillations of a real oil well. Dec. \n2010, [S.l.]: IEEE, Dec. 2010. p. 4473\u20134479. Dispon\u00edvel em: \n<http://ieeexplore.ieee.org/document/5717367/>.  \n\nDI MEGLIO, Florent et al. Stabilization of slugging in oil production facilities with or \nwithout upstream pressure sensors. Journal of Process Control, v. 22, n. 4, p. \n809\u2013822, Apr. 2012. Dispon\u00edvel em: \n<http://www.scopus.com/inward/record.url?eid=2-s2.0-\n84859550558&amp;partnerID=40&amp;md5=c9c552e1838d482207b2ce03faf7e388>. \n\nDI MEGLIO, Florent; KAASA, Glenn-Ole Ole; PETIT, Nicolas. A first principle \nmodel for multiphase slugging flow in vertical risers. Dec. 2009, [S.l.]: IEEE, Dec. \n2009. p. 8244\u20138251. Dispon\u00edvel em: \n<http://ieeexplore.ieee.org/document/5400680/>.  \n\nDIEHL, Fabio C. et al. Fast Offshore Wells Model (FOWM): A practical dynamic \nmodel for multiphase oil production systems in deepwater and ultra-deepwater \nscenarios. Computers &amp; Chemical Engineering, v. 99, p. 304\u2013313, Apr. 2017. \nDispon\u00edvel em:&lt;http://linkinghub.elsevier.com/retrieve/pii/S0098135417300443>. \nAcesso em: 21 feb. 2017. \n\nEIKREM, Gisle Otto; AAMO, Ole Morten; FOSS, Bjarne. On Instability in Gas Lift \nWells and Schemes for Stabilization by Automatic Control. SPE Production &amp; \nOperations, v. 23, n. 2, p. 268\u2013279, 1 May 2008. Dispon\u00edvel em: \n<http://www.onepetro.org/mslib/servlet/onepetropreview?id=SPE-101502-\nPA%5Cnhttps://www.onepetro.org/journal-paper/SPE-101502-PA>. \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 83 \n \n \nELMAN, Howard C et al. Lyapunov Inverse Iteration for Identifying Hopf \nBifurcations in Models of Incompressible Flow. SIAM Journal on Scientific \nComputing, doi: 10.1137/110827600, v. 34, n. 3, p. A1584\u2013A1606, 1 Jan. 2012. \nDispon\u00edvel em:&lt;http://epubs.siam.org/doi/10.1137/110827600>. \n\nFABRE, Jean et al. Severe Slugging in Pipeline/Riser Systems. [S.l: s.n.], 1990. v. \n5. Dispon\u00edvel em:&lt;http://www.onepetro.org/doi/10.2118/16846-PA>.  \n\nFINKEL, Daniel E. Global optimization with the direct algorithm. 2005. 2005.  \n\nFOSS, Bjarne. Process control in conventional oil and gas fields\u2014Challenges and \nopportunities. Control Engineering Practice, v. 20, n. 10, p. 1058\u20131064, 2012. \nDispon\u00edvel em: \n<http://www.sciencedirect.com/science/article/pii/S0967066112000202>. \n\nGEREVINI, Giovani. Atenua\u00e7\u00e3o de golfadas em sistemas de eleva\u00e7\u00e3o de petr\u00f3leo \nem ambiente offshore. p. 100, 2017. \n\nGEREVINI, Giovani Gon\u00e7alves. Atenua\u00e7\u00e3o de golfadas em sistemas de eleva\u00e7\u00e3o \nde petr\u00f3leo em ambiente offshore. 2017. Dispon\u00edvel em: \n<http://www.lume.ufrgs.br/handle/10183/172287>. Acesso em: 18 feb. 2018. \n\nGERHARD, D. Pitch extraction and fundamental frequency: history and current \ntechniques. . Deparment of Computer Science, University of Regina, Regina, \nCanada: [s.n.]. , 2003 \n\nGODHAVN, John Morten; FARD, Mehrdad P.; FUCHS, Per H. New slug control \nstrategies, tuning rules and experimental results. Journal of Process Control, v. 15, \nn. 5, p. 547\u2013557, 1 Aug. 2005. Dispon\u00edvel em: \n<http://www.sciencedirect.com/science/article/pii/S0959152404001131>. Acesso \nem: 25 sep. 2017. \n\nGUCKENHEIMER, John; MYERS, Mark; STURMFELS, Bernd. Computing Hopf \nBifurcations I. SIAM Journal on Numerical Analysis, doi: \n10.1137/S0036142993253461, v. 34, n. 1, p. 1\u201321, 1 Feb. 1997. Dispon\u00edvel em: \n<http://epubs.siam.org/doi/10.1137/S0036142993253461>. \n\nHAVRE, Kjetil; DALSMO, Morten. Active Feedback Control as a Solution to \nSevere Slugging. SPE Production &amp; Facilities, v. 17, n. 3, p. 138\u2013148, 2002. \nDispon\u00edvel em:&lt;http://www.onepetro.org/doi/10.2118/79252-PA>. \n\nH\u00dcFFNER, Leonardo Nardi. Formula\u00e7\u00e3o de Fun\u00e7\u00e3o Objetivo para Estima\u00e7\u00e3o de \nPar\u00e2metros de Modelos com Ciclo Limite. 2018. \n\nHYNNE, F.; DAN\u00d8, S.; S\u00d8RENSEN, P. G. Full-scale model of glycolysis in \nSaccharomyces cerevisiae. Biophysical Chemistry, v. 94, n. 1\u20132, p. 121\u2013163, Dec. \n2001. \n\nHYNNE, F.; GRAAE S\u00d8RENSEN, P.; M\u00d8LLER, T. Complete optimization of \nmodels of the Belousov-Zhabotinsky reaction at a Hopf bifurcation. The Journal of \nChemical Physics, v. 98, n. 1, p. 219\u2013230, Jan. 1993. Dispon\u00edvel em: \n<http://aip.scitation.org/doi/10.1063/1.464667>. \n\n\n\n84  \n \n\n \n\nJAHANSHAHI, E. et al. A comparison between Internal Model Control, optimal \nPIDF and robust controllers for unstable flow in risers. IFAC Proceedings Volumes \n(IFAC-PapersOnline), v. 19, n. March 2016, p. 5752\u20135759, 2014. \n\nJAHANSHAHI, Esmaeil. Control Solutions for Multiphase Flow. 2013. Norwegian \nUniversity of Science and Technology, 2013.  \n\nJAHANSHAHI, Esmaeil; SKOGESTAD, Sigurd. Simplified Dynamical Models for \nControl of Severe Slugging in Multiphase Risers. IFAC Proceedings Volumes, v. \n44, n. 1, p. 1634\u20131639, Jan. 2011. Dispon\u00edvel em: \n<http://linkinghub.elsevier.com/retrieve/pii/S1474667016438449>. Acesso em: 21 \nfeb. 2017. \n\nJANSEN, B\u00e5rd et al. Automatic Control of Unstable Gas Lifted Wells. 4 Apr. 1999, \n[S.l.]: Society of Petroleum Engineers, 4 Apr. 1999. p. 1\u20139. Dispon\u00edvel em: \n<http://www.onepetro.org/doi/10.2118/56832-MS>.  \n\nJANSEN, F.E.; SHOHAM, O.; TAITEL, Y. The elimination of severe slugging\u2014\nexperiments and modeling. International Journal of Multiphase Flow, v. 22, n. 6, p. \n1055\u20131072, Nov. 1996. Dispon\u00edvel em: \n<http://linkinghub.elsevier.com/retrieve/pii/0301932296000274>. Acesso em: 21 \nfeb. 2017. \n\nLEE, Abraham. Pyswarm v0.6. . [S.l: s.n.]. Dispon\u00edvel em: \n<https://pypi.python.org/pypi/pyswarm/#downloads>. , 2014 \n\nMEERBERGEN, Karl; SPENCE, Alastair. Inverse Iteration for Purely Imaginary \nEigenvalues with Application to the Detection of Hopf Bifurcations in Large-Scale \nProblems. SIAM Journal on Matrix Analysis and Applications, doi: \n10.1137/080742890, v. 31, n. 4, p. 1982\u20131999, 1 Jan. 2010. Dispon\u00edvel em: \n<http://epubs.siam.org/doi/abs/10.1137/080742890>. \n\nNABAVI, Seyedbehzad; WILLIAMS, Cranos M. A novel cost function to estimate \nparameters of oscillatory biochemical systems. EURASIP Journal on \nBioinformatics and Systems Biology, v. 2012, n. 1, p. 3, 2012. Dispon\u00edvel em: \n<https://bsb-eurasipjournals.springeropen.com/articles/10.1186/1687-4153-2012-\n3>. \n\nOLIVEIRA, J.A.; GAMBETTA, R.; PINTO, J.C. Pega Ponto v1.0. . [S.l: s.n.]. \nDispon\u00edvel em:&lt;http://pega-ponto.software.informer.com/1.0/>. , 2006 \n\nPEDERSEN, Simon; DURDEVIC, Petar; YANG, Zhenyu. Challenges in slug \nmodeling and control for offshore oil and gas productions: A review study. \nInternational Journal of Multiphase Flow, v. 88, p. 270\u2013284, 2017. \n\nPETROBRAS. Confira nossa produ\u00e7\u00e3o de petr\u00f3leo e g\u00e1s natural em julho. \nDispon\u00edvel em:&lt;http://www.petrobras.com.br/fatos-e-dados/confira-nossa-\nproducao-de-petroleo-e-gas-natural-em-julho.htm>.  \n\nPOLI, Riccardo; KENNEDY, James; BLACKWELL, Tim. Particle swarm \noptimization. Swarm Intelligence, v. 1, n. 1, p. 33\u201357, 17 Oct. 2007. Dispon\u00edvel \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 85 \n \n \nem:&lt;http://dx.doi.org/10.1007/s11721-007-0002-0>. \n\nRIZZO FILHO, Haroldo dos Santos. A Otimiza\u00e7\u00e3o de G\u00e1s Lift na Produ\u00e7\u00e3o de \nPetr\u00f3leo: Avalia\u00e7\u00e3o da Curva de Performance do Po\u00e7o. 2011. 92 f. UFRJ, 2011.  \n\nSARICA, Cem; TENGESDAL, Jarl \u00c3\u02dc. A New Technique to Eliminate Severe \nSlugging in Pipeline/Riser Systems. SPE Annual Technical Conference and \nExhibition. [S.l.]: Society of Petroleum Engineers. Dispon\u00edvel em: \n<http://www.onepetro.org/mslib/app/Preview.do?paperNumber=00063185&amp;society\nCode=SPE>. , 2000 \n\nSCHMIDT, Z; BRILL, J.P.; BEGGS, H.D. Experimental Study of Severe Slugging \nin a Two-Phase-Flow Pipeline - Riser Pipe System. Society of Petroleum \nEngineers Journal, v. 20, n. 5, p. 407\u2013414, 1 Oct. 1980. Dispon\u00edvel em: \n<http://www.onepetro.org/doi/10.2118/8306-PA>. \n\nSCHMIDT, Z; BRILL, J P; BEGGS, H D. Choking can eliminate pipeline slugging. \nOil Gas J., v. 12, p. 230\u2013238, 1979. \n\nSCHWAAB, M\u00e1rcio; PINTO, Jos\u00e9 Carlos. An\u00e1lise de Dados Experimentais I: \nFundamentos de Estat\u00edstica e Estima\u00e7\u00e3o de Par\u00e2metros. First ed. Rio de Janeiro: \nE-papers, 2007.  \n\nSEYDEL, R\u00fcdiger. Practical Bifurcation and Stability Analysis. New York, NY: \nSpringer New York, 2010. v. 5. Dispon\u00edvel em: \n<http://link.springer.com/10.1007/978-1-4419-1740-9>. (Interdisciplinary Applied \nMathematics). \n\nSINEGRE, L.; PETIT, Nicolas; MENEGATTI, P. Predicting instabilities in gas-lifted \nwells simulation. 2006 American Control Conference, p. 8 pp., 2006. Dispon\u00edvel \nem:&lt;http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=1657604>. \n\nSKOGESTAD, Sigurd; JAHANSHAHI, Esmaeil; HANSEN, Henrik. Control \nstructure design for stabilizing unstable gas-lift oil wells. IFAC Proceedings \nVolumes (IFAC-PapersOnline), v. 8, n. PART 1, p. 93\u2013100, 2012. Dispon\u00edvel em: \n<http://linkinghub.elsevier.com/retrieve/pii/S1474667016304256>. Acesso em: 21 \nfeb. 2017. \n\nSTORKAAS, E. Stabilizing control and controllability. 2005. 156 f. Norwegian \nUniversity of Science and Technology, 2005. Dispon\u00edvel em: \n<http://www.nt.ntnu.no/users/skoge/diplom/prosjekt08/tuvnes/Articles/STORKAAS\n_PHD_THESIS_STABILIZING CONTROL AND Controllability_Control Solutions \nto Slug_FLOW.pdf>.  \n\nSTORKAAS, Espen. Stabilizing control and controllability: control solutions to \navoid slug flow in pipeline-riser systems. 2005. 2005.  \n\nSTORNES, Karl Ole; HAVRE, Kjetil; STRAY, Henrik. Taming slug flow in \npipelines. ABB Review, v. 46, n. 4, p. 55\u201363, 2000. \n\nTHOMAS, Jos\u00e9 Eduardo. Fundamentos de Engenharia de Petroleo. Rio de \nJaneiro: Interci\u00eancia, 2001.  \n\n\n\n86  \n \n\n \n\nVOGEL, J V. Inflow Performance Relationships for Solution-Gas Drive Wells. \n1968. \n\nWALLIS, Graham B. One-dimensional two-phase flow. New York: McGraw-Hill, \n1969.  \n\nWEISMAN, J. Two-phase flow patterns. Cited By?:1Export Date: 3 November \n2017, 1983. Dispon\u00edvel em:&lt;https://www.scopus.com/inward/record.uri?eid=2-\ns2.0-0020556019&amp;partnerID=40&amp;md5=08df04132425fe33ae561c40f8326541>. \n\nWEISMAN, J.; KANG, S.Y. Flow pattern transitions in vertical and upwardly \ninclined lines. International Journal of Multiphase Flow, v. 7, n. 3, p. 271\u2013291, Jun. \n1981. Dispon\u00edvel em: \n<http://linkinghub.elsevier.com/retrieve/pii/0301932281900227>. Acesso em: 21 \nfeb. 2017. \n\n \n\n \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros \n 87 \n \n\n \n\nAp\u00eandice A \u2013 C\u00f3digos implementados \nem Python \n\nEsta se\u00e7\u00e3o \u00e9 dedicada a apresentar os principais c\u00f3digos utilizados neste \ntrabalho. Para os arquivos .py, o t\u00edtulo em it\u00e1lico representa a fun\u00e7\u00e3o descrita. O \nfluxograma da Figura A.1 ilustra as tomadas de decis\u00e3o para uma itera\u00e7\u00e3o. \n\n \n\nFigura A.1: Fluxograma para obten\u00e7\u00e3o do valor da fun\u00e7\u00e3o objetivo para uma \nitera\u00e7\u00e3o. \n\n  \n\n\n\n88 C\u00f3digos implementados em Python \n \n\n \n\n1.1 meglio.mo \nModelo Meglio implementado em JModelica. \n\n1. model meglio   \n2.                \n3.     //PARAMETERS   \n4.         parameter Real rol=900;   \n5.         parameter Real Ps=6.6e5;   \n6.         parameter Real R=8.314;   \n7.         parameter Real T=363.0;   \n8.         parameter Real M=2.2e-2;   \n9.         parameter Real g=9.81;   \n10.         parameter Real teta=0.7854;   \n11.         parameter Real A=1.77e-2;   \n12.         parameter Real mlstill=3.73e4;   \n13.         parameter Real D=1.5e-1;   \n14.         parameter Real Wgin=8.2e-1;   \n15.         parameter Real Wlin=11.75;   \n16.         parameter Real L=5200;   \n17.        \n18.         parameter Real Cg=1e-4;   \n19.         parameter Real E=0.78;   \n20.         parameter Real Veb=48.0;   \n21.         parameter Real Cout=2.8e-3;   \n22.        \n23.         parameter Real x1_0=5.4132e3;    \n24.         parameter Real x2_0=0.2704e3;    \n25.         parameter Real x3_0=4.9669e3;    \n26.        \n27.         //parameter Real u=0.5;   \n28.         parameter Real pi=3.14;   \n29.         parameter Real epsi = 1e-10;   \n30.        \n31.     //Initial Conditions   \n32.         Real x1(fixed=true,start=x1_0);    \n33.         Real x2(fixed=true,start=x2_0);    \n34.         Real x3(fixed=true,start=x3_0);    \n35.            \n36.     //Outputs   \n37.         Real Vr;   \n38.         Real Peb;   \n39.         Real Prt;   \n40.         Real Prb;   \n41.         Real Wout;   \n42.         Real Wlout;   \n43.         Real Wgout;   \n44.         Real Wg;   \n45.            \n46.         input Real u;   \n47.        \n48. equation   \n49.        \n50.     Vr = L*pi*D*D/4;   \n51.     Peb = x1*R*T/(M*Veb);   \n52.     Prt = x2*R*T/(M*(Vr-(x3+mlstill)/rol));   \n53.    \n54.     Prb = Prt + (x3+ mlstill)*g*sin(teta)/A;   \n55.     Wout = Cout*u*sqrt(rol)*sqrt(((Prt-Ps)+sqrt((Prt-Ps)^2+epsi))/2);   \n56.     Wgout  = x2*Wout/x3;   \n57.     Wlout  = Wout;   \n58.     Wg = Cg*((Peb - Prb)+sqrt((Peb - Prb)^2+epsi))*(0.5);   \n59.        \n60.     der(x1) = (1-E)*Wgin-Wg;   \n61.     der(x2) = E*Wgin+Wg-Wgout;    \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 89 \n \n \n\n62.     der(x3) = Wlin - Wlout;   \n63.        \n64. end meglio;   \n \n\n1.2 FOWM.mo \nModelo FOWM implementado em JModelica. \n\n1. model ABL56   \n2.                \n3.     //PARAMETERS   \n4.         parameter Real Rol     = 900;   \n5.         parameter Real R       = 8314;   \n6.         parameter Real T       = 298;   \n7.         parameter Real M       = 18;   \n8.         parameter Real g       = 9.81;   \n9.         parameter Real teta    = 3.14/4;   \n10.         parameter Real Ps      = 1013250;   \n11.         parameter Real Pr      = 2.25e7;   \n12.         parameter Real ALFAgw  = 0.0188;   \n13.         parameter Real Romres  = 891.9523;   \n14.         parameter Real L       = 4497;   \n15.         parameter Real Lt      = 1639;   \n16.         parameter Real La      = 1118;   \n17.         parameter Real D       = 0.152;   \n18.         parameter Real Dt      = 0.150;   \n19.         parameter Real Da      = 0.140;   \n20.         parameter Real Hvgl    = 916;   \n21.         parameter Real Hpdg    = 1117;   \n22.         parameter Real Ht      = 1279;   \n23.         parameter Real epsi    = 1e-10;   \n24.    \n25.     //ADJUST PARAMETERS   \n26.         parameter Real mlstill = 6.222e1;   \n27.         parameter Real Cg      = 1.137e-3;   \n28.         parameter Real Cout    = 2.039e-3;   \n29.         parameter Real Veb     = 6.098e1;   \n30.         parameter Real E       = 1.545e-1;   \n31.         parameter Real Kw      = 6.876e-4;   \n32.         parameter Real Ka      = 2.293e-5;   \n33.         parameter Real Vr      = 226.74;   \n34.         parameter Real Kr      = 1.269e2;   \n35.    \n36.    \n37.     //PARAMETERS OF DECISION          \n38.         parameter Real z      = 0.05;       \n39.         parameter Real Wgc      = 0.693246557269;   \n40.        \n41.    \n42.         parameter Real A       = D*D*3.14/4;   \n43.         parameter Real Vt      = Lt*Dt*Dt*3.14/4;   \n44.         parameter Real Va      = La*Da*Da*3.14/4;   \n45.    \n46.     //Initial Conditions   \n47.         parameter Real x1_0      = 9347.5467727;   \n48.         parameter Real x2_0      = 5347.53586993;   \n49.         parameter Real x3_0      = 35014.1218045;   \n50.         parameter Real x4_0      = 2395.94295262;   \n51.         parameter Real x5_0      = 1788.01439135;   \n52.         parameter Real x6_0      = 11725.3198923;           \n53.            \n54.     //Outputs    \n55.         Real x1(fixed=true,start=x1_0);    \n56.         Real x2(fixed=true,start=x2_0);    \n57.         Real x3(fixed=true,start=x3_0);    \n58.         Real x4(fixed=true,start=x4_0);    \n\n\n\n90 C\u00f3digos implementados em Python \n \n\n \n\n59.         Real x5(fixed=true,start=x5_0);   \n60.         Real x6(fixed=true,start=x6_0);    \n61.        \n62.         Real Peb;   \n63.         Real Prt;   \n64.         Real Prb;   \n65.         Real ALFAg;   \n66.         Real ALFAl;         \n67.         Real Wout;   \n68.         Real Wlout;   \n69.         Real Wgout;   \n70.         Real Wg;   \n71.    \n72.          \n73.         Real Vgt;      \n74.         Real ROgt;    \n75.         Real ROmt;           \n76.         Real Ptt;   \n77.         Real Ptb;   \n78.         Real Ppdg;   \n79.         Real Pbh;           \n80.         Real ALFAgt;           \n81.         Real Wwh;   \n82.         Real Wwhg;   \n83.         Real Wwhl;   \n84.         Real Wr;   \n85.             \n86.         Real Pai;         \n87.         Real ROai;                              \n88.         Real Wiv;   \n89.    \n90. equation   \n91.    \n92.         Peb = x1*R*T/(M*Veb);   \n93.         Prt = x2*R*T/(M*(Vr-(x3+mlstill)/Rol));   \n94.         Prb = Prt + (x3 + mlstill)*g*sin(teta)/A;   \n95.         ALFAg = x2/(x2 + x3);   \n96.         ALFAl = 1 - ALFAg;         \n97.         Wout = Cout*z*sqrt(Rol*((Prt - Ps)+sqrt((Prt - Ps)^2+epsi))*(1/2));   \n98.         Wlout = ALFAl*Wout;   \n99.         Wgout = ALFAg*Wout;   \n100.         Wg = Cg*((Peb - Prb)+sqrt((Peb - Prb)^2+epsi))*(1/2);   \n101.    \n102.          \n103.         Vgt = Vt - x6/Rol;      \n104.         ROgt = x5/Vgt;    \n105.         ROmt = (x5 + x6)/Vt;           \n106.         Ptt  = ROgt*R*T/M;   \n107.         Ptb  = Ptt + ROmt*g*Hvgl;   \n108.         Ppdg = Ptb + Romres*g*(Hpdg-Hvgl);   \n109.         Pbh    = Ppdg + Romres*g*(Ht-Hpdg);           \n110.         ALFAgt = x5/(x6 + x5);           \n111.         Wwh = Kw*sqrt(Rol*((Ptt - Prb)+sqrt((Ptt - Prb)^2+epsi))*(1/2));   \n112.         Wwhg = Wwh*ALFAgt;   \n113.         Wwhl = Wwh*(1 - ALFAgt);   \n114.         Wr   = Kr*(1-0.2*Pbh./Pr-0.8*(Pbh./Pr).^2);   \n115.             \n116.         Pai  = ((R*T/(Va*M)) + (g*La/Va))*x4;         \n117.         ROai = M*Pai/(R*T);                              \n118.         Wiv  = Ka*sqrt(ROai*((Pai - Ptb)+sqrt((Pai - Ptb)^2+epsi))*(1/2));   \n119.            \n120.         der(x1) = (1 - E)*(Wwhg) - Wg;                      \n121.         der(x2) = E*(Wwhg) + Wg - Wgout;                   \n122.         der(x3) = Wwhl - Wlout;                              \n123.         der(x4) = Wgc - Wiv;                                 \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 91 \n \n \n\n124.         der(x5) = Wr * ALFAgw + Wiv - Wwhg;                  \n125.         der(x6) = Wr * ( 1 - ALFAgw ) - Wwhl;               \n126.    \n127. end ABL56;   \n \n\n1.3 peakdetect.py \npeakdetect - Algoritmo de detec\u00e7\u00e3o de picos. \n\n1. import numpy as np   \n2.    \n3. def _datacheck_peakdetect(x_axis, y_axis):   \n4.     if x_axis is None:   \n5.         x_axis = range(len(y_axis))   \n6.        \n7.     if len(y_axis) != len(x_axis):   \n8.         raise ValueError(    \n9.                 \"Input vectors y_axis and x_axis must have same length\")   \n10.        \n11.     #needs to be a numpy array   \n12.     y_axis = np.array(y_axis)   \n13.     x_axis = np.array(x_axis)   \n14.     return x_axis, y_axis   \n15.    \n16. def peakdetect(y_axis, x_axis = None, lookahead = 200, delta=0):   \n17.     \"\"\"  \n18.     Converted from/based on a MATLAB script at:   \n19.     http://billauer.co.il/peakdet.html  \n20.       \n21.     function for detecting local maxima and minima in a signal.  \n22.     Discovers peaks by searching for values which are surrounded by lower  \n23.     or larger values for maxima and minima respectively  \n24.       \n25.     keyword arguments:  \n26.     y_axis -- A list containing the signal over which to find peaks  \n27.       \n28.     x_axis -- A x-axis whose values correspond to the y_axis list and is used  \n29.         in the return to specify the position of the peaks. If omitted an  \n30.         index of the y_axis is used.  \n31.         (default: None)  \n32.       \n33.     lookahead -- distance to look ahead from a peak candidate to determine if  \n34.         it is the actual peak  \n35.         (default: 200)   \n36.         '(samples / period) / f' where '4 >= f >= 1.25' might be a good value  \n37.       \n38.     delta -- this specifies a minimum difference between a peak and  \n39.         the following points, before a peak may be considered a peak. Useful  \n40.         to hinder the function from picking up false peaks towards to end of  \n41.         the signal. To work well delta should be set to delta >= RMSnoise * 5.  \n42.         (default: 0)  \n43.             When omitted delta function causes a 20% decrease in speed.  \n44.             When used Correctly it can double the speed of the function  \n45.       \n46.       \n47.     return: two lists [max_peaks, min_peaks] containing the positive and  \n48.         negative peaks respectively. Each cell of the lists contains a tuple  \n49.         of: (position, peak_value)   \n50.         to get the average peak value do: np.mean(max_peaks, 0)[1] on the  \n51.         results to unpack one of the lists into x, y coordinates do:   \n52.         x, y = zip(*max_peaks)  \n53.     \"\"\"   \n54.     max_peaks = []   \n55.     min_peaks = []   \n56.     dump = []   #Used to pop the first hit which almost always is false   \n57.           \n\n\n\n92 C\u00f3digos implementados em Python \n \n\n \n\n58.     # check input data   \n59.     x_axis, y_axis = _datacheck_peakdetect(x_axis, y_axis)   \n60.     # store data length for later use   \n61.     length = len(y_axis)   \n62.        \n63.        \n64.     #perform some checks   \n65.     if lookahead &lt;1:   \n66.         raise ValueError(\"Lookahead must be '1' or above in value\")   \n67.     if not (np.isscalar(delta) and delta >= 0):   \n68.         raise ValueError(\"delta must be a positive number\")   \n69.        \n70.     #maxima and minima candidates are temporarily stored in   \n71.     #mx and mn respectively   \n72.     mn, mx = np.Inf, -np.Inf   \n73.        \n74.     #Only detect peak if there is 'lookahead' amount of points after it   \n75.     for index, (x, y) in enumerate(zip(x_axis[:-lookahead],    \n76.                                         y_axis[:-lookahead])):   \n77.         if y > mx:   \n78.             mx = y   \n79.             mxpos = x   \n80.         if y &lt;mn:   \n81.             mn = y   \n82.             mnpos = x   \n83.            \n84.         ####look for max####   \n85.         if y &lt;mx-delta and mx != np.Inf:   \n86.             #Maxima peak candidate found   \n87.             #look ahead in signal to ensure that this is a peak and not jitter   \n88.             if y_axis[index:index+lookahead].max() &lt;mx:   \n89.                 max_peaks.append([mxpos, mx])   \n90.                 dump.append(True)   \n91.                 #set algorithm to only find minima now   \n92.                 mx = np.Inf   \n93.                 mn = np.Inf   \n94.                 if index+lookahead >= length:   \n95.                     #end is within lookahead no more peaks can be found   \n96.                     break   \n97.                 continue   \n98.             #else:  #slows shit down this does   \n99.             #    mx = ahead   \n100.             #    mxpos = x_axis[np.where(y_axis[index:index+lookahead]==mx)]   \n101.            \n102.         ####look for min####   \n103.         if y > mn+delta and mn != -np.Inf:   \n104.             #Minima peak candidate found    \n105.             #look ahead in signal to ensure that this is a peak and not jitter   \n106.             if y_axis[index:index+lookahead].min() > mn:   \n107.                 min_peaks.append([mnpos, mn])   \n108.                 dump.append(False)   \n109.                 #set algorithm to only find maxima now   \n110.                 mn = -np.Inf   \n111.                 mx = -np.Inf   \n112.                 if index+lookahead >= length:   \n113.                     #end is within lookahead no more peaks can be found   \n114.                     break   \n115.             #else:  #slows shit down this does   \n116.             #    mn = ahead   \n117.             #    mnpos = x_axis[np.where(y_axis[index:index+lookahead]==mn)]   \n118.        \n119.        \n120.     #Remove the false hit on the first value of the y_axis   \n121.     try:   \n122.         if dump[0]:   \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 93 \n \n \n\n123.             max_peaks.pop(0)   \n124.         else:   \n125.             min_peaks.pop(0)   \n126.         del dump   \n127.     except IndexError:   \n128.         #no peaks were found, should the function return empty lists?   \n129.         pass   \n130.            \n131.     return [max_peaks, min_peaks]   \n \n\n1.4 freq.py \nfreq - Determina\u00e7\u00e3o de frequ\u00eancia baseada em autocorrela\u00e7\u00e3o. \n\n1. from numpy.fft import rfft   \n2. from numpy import argmax, mean, diff, log, copy, arange   \n3. from scipy.signal import fftconvolve   \n4.    \n5.    \n6. def parabolic(f, x):   \n7.        \n8.     \"\"\"Quadratic interpolation for estimating the true position of an  \n9.     inter-sample maximum when nearby samples are known.  \n10.      \n11.     f is a vector and x is an index for that vector.  \n12.      \n13.     Returns (vx, vy), the coordinates of the vertex of a parabola that goes  \n14.     through point x and its two neighbors.  \n15.      \n16.     Example:  \n17.     Defining a vector f with a local maximum at index 3 (= 6), find local  \n18.     maximum if points 2, 3, and 4 actually defined a parabola.  \n19.      \n20.     In [3]: f = [2, 3, 1, 6, 4, 2, 3, 1]  \n21.      \n22.     In [4]: parabolic(f, argmax(f))  \n23.     Out[4]: (3.2142857142857144, 6.1607142857142856)  \n24.      \n25.     \"\"\"   \n26.     xv = 1/2. * (f[x-1] - f[x+1]) / (f[x-1] - 2 * f[x] + f[x+1]) + x   \n27.     yv = f[x] - 1/4. * (f[x-1] - f[x+1]) * (xv - x)   \n28.     return (xv, yv)   \n29.    \n30. def freq(signal, fs):   \n31.        \n32.     \"\"\"Estimate frequency using autocorrelation  \n33.       \n34.     Pros: Best method for finding the true fundamental of any repeating wave,   \n35.     even with strong harmonics or completely missing fundamental  \n36.       \n37.     Cons: Not as accurate, doesn't work for inharmonic things like musical   \n38.     instruments, this implementation has trouble with finding the true peak  \n39.       \n40.     \"\"\"   \n41.     # Calculate autocorrelation (same thing as convolution, but with one input   \n42.     # reversed in time), and throw away the negative lags   \n43.     signal = signal - mean(signal) # Remove DC offset   \n44.     corr = fftconvolve(signal, signal[::-1], mode='full')   \n45.     corr = corr[len(corr)/2:]   \n46.        \n47.     # Find the first low point   \n48.     d = diff(corr)   \n49.     start = next(i for i in range(len(d)) if d[i] > 0)   \n50.        \n51.     # Find the next peak after the low point (other than 0 lag).  This bit is    \n52.     # not reliable for long signals, due to the desired peak occurring between    \n\n\n\n94 C\u00f3digos implementados em Python \n \n\n \n\n53.     # samples, and other peaks appearing higher.   \n54.     i_peak = argmax(corr[start:]) + start   \n55.     i_interp = parabolic(corr, i_peak)[0]   \n56.        \n57.     return fs / i_interp   \n \n\n1.5 cycle.py \nCycle - Obten\u00e7\u00e3o do ciclo representativo. \n\n1. import scipy.interpolate as inter   \n2. from numpy import *   \n3. from freq import freq   \n4. from peakdetect import peakdetect   \n5.    \n6. def Cycle(traw,yraw):   \n7.        \n8.     \"\"\"  \n9.     Input 1 - time data  \n10.     Input 2 - signal data  \n11.       \n12.     Output 1 - cycle time data  \n13.     Output 2 - cycle signal data  \n14.     Output 3 - cycle variance data  \n15.       \n16.     \"\"\"   \n17.        \n18.     if len(traw) != len(yraw): raise ValueError('Input arrays must have same leng\n\nth')   \n19.        \n20.     Ts = traw[1]-traw[0]   \n21.     T = 1./freq(yraw,1./Ts)   \n22.     L = len(traw)   \n23.     LA = T/Ts/1.5   \n24.     if LA &lt;1.: LA = 1   \n25.     peaks = peakdetect(yraw, lookahead=LA)   \n26.    \n27.     tshift = []   \n28.     yshift = []   \n29.     for i in range(len(peaks[1])-1):   \n30.         tshift.append(array(traw[peaks[1][i][0]:peaks[1][i+1][0]+1])-\n\ntraw[peaks[1][i][0]])   \n31.         yshift.append(yraw[peaks[1][i][0]:peaks[1][i+1][0]+1])   \n32.         #plot(tshift[i],yshift[i])   \n33.    \n34.     NP = int(mean([ len(i) for i in tshift ]))   \n35.    \n36.        \n37.     tspline = []   \n38.     yspline = []   \n39.     yshift = []   \n40.     spliner = linspace(0,1./freq(yraw,1./(float(traw[1]-traw[0]))),NP)   \n41.     for i in range(len(peaks[1])-1):   \n42.         yshift.append(yraw[peaks[1][i][0]:peaks[1][i+1][0]+1])   \n43.         ranger = linspace(0,1./freq(yraw,1./(float(traw[1]-\n\ntraw[0]))),len(yshift[i]))   \n44.         tspline.append(ranger)   \n45.         yfspline = inter.InterpolatedUnivariateSpline(tspline[i],yshift[i])   \n46.         yspline.append(yfspline(spliner))   \n47.    \n48.     ymean = [ mean([ yspline[k][i] for k in range(len(yspline))]) for i in range(\n\nlen(spliner)) ]   \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 95 \n \n \n\n49.     yvar = [ var([ yspline[k][i] for k in range(len(yspline))]) for i in range(le\nn(spliner)) ]   \n\n50.        \n51.     return spliner,ymean,yvar   \n \n\n1.6 stability.py \nStabilityCheck - Determina a condi\u00e7\u00e3o do sistema (estado estacion\u00e1rio, \n\ntransiente ou ciclo limite); \n\n1. import scipy   \n2. import numpy as np   \n3. from numpy import mean, array as A, log, exp   \n4. from peakdetect import peakdetect   \n5.    \n6.    \n7. def LS(ye,ym,gl): return sum( ( A(ye) - A(ym) ) **2 ) / gl   \n8.    \n9. def f(t,y):   \n10.        \n11.     DFT = np.fft.fft(y)/len(y)   \n12.     fs = 1./(t[1]-t[0])   \n13.     xDFT = np.fft.fftfreq(len(DFT),d=1./fs)   \n14.     M = np.argmax(abs(DFT))   \n15.     return abs(xDFT[M])   \n16.    \n17. def b(t,y,la):   \n18.        \n19.     pmax,pmin = peakdetect(y,lookahead=la)   \n20.     tpeak,ypeak = [],[]   \n21.     for i in range(len(pmax)):   \n22.         tpeak.append(t[pmax[i][0]])   \n23.         ypeak.append(pmax[i][1])   \n24.            \n25.     bmean = mean([log(ypeak[i]/ypeak[i+1])/(tpeak[i+1]-\n\ntpeak[i]) for i in range(len(tpeak)-1)])   \n26.        \n27.     return bmean   \n28.    \n29. def C(t,y,la):   \n30.        \n31.     pmax,pmin = peakdetect(y,lookahead=la)   \n32.     tpeak,ypeak = [],[]   \n33.     for i in range(len(pmax)):   \n34.         tpeak.append(t[pmax[i][0]])   \n35.         ypeak.append(pmax[i][1])   \n36.            \n37.     Cmean = 0.5*mean([(ypeak[i]/exp(-b(t,y,la)*tpeak[i])+ypeak[i+1]/exp(-\n\nb(t,y,la)*tpeak[i+1])) for i in range(len(tpeak)-1)])   \n38.        \n39.     return Cmean   \n40.        \n41. def Exp(b,c,t): return c*exp(-b*A(t))   \n42.    \n43. def StabilityCheck(t,y,debug=False):   \n44.        \n45.     \"\"\"  \n46.     Input 1 - time data  \n47.     Input 2 - signal data  \n48.       \n49.     Output - True = Yes, the system is stabilizing / False = No, the system prese\n\nnts limit cycle  \n50.       \n51.     \"\"\"   \n52.        \n53.     ## 1 - Tem periodo e pelo menos 3 ciclos?   \n\n\n\n96 C\u00f3digos implementados em Python \n \n\n \n\n54.     try:   \n55.         T = 1./f(t,A(y)-mean(y))   \n56.         ts = t[1] - t[0]   \n57.         N = int(t[-1]/T)   \n58.         n = int(3.*T/ts) + 1   \n59.         if not N >= 6:    \n60.             if debug: print('N &lt;6, T = '+str(T)+', N = '+str(N)+', t[-\n\n1] = '+str(t[-1]))   \n61.             return True # com menos de 6 ciclos, o metodo nao funciona (3 ciclos \n\nde corte, 3 ciclos de ajuste)   \n62.     except:   \n63.         return True   \n64.         if debug:    \n65.             print 'erro na avaliacao de periodos'   \n66.             return True   \n67.        \n68.     ## 2 - A variancia dos tres ultimos periodos tem significancia? / Todos os pi\n\ncos sao decrescentes?   \n69.     if np.var(y[-n:]) &lt;1e-5:   \n70.         if debug: print 'variancia insignificante'   \n71.         return True   \n72.     t,y = A(t[n:])-t[n],y[n:]   \n73.     la = int(len(t)/(t[-1]/T)/1.5)   \n74.     if la &lt;1: la = 1   \n75.     pmax,pmin = peakdetect(y,lookahead=la)   \n76.     thpeak,yhpeak,tlpeak,ylpeak = [],[],[],[]   \n77.     for i in range(len(pmax)):   \n78.         thpeak.append(t[pmax[i][0]])   \n79.         yhpeak.append(pmax[i][1])   \n80.     for i in range(len(pmin)):   \n81.         tlpeak.append(t[pmin[i][0]])   \n82.         ylpeak.append(pmin[i][1])   \n83.            \n84.     if np.var(yhpeak) &lt;1e-3:   \n85.         if debug: print 'picos nao variam significativamente'   \n86.         return False   \n87.     elif np.var(ylpeak) &lt;1e-3:   \n88.         if debug: print 'picos nao variam significativamente'   \n89.         return False   \n90.            \n91.     dec = all([yhpeak[i] > yhpeak[i+1] for i in range(len(yhpeak)-1)])   \n92.     if not dec:    \n93.         if debug: print 'picos nao sao decrescentes'   \n94.         return False   \n95.            \n96.     ## 3 - Um oscilador harmonico subamortecido ajusta os picos melhor do que a m\n\nedia dos picos?   \n97.     med = mean(yhpeak+ylpeak)   \n98.     yh = Exp(b(t,A(y)-med,la),C(t,A(y)-med,la),thpeak)   \n99.     gl1 = len(thpeak)-2   \n100.     ls1 = LS(A(yhpeak)-med,yh,gl1)   \n101.     gl2 = len(tlpeak)-1   \n102.     ls2 = LS(yhpeak,mean(yhpeak),gl2)   \n103.     rls = ls1/ls2   \n104.     F1 = 1./scipy.stats.f.ppf(0.90,gl1,gl2)   \n105.     F2 = scipy.stats.f.ppf(0.90,gl2,gl1)   \n106.        \n107.     if F1 &lt;rls and rls &lt;F2:    \n108.         if debug: print 'passou no teste de Fisher'   \n109.         return False   \n110.     else:    \n111.         if debug: print 'estavel'   \n112.         return True   \n \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 97 \n \n \n\n1.7 Settings.py \nSettings \u2013 Compila o modelo. \n\n1. def Settings(SimName,N,minh = 0.001,solver='Radau5ODE',directory=''):   \n2.        \n3.     \"\"\"  \n4.     Inputs:  \n5.     SimName - Nome do modelo  \n6.     N - Numero de pontos  \n7.     minh - Valor do passo minimo (somente valido para BDF)  \n8.     solver - Nome do solver a ser utilizado. Opcoes recomendadas: Radau5ODE ou CV\n\node.  \n9.     directory - Nome do diret\u00f3rio do arquivo. Exemplos: FOWM/, Meglio/...  \n10.       \n11.     Outputs:  \n12.     slugging - Modelo compilado  \n13.     opts - Op\u00e7\u00f5es de simula\u00e7\u00e3o  \n14.     \"\"\"   \n15.     # Compila e carrega a simulacao   \n16.     fmu_name = compile_fmu(SimName, directory+SimName+'.mo')   \n17.     slugging = load_fmu(fmu_name, log_level=0)   \n18.    \n19.     opts = slugging.simulate_options()   \n20.     opts['ncp'] = N - 1 #numero de pontos no intervalo   \n21.     opts['solver'] = solver   \n22.     opts[solver+'_options']['verbosity'] = 50 # omite dados de simulacao   \n23.     opts[solver+'_options']['atol'] = 1e-8   \n24.     opts[solver+'_options']['rtol'] = 1e-8   \n25.     opts['result_handling'] = 'memory'   \n26.     if solver == 'CVode':   \n27.         opts['CVode_options']['discr'] = 'BDF' # Backward differentiation formula\n\n - metodo de passo multiplo    \n28.         opts['CVode_options']['minh'] = minh   \n29.    \n30.     return slugging,opts   \n \n\nExemplo de utiliza\u00e7\u00e3o: \n\n1. sim,opts = Settings('Real Well A',700,solver='CVode',minh=1e-4,directory='Real \nWell A/')   \n\n \n\n1.8 ZeroPad.py \nZeroPad \u2013 Preenchimento do ciclo do modelo com a pr\u00f3pria m\u00e9dia. \n\n1. import scipy.interpolate as inter   \n2. from numpy import array as A   \n3.    \n4. def ZeroPad(ym,tm,te):   \n5.        \n6.     ym,tm,te = A(ym),A(tm),A(te)   \n7.     if debug: print(tm,te)   \n8.     Tsm = tm[1]-tm[0]   \n9.     if tm[-1] &lt;te[-1]:   \n10.         Sm = inter.InterpolatedUnivariateSpline(tm,ym)   \n11.         if tm[-1] + Tsm &lt;te[-1]:   \n12.             i2 = next(list(te).index(i) for i in te if i > tm[-1])   \n13.             Ym = list(Sm(te[:i2])) + [mean(ym)]*(len(te)-i2)   \n14.         else:   \n15.             Ym = Sm(te)   \n16.            \n17.     elif te[-1] &lt;tm[-1]:   \n18.         Sm = inter.InterpolatedUnivariateSpline(tm,ym)   \n\n\n\n98 C\u00f3digos implementados em Python \n \n\n \n\n19.         Ym = Sm(te)   \n20.     else:   \n21.         Ym = ym   \n22.            \n23.     return Ym   \n  \n\n1.9 FO.py \nAbaixo segue um exemplo de fun\u00e7\u00e3o objetivo Fobj. Sup\u00f5e-se que:  \n\n? O modelo FOWM est\u00e1 compilado com o exemplo da fun\u00e7\u00e3o Settings (sim \ne opts); \n\n? O n\u00famero de pontos compilado com a fun\u00e7\u00e3o Settings \u00e9 maior do que o \nn\u00famero de pontos dos dados de refer\u00eancia; \n\n? Os dados de refer\u00eancia t\u00eam a mesma amostragem do modelo (somente \nrelevante se o modelo n\u00e3o est\u00e1 apresentando ciclo limite); \n\n? A estima\u00e7\u00e3o \u00e9 para o Cen\u00e1rio 1 dos resultados, onde 8 par\u00e2metros s\u00e3o \nestimados enquanto o volume do riser  \u00e9 fixo; \n\n? Os valores de tempo da refer\u00eancia est\u00e3o em horas; \n\n? Os valores do sinal da refer\u00eancia est\u00e3o em bar. \n\n1. from stability import f, StabilityCheck   \n2. from ZeroPad import ZeroPad   \n3. from Cycle import Cycle   \n4. import numpy as *   \n5.    \n6. def Fobj(P,yraw,te,ye,vare,NP,sim=(),opts=(),IN=()):   \n7.        \n8.     \"\"\"  \n9.     Inputs:  \n10.     P - Lista de parametros  \n11.     yraw - dados de referencia  \n12.     te - tempo do ciclo de referencia  \n13.     ye - sinal do ciclo de referencia  \n14.     vare - variancia do ciclo de referencia  \n15.     NP - numero de pontos a serem simulados.  \n16.     //CUIDADO// ==> !!! NP deve ser igual ao numero de pontos da compilacao do mo\n\ndelo !!!  \n17.     sim,opts - Resultado da compilacao obtida com a funcao Settings  \n18.     IN - informacao adicional a ser adicionada na simulacao  \n19.       \n20.     Output:  \n21.     Valor da funcao objetivo  \n22.     \"\"\"   \n23.        \n24.     # Simulacao   \n25.     sim.reset()   \n26.     sim.set(['mlstill','Cg','Cout','Veb','E','Kw','Ka','Kr'],P)   \n27.     sim.set(['Wgc','Vr'],[1.406,4497*0.152**2*3.14/4])   \n28.     try:   \n29.         Sim = sim.simulate(start_time=0,final_time=(NP-\n\n1)*60.,options=opts,input=IN)   \n30.         t,ymod = Sim['time']/3600.,array(Sim['Ppdg'])/1e5   \n31.     except: return 1e12   \n\n\n\n6.3 Sugest\u00f5es de trabalhos futuros 99 \n \n \n\n32.        \n33.     # Tenta descartar dados da convergencia inicial (3 ciclos)   \n34.     T = 1./f(t,ymod-mean(ymod))   \n35.     ts = t[1] - t[0]   \n36.     n = int(3*T/ts)   \n37.     ym = []   \n38.     try: t,ym = A(t[n:])-t[n],ymod[n:]   \n39.     except: t,ym = t,ymod   \n40.        \n41.     FO = 0.   \n42.    \n43.     # O sistema esta em estado estacionario, estado transiente?   \n44.     try: steadystate = Stable(t,ym)   \n45.     except: steadystate = True   \n46.    \n47.     # Se apresenta ciclo limite, aplica WLS;   \n48.     # Se nao apresenta ciclo limite, aplica LS.   \n49.     if not steadystate:   \n50.         try:   \n51.             ctm,cym,cvarm = Cycle(t,ym)   \n52.             Ym = ZeroPad(cym,ctm,te)   \n53.             FO += sum(( array(Ym) - array(ye) ) ** 2 / array(vare))   \n54.         except:   \n55.             FO += sum( ( array(ymod[:len(yraw)]) - array(yraw) ) ** 2 )   \n56.     else: FO += sum( ( array(ymod[:len(yraw)]) - array(yraw) ) ** 2 )   \n57.                \n58.     return FO"}]}}}