{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.19429"}, {"@name": "filename", "#text": "2779_Cardoso_ClaudioGuidoSilva_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Grades di\u00e1dicas adaptativas para simula\u00e7\u00e3o de \nescoamento de petr\u00f3leo \n\nClaudio Guido S. Cardoso \n\nDisserta\u00e7\u00e3o de Mestrado \n\np \n\n\n\nInstituto de Computa\u00e7\u00e3o \nUniversidade Estadual de Campinas \n\nGrades di\u00e1dicas adaptativas para simula\u00e7\u00e3o de \n\nescoamento de petr\u00f3leo \n\nCardoso \n\nOutubro de 2004 \n\nBanca Examinadora: \n\n\u2022 Prof. Dr. Jorge Stolfi \nIC- UNICAMP (Orientador) \n\n\u2022 Pro f. Dr. Denis J. Schiozer \nCEPETRO - UNICA:VlP \n\no Profa. Dra. :Vlar\u00eda Cristina de Castro Cunha \nIMECC - UNICAMP \n\no Prof. Dr. Cid Carvalho de Souza \nIC- UNICAMP \n\ni i \n\n\n\nUNIDADE \n\n)1 Nll CHAMADA \n\nI ~-\njv_~ \n' ( PRQC, \n\nI PRE\u00c7O \nI DATA ~fL~kL=~~\u00b7\u00b7~~-\n\nN12CPD \n\nCl79g \n\nFICHA CATALOGR\u00c1FICA ELABORADA PELA \nDO IMECC DA UNICAMP \n\nCardoso, Claudio Guido Silva \n\nGrades di\u00e1dicas adaptativas para simula\u00e7\u00e3o de escoamento de \n\npetr\u00f3leo I Claudio Guido Silva Cardoso-- Campinas, (S.P. :s.n.], 2004. \n\nOrientadores :Jorge Stolfi ; Anamaria Gomide \n\nDisserta\u00e7\u00e3o (mestrado) - Universidade Estadual de Campinas, \n\nInstituto de Computa\u00e7\u00e3o. \n\nL Simula\u00e7\u00e3o (Computadores digitais). 2. Equa\u00e7\u00f5es diferenciais. 3. \n\nGalerkin, M\u00e9todos de. 4. Reservat\u00f3rio de petr\u00f3leo. L Stolfi, Jorge. n. \n\nGomide, Anamaria. IH. Universidade Estadual de Campinas. Instituto de \n\nComputa\u00e7\u00e3o. IV. T\u00edtulo. \n\n\n\nGrades di\u00e1dicas adaptativas para simula\u00e7\u00e3o de \n\nde petr\u00f3leo \n\nEste exemplar corresponde \u00e0 reda\u00e7\u00e3o final da \nDisserta\u00e7\u00e3o devidamente corrigida e defendida \npor Claudio Guido S. Cardoso e aprovada pela \nBanca Examinadora. \n\nCampinas. I\\ovembro de 2004. \n\n/j // ///u-RH.t: \n/~~~: Dr. Jorge Stolfi \n\nIC- UNICAMP (Orientador) \n\n\u00d3'vtev...-./\\_ U41__0, ' ..:::;r- ~ \nProfa. Dra. Ana aria Gomide \n\nI ~ ~0- - ~JJ. \n\u00b7~ - UNICAMP (. o-orientadora) \n\n1V \n\n\n\nDisserta\u00e7\u00e3o apresentada ao Instituto de Com-\nputa\u00e7\u00e3o, UNICAMP, como requisito parcial para \na obten\u00e7\u00e3o do t\u00edtulo de \u00e9\\Iestre em Ci\u00eancia da \nComputa\u00e7\u00e3o. \n\n\n\nTERMO DE APROVA\u00c7\u00c3O \n\nTese defendida e aprovada em 01 de dezembro de 2004, pela Banca \n\nProfessores Doutores: \n\n(\\ \n\n' \n\nProf. D~ s'\u00e9tu\u00f3'zer \nCEPET - UNIC MP \n\n1\\ \n\n\\J;;\\, \\ \n\nProfa. Ora. Maria Cristina de Castro Cunha \n!MECC - UNICAMP \n\nPrd. o{.Cid CaRfa1ho i!~a ' \n!C- UNICAMP \n\nPr9f.\" Dr. Jorge Stolfi \n-l\u00ea- UNICAMP \n\n\n\n\u00a9 Claudio Gu\u00eddo S. Cardoso, 2004. \nTodos os direitos reservados. \n\nVll \n\n\n\n\"A vida \u00e9 um cubo. N\u00e3o sei porque, mas \u00e9.\" \n\nComado Gomes \n\nVll1 \n\n\n\nResumo \n\nNesta disserta\u00e7\u00e3o, estudamos as aplica\u00e7\u00f5es de splines constru\u00eddos sobre grades \ndi\u00e1dicas na aproxima\u00e7\u00e3o de fun\u00e7\u00f5es e solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais. Nosso \nfoco principal \u00e9 a simula\u00e7\u00e3o de escoamento de petr\u00f3leo em reservat\u00f3rios naturais. \n\nlma grade di\u00e1dica \u00e9 constru\u00edda atrav\u00e9s de divis\u00f5es sucessivas de uma c\u00e9lula \nraiz retangular, sempre pela metade, alternando a dire\u00e7\u00e3o do corte ciclicamente \npelos eixos de coordenadas. Desta forma, os splines di\u00e1dicos podem ser refina-\ndos adaptativamente de acordo com as fun\u00e7\u00f5es a serem aproximadas, at\u00e9 que \nsatisfa\u00e7am o grau de precis\u00e3o exigido. As grades di\u00e1dicas tamb\u00e9m possuem uma \nestrutura muito simples e podem ser representadas e manipuladas computacio-\nnalmente com grande efici\u00eancia e facilidade. \n\nTrabalhamos em particular com uma fam\u00edlia de splines di\u00e1dicos multilineares \ne cont\u00ednuos para uma grade arbitr\u00e1ria G, que denominamos por E 1[GJ. Desen-\nvolvemos algoritmos que geram duas bases padr\u00f5es de elementos finitos (tendas \ndi\u00e1dicas) Bmax e Bmin para estes espa\u00e7os. Para testarmos as potencialidades dos \nespa\u00e7os [ 1 [G], realizamos experimentos num\u00e9ricos utilizando a t\u00e9cnica de apro-\nxima\u00e7\u00e3o por m\u00ednimos quadrados, e resolvemos alguns casos de equa\u00e7\u00f5es diferen-\nciais parciais lineares. Nestes experimentos, estudamos o uso de malhas di\u00e1dicas \nde resolu\u00e7\u00e3o vari\u00e1vel no espa\u00e7o e no tempo. Conclu\u00edmos que grades adaptativas \npodem produzir os mesmos resultados que uma grade uniforme fina, a uma fra\u00e7\u00e3o \ndo custo. \n\nA \u00faltima parte deste trabalho descreve em detalhes a constru\u00e7\u00e3o e teste de \num simulador para escoamento bif\u00e1sico \u00f3leo/\u00e1gua (Sim\u00f3leo), baseado em gra-\ndes di\u00e1dicas adaptativas. Revisamos, em linhas gerais, as equa\u00e7\u00f5es que regem \neste processo, e sua discretiza\u00e7\u00e3o pelo m\u00e9todo de elementos finitos (Galerkin). \nDesta forma, obtemos um sistema de equa\u00e7\u00f5es diferenciais n\u00e3o linear, dependente \ndo espa\u00e7o e do tempo, que resolvemos de maneira iterativa. O desempenho do \nSim\u00f3leo foi avaliado utilizando um modelo popular de reservat\u00f3rio (5 po\u00e7os). \n\nlX \n\n\n\nAbstract \n\nIn this dissertation we study the application of splines built over dyadic grids for \nfunction approxirnation and integration of differential equations. Our rnain focus \nis the sirnulation of oi! fiow in natural reservoirs. \n\nA dyadic grid is built by recursively splitting a rectangular root cell into equal \nnHlves. alternating the orientat\u00edon of the cut cyclically over the coordinate axis. \nTherefore, dyadic splines may be refined adaptatively to fit the funct\u00edons they are \napproximating, unti! a certain precision leve! is reached. Dyadic grids also have a \nsimple structure which rnay be easily and efficiently represented and manipulated \nby computers. \n\nvVe worked in particular with a family of multilinear and continuous dyadic \nsplines for a certain grid G, denoted by E1 [G]. Algorithms were developed to \nbuild two standard basis of finite elements ( dyadic tents ), Bmax and Bmin, for \nsuch function spaces. In order to test the potentialities of the spaces [ 1 [G], we \nperformed some numerical experirnents of least squares approximations and inte-\ngration of linear partia! differential equations. In these experiments, we studied \nthe use of adaptive dyadic grids, whose resolution varies in time and space. \\Ve \nconclude that adaptive grids can produce the same results as a fine uniforrn grid, \nat a fraction of the cost. \n\nThe last part of this work describes in detail the developrnent and tests of an \noil/water ilow simulator (Sim\u00f3leo ), based on adaptive dyadic grids. We review \nthe oi! ilow equations, and their discretization by the finite elernent (Galerkin) \nrnethod. Thus, we obtain a non linear differential equation system, depending \non space and time, which we solve iterat\u00edvely. The prograrn's performance is \nmeasured with experirnents using a popular reservoir model (5-spot). \n\nX \n\n\n\nAgradecimentos \n\nPara n\u00e3o fugir \u00e0 regra, agrade\u00e7o logo ao Divino por ter enfim chegado nesta parte \nda tese, e pela profunda paz de esp\u00edrito que ele tem sempre dado a mim e aos \nmeus. Obrigado tamb\u00e9m aos meus fant\u00e1sticos pa\u00eds Oscar\u00edto e \"Wilma, que me \nap\u00f3iam at\u00e9 mesmo quando resolvo deix\u00e1-los pra passar um tempo longe da velha \nBahia. Um grande beijo pra minha querida irm\u00e3 Carm\u00e9lia (Mel), que perdeu um \ncarnaval inteiro tomando chuva aqui comigo, em um dos per\u00edodos mais divertidos \nda minha estada em Campinas! Para comparar com estes dias, somente a visita \ndo v\u00f3 Cleber (Varvito) que fez com que me sentisse um pouco em casa uo primeiro \nanivers\u00e1rio longe (e ainda trouxe um bolo da v\u00f3). Um enorme abra\u00e7o pra voc\u00eas, \nvov\u00f4s Oscar e ClebeL vov\u00f3s Lacy e Carm\u00e9lia. Este livro \u00e9 apenas um dos muitos \nfrutos do que voc\u00eas semearam. \n\nA minha princesa Priscila (a ch\u00fa 1), meus agradecimentos de cora\u00e7\u00e3o pelo \nenorme carinho, paci\u00eancia e companheirismo expressos no pouco tempo que pas-\nsamos juntos, e ao longo de muitos e muitos dias do outro lado da linha. \n\nDesejo tudo de bom para a dupla din\u00e2mica de orientadores Stolfi e Ana, \nex\u00edmios computeiros, matem\u00e1ticos, f\u00edsicos e comedores de pizza! Sempre foi uma \nenorme satisfa\u00e7\u00e3o trabalhar com voc\u00eas. \n\nUm forte abra\u00e7o aos irm\u00e3os pistolinhas: Zeh (pistolinha aposentado, churras-\nqueiro profissional e tamb\u00e9m o consumidor mais chat... digo, mais exigente do \nmundo), Triste Toy Boy (cuja gargalhada sutil tem at\u00e9 eco), Guto (miserav\u00e3o \ne quem devo meu pr\u00f3prio t\u00edtulo pistol\u00edstico), Daniel Linux (hora Ba\u00ea\u00ea\u00eaaaaa!), \nBart (pistolinha adjunto, o terr\u00edvel), Glauber (p\u00edstol\u00ednha honor\u00e1rio, o bonec\u00e3o \nde Olinda); e a todos os seus agradabil\u00edssimos agregados: Carmen, Yeda, Celso, \nlVlara, Marc\u00e3o e o pessoal da f\u00edsica, meu rec\u00e9m-chegado sobrinho Gutinho, sua \nmam\u00e3e Tina, M\u00e9rcia, Messias, Daniela e a todo O\u2022resto do povo' \n\nAos grandes amigos de caminhadas pelos corredores do IC: :Vlarc\u00e3o (Vin\u00edcius), \nMagr\u00e2o, Bila, Bazinho, Par\u00e1, Silvana, Borin, .J\u00fa (do Borin), J\u00fa (do Tio Sam), \nM\u00e1rcio, Felipe (Ozzy), Silvania, Cesar (fala miseravation!), Jean, Amanda, Greg \n\nxi \n\n\n\nSkywalker, Larissa, L\u00e1zaro, Chenca (e a todos os mardito), Daniel Andrade (e \naL novidades? 1), Nielsen, Wesley, Daniela, Tha\u00edsa, Sandro, Lu\u00eds, Nilton, Cle-\nber, Evandro, Norton, Fernando (monstro), Fernando (do Par\u00e1), Luciana, F\u00e1bio, \nSchubert, Sheila, Mar\u00edlia, Luciano, os infal\u00edveis \u00fagias Nelson, \njuntamente com os professores, pessoal da administra\u00e7\u00e3o, e a todo mundo que fi-\ncou faltando na lista (agora \u00e9 melhor correr atr\u00e1s da pr\u00f3xima tese, meu chapa'), \num ax\u00e9 caloroso, e nos vemos por a\u00ed! \n\nMeus agradecimentos ao pessoal da engenharia de petr\u00f3leo (Valmir, Eliana. \nprof. Denis), \u00e0 profa. Cristina e a todos que ajudaram a fazer a \u00e1gua deste \nsimulador andar' \n\nE obrigado tamb\u00e9m \u00e0 CAPES, CNPq e \u00e0 UNI C AMP pelo auxilio financeiro' \n(ufa' Essa foi por pouco') \n\nDD \n' f: ?A~Uf \n\n' Q\\l\" AC A So..J ... \n\nxii \n\n\n\nSum\u00e1rio \n\nResumo \n\nAbstract \n\nAgradecimentos \n\n1 Introdu\u00e7\u00e3o \nLl \n\nL2 \nSplines di\u00e1dicos adaptativos \nSimula\u00e7\u00e3o do escoamento de petr\u00f3leo \n1.2.1 Diferen\u00e7as finitas _____ _ \n\n1.2.2 M\u00e9todos de resolu\u00e7\u00e3o vari\u00e1vel \n1.2.3 Vantagens dos splines di\u00e1dicos _ \n\n1.3 Estrutura do trabalho \n1.4 Revis\u00e3o bibliogr\u00e1fica _ _ _ _ _ _ ___ _ \n\n1.4.1 Splines di\u00e1dicos _ _ _ _ _ ___ _ \n\n1.4.2 Simula\u00e7\u00e3o de escoamento multif\u00e1sico \n\n2 Grades Adaptativas \n2.1 Grades di\u00e1dicas _ \n2.2 Orienta\u00e7\u00e3o, indexa\u00e7\u00e3o e profundidade _ \n2.3 Posicionamento e tamanho das c\u00e9lulas \n2.4 Geometria can\u00f4nica _ \n\n3 Spl\u00ednes di\u00e1dicos \n3.1 Splines ___ _ \n3.2 Elementos finitos _ _ _ _ _ _ _ _ _____ _ \n\n3.3 splines multilineares sobre grades di\u00e1dicas \n\nXlll \n\nviii \n\nix \n\nX \n\nxi \n\n1 \n\n1 \n2 \n\n3 \n3 \n4 \n4 \n\no \n5 \n5 \n\n9 \n9 \n\n11 \n\n12 \n14 \n\n15 \n15 \n16 \n16 \n\n\n\n3.4 As fun\u00e7\u00f5es tenda . . . .... \n\n3.5 As bases Bmax e Bmin \n3.5.1 Independ\u00eancia linear das bases Bmax e Bmin \n3.5.2 Interpola\u00e7\u00e3o usando tendas \n3.5.3 Cobertura das bases Bmax e \n\n3.6 Determina\u00e7\u00e3o de bases Bmax e Bmin \n3.6.1 Lugares e o conjunto estrela \n3.6.2 \n3.6.3 \n\n3.6.4 \n\nO algoritmo Gera_Bmax . . \nO algoritmo Gera_Bmin . \nA complexidade de Gera_Bmax e Gera..Bmin . \n\n4 Aproxima\u00e7\u00e3o por m\u00ednimos quadrados \n4.1 Aproxima\u00e7\u00e3o por m\u00ednimos quadrados \n4.2 O produto escalar de fun\u00e7\u00f5es tenda \n4.3 \n\n4.4 \n\n4.6 \n\nProduto escalar de fun\u00e7\u00f5es gerais \n4.3.1 Quadratura de Gauss . \n4.3.2 Integra\u00e7\u00e3o em k vari\u00e1veis \n4.3.3 Produtos escalares \nExemplos usando grades regulares \nAproxima\u00e7\u00f5es com refinamento da grade \n4.5.1 Exemplos usando grades refinadas . \n\n5 Solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais parciais lineares \n5.1 O m\u00e9todo dos res\u00edduos ponderados \n5.2 O m\u00e9todo de Galerkin ......... . \n5.3 Equa\u00e7\u00f5es lineares ............ . \n\n5.3.1 Reduzindo a ordem das derivadas \n5.3.2 A equa\u00e7\u00e3o de Helmholtz . . ... \n5.3.3 Produto escalar de gradientes de fun\u00e7\u00f5es tenda \n\n5.4 Exemplo . . . . . . . . . . . . . . . . . . . . . . .... \n\n17 \n18 \n19 \n\n19 \n\n20 \n23 \n23 \n24 \n27 \n\n28 \n\n31 \n31 \n\n32 \n35 \n\n35 \n\n36 \n37 \n\n37 \n\n42 \n\n43 \n\n47 \n47 \n48 \n48 \n\n49 \n\n50 \n51 \n53 \n\n6 Solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais lineares e dependentes do tempo 57 \n6.1 A difus\u00e3o do calor. . . 58 \n6.2 Exemplo de simula\u00e7\u00e3o . . 59 \n\n7 As equa\u00e7\u00f5es de escoamento \n7.1 :V!odelagem matem\u00e1tica \n\n7.1.1 A lei de Darcy . \n\nxiv \n\n67 \n67 \n\n69 \n\n\n\n7.2 Escoamento bif\u00e1sico \u00f3leo/ \u00e1gua . 70 \n7.2.1 Satura\u00e7\u00f5es relativas . 70 \n7.2.2 Press\u00f5es capilares 70 \n7.2.3 A equa\u00e7\u00e3o geral 71 \n\n8 Discretiza\u00e7\u00e3o das equa\u00e7\u00f5es 73 \n8.1 Discretiza\u00e7\u00e3o das equa\u00e7\u00f5es de escoamento 73 \n\n8.1.1 Discretiza\u00e7\u00e3o das vari\u00e1veis 73 \n8.1.2 Crit\u00e9rio de Galerkin 74 \n8.1.3 Termo do fluxo 74 \n\n8.2 Forma matricial das equa\u00e7\u00f5es 75 \n8.3 Integra\u00e7\u00e3o no tempo 76 \n\n8.3.1 Dados da simula\u00e7\u00e3o . 77 \n8.3.2 C\u00e1lculo das press\u00f5es e fluxos 77 \n8.3.3 C\u00e1lculo das taxas de inje\u00e7\u00e3o 77 \n\n8.4 Adapta\u00e7\u00e3o din\u00e2mica da grade 78 \n8.4.1 A grade inicial Gini 79 \n8.4.2 Escolha de uma nova grade 79 \n8.4.3 Mudan\u00e7a de base 79 \n8.4.4 Estrat\u00e9gia adaptativa . 79 \n\n8.5 C\u00e1lculo das matrizes e vetores do sistema . 80 \n8.5.1 Decomposi\u00e7\u00e3o em c\u00e9lulas . 80 \n8.5.2 Determina\u00e7\u00e3o dos termos constantes 81 \n\n9 O simulador Sim\u00f3leo 83 \n9.1 O Sim\u00f3leo 83 \n\n9.1.1 Funcionalidades 83 \n9.1.2 Estrutura 84 \n\n9.2 Testes de simula\u00e7\u00e3o . 86 \n9.2.1 Dados de simula\u00e7\u00e3o . 85 \n9.2.2 Resultados . 87 \n9.2.3 Evolu\u00e7\u00e3o da press\u00e3o m\u00e9dia . 96 \n9.2.4 Produ\u00e7\u00e3o de \u00f3leo e \u00e1gua 96 \n9.2.5 Tempo de simula\u00e7\u00e3o 97 \n9.2.6 An\u00e1lise dos resultados 97 \n\nXV \n\n\n\n10 Conclus\u00f5es e trabalhos futuros \n10.1 Conclus\u00f5es . \n\n10.1.1 Simplicidade de grades e bases di\u00e1dicas \n10.1.2 Aproxima\u00e7\u00e3o com splines di\u00e1d\u00edcos. \n10.1.3 Grades adaptativas \n\n10.2 Propostas futuras \n10.2.1 Splines de graus mais elevados . \n10.2.2 Escolha da base \n10.2.3 Passo de tempo adaptativo .. \n10.2.4 Novas estrat\u00e9gias para integra\u00e7\u00e3o no tempo \n10.2.5 Sugest\u00f5es para o Sim\u00f3leo . \n\nBibliografia \n\nxvi \n\n99 \n99 \n99 \n99 \n\n100 \n100 \n100 \n\n100 \n100 \n101 \n101 \n\n102 \n\n\n\na de Tabelas \n\n4.1 Valores de t1 e CJ, para n = 10 .. 36 \n4. 2 Fun\u00e7\u00f5es para testes do m\u00e9todo de m\u00ednimos quadrados. 37 \n4.3 Dist\u00e2ncias I lu- u' li caculadas para cada base de aproxima\u00e7\u00e3o. O \n\npar\u00e2metro \u00c0 \u00e9 o di\u00e2metro das c\u00e9lulas da grade. 38 \n4.4 Dimens\u00f5es das bases e dist\u00e2ncias !lu- u'll das aproxima\u00e7\u00f5es. . 45 \n\n5.1 Dimens\u00f5es das bases e dist\u00e2ncias llu- u\u202211 das solu\u00e7\u00f5es aproxima-\ndas de uma equa\u00e7\u00e3o de Helmholtz. 55 \n\n6.1 Dimens\u00f5es das bases e dist\u00e2ncias !I TI- r\u00b7Ijl entre os resultados \nfinais de quatro simula\u00e7\u00f5es de um processo de difus\u00e3o. 65 \n\n9.1 Tempo total em minutos das simula\u00e7\u00f5es com as grades regulares e \ncom a grade adaptativa. . . . . . . . . . . . . . . . . . 97 \n\nxvii \n\n\n\nLista Figuras \n\nL 1 Exemplos de splines em uma e duas dimens\u00f5es. 1 \n1.2 Exemplo de grade di\u00e1dica bidimensionaL 2 \n1.3 Processo de explota\u00e7\u00e3o de petr\u00f3leo. 3 \n\n2.1 Cria\u00e7\u00e3o de uma grade di\u00e1dica bidimensionaL 10 \n2.2 Cria\u00e7\u00e3o de uma grade di\u00e1dica tridimensionaL 10 \n2.3 Uma c\u00e9lula m\u00e3e, com duas c\u00e9lulas filhas e quatro c\u00e9lulas netas. . 10 \n2.4 Arvore bin\u00e1ria correspondente a uma grade. . 11 \n2.5 A origem coincide com um dos v\u00e9rtices da c\u00e9lula raiz. 11 \n2.6 Distribui\u00e7\u00e3o dos \u00edndices em uma grade 2d. 12 \n2. 7 N\u00edvel 5 de uma grade di\u00e1dica. . . . . . . 12 \n2.8 C\u00e9lula C com vetores Q(C) = (4,4,2) e o(C) (2,3,0). 14 \n\n3.1 Suporte de um spline de aproxima\u00e7\u00e3o. . ... 16 \n3.2 Fun\u00e7\u00e3o tenda com uma e duas dimens\u00f5es. . . . . . 17 \n3. 3 A base m\u00ednima! do espa\u00e7o [ 1 de uma grade bidimensional irregular \n\nG. ............. ... . 18 \n3.4 A base maximal do espa\u00e7o [ 1 de uma grade bidimensional irregular \n\nG. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 \n3.5 Um v\u00e9rtice completo A, esquina das c\u00e9lulas C1, C4, C6 e C7; um \n\nv\u00e9rtice incompleto B, esquina das c\u00e9lulas C2, C5 e intermedi\u00e1rio \u00e0 \nc\u00e9lula C3; e um v\u00e9rtice de fronteira C. . . . . . . . . . . . . . . . 21 \n\n3.6 Cada v\u00e9rtice incompleto (B, D, E, F, H, 1 e J) \u00e9 intermedi\u00e1rio a \numa c\u00e9lula de profundidade menor do que todas as c\u00e9lulas das quais \ns\u00e3o esquinas. . . . . . . . . \n\n3.7 Lugares incompletos cujas faces s\u00e3o respectivamente um segmento \nde reta e um ponto, na primeira e terceira grade a partir da posi\u00e7\u00e3o \nmais \u00e0 esquerda. Na segunda e quarta grade, as c\u00e9lulas em destaque \n\n22 \n\ns\u00e3o divididas para que estes lugares tornem-se completos. . . . . . 24 \n\nXVlll \n\n\n\n3.8 Nas duas grades tridimensionais, uma mesma face F plana determi-\nnada por c\u00e9lulas de profundidade 3 ou 4. Na grade bidimensionaL \numa face F (ponto) determinada por c\u00e9lulas de profundidade 2 ou 3. 24 \n\n3.9 Um lugar aresta em uma grade bidimensional e em uma grade \ntridimensional. \n\n3.10 Na grade \u00e0 esquerda, o eixo de divis\u00e3o \ndestaque. \n\n\u00e9 ortogonal \u00e0 face em \n\n3.11 Gera_Bmax executado sobre duas faces determinadas por c\u00e9lulas \ncujos eixos de divis\u00e3o s\u00e3o paralelos a estas faces. \n\n24 \n\n26 \n\n27 \n\n4.1 Tendas T 1, T\", e a regi\u00e3o R comum aos suportes destas fun\u00e7\u00f5es. 33 \n4.2 A c\u00e9lula C' de T 1 est\u00e1 contida na c\u00e9lula C\" de T\". . . . 33 \n4.3 A fun\u00e7\u00e3o sxsy e suas aproxima\u00e7\u00f5es por m\u00ednimos quadrados nas \n\nbases Bmin de n\u00edveis 6, 8, e 10, tra\u00e7adas com 61 =O, 08 e \u00d4z = 1, 2_ \nOs res\u00edduos li - li' foram tra\u00e7ados com a1 = O, 008 e 62 = O, 12. . 39 \n\n4.4 Fun\u00e7\u00e3o galiss e aproxima\u00e7\u00f5es nas bases Bmin de n\u00edveis 6, 8, e 10, \ncom 61 = O, 08 e o2 = 1, 2. Para os res\u00edduos li - u\u2022, foram usados \n61 =O, 008 e 62 =O, 12. . . . . . . . . . . . 40 \n\n4.5 Fun\u00e7\u00e3o tendaR e aproxima\u00e7\u00f5es nas bases Bmin de n\u00edveis 6, 8, e 10 \ncom 61 =O, 08 e 62 = L 2. Os res\u00edduos u- u' possuem 51 =O, 008 \ne 62 = O, 12. . . . . . . . . . . . . . . . . . . . . . . 41 \n\n4.6 Fun\u00e7\u00e3o gauss e aproxima\u00e7\u00f5es nas bases Bmin regulares de n\u00edveis 8, \nlO e em uma base Bmin irregular de n\u00edvel m\u00e1ximo 10, com 0 1 =O, 08 \ne i52 = 1, 2. Os res\u00edduos li- li' possuem 61 O, 008 e 62 =O, 12. 44 \n\n5.1 Fun\u00e7\u00f5es A (esquerda) e r (direita). . . . . . . . . . . . . . . . . 52 \n5.2 Solu\u00e7\u00e3o exata da equa\u00e7\u00e3o (5.23) de Helmholtz, com 61 = O, l e \n\n\u00d4z = l, 1. . . . . . . . . . . . . . - . . . . . . . . . . . . . 53 \n5.3 Solu\u00e7\u00e3o da equa\u00e7\u00e3o de Helmholtz usando bases minimais definidas \n\nsobre grades regulares de n\u00edveis 6, 8, 10 e uma grade irregular de \nprofundidade m\u00e1xima lO, com 61 = O, l e 62 = 1. l. Os res\u00edduos \nli- li\u2022 possuem o1 =O, 006 e o2 =O, 07 ..... \n\n6.1 Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de profundi-\ndade 6. A \u00faltima linha mostra o resultado final da integra\u00e7\u00e3o (r\" f), \na aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata correspon-\ndente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens t\u00eam \n\n54 \n\npar\u00e2metro 62 = 188, O. . . . . . . . . . . . . . . . . 61 \n\nXlX \n\n\n\n6.2 Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de profundi-\ndade 8. A \u00faltima linha mostra o resultado final da integra\u00e7\u00e3o (I' f), \na aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata correspon-\ndente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens t\u00eam \npar\u00e2metro o2 = 188, O. 62 \n\n6.3 Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de profun-\ndidade 10. A \u00faltima mostra o resultado final da integra\u00e7\u00e3o \n(T'f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata cor-\nrespondente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens \nt\u00eam par\u00e2metro o2 = 188, O. . . . . . . . . . . . . . . . . . . . . . 63 \n\n6.4 Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base irregular de profun-\ndidade m\u00e1xima 10. A \u00faltima linha mostra o resultado final da in-\ntegra\u00e7\u00e3o (Y'f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o \nexata correspondente (T f), e a diferen\u00e7a entre estas duas. Todas \nas imagens t\u00eam par\u00e2metro 152 188, O. 64 \n\n7.1 Elemento infinitesimal dx x dy x dz . 67 \n\n9.1 J\\l\u00f3dulos do programa Sim\u00f3leo. 84 \n9.2 Disposi\u00e7\u00e3o dos cinco po\u00e7os no teste com o Sim\u00f3leo. 86 \n9.3 Satura\u00e7\u00e3o da \u00e1gua Sa em 5 estagws de simula\u00e7\u00e3o utilizando as \n\ngrades regulares de n\u00edveis 6, 8 e 10. Todos os gr\u00e1ficos possuem \no, =O, 08 e 62 = 1, O. . ............ - . . . . . . . . 88 \n\n9.4 Perfis da satura\u00e7\u00e3o da \u00e1gua Sa sobre tr\u00eas grades regulares. Todos \nos gr\u00e1ficos possuem valor m\u00ednimo -1 e m\u00e1ximo 1 na escala verticaL \nA escala horizontal vai do po\u00e7o injetor central at\u00e9 um po\u00e7o de \nextra\u00e7\u00e3o (1,2 km). . . . . . . . . . . . . . . . . . . . . . . . . . 89 \n\n9.5 Press\u00e3o p em 5 est\u00e1gios de simula\u00e7\u00e3o utilizando as grades regulares \nde n\u00edveis 6, 8 e 10, com 01 = 20000 e 52 = 400000. A press\u00e3o \u00e9 \npositiva (acima de p) em volta do po\u00e7o de inje\u00e7\u00e3o, e negativa nos \npo\u00e7os de extra\u00e7\u00e3o. . . . . . . . . . . . . . . . .. _ . . . . . . . . 90 \n\n9.6 Perfis da press\u00e3o p sobre tr\u00eas grades regulares. A escala vertical \nvaria de -400000 Pa a 400000 Pa. A escala horizontal vai do po\u00e7o \ninjetor central at\u00e9 um po\u00e7o de extra\u00e7\u00e3o (1,2 km). . . . . . . . . 91 \n\n9. 7 Satura\u00e7\u00e3o da \u00e1gua Sa sobre grades regulares de n\u00edveis 8, 10 e uma \ngrade adaptativa din\u00e2mica de n\u00edvel m\u00e1.,ximo 10. Todos os gr\u00e1ficos \npossuem 51 =O, 08 e 62 = 1, O. . . . . . . . . . . . . . . . . . . 92 \n\nXX \n\n\n\n9.8 Perfis da satura\u00e7\u00e3o da \u00e1gua Sa sobre duas grades regulares e uma \ngrade refinada adaptativamente, com valor m\u00ednimo -1 e m\u00e1.-ximo 1 \nna escala vertical. A escala horizontal vai do po\u00e7o injetor central \nat\u00e9 um po\u00e7o de extra\u00e7\u00e3o (1,2 km). . . . . . . 93 \n\n9.9 Press\u00e3o p utilizando grades regulares de n\u00edveis 8, 10, e uma grade \ncom refinamento local din\u00e2mico. Gr\u00e1ficos tra\u00e7ados com 61 = 20000 \ne o2 = 400000. 94 \n\n9.10 Perfis da press\u00e3o p sobre duas grades regulares e uma grade com \nrefinamento locai gerada dinamicamente. A escala vertical tem \nvalor m\u00ednimo de -400000 P a e m\u00e1ximo de 400000 P a. A escala \nhorizontal vai do po\u00e7o injetor central at\u00e9 um po\u00e7o de extra\u00e7\u00e3o (1,2 \nkm). . . . . . . . . . . . . . . . . . 95 \n\n9.11 Press\u00e3o m\u00e9dia do reservat\u00f3rio (em kPa) por tempo (em dias), nas \nsimula\u00e7\u00f5es com grades regulares de n\u00edveis 6, 8, 10 e com a grade \nadaptativa de profundidade m\u00e1xima 10. . 96 \n\n9.12 Taxas de produ\u00e7\u00e3o de \u00f3leo (esquerda) e \u00e1gua (direita) em m 3 /dia, \nnas simula\u00e7\u00f5es com grades regulares e com a grade refinada dina-\nmicamente. 96 \n\nXX! \n\n\n\nCap\u00edtulo 1 \n\nIntrodu\u00e7\u00e3o \n\nPropomos neste trabalho o uso de bases de .splines definidas sobre grades di\u00e1dicas \nadaptativas para a aproxima\u00e7\u00e3o de fun\u00e7\u00f5es e solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais, \ntendo como foco principal a simula\u00e7\u00e3o de escoamento de petr\u00f3leo em reservat\u00f3rios \nnaturais. \n\n1.1 Splines di\u00e1dicos adaptativos \n\n\u00c9 comum usarmos espa\u00e7os de aproxima\u00e7\u00e3o para lidarmos com problemas envol-\nvendo fun\u00e7\u00f5es muito irregulares e equa\u00e7\u00f5es diferenciais, porque desta forma con-\nseguimos simplific\u00e1-los e manipul\u00e1-los por meio de computadores. Estes espa\u00e7os \npodem conter por exemplo s\u00e9ries trigonom\u00e9tricas ou polin\u00f4mios. Aqui utilizamos \nfun\u00e7\u00f5es de aproxima\u00e7\u00e3o muito populares: os splines [BBB87, BQDY89, Mor85], \ncujos dom\u00ednios s\u00e3o divididos em regi\u00f5es distintas, onde possuem comportamento \nessencialmente polinomiaL Na figura 1.1 mostramos um spline unidimensional, \nlinear em cada segmento do eixo x (esquerda), e um spline bidimensional em \ncurvas de n\u00edvel (direita). \n\nFigura 1.1: Exemplos de splines em uma e duas dimens\u00f5es. \n\n1 \n\n\n\n1.2. Simula\u00e7\u00e3o do escoamento de petr\u00f3leo 2 \n\nTrabalhamos especificamente com splines di\u00e1dicos, ou splines definidos sobre \ngrades di\u00e1dicas. Uma grade di\u00e1dica \u00e9 constru\u00edda basicamente atrav\u00e9s de divis\u00f5es \nsucessivas de uma c\u00e9lula raiz retangular, sempre pela metade. A figura 1.2 abaixo \nmostra a grade di\u00e1dica sobre a qual o spline bidimensional da figura 1.1 est\u00e1 \ndefinido. \n\nFigura 1.2: Exemplo de grade di\u00e1dica bidimensional. \n\nA vantagem do uso de grades di\u00e1dicas \u00e9 que elas possuem uma estrutura \nmuito simples, e podem ser representadas e manipuladas computacionalmente \ncom grande economia e facilidade. Ao mesmo tempo, podemos refinar um spline \ndi\u00e1dico at\u00e9 que ele esteja suficienteiliente pr\u00f3ximo de uma fun\u00e7\u00e3o qualquer. \n\n1.2 Simula\u00e7\u00e3o do escoamento de petr\u00f3leo \n\nNossa principal motiva\u00e7\u00e3o \u00e9 investigar a aplica\u00e7\u00e3o de splines di\u00e1dicos na simula\u00e7\u00e3o \ndo escoamento de petr\u00f3leo em reservat\u00f3rios naturais [AS79, Cri77, Str88]. Esta \nsimula\u00e7\u00e3o \u00e9 complexa devido \u00e0 presen\u00e7a de outros fluidos (\u00e1gua e/ou g\u00e1s) que \nse movem com velocidades diferentes da do \u00f3leo. Al\u00e9m disso, m\u00e9todos modernos \nde extra\u00e7\u00e3o de petr\u00f3leo utilizam o bombeamento de \u00e1gua ou outras subst\u00e2ncias \nem determinados po\u00e7os de inje\u00e7\u00e3o, criando diferen\u00e7as de press\u00e3o que empurram \no \u00f3leo presente nos meios porosos subterr\u00e2neos na dire\u00e7\u00e3o dos po\u00e7os de extra\u00e7\u00e3o \n(figura 1.3). \n\n\n\n1.2. Simula\u00e7\u00e3o do escoamento de petr\u00f3leo 3 \n\nFigura 1.3: Processo de explota\u00e7\u00e3o de petr\u00f3leo. \n\n1.2.1 Diferen\u00e7as finitas \n\nO movimento dos fluidos num reservat\u00f3rio \u00e9 descrito por equa\u00e7\u00f5es diferenciais \nparciais n\u00e3o lineares. Os primeiros simuladores utilizaram o m\u00e9todo de diferen\u00e7as \nfinitas, em que o estado do reservat\u00f3rio \u00e9 amostrado numa grade regular. \nm\u00e9todo continua sendo o mais usado nos simuladores comerciais. \n\n1.2.2 M\u00e9todos de resolu\u00e7\u00e3o vari\u00e1vel \n\nPor\u00e9m, o escoamento geralmente inclui v\u00e1rias regi\u00f5es criticas, onde as grande-\nzas relevantes variam rapidamente no espa\u00e7o. Essas regi\u00f5es podem ser est\u00e1ticas, \ncomo nas proximidades dos po\u00e7os, falhas geol\u00f3gicas, aqu\u00edferos, etc; ou din\u00e2micas \n(vari\u00e1veis no tempo), como as interfaces razoavelmente abruptas entre as subst\u00e2ncias \nm\u00f3veis (\u00f3leo I \u00e1gua, \u00f3leo I g\u00e1s, etc). A diferen\u00e7a de escala necess\u00e1ria para a si-\nmula\u00e7\u00e3o nestes pontos e no restante do dom\u00ednio \u00e9 muito grande e pode variar de \ndezenas de quil\u00f5metros a poucos metros. \n\nDevido \u00e0 extens\u00e3o dos campos t\u00edpicos, \u00e9 invi\u00e1vel representar todo o reservat\u00f3rio \nna escala mais detalhada, ainda mais quando consideramos que \u00e9 necess\u00e1rio exe-\ncutar centenas de simula\u00e7\u00f5es, abrangendo d\u00e9cadas de funcionamento. \n\nPor esta raz\u00e3o, boa parte da pesquisa na \u00e1rea objetiva reduzir o custo computa-\ncional das simula\u00e7\u00f5es sem prejudicar significativamente a precis\u00e3o dos resultados. \nAs id\u00e9ias propostas para este fim incluem o uso de sistemas h\u00edbridos de coorde-\nnadas [NLP+9\u00fc], abordagens multiescalas [Gue98], simula\u00e7\u00e3o por linhas de fluxo \n[dCS98], entre outras. Neste sentido, uma das t\u00e9cnicas mais comuns \u00e9 o refina-\nmento local, na qual apenas as regi\u00f5es cr\u00edticas do reservat\u00f3rio s\u00e3o representadas \ncom maior riqueza de detalhes [ATL91, GE97, HGH83, NLP+go, Ris02, Was87]. \nMuitas dessas abordagens sofrem de dois problemas: a natureza e representa\u00e7\u00e3o \nda grade, que dificultam sua modifica\u00e7\u00e3o din\u00e2mica; e a restri\u00e7\u00e3o a poucos n\u00edveis \n\n\n\n1.3. Estrutura do trabalho 4 \n\nde refinamento, com escalas muito diferentes entre si, que implica em desperd\u00edcio \nde trabalho. \n\n1.2.3 Vantagens dos splines di\u00e1dicos \n\nOs splines di\u00e1dicos proporcionam refinamento local din\u00e2mico e gradual: o espa\u00e7o \nde fun\u00e7\u00f5es aproximadoras pode ser adaptado ao longo do processo de escoamento. \nNos locais onde apresentam pouca varia\u00e7\u00e3o, aproximamos as propriedades pe-\ntrof\u00edsicas com segmentos mais grosseiros da grade di\u00e1dica, acelerando os c\u00e1lculos \ne economizando recursos do simulador. \n\n1.3 Estrutura do trabalho \n\nNo cap\u00edtulo 2 descrevemos em detalhes as grades di\u00e1dicas, mostrando a corres-\npond\u00eancia entre elas e as \u00e1rvores bin\u00e1rias. No cap\u00edtulo 3 definimos os splines \ndi\u00e1dicos, associados a uma determinada grade di\u00e1dica, e em particular os splines \nmultilineares de continuidade zero, que utilizaremos nesta disserta\u00e7\u00e3o. Exibimos \nduas bases padr\u00f5es de elementos finitos para este espa\u00e7o, as bases Bmax (maximal) \ne Bmin {m\u00ednima!), que nos permitem representar sucintamente os splines multili-\nneares cont\u00ednuos, pois as restri\u00e7\u00f5es de grau e continuidade est\u00e3o automaticamente \nasseguradas. A base minimal, quando extra\u00edda a partir de grades regulares, \u00e9 \nsimilar a esquemas de diferen\u00e7as finitas com interpola\u00e7\u00e3o linear [Cri77]. A base \nmaximal, por outro lado, apresenta um car\u00e1ter multiescala. Encerramos o cap\u00edtulo \ndescrevendo dois algoritmos eficientes que encontram respectivamente Bmax e Bmin \ncom tempo de execu\u00e7\u00e3o m<Lximo da ordem do n\u00famero de c\u00e9lulas folha das grades \ndi\u00e1dicas a partir das quais foram extra\u00eddas. \n\nNos cap\u00edtulos seguintes, descrevemos uma s\u00e9rie de aplica\u00e7\u00f5es para splines \ndi\u00e1dicos. No cap\u00edtulo 4 consideramos a aproxima\u00e7\u00e3o de fun\u00e7\u00f5es pelo m\u00e9todo \nde m\u00ednimos quadrados. Neste cap\u00edtulo tamb\u00e9m apresentamos um algoritmo que \nrealiza o refinamento de uma grade di\u00e1dica G a partir de uma fun\u00e7\u00e3o f qualquer, \ntornando G mais segmentada nas regi\u00f5es do dom\u00ednio onde f possui um compor-\ntamento n\u00e3o linear mais acentuado. Mostramos por experimentos que o uso de \ngrades di\u00e1dicas adaptativas proporciona resultados t\u00e3o precisos quanto o de uma \ngrade uniforme de mesma resolu\u00e7\u00e3o m\u00e1xima, a uma fra\u00e7\u00e3o do custo. \n\nNo cap\u00edtulo 5 revisamos a t\u00e9cnica de Galerkin para a solu\u00e7\u00e3o de equa\u00e7\u00f5es \ndiferenciais parciais. Ilustramos essa t\u00e9cnica resolvendo um problema linear, a \n\n\n\n1.4. Revis\u00e3o bibliogr\u00e1fica 5 \n\nequa\u00e7\u00e3o de Helmholtz [Gom99]. No cap\u00edtulo 6, estendemos essa t\u00e9cnica a equa\u00e7\u00f5es \ndiferenciais vari\u00e1veis no tempo. Para autenticarmos essa nova abordagem, si-\nmulamos um processo de difus\u00e3o do calor em meio isotr\u00f3pico e comparamos os \nresultados com dados obtidos analiticamente. \n\nNos cap\u00edtulos 7 a 9 enfocamos o problema da simula\u00e7\u00e3o do escoamento de \npetr\u00f3leo. No cap\u00edtulo 7 introduzimos as equa\u00e7\u00f5es de escoamento multif\u00e1sico \n\u00f3leo/\u00e1gua que, no cap\u00edtulo 8, discretizamos e adaptamos \u00e0 modelagem por ele-\nmentos finitos. O cap\u00edtulo 9 descreve os m\u00f3dulos do programa de simula\u00e7\u00e3o que \ndesenvolvemos (Sim\u00f3leo), e apresenta alguns testes realizados para avali\u00e1-lo. Con-\nclu\u00edmos, no cap\u00edtulo 10, com observa\u00e7\u00f5es principalmente a respeito destes testes \ne outras considera\u00e7\u00f5es finais. \n\n1.4 \n\n1 Spl\u00ednes di\u00e1dicos \n\nExiste uma grande variedade de trabalhos baseados em splines na literatura \n([Gom99, BBB87] por exemplo). Em geometria computacional e outras \u00e1reas, \nas grades di\u00e1dicas s\u00e3o conhecidas como k-d trees \u00edHS99]. Duchaineau [Duc96] \nestudou especificamente os splines di\u00e1dicos, e mostrou que eles podem ser usados \nem esquemas de aproxima\u00e7\u00e3o, compacta\u00e7\u00e3o e projeto interativo de fun\u00e7\u00f5es. \n\n1.4.2 Simula\u00e7\u00e3o de escoamento multif\u00e1sico \n\nNo tocante \u00e0 simula\u00e7\u00e3o do escoamento de petr\u00f3leo, diversos experimentos encora-\njam o uso de refinamento locaL Esta t\u00e9cnica vem tradicionalmente sendo utilizada \ncom modelagens por diferen\u00e7as finitas, m\u00e9todo que emprega grades uniformes e \nportanto dificulta abordagens din\u00e2micas e com muitos n\u00edveis de refinamento. A \nmaioria das propostas nesse sentido envolvem uma malha grosseira global e al-\ngumas malhas mais finas nas regi\u00f5es cr\u00edticas do dom\u00ednio. As itera\u00e7\u00f5es num\u00e9ricas \ns\u00e3o realizadas alternadamente entre a malha grosseira e as malhas finas, sendo \nque os resultados de cada uma gera as condi\u00e7\u00f5es de contorno para a outra. Al\u00e9m \ndisso, esquemas especiais s\u00e3o necess\u00e1rios para traduzir as propriedades entre os \nn\u00edveis de refinamento. As press\u00f5es, normalmente representadas por fun\u00e7\u00f5es su-\naves, s\u00e3o obtidas por meio de interpola\u00e7\u00e3o. As satura\u00e7\u00f5es, por outro lado, s\u00e3o \ndadas por fun\u00e7\u00f5es mais irregulares e portanto s\u00e3o estimadas geralmente por meio \nde replica\u00e7\u00e3o de valores. Citamos a seguir alguns destes trabalhos. \n\n\n\nlA. Revis\u00e3o bibliogr\u00e1fica 6 \n\nHe\u00ednemann et al [HGH83] desenvolveram um simulador que permite a rea-\nliza\u00e7\u00e3o de refinamento local din\u00e2mico de malhas tridimensionais com um limite \nde 8 divis\u00f5es das c\u00e9lulas iniciais em cada dire\u00e7\u00e3o. Este simulador foi criado para \ndar a v\u00e1rias formula\u00e7\u00f5es, como esquemas Black-Oil e fluxos de vapor, que \npodem ser avaliadas como processos simult\u00e2neos. Os escoamentos baseados no \nmodelo Black-Oil usam equa\u00e7\u00f5es no formato IMPES (Implicit Pressure Explicit \nSaturation [Cri77]), com passo de tempo tamb\u00e9m vari\u00e1veL \n\nEstes pesquisadores conclu\u00edram que o refinamento local \u00e9 capaz de reduzir o \ntempo de execu\u00e7\u00e3o do sistema se o n\u00famero de c\u00e9lulas empregadas nas malhas \npode ser reduzido em 20%. \n\nWasserman [Was87] sugeriu uma t\u00e9cnica na qual o refinamento local \u00e9 aplicado \nem janelas, que s\u00e3o regi\u00f5es retangulares com at\u00e9 tr\u00eas dimens\u00f5es. Em seu trabalho \nas janelas s\u00e3o refinadas estaticamente, e a partir das propriedades do reservat\u00f3rio \n\nsuas sub-regi\u00f5es. Nestes c\u00e1\u00edculos, as press\u00f5es s\u00e3o obtidas por interpola\u00e7\u00e3o, e as \nsatura\u00e7\u00f5es por meio de replica\u00e7\u00e3o. \n\nA solu\u00e7\u00e3o dos sistemas de equa\u00e7\u00f5es resultantes \u00e9 feita de maneira que a adi\u00e7\u00e3o \nde novas janelas ao modelo aumenta linearmente, e n\u00e3o exponencialmente, seu \nn\u00famero de opera\u00e7\u00f5es. Exemplos de simula\u00e7\u00e3o mostraram que o refinamento ver-\ntical \u00e9 importante. \n\nNacul et al [NLP+9\u00fc] mostraram algumas formas de acelerar a converg\u00eancia de \nsistemas com refinamento local associados \u00e0 t\u00e9cnica de decomposi\u00e7\u00e3o de dom\u00ednios. \nEsta t\u00e9cnica consiste em dividir a ampla regi\u00e3o do reservat\u00f3rio em subdom\u00ednios e \nresolver os sistemas num\u00e9ricos referentes a cada um deles separadamente. \n\nO uso de pr\u00e9-condicionadores, ou seja, a aplica\u00e7\u00e3o de resultados obtidos por \nsimula\u00e7\u00f5es sobre malhas grosseiras como valores iniciais dos m\u00e9todos iterativos \nreduziu o tempo de converg\u00eancia de todos os experimentos realizados. A quanti-\ndade de itera\u00e7\u00f5es tamb\u00e9m foi reduzida fazendo um tipo de relaxa\u00e7\u00e3o nas vari\u00e1veis \ndos sistemas. Analisando os casos nos quais os subdom\u00ednios possu\u00edam regi\u00f5es em \ncomum, Nacul et al verificaram que quando estas regi\u00f5es s\u00e3o pequenas as taxas de \nconverg\u00eancia podem ser melhoradas, ao passo que regi\u00f5es comuns muito grandes \nem geral aumentam o tempo de processamento. \n\nDuas t\u00e9cnicas foram investigadas por Risso [Ris02] com a finalidade de reduzir \no tempo das simula\u00e7\u00f5es: o refinamento local e as fronteiras abertas. Para reali-\nzar esta investiga\u00e7\u00e3o, construiu um modelo base contendo certas regi\u00f5es cr\u00edticas \npr\u00f3ximas aos po\u00e7os. Risso dividiu seus experimentos com refinamento local em \n\n\n\n1.4. Revis\u00e3o b\u00edbl\u00edogr\u00e1flca 7 \n\ntr\u00eas etapas, nas quais realizou testes com refinamentos graduais e abruptos, restri-\ntos ou al\u00e9m das regi\u00f5es de interesse e com grades de resolu\u00e7\u00f5es, com ou sem \nrefinamento das regi\u00f5es cr\u00edticas em cada uma delas. Ap\u00f3s um estudo comparativo, \nverificou que o refinamento locaL al\u00e9m das regi\u00f5es cr\u00edticas, \u00e9 indesej\u00e1vel porque \nreduz pouco o erro em rela\u00e7\u00e3o ao aumento no tempo de simula\u00e7\u00e3o causado pelo \nuso de grades mais finas. Os menores tempos de simula\u00e7\u00e3o foram obtidos usando a \nmalha grosseira, que entretanto mostrou-se invi\u00e1vel em fun\u00e7\u00e3o da baixa qualidade \ndos resultados. A melhor escala de refinamento tanto do modelo base quanto das \nregi\u00f5es cr\u00edticas foi de com consider\u00e1veis ganhos nos tempos de execu\u00e7\u00e3o. Risso \nconcluiu que o refinamento local \u00e9 mais indicado para reservat\u00f3rios pequenos com \npoucos po\u00e7os, e sugeriu que as regi\u00f5es cr\u00edticas de reservat\u00f3rios muito grandes de-\nvem ser estudadas como reservat\u00f3rios individuais, juntamente com uma avalia\u00e7\u00e3o \ncuidadosa dos fluxos em suas fronteiras. \n\n\n\n1.4. Revis\u00e3o bibliogr\u00e1fica 8 \n\n\n\nGrades Adaptativas \n\nNeste cap\u00edtulo descrevemos as grades di\u00e1d\u00edcas, que permitem a discretiza\u00e7\u00e3o he-\nterog\u00eanea dos dom\u00ednios de integra\u00e7\u00e3o. Atrav\u00e9s desta heterogeneidade podemos \nmelhorar a precis\u00e3o das solu\u00e7\u00f5es obtidas, refinando as bases de aproxima\u00e7\u00e3o onde \nestas solu\u00e7\u00f5es possuem comportamento mais irregular. A estrutura simples das \ngrades di\u00e1dicas tamb\u00e9m facilita a representa\u00e7\u00e3o e manipula\u00e7\u00e3o destas estruturas \nem computadores. \n\n2.1 Grades di\u00e1dicas \n\nPodemos obter uma grade di\u00e1dica atrav\u00e9s de divis\u00f5es sucessivas de uma c\u00e9lula \ninicial ou c\u00e9lula raiz, correspondente \u00e0 totalidade do dom\u00ednio, sempre pela metade. \nCada nova divis\u00e3o \u00e9 feita por um plano perpendicular a um eixo de coordenadas \ndiferente, numa ordem c\u00edclica. Por exemplo, para um dom\u00ednio tridimensional \ncom eixos cartesianos x, y e z, se a primeira divis\u00e3o for perpendicular a x, ent\u00e3o \na segunda dever\u00e1 ser perpendicular ao eixo y, a terceira perpendicular a z, a \nquarta perpendicular a x, e assim por diante, ciclicamente (figuras 2.1 e 2.2). \nEsta organiza\u00e7\u00e3o pode ser aplicada a um n\u00famero arbitr\u00e1rio de dimens\u00f5es k ;::: 1, \ne faz com que o refinamento da grade ocorra gradativamente. Por fim, obtemos \num conjunto sub-regi\u00f5es retangulares. \n\n9 \n\n\n\n2.1. Grades di\u00e1dicas \n\nI I I \nI I \n\nI \n\n. \nI I I i I '' I I , i I : \n\ni ' I I ' I I ! ; I \nI ' I ; I I ; I ; ,i \n\n! ; i ! \" ' ' ' I I I ' I I ! \n\nFigura 2.1: Cria\u00e7\u00e3o de uma grade di\u00e1dica bidimensional. \n\n/ \n\nX \n-> \n\nFigura 2.2: Cria\u00e7\u00e3o de uma grade di\u00e1dica tridimensional. \n\n10 \n\nI \nI \n\nAssim, cada c\u00e9lula pode ser dividida em duas c\u00e9lulas filhas (figura 2.3 ) e, a \nmenos que seja a c\u00e9lula raiz, equivale \u00e0 metade de sua c\u00e9lula m\u00e3e. \n\nw \n\u2022 I \n\nI ' I n \n\nH \n\nir \n' \n\nc\u00e9lula m\u00e3e \n\nf-i . ' ; \ni H \n\ni-\n2 c\u00e9lulas filhas 4 c\u00e9lulas netas \n\nFigura 2.3: Uma c\u00e9lula m\u00e3e, com duas c\u00e9lulas filhas e quatro c\u00e9lulas \nnetas. \n\nProlongando-se esta disposi\u00e7\u00e3o indefinidamente obtemos a grade di\u00e1dica infi-\nnita c\u00b7. Na pr\u00e1tica usamos uma grade di\u00e1dica finita, em que o processo termina \ndepois de um n\u00famero finito de divis\u00f5es e portanto todas as grades mencionadas \nno restante deste trabalho devem ser consideradas finitas. \n\n\n\n2.2. Orienta\u00e7\u00e3o, indexa\u00e7\u00e3o e profundidade 11 \n\nAs c\u00e9l-ulas folha s\u00e3o o conjunto de c\u00e9lulas da grade que n\u00e3o sofrem divis\u00f5es. \n!\\a figura 2.3, entre as c\u00e9lulas destacadas, a c\u00e9lula m\u00e3e e as c\u00e9lulas filhas n\u00e3o s\u00e3o \nfolhas, ao contr\u00e1rio das c\u00e9lulas netas. \n\nLogicamente, grades d\u00ed\u00e1dicas correspondem a \u00e1rvores bin\u00e1rias (figura 2.4), e \nmodelar uma grade di\u00e1dica equivale a escolher uma \u00e1rvore bin\u00e1ria correspondente \nlimitando adequadamente sua profundidade em cada regi\u00e3o do dom\u00ednio. \n\nFigura 2.4: Arvore bin\u00e1ria correspondente a uma grade. \n\n2.2 Orienta\u00e7\u00e3o, indexa\u00e7\u00e3o e profundidade \n\nPara simplificar os c\u00e1lculos, vamos supor que a origem do sistema de coordenadas \u00e9 \num v\u00e9rtice da c\u00e9lula raiz, e que todas as arestas s\u00e3o paralelas aos eixos coordenados \n( \" ? -) ngura __ o . \n\ni \ni I \n\n'I I \nI \n' ! ,0)1 (0 \n\ni i \n\n' I \n\n' \n\u2022 \n\n' \n\nl \n\n;t~~~~~~2_ \n' ' \n\ni y . \n(0,0,0) \n\nFigura 2.5: A origem coincide com um dos v\u00e9rtices da c\u00e9lula raiz. \n\nAtribu\u00edmos a cada c\u00e9lula da grade di\u00e1dica um \u00edndice, que \u00e9 um valor inteiro \npositivo. A c\u00e9lula raiz, a \u00fanica que n\u00e3o provem da parti\u00e7\u00e3o de outras, tem \u00edndice \nL Uma c\u00e9lula filha de uma c\u00e9lula de \u00edndice I recebe \u00edndice 21 ou 21 + 1, conforme \nesteja respectivamente mais pr\u00f3xima ou distante da origem. Assim, podemos \nrepresentar cada c\u00e9lula de maneira compactada com apenas 1 bit. Veja a distri-\nbui\u00e7\u00e3o dos \u00edndices em uma grade bidimensional na figura 2.6. \n\n\n\n2.3. Posicionamento e tamanho das c\u00e9lulas 12 \n\n1 I 1. i5l7l \nI \n\n2 \nI \n\n3 lc:>l416l \n1 \n\n4 7 \n\nFigura 2.6: Distribui\u00e7\u00e3o dos \u00edndices em uma grade 2d. \n\nToda c\u00e9lula tamb\u00e9m tem uma profundidade na \u00e1rvore bin\u00e1ria derivada da \ngrade di\u00e1dica: a c\u00e9lula raiz tem profundidade O, e cada filha de uma c\u00e9lula de \nprofundidade P tem profundidade P + 1. Ou seja, a profundidade de uma c\u00e9lula \nC indica o n\u00famero de cortes necess\u00e1rios para transformar a c\u00e9lula raiz na c\u00e9lula \nC. O n\u00edvel P da grade \u00e9 o conjunto de todas as c\u00e9lulas com profundidade P, que \npode ter no m\u00e1.ximo 2P c\u00e9lulas. A figura 2.1 cont\u00e9m os 8 (do zero \nao s\u00e9timo) da grade di\u00e1dica infinita . Na figura 2. 7 as c\u00e9lulas de profundidade \n5 (o n\u00edvel 5) est\u00e3o em destaque. \n\nFigura 2.7: N\u00edvel 5 de uma grade di\u00e1dica. \n\n2.3 Posicionamento e tamanho das c\u00e9lulas \n\nCada n\u00edvel de profundidade da grade infinita G' funciona como uma esp\u00e9cie de \ntabuleiro regular, com espa\u00e7amentos iguais ao longo de cada eixo, sempre em \nquantidades equivalentes a alguma pot\u00eancia negativa de 2 vezes a dimens\u00e3o cor-\nrespondente da c\u00e9lula raiz. Portanto a posi\u00e7\u00e3o e tamanho de uma c\u00e9lula podem \nser obtidos facilmente a partir de sua profundidade P e \u00edndice I. \n\nComo a profundidade reflete a quantidade de cortes necess\u00e1rios para gerar \numa determinada c\u00e9lula, e lembrando que estes cortes ocorrem alternando os \neixos ciclicamente, ent\u00e3o podemos calcular a quantidade m\u00e1xima de c\u00e9lulas Qi \n\n\n\n2.3. Posicionamento e tamanho das c\u00e9lulas 13 \n\nque podem ser dispostas ao longo do eixo i de uma grade G com k dimens\u00f5es, a \num de profundidade P: \n\nqi=IPI+{l se \nLkJ O se \n\nPmod k >i \nPmod k :<::i \n\nPara encontrarmos, por exemplo, o vetor Q das poss\u00edveis posi\u00e7\u00f5es distintas de \numa c\u00e9lula com profundidade P = 5 em G, sendo k = 3, fazemos: \n\ni=O (eixo X), l\"l+l Q0 = 2 L = 4 (5 mod 3 >O) \n(eixo \n\nI e I . 1 \n(5mod3> 1) i= 1 Q. = 2.3F = 4 \n\n\"' \ni=2 (eixo Z), i\" J~o \" Qo = 2\" \u00b7 =L (5 mod 3 :<:: 2) \n\nA posi\u00e7\u00e3o de uma c\u00e9lula C \u00e9 o vetor 6(C) = (60 , ... , \u00f3k-J que d\u00e1 o n\u00famero \nde c\u00e9lulas de profundidade P entre C e a origem em cada eixo. Os valores \n50 , J1 , ... , Ok-! podem ser extra\u00eddos do \u00edndice I de C, bastando apenas desen-\ntrela\u00e7ar seus P bits menos significativos, organizando-os em k grupos. :Vlais pre-\ncisamente, a representa\u00e7\u00e3o bin\u00e1ria de cada J1 \u00e9 composta pelo i-\u00e9simo bit menos \nsignificativo de I somado aos demais bits tomados de k em k, at\u00e9 a \u00faltima casa \nantes do bit 1 mais significativo. \n\nAssim, por exemplo, se a grade G for dividida at\u00e9 que todas as suas c\u00e9lulas \nalcancem profundidade 5, com um total de 25 = 32 c\u00e9lulas, ent\u00e3o cada eixo ter\u00e1 \nrespectivamente Q = (4, 4, 2) c\u00e9lulas. Se uma c\u00e9lula C tiver \u00edndice I 57, de \n\n-'<01201 \nrepresenta\u00e7\u00e3o bin\u00e1ria 1110012, ent\u00e3o sua posi\u00e7\u00e3o \u00e9 obtida separando-se os 5 bits \n\nmenos significativos como o(C) = ( l02 , H,, 02 ) = (2, 3, 0). Observe a estrutura \nda grade G e a posi\u00e7\u00e3o da c\u00e9lula C na figura 2.8. \n\n\n\n2.4. Geometria can\u00f4nica 14 \n\nFigura 2.8: C\u00e9lula C, com vetores Q(C) = (4, 4, 2) e o(C) = (2, 3, 0). \n\n2.4 Geometria can\u00f4nica \n\nNuma grade di\u00e1dica, como a divis\u00e3o das c\u00e9lulas segue sempre a mesma ordem \nc\u00edclica de eixos, a escolha das propor\u00e7\u00f5es da c\u00e9lula raiz interfere diretamente na \nvelocidade com que os refinamentos trazem ganhos de precis\u00e3o num\u00e9rica. Isto \nocorre porque os erros de aproxima\u00e7\u00e3o de espa\u00e7os de spiines s\u00e3o proporcionais \nao di\u00e2metro das c\u00e9lulas, isto \u00e9, \u00e0s suas maiores arestas. Portanto, uma c\u00e9lula \nisom\u00e9trica (com todas as arestas iguais) precisa ser dividida ao menos k vezes, em \numa grade de dimens\u00e3o k, para que o erro atribu\u00eddo \u00e0s c\u00e9lulas resultantes seja \nreduzido significativamente. Al\u00e9m disso a divis\u00e3o produziria 2k c\u00e9lulas isom\u00e9tricas \ne consequentemente este problema se repetiria em todos os n\u00edveis. \n\nPara que as c\u00e9lulas em todos os n\u00edveis de profundidade mantenham-se propor-\ncionais, a c\u00e9lula raiz deve ter no eixo i tamanho z-i/k com i variando entre O e \nk-1. Uma c\u00e9lula raiz bidimensional assim definida ter\u00e1 lados de tamanho 1 : 2- 1 / 2 \n\nou 1 : V\u00fc,i). Em 3 dimens\u00f5es, estas propor\u00e7\u00f5es tornam-se 1 : 2-113 : 2-z;a Todas \nas c\u00e9lulas de profundidade P ser\u00e3o similares \u00e0 c\u00e9lula raiz, submetida a uma escala \nlinear de fator 2-P/k, e rodada por uma permuta\u00e7\u00e3o de eixos. \n\nDesta forma, o di\u00e2metro das c\u00e9lulas \u00e9 reduzido por um fator constante de 2- 1 /k \na cada n\u00edveL Embora as c\u00e9lulas apresentem maior precis\u00e3o em eixos diferentes de \nn\u00edvel para n\u00edvel, esta abordagem leva a refinamentos graduais da grade di\u00e1dica, e \n\u00e9 isotr\u00f3pica se considerarmos todos os n\u00edveis em conjunto. \n\n\n\nCap\u00edtulo 3 \n\nSplines di\u00e1dicos \n\nMostramos em detalhes neste cap\u00edtulo a fam\u00edlia das fun\u00e7\u00f5es tenda, um subespa\u00e7o \nmultilinear do espa\u00e7o de splines gerais definidos sobre grades di\u00e1dicas, Destaca-\nmos duas bases espec\u00edficas para estas fun\u00e7\u00f5es multilineares, e mostramos algorit-\nmos discretos para encontr\u00e1-las al\u00e9m de um algoritmo simples capaz de interpolar \numa fun\u00e7\u00e3o qualquer usando fun\u00e7\u00f5es tendas, Analisando os algoritmos que en-\ncontram as bases, mostramos que possuem um tempo de execu\u00e7\u00e3o proporcional \nao n\u00famero de c\u00e9lulas folha das grades di\u00e1dicas sobre as quais s\u00e3o chamados, \n\n3.1 Splines \n\nUm spline \u00e9 uma fun\u00e7\u00e3o polinomial por partes, ou seja, uma fun\u00e7\u00e3o f sobre \ncujo dom\u00ednio rl existe uma parti\u00e7\u00e3o (grade) em regi\u00f5es distintas (c\u00e9lulas), sendo \nque f possui comportamento polinomial em cada c\u00e9lula, Quando o dom\u00ednio rl \nest\u00e1 estruturado como uma grade di\u00e1dica G, f \u00e9 um spline di\u00e1dico, A fun\u00e7\u00e3o f \nrestrita a alguma destas c\u00e9lulas do dom\u00ednio \u00e9 chamada de retalho polinomial (ou \nsimplesmente retalho), A continuidade m\u00ednima de f nas fronteiras entre todos os \nretalhos indica a continuidade de r o grau m\u00e1ximo de f \u00e9 dado pelo grau m\u00e1ximo \nde todas as vari\u00e1veis independentes sobre todos seus retalhos. A vantagem do uso \nde splines est\u00e1 na reconhecida simplicidade dos polin\u00f4mios combinada com a \npossibilidade de melhorar a qualidade da aproxima\u00e7\u00e3o numa regi\u00e3o arbitr\u00e1ria de \nrl, usando uma parti\u00e7\u00e3o mais fina nesta regi\u00e3o, \n\n15 \n\n\n\n32 Elementos finitos 16 \n\n3.2 Elementos finitos \n\nO suporte de um spl\u00edne \u00e9 o conjunto c\u00e9lulas onde ele n\u00e3o \u00e9 identicamente nulo. \n\nAssim, outra vantagem de splines como fun\u00e7\u00f5es aproximadoras \u00e9 que seus espa\u00e7os \nmuitas vezes possuem bases cujos elementos (fun\u00e7\u00f5es das bases) t\u00eam suporte muito \npequeno, independente do n\u00famero total de c\u00e9lulas na grade (figura 3.1). \n\nDD\u00ediDB \nn. ,noo, IDO \nLJ ~ OOL.-...l 1' L) \n\n[].\n, ,_;.DI. I' I \nD, ,noo uuo \n\nI \nH= I ~ \n\nI \nI 1-\n\ngrade di\u00e1dica retalhos suporte limitado \n\nSplines com esta caracter\u00edstica s\u00e3o chamados elementos finitos. Para obtermos \no valor de uma fun\u00e7\u00e3o u'(x) =E ai'Pi(x) num dado ponto x combinando elemen-\ntos finitos de uma base :p, s\u00f3 \u00e9 necess\u00e1rio calcularmos os termos 'Pi(x) tais que x \nperten\u00e7a ao suporte de 'fi, o que normalmente ocorre com poucas fun\u00e7\u00f5es da base. \nNa aplica\u00e7\u00e3o de m\u00e9todos num\u00e9ricos, como o m\u00e9todo de Galerkin ou aproxima\u00e7\u00f5es \n\npor m\u00ednimos quadrados, os sistemas de equa\u00e7\u00f5es montados com estas bases nor-\nmalmente s\u00e3o represent\u00e1veis por matrizes esparsas. A escolha de alguma base de \naproxima\u00e7\u00e3o depende do grau de suavidade buscado. Splines de graus elevados \npodem gerar aproxima\u00e7\u00f5es mais fi\u00e9is a fun\u00e7\u00f5es suaves, usando menos retalhos. \n\nAs fun\u00e7\u00f5es aproximadoras que escolhemos neste trabalho s\u00e3o elementos finitos \nmultilineares, ou seja, splines multilineares definidos sobre uma grade di\u00e1dica \nfinita G de dimens\u00e3o k. \n\n3.3 splines multilineares sobre grades di\u00e1dicas \n\nUm spl\u00edne multilinear de dom\u00ednio k-dimensional definido sobre uma grade di\u00e1dica \nG possui um retalho sobre cada c\u00e9lula de G, tem continuidade O e grau m\u00e1ximo \n1 em suas k vari\u00e1veis. Embora paralelamente a cada eixo a varia\u00e7\u00e3o de um \n\nspline multilinear seja linear, em outras dire\u00e7\u00f5es a varia\u00e7\u00e3o pode ser quadr\u00e1tica \nou c\u00fabica, em decorr\u00eancia do produto de suas k vari\u00e1veis (grau total k). \n\nChamaremos de [ 1 [G] o espa\u00e7o das fun\u00e7\u00f5es multilineares de fronteira nula de-\n\nfinido sobre uma grade G di\u00e1dica. Modificando a estrutura da grade G, alteramos \nem geral o espa\u00e7o E 1 [G] e portanto suas bases. \n\n\n\n3.4. As fun\u00e7\u00f5es tenda 17 \n\n3.4 As fun\u00e7\u00f5es tenda \n\nNas bases que consideramos neste trabalho, o suporte de um elemento k-dimensional \nT \u00e9 composto por 2k c\u00e9lulas de mesmo tamanho e profundidade, agrupadas em \ntorno de um v\u00e9rtice central v. Neste ponto o elemento da base, r, possui valor 1, \ncaindo linearmente ao longo de cada eixo para O na fronteira do suporte. No caso \nparticular de k = 2, o gr\u00e1fico do elemento gen\u00e9rico assemelha-se a uma tenda e \npor isso os elementos (para qualquer k ) ser\u00e3o aqui designados fun\u00e7\u00f5es tenda ou \nsimplesmente tendas (figura 3.2). \n\n1 \n\n-1 \n\n1 -1 \n\nFigura 3.2: Fun\u00e7\u00e3o tenda com uma e duas dimens\u00f5es. \n\nA profundidade (posto) de uma tenda \u00e9 a profundidade das c\u00e9lulas de seu \nsuporte. Uma tenda pode ser identificada unicamente por sua c\u00e9lula superior C, \na c\u00e9lula de seu suporte mais distante da origem. Denotaremos por Te a tenda de \numa grade di\u00e1dica G cuja c\u00e9lula superior \u00e9 C, e podemos escrev\u00ea-la como \n\nk-l \nTe(xo, ... 'Xk-l) =TI A (2'1kQixi- oi) (3.1) \n\ni=O \n\nonde Qi \u00e9 o n\u00famero de c\u00e9lulas de profundidade P na grade infinita G\" ao longo \nda dire\u00e7\u00e3o i: \u00edii \u00e9 a componente i do vetor posi\u00e7\u00e3o 6 de C; e A \u00e9 a fun\u00e7\u00e3o definida \npor \n\nA(x) = max{O, 1 \n{ \n\n1 X \n\nlx} = O \nl+x \n\nseO:s;x:s;l \n\nse \\x11 > 1 \nse-1:<:;x<0 \n\n(3.2) \n\n\u00c9 importante observar que esta defini\u00e7\u00e3o da tenda Te admite que a grade G mede \n2-i/k em cada dire\u00e7\u00e3o i. Se ao longo de cada eixo a grade G variasse apenas de \nzero a um, a f\u00f3rmula de Te seria n:,;:-~ A (Qixi- lii)\u00b7 \n\n\n\n3.5. As bases Bmax e Bmin 18 \n\n3.5 As bases Bmax e Bmin \n\nt\u00edl\u00ed:zami)S para cada espa\u00e7o de splines E1[G] duas bases, Bmax e Bmin\u00b7 Em ambas \nb\u00e1 uma tenda para cada v\u00e9rtice completo de G, ou seja, para cada v\u00e9rtice que \ntem 2k c\u00e9lulas incidentes. A base Bmax (maximal) consiste nas tendas de maior \nsuporte poss\u00edvel (figura 3.4), eu quanto Bmin (m\u00ednima/) consiste nas tendas de me-\nnor suporte poss\u00edvel (figura 3.3). Quando G \u00e9 uma grade regular de profundidade \nP, Bmax possu\u00ed tendas em todos os n\u00edveis de k; at\u00e9 P, e Bmin possui tendas apenas \nde n\u00edvel P. \n\nTo Tz \n\nTy Tg Tg \n\nFigura 3.3: A base minimal do espa\u00e7o [ 1 de uma grade bidimensional \nirregular G. \n\nNote que nas figuras 3.3 e 3.4 as tendas numeradas iguais possuem o mesmo \nv\u00e9rtice central, e a diferen\u00e7a entre as duas bases est\u00e1 nas tendas 7 2 , 7 6 e 7 8 . \n\nTs Tg \n\nFigura 3.4: A base maximal do espa\u00e7o [ 1 de uma grade bidimensional \nirregular G. \n\nA bases Bmax podem ser encontradas mais facilmente do que as bases Bmin, \nmas possuem como desvantagem num\u00e9rica uma tend\u00eancia a gerar matrizes den-\nsas do produto escalar de suas fun\u00e7\u00f5es. Por outro lado, como suas tendas s\u00e3o \nmais abrangentes, permitem realizar aproxima\u00e7\u00f5es grosseiras de amplas regi\u00f5es \ndo dom\u00ednio utilizando apenas subconjuntos delas. \n\n\n\n3.5. As bases Bmax e Bmin 19 \n\nAs bases Bmin t\u00eam como propriedade gerar as matrizes de produtos escalares \nmais esparsas poss\u00edveis~ pois as regi\u00f5es comuns ao suporte de suas tendas s\u00e3o \nminimizadas. Isso aumenta a estabilidade num\u00e9rica porque reduz ao m\u00e1ximo a \ninterfer\u00eancia no sistema de altera\u00e7\u00f5es na base. \n\n.1 bases Bmax e Bm\u00edn \n\nProvaremos que Bmax e Bmin s\u00e3o de fato bases para um espa\u00e7o [ 1 [G] mostrando \nque as fun\u00e7\u00f5es tenda destes conjuntos s\u00e3o linearmente independentes (LI) e geram \no espa\u00e7o [ 1 [G]. Come\u00e7aremos mostrando a independ\u00eancia linear de todo conjunto \nsimples, ou todo conjunto de tendas que possui no m\u00e1ximo uma tenda para cada \nv\u00e9rtice. \n\nLema 3.1 Seja B um conjunto simples de tendas, e r uma tenda de profundidade \nm\u00ednima em B com v\u00e9rtice central v. Qualquer combina\u00e7\u00e3o linear do conjunto \nB' B-r \u00e9nulaemv. \n\nProva: Para qualquer tenda r' de B' o ponto v est\u00e1 situado na fronteira ou no \nexterior do suporte de r', e \u00e9 zero neste ponto. O \n\nTeorema 3.1 Qualquer conjunto simples B de tendas \u00e9 linearmente indepen-\ndente. \n\nProva: Suponhamos que B n\u00e3o seja LL ou seja, existe alguma tenda de B que \npode ser escrita corno combina\u00e7\u00e3o linear das demais. Neste caso, seja r urna \ntenda nestas condi\u00e7\u00f5es com profundidade P m\u00ednima em B e v\u00e9rtice central v. \nObviamente ela pode ser escrita como combina\u00e7\u00e3o linear das outras tendas, com \nprofundidades maiores ou iguais \u00e0 P. Contudo, pelo lema 3.1 isto n\u00e3o \u00e9 poss\u00edvel \nporque qualquer combina\u00e7\u00e3o linear das outras tendas de B ter\u00e1 valor zero em v, \nonde r \u00e9 um e portanto B s\u00f3 pode ser LI. O \n\n3.5.2 Interpola\u00e7\u00e3o usando tendas \n\nAntes de prosseguir com as provas, mostraremos um algoritmo simples de inter-\npola\u00e7\u00e3o usando tendas. Seja G urna grade di\u00e1dica k-dimensional, B um conjunto \nqualquer de tendas e f urna fun\u00e7\u00e3o arbitr\u00e1ria definida sobre G. O algoritmo 3.5.1 \n\n\n\n3.5. A.s bases l3max e Bmin \n\nalgoritmo 3.5.1 Interpola(B, f) \n\nL Seja V o conjunto dos v\u00e9rtices centrais das tendas de B: \n2: Ordene Bem ordem de profundidade, obtendo\"\" .. Jn: \n3: for i : 1 -+ n do \n4: Seja v o v\u00e9rtice central de T;; \n5: if v \u00e9/ V then \n5: O; f- O; \n7: else \n8: o; f- f(v)- L{OjT;(v): j&lt;i e v E Dom(T;)}; \n9: V+-V {v}; \n\n10: end if \n11: end for \n\n20 \n\n(Interpola) encontra uma combina\u00e7\u00e3o linear g = L~=o o;T: de B que interpola f \nnos v\u00e9rtices centrais das tendas de B. \n\nLema 3.2 A fun\u00e7\u00e3o g resultante do algoritmo 3.5.1 tem g(v) = f( v) em todo \nv\u00e9rtice central v das tendas do conj-unto B. \n\nProva: No passo 8, cada coeficiente ai \u00e9 calculado de forma que f( v) = L; OjT;( v), \npara j :Si (a restri\u00e7\u00e3o v E Dom(T;) \u00e9 sup\u00e9rfula pois T;(v) O se v \u00e9/ Dom(T;)), \nonde v \u00e9 o v\u00e9rtice central de T;. Verifica-se que a combina\u00e7\u00e3o linear L; a;T;(v), \ncom j > i das demais tendas de B \u00e9 sempre nula. Isto ocorre porque as tendas \ncom j > i ou t\u00eam centro em v, e portanto ter\u00e3o a; = O (pelos passos 5 e 9), ou \nt\u00eam centro diferente de v e profundidades maiores ou iguais \u00e0 profundidade de T,, \ne portanto T; (v) = O pelo lema 3. L O \n\n3.5.3 Cobertura das bases Bmax e Bmin \n\nVamos mostrar agora que as bases Bmax e Bmin de uma grade k-dimensional G \ngeram todo o espa\u00e7o E1 [G]. Na verdade provaremos que qualquer conjunto de \ntendas que inclu\u00ed pelo menos uma tenda para cada v\u00e9rtice completo de G (um \nconjunto completo de tendas) gera todo o espa\u00e7o [ 1 [ G]. \n\nDiremos que um v\u00e9rtice v \u00e9 esquina de uma face F de G se v for face (de \ndimens\u00e3o O) de F. Se v est\u00e1 sobre alguma face F (com dimens\u00e3o d :S k) de \nalguma c\u00e9lula folha C de G mas n\u00e3o \u00e9 esquina de F, ent\u00e3o v \u00e9 intermedi\u00e1rio \nde F e de C. Diremos que v \u00e9 incompleto se n\u00e3o est\u00e1 na fronteira da grade e \u00e9 \nintermedi\u00e1rio de alguma c\u00e9lula folha. \n\n\n\n3.5. A.s bases Bmax e Bmin \n\nI \nA \n\nC6/ \nj \n\n' \n\\ \n\n/ incompleto \n\nC2[ l:l \nC3 \n\nC4,C5 \n\nC7 \n\ncompleto \n\nc \n' de \n\nfronteira \n\nFigura 3.5: Um v\u00e9rtice completo esquina das c\u00e9lulas Cl, C4, C6 e \nC7; um v\u00e9rtice incompleto B, esquina das c\u00e9lulas C2, C5 e intermedi\u00e1rio \n\u00e0 c\u00e9lula C3; e um v\u00e9rtice de fronteira C. \n\n21 \n\nEm uma grade di\u00e1dica G, para todo v\u00e9rtice v seja o conjunto das c\u00e9lulas \nfolha incidentes a v. Se v \u00e9 completo ent\u00e3o ele \u00e9 esquina de todas as c\u00e9lulas de \nl'i(v). Quando v \u00e9 incompleto, ele sempre \u00e9 esquina de pelo menos duas c\u00e9lulas \nde N( v) e intermedi\u00e1rio de pelo menos uma destas c\u00e9lulas. \n\nLema 3.3 Seja G uma grade di\u00e1dica k-dimensional, f uma fun\u00e7\u00e3o de E1 [G], e \nv um v\u00e9rtice intermedi\u00e1rio de uma face F de alguma c\u00e9lula folha C. Se f \u00e9 nula \nem todos os v\u00e9rtices de F, \u00e9 nula em v. \n\nProva: N\u00e3o pode haver mais do que um retalho polinomial de f em C, porque C \n\u00e9 uma c\u00e9lula folha. Este retalho \u00e9 multilinear dentro de Q_ Como f \u00e9 cont\u00ednua, \nent\u00e3o a restri\u00e7\u00e3o fi F tamb\u00e9m deve ser uma fun\u00e7\u00e3o multilinear. Assim, a varia\u00e7\u00e3o \nde f entre quaisquer dois v\u00e9rtices adjacentes de F \u00e9 linear e consequentemente f \nter\u00e1 valor O sobre toda a aresta entre estes dois pontos. Repetindo este argumento \nem todos os eixos, conclu\u00edmos que f \u00e9 zero em toda face F, e portanto no v\u00e9rtice \nv. o \n\nLema 3.4 Seja v um v\u00e9rtice incompleto. Se v \u00e9 intermedi\u00e1rio de uma c\u00e9lula C, \nent\u00e3o C tem profundidade menor que a profundidade de qualquer c\u00e9lula da qual \nv \u00e9 esquzna. \n\n\n\n35 As bases Bmax e Bmin \n\n/C3>C2>C5 \n\n{' \nC2 \\ B E C9 \n\nC3 \nH C10 \n\nCll \nCll > C3 > C10 \n\nC7 > C4 = CS \n\nFigura 3.6: Cada v\u00e9rtice incompleto (B, D, E, F, H, I e J) \u00e9 \nintermedi\u00e1rio a uma c\u00e9lula de profundidade menor do que todas as \nc\u00e9lulas das quais s\u00e3o esquinas. \n\n22 \n\nProva: Seja G uma grade di\u00e1dica k-dimens\u00edonal. Se v \u00e9 um v\u00e9rtice completo \nde G e C \u00e9 a c\u00e9lula folha de menor profundidade da qual v \u00e9 esquina, ent\u00e3o v \ntamb\u00e9m \u00e9 esquina de outras 2k - 1 c\u00e9lulas (n\u00e3o necessariamente folhas) de G de \nmesma profundidade. Agora seja v um v\u00e9rtice incompleto (como ilustrado na \nfigura 3.6) e N( v) o conjunto das c\u00e9lulas folha incidentes em v. Seja C1 a c\u00e9lula \nde menor profundidade P 1 em N (v) que tem v como esquina e C2 uma c\u00e9lula de \nN(v) com profundidade P2 , da qual v \u00e9 intermedi\u00e1rio. Refinemos G at\u00e9 encontrar \numa grade G', onde todas as c\u00e9lulas t\u00eam profundidade m\u00ednima P1 . O v\u00e9rtice v \nser\u00e1 completo em G' e esquina de 2k c\u00e9lulas de profundidade P1 . Como G' \u00e9 um \nrefinamento de G, algumas destas c\u00e9lulas ser\u00e3o descendentes de C2 e portanto \nA<~ D \n\nLema 3.5 Seja G uma grade di\u00e1dica k-dimensional e f uma fun\u00e7\u00e3o do espa\u00e7o \nE1 [G]. Se f \u00e9 zero em todos os v\u00e9rtices completos de G ent\u00e3o \u00e9 zero tamb\u00e9m em \ntodos os v\u00e9rtices incompletos de G. \n\nProva: Seja H o grafo orientado cujos n\u00f3s s\u00e3o os v\u00e9rtices de G, e no qual cada \nv\u00e9rtice incompleto v aponta para as esquinas de todas as faces das quais ele \u00e9 \nintermedi\u00e1rio. Note que se f \u00e9 zero nessas esquinas, ent\u00e3o pelo lema 3.3, f \u00e9 zero \ntamb\u00e9m em v. Denotaremos por r;( v) a profundidade da maior c\u00e9lula de quem v \n\u00e9 esquina. Este grafo n\u00e3o pode ter ciclos, porque para qualquer aresta de v1 para \nv2 , pelo lema 3.4 r;( vi) > r;( !J:2). Os sorvedouros de H s\u00e3o v\u00e9rtices completos ou \nde fronteira. Como f \u00e9 nula nestes pontos, ent\u00e3o (por indu\u00e7\u00e3o na dist\u00e2ncia ao \nsorvedouro mais distante)/ \u00e9 nula em todos os v\u00e9rtices de G. D \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin 23 \n\nTeorema 3.2 Todo conjunto completo de tendas B definido sobre uma grade \ndi\u00e1dica G gera o espa\u00e7o E1 [G]. \n\nProva: Sejam f um spline de E1 [G] e B um conjunto completo de tendas sobre \nG. Pelo lema 3.2 podemos encontrar uma combina\u00e7\u00e3o linear g de B tal que \ng( v) = em todos os v\u00e9rtices completos de G. Vamos mostrar que g = f. \nComo as tendas de B pertencem ao espa\u00e7o E 1 [ G], a diferen\u00e7a r = g - f tamb\u00e9m \npertence a este espa\u00e7o; ela \u00e9 zero na fronteira de G e \u00e9 zero em todos os v\u00e9rtices \ncompletos de G. Pelo lema 3.5, r tamb\u00e9m \u00e9 zero em todos os v\u00e9rtices incompletos \nde G e, pelo lema 3.3, r \u00e9 identicamente nula em G. O \n\nAs bases Bmax e Bm;n s\u00e3o conjuntos simples e completos, de maneira que pelos \nteoremas 3.1 e 3.2 s\u00e3o de fato bases do espa\u00e7o E1[G]. \n\n3.6 Determina\u00e7\u00e3o de bases Bmax e Bmin \n\n\u00c9 importante que tenhamos algoritmos eficientes para encontrar as bases Bmax e \nBmin de uma grade di\u00e1dica G, porque qualquer altera\u00e7\u00e3o em G normalmente modi-\nfica estas bases. Como h\u00e1 uma correspond\u00eancia entre tendas e v\u00e9rtices completos, \nent\u00e3o obteremos Bmax e Bmin em princ\u00edpio encontrando os v\u00e9rtices completos de \nG. Se para cada v\u00e9rtice v encontrado guardarmos uma tenda T cujo suporte \u00e9 \ncomposto pelas c\u00e9lulas de menor profundidade que t\u00eam v como esquina, chegare-\nmos a Bmax. Fazendo o mesmo, mas escolhendo as c\u00e9lulas de maior profundidade, \nchegaremos a Bmin\u00b7 \n\n3.6.1 Lugares e o conjunto estrela \n\nAntes de mostrarmos os algoritmos que encontram as bases, precisaremos de duas \ndefini\u00e7\u00f5es \u00fateis para trabalharmos com sub-regi\u00f5es de grades di\u00e1dicas, os lugares \ne suas estrelas. Um lugar L de uma grade di\u00e1d\u00edca G k-dimensional consiste de \numa profundidade P(L), e uma face F(L) de alguma c\u00e9lula de n\u00edvel P(L) da \ngrade G que n\u00e3o est\u00e1 na fronteira de G. Dizemos que a dimens\u00e3o do lugar L \u00e9 \na dimens\u00e3o d de F(L). Na grade di\u00e1dica infinita c\u2022 h\u00e1 exatamente 2k-d c\u00e9lulas \nde profundidade P(L) incidentes \u00e0 face F( L). Se todas estas c\u00e9lulas tamb\u00e9m s\u00e3o \nc\u00e9lulas da grade G (n\u00e3o necessariamente folhas) ent\u00e3o L \u00e9 dito um lugar completo \nde G. Veja a figura 3.7 abaixo. A lista destas c\u00e9lulas \u00e9 a estrela de L, denotada \npor L'. \n\n\n\n3.6. Determina\u00e7\u00e3o de bases Bmax e Bmin \n\nFigura 3. 7: Lugares incompletos cujas faces s\u00e3o respectivamente um \nsegmento de reta e um ponto, na primeira e terceira grade a partir da \nposi\u00e7\u00e3o mais \u00e0 esquerda. segunda e quarta grade, as c\u00e9lulas em \ndestaque s\u00e3o divididas para que estes lugares tornem-se completos. \n\n24 \n\nNote que uma mesma face F pode ser parte de dois lugares distintos, com \nn\u00edveis diferentes (figura 3.8). \n\nFigura 3.8: Nas duas grades tridimensionais, uma mesma face F plana \ndeterminada por c\u00e9lulas de profundidade 3 ou 4. Na grade \nbidimensional, uma face F (ponto) determinada por c\u00e9lulas de \nprofundidade 2 ou 3. \n\nSe F(L) \u00e9 uma c\u00e9lula, ent\u00e3o L \u00e9 sempre completo e L' tem uma \u00fanica c\u00e9lula, \na pr\u00f3pria F(L). Numa grade bidimensional, a estrela de um lugar aresta consiste \nde duas c\u00e9lulas (figura 3.9, esquerda), enquanto em uma grade tridimensional a \nestrela de um lugar aresta tem 4 c\u00e9lulas (figura 3.9, direita). Os lugares completos \nde dimens\u00e3o zero s\u00e3o os v\u00e9rtices completos de G. \n\nFigura 3.9: Um lugar aresta em uma grade bidimensional e em uma \ngrade tridimensional. \n\n3.6.2 O algoritmo Gera_Bmax \n\nGera_Bmax \u00e9 um procedimento recursivo que encontra a base Bmax de uma grade \nG de dimens\u00e3o k, fazendo um percurso em profundidade nos lugares de G em busca \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin \n\nde v\u00e9rtices completos. As entradas do algoritmo s\u00e3o uma sequ\u00eancia (!0 , ... , In_ 1 ) \nde \u00edndices que representam as c\u00e9lulas da estrela V de um lugar completo L de \nG; a dimens\u00e3o d deste lugar; o eixo de divis\u00e3o i = P(L) mod k; e a lista H = \n(h0 , ... , hm- 1 ) dos eixos ortogonais a F( L), onde m = k- d. O algoritmo devolve \na lista dos \u00edndices das c\u00e9lulas superiores das tendas da base. Para todo r E \nO, ... , m- 1 e todo j E O, ... , n - l, o bit 2' do \u00edndice j diz se a c\u00e9lula Ij est\u00e1 \nmais perto (O) ou mais longe da origem do que a face F(L) na dire\u00e7\u00e3o do eixo \n\nhr\u00b7 \n\nalgoritmo 3.6.1 Gera.Bmax( (!0 , ... , In- 1), d, i, (h0 , ... , hm-l)) \n\n1: if d = O then L \u00e9 um ponto. \n2: Devolve {In-d; Inclui a nova tenda (Bmax +-- Bmax U {In-i}). \n3: else \n4: if (10 , ... , In-J n\u00e3o possu\u00ed folhas then \n5: Calcule A = (Ih) ... 1 1~_ 1 ) 7 tal que 1;. = \n6: Calcule B = (Ig, ... ,1~_ 1 ), tal que Ij' = (2Ij + \n7: l +-- (i + 1) mod k; \n8: if i hr para algum r em O, ... , m - 1 then \n9: Calcule C+-- {Cj =Ai se o bit r de j \u00e9 1, ou Ci =Bise este bit \u00e9 O}; \n\n10: B' +-- Gera.Bmax(C, d, I, H); \nll\u2022 Devolve B'; \n12: else \n13: B' +-- Gera_Bmax(A, d, l, H); \n14: B\" +-- Gera.Bmax(B, d, I, H); \n15: B 111 +-- Gera_Bmax(A \u00b7 B, d- L I, H\u00b7 (i)): \n16: Devolve B' U B\" U B 111 ; \n17: end if \n18: else \n19: Devolve {}; \n20: end if \n21: end if \n\nA chamada inicial \u00e9 Gera.Bmax((l), k, O,()). \n\nLema 3.6 O algoritmo Gera_Bmax executado sobre um lugar completo L encon-\ntra todos os lugares completos de dimens\u00e3o zero ( 1) cujo v\u00e9rtice est\u00e1 em F (L) e \n(2) cuja profundidade P \u00e9 a menor poss\u00edvel mas P 2: P(L). \n\nProva: Precisamos mostrar que o algoritmo Gera_Bmax encontra todos os v\u00e9rtices \ncompletos (e consequentemente as tendas) existentes no interior da face F( L), e \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin 26 \n\nque as c\u00e9lulas do suporte destas tendas s\u00e3o escolhidas de forma que elas t\u00eam a \nmenor profundidade poss\u00edvel em F( L). Seja V o conjunto de todos estes v\u00e9rtices \ncompletos. \n\nPrimeiro o algoritmo verifica a dimens\u00e3o d, na linha l. Se esta for zero ent\u00e3o \nL \u00e9 um v\u00e9rtice; como L \u00e9 completo, ele determina uma tenda cujo suporte \u00e9 L', \ncom v\u00e9rtice central F(L) =v. Neste caso V= {v}, m = k, e o algoritmo devolve \na c\u00e9lula , que \u00e9 a c\u00e9lula de L' incidente a v mais distante da origem em todas \nas dire\u00e7\u00f5es (linha 2). \n\nNa linha 4, se alguma c\u00e9lula da lista (10 , ... , \u00e9 folha, ent\u00e3o, como L tem \ndimens\u00e3o d > O, n\u00e3o h\u00e1 v\u00e9rtices completos em F (L) e portanto o conjunto V \u00e9 \nvazio (linha 19). Caso contr\u00e1rio, as c\u00e9lulas de L' podem ser todas divididas ao \nlongo do eixo i (linhas 5 e 6), criando os conjuntos A e B. \n\nEssa divis\u00e3o pode acompanhar uma divis\u00e3o de L ou n\u00e3o, conforme a posi\u00e7\u00e3o do \neixo i em rela\u00e7\u00e3o a F (L). Quando i \u00e9 ortogonal a F (L) (linha 8, figura 3.1 O), a face \nF(L) n\u00e3o \u00e9 modificada, mas L \u00e9 substitu\u00eddo por um lugar L' tal que F(L') = F(L) \ne P(L') = P(L) + 1. Cada c\u00e9lula Cj de L\" \u00e9 uma das filhas (AJ ou Bj) da c\u00e9lula \ncorrespondente de L'. Especificamente, suponha que i = hr; ent\u00e3o CJ \u00e9 Ai se o \nbit r de j \u00e9 1, sen\u00e3o CJ \u00e9 BJ (linha 9). Como F(L') = F(L), a lista B' de \u00edndices \ndevolvida na linha 10 representa tendas com os mesmos v\u00e9rtices centrais V. \n\nX \n--!> \n\nFigura 3.10: Na grade \u00e0 esquerda, o eixo de divis\u00e3o ( x) \u00e9 ortogonal \u00e0 \nface em destaque. \n\nQuando o eixo i \u00e9 paralelo a F( L) (linha 12), os \u00edndices de A e B representam \nrespectivamente L'\" e L\"', as estrelas dos lugares L' e L\" resultantes da divis\u00e3o \nde L ao meio. A concatena\u00e7\u00e3o de A e B, por sua vez, representa L\"'\", a estrela \ndo lugar com dimens\u00e3o d- 1 que separa L' e L\" (figura 3.11). Neste caso tr\u00eas \ninst\u00e2ncias de GeraJ3max s\u00e3o chamadas, nas linhas 13, 14 e 15, para procurarem \nos v\u00e9rtices completos V', F\", e V\"' sobre F( L'), F( L\") e F(L\"'). Como estas faces \ns\u00e3o disjuntas e sua uni\u00e3o \u00e9 F( L), ent\u00e3o V' n V\" n V 111 ={}e V= V' U F\" U V\"'. \n\n\n\n3.6. Determina\u00e7\u00e3o de bases Bmax e Bmin 27 \n\nFigura 3.11: Gera_Bmax executado sobre duas faces determinadas por \neixos de s\u00e3o paralelos a estas faces. \n\nPara todo v\u00e9rtice v E V, a profundidade de qualquer lugar que tem v como \nface ser\u00e1 pelo menos P(L) (se F(L) for um ponto) e portanto a condi\u00e7\u00e3o (2) do \nlema ser\u00e1 respeitada. O \n\nTeorema 3.3 O algoritmo 3Ji.1 (Gera_Bmax) executado sobre uma grade di\u00e1dica \nG k-dimensional encontra a base Bmax de G. \n\nProva: Executando Gera.Bmax sobre o lugar L, cuja estrela U cont\u00e9m apenas \na c\u00e9lula raiz de G, encontraremos pelo lema 3.6 todos os v\u00e9rtices completos no \ndom\u00ednio de G, (F(L)), al\u00e9m de um conjunto de \u00edndices representando as tendas \nde maiores suportes em G com centro nestes v\u00e9rtices. O \n\n3.6.3 O algoritmo Gera_Bmin \n\nO algoritmo Gera.Bmin \u00e9 uma modifica\u00e7\u00e3o de Gera_Bma.x, com uma condi\u00e7\u00e3o \nadicional no comando if na linha 1: \n\nif d = O e (J0 , ... , In_ 1 ) possui alguma folha then \n\nend if \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin 28 \n\nLema 3. 7 O algoritmo Gera_Bmin executado sobre um lugar completo L encontra \ntodos os lugares completos de dimens\u00e3o zero (1) cujo v\u00e9rtice est\u00e1 em e (2) \ncuja profundidade P \u00e9 a maior poss\u00edvel. \n\nProva: A demonstra\u00e7\u00e3o \u00e9 an\u00e1loga \u00e0 do lema 3.6. A \u00fan\u00edca diferen\u00e7a \u00e9 que no \npasso 1, se a condi\u00e7\u00e3o \u00e9 satisfeita, obviamente L \u00e9 o lugar de maior profundidade \ncentrado no v\u00e9rtice v = F (L)_ \n\nSe d = O mas L' n\u00e3o possui folhas, ent\u00e3o F(L) ser\u00e1 um v\u00e9rtice v ortogonal \na todos os k eixos de coordenadas e o algoritmo ser\u00e1 chamado recursivamente \n(linhas 9 e 10) sobre as c\u00e9lulas filhas de L' que t\u00eam v como esquina, at\u00e9 chegar a \num lugar L', onde L'\" tem alguma c\u00e9lula folha. Neste caso, a tenda T cujo suporte \n\u00e9 L'\" tem profundidade m\u00e1xima em F(L). D \n\nTeorema 3.4 O algoritmo (Gera_Bm\u00edn) executado sobre uma grade di\u00e1d\u00edca G \nk-d\u00edmens\u00edonal encontra a base Bmin de \n\nProva: Tamb\u00e9m executando Gera_Bmin sobre o lugar L, cuja estrela L' cont\u00e9m \napenas a c\u00e9lula raiz de G, encontraremos pelo lema 3.7 todos os v\u00e9rtices completos \nno dom\u00ednio de G, (F(L)), e um conjunto de \u00edndices representando as tendas de \nmenores suportes em G com centro nestes v\u00e9rtices. D \n\n3.6.4 A complexidade de Gera_Bmax e Gera_Bmin \n\nCalcularemos o tempo de execu\u00e7\u00e3o dos algoritmos GeraJ3max e Gera_Bmin, ca-\npazes de encontrar respectivamente as bases Bmax e Bmin de uma grade di\u00e1dica G \nde dimens\u00e3o k, em fun\u00e7\u00e3o do n\u00famero n de c\u00e9lulas folha de G. Este n\u00famero reflete \na complexidade da grade G, independente da forma com que ela foi refinada. \n\nToda grade di\u00e1dica \u00e9 o resultado de uma s\u00e9rie de divis\u00f5es de sua c\u00e9lula raiz. \nCada divis\u00e3o acrescenta exatamente duas c\u00e9lulas \u00e0 grade, o que em sua estrutura \nde \u00e1rvore bin\u00e1ria significa transformar uma c\u00e9lula folha na m\u00e3e de duas novas \nc\u00e9lulas folha. Da mesma forma, o n\u00famero de c\u00e9lulas folha \u00e9 incrementado de uma \nunidade. Assim, se G tem n c\u00e9lulas folha, ent\u00e3o foi gerada a partir de n - 1 \ndivis\u00f5es de sua c\u00e9lula ra\u00edz, e possui (2 x n)- 1 c\u00e9lulas ao totaL \n\nSuponhamos que G \u00e9 bidimensional, e seja G uma c\u00e9lula de G. A c\u00e9lula G \npode, no m\u00e1ximo, pertencer \u00e0 estrela de 4 lugares de dimens\u00e3o O + 4 lugares de \ndimens\u00e3o 1 + um lugar de dimens\u00e3o 2 = 9 lugares distintos. Como Gera_Bm\u00edn \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin 29 \n\nverifica cada lugar de G uma \u00fanica vez, ent\u00e3o n\u00e3o pode ter um tempo de execu\u00e7\u00e3o \nsuperior a 9 x x n) -1), ou seja, sua complexidade \u00e9 da ordem de 8(n) quando \nexecutado sobre grades bidimensionais. \n\nSe C \u00e9 uma c\u00e9lula de uma grade G tridimensional, uma verifica\u00e7\u00e3o an\u00e1loga \nnos indica que no m\u00e1ximo C pode fazer parte da estrela de 27 lugares distintos. \nPortanto, como G tamb\u00e9m possui (2 x n)- 1 c\u00e9lulas neste caso, ent\u00e3o Gera_Bmin \ntamb\u00e9m tem complexidade da ordem de 8(n) quando executado sobre grades \ntridimensionais. Considerando que o algoritmo Gera.J3max verifica uma quanti-\ndade de lugares menor ou igual ao n\u00famero total de lugares de G, ent\u00e3o possui \ncomplexidade m\u00e1xima igual \u00e0 de Gera_Bmin. \n\n\n\n3. 6. Determina\u00e7\u00e3o de bases Bmax e Bmin 30 \n\n\n\nCap\u00edtulo 4 \n\nAproxima\u00e7\u00e3o por \nquadrados \n\n, . \nillllllillOS \n\nA aproxima\u00e7\u00e3o por m\u00ednimos quadrados \u00e9 uma t\u00e9cnica bastante conhecida, O uso \nde tendas nestes casos pode ser vantajoso, considerando a estrutura simples destas \nfun\u00e7\u00f5es, de f\u00e1cil armazenamento e manipula\u00e7\u00e3o, Al\u00e9m disso, na aproxima\u00e7\u00e3o de \nfun\u00e7\u00f5es muito irregulares, podemos refinar as bases at\u00e9 alcan\u00e7armos o grau de \nprecis\u00e3o requerido, sem desperd\u00edcio de recursos, \n\n4.1 Aproxima\u00e7\u00e3o por m\u00ednimos quadrados \n\nSeja u(x) uma fun\u00e7\u00e3o que queremos aproximar, definida sobre um dom\u00ednio rl \nde dimens\u00e3o k, Buscamos uma aproxima\u00e7\u00e3o que seja uma combina\u00e7\u00e3o linear \nu' (x) =I:;,;;~ aj'Pj(x), onde tp \u00e9 um conjunto linearmente independente de fun\u00e7\u00f5es \ndefinidas sobre [L Seja S' o espa\u00e7o gerado pela base (tpo,,,., 'Pn- 1 ). Segundo o \ncrit\u00e9rio dos m\u00ednimos quadrados, a melhor aproxima\u00e7\u00e3o para u no espa\u00e7o s\u00b7 \u00e9 a \nque minimiza a dist\u00e2ncia \n\n!lu- u'll =(L (u(x)- u'(x)) 2 dx) 112 \nonde dx = dxk- 1 .\u2022\u2022 dx 0 . A eqna\u00e7\u00e3o (4.1) pode ser escrita tamb\u00e9m como \n\nllu u'll = (u- u', u- u') 112 \n\nonde (,) denota o produto escalar de duas fun\u00e7\u00f5es sobre rl, definido por \n\n(f, g) =In f(x)g(x)dx \n31 \n\n(4.1) \n\n(4.2) \n\n\n\n4.2. O produto escalar de fun\u00e7\u00f5es tenda 32 \n\nPor brevidade, omitiremos o argumento \"(x)\" nas integrais a seguir. \nVerifica-se que minimizar (4.1) equivale a tomar u' a proje\u00e7\u00e3o ortogonal deu \n\nsobre o espa\u00e7o de aproxima\u00e7\u00e3o s\u00b7' ou seja, resolver as equa\u00e7\u00f5es \n\n(u-v:,cp;)=O = i(u-u')cp1dx=O i = O, ... , n - 1 \n\nOu seja, \nn-1 \n\ni ( u- L OJ'PJ)cp1dx =O \nn J=O \n\ni = O, ... , n - 1 (4.4) \n\nDesenvolvendo o lado direito desta equa\u00e7\u00e3o para um dado i, obtemos \n\nn-l n-l \n\ni u cp,dx- 1 (L OJ'P;)'P1dx = 1 u '\u00c71dx- L aJ \nn n j=O n j=O \n\nde maneira que podemos reescrever as equa\u00e7\u00f5es ( 4.4) como \n\nn-1 \n\nL aJ 1 'PJ'Pidx = 1 u cp,dx \nj=O n n \n\nO, .. . ,n- 1 (4.5) \n\nEsta f\u00f3rmula \u00e9 o Sistema Normal de n equa\u00e7\u00f5es lineares sobre n vari\u00e1veis, os \ncoeficientes a0 , ..\u2022 , On-l\u00b7 Sua representa\u00e7\u00e3o matricial tem a forma E a = b, onde \nE \u00e9 uma matriz n x n, e b \u00e9 um vetor coluna de tamanho n, definidos por \n\nEiJ =('?i, 'P;) bi = (u, 'Pi) i, j = O, ... , n- 1 \n\n4.2 O produto escalar de fun\u00e7\u00f5es tenda \n\nNesta se\u00e7\u00e3o mostramos como calcular o produto escalar (cp;, 'Pj) de duas fun\u00e7\u00f5es \ntenda, necess\u00e1rio \u00e0 composi\u00e7\u00e3o da matriz E do sistema (4.5). Na se\u00e7\u00e3o 4.3 \nmostraremos uma f\u00f3rmula gen\u00e9rica para o c\u00e1lculo aproximado de um elemento \nb; = (u, cp;), para uma fun\u00e7\u00e3o qualquer f. \n\nSejam r' e r\" duas tendas definidas sobre uma grade di\u00e1dica G de dimens\u00e3o k. \nObviamente, para calcular o produto escalar (r', r\") precisamos calcular a integral \n(4.2) apenas na regi\u00e3o R (figura 4.1) coberta pelos suportes das duas tendas. \n\n\n\n4.2. O produto escalar de \u00cdun\u00e7\u00f5es tenda 33 \n\nT R \n\n~1 1 .~1. I ; ' . I I l t \nFigura 4.1: Tendas T', , e a regi\u00e3o R comum aos suportes destas \nfun\u00e7\u00f5es. \n\nSupondo sem perda de generalidade que o posto de .,-' \u00e9 maior ou igual ao \nposto P\" de r', verifica-se que esta regi\u00e3o \u00e9 a uni\u00e3o de no m\u00e1ximo 2k c\u00e9lulas \nCb, ... , c;,_ 1 de posto P', contidas no suporte de r'. Portanto, podemos escrever \n\nf,,..! \n\\' ) T\n\n1T\"dx \n\nNo restante desta se\u00e7\u00e3o veremos como calcular a integral fc r'r\"dx, para uma \nc\u00e9lula C' = Cj. \n\nPela defini\u00e7\u00e3o (3.1), \n\nk-l k-1 \n\nr'(x) = IJ A(2ifkQ;x;- o;) e r'(x) IJ A(21/kQ;'x1 - 6;') (4.7) \ni=O i:::::O \n\nSeja C\" a c\u00e9lula do suporte de r\" que cont\u00e9m a c\u00e9lula C' (figura 4.2). \n\nFigura 4.2: A c\u00e9lula C' de r' est\u00e1 contida na c\u00e9lula C\" de r\". \n\nPara x em C', podemos reescrever a f\u00f3rmula da tenda r\" como \n\nk~l k-l \n\nr\"(x) = lJ J\\(2 1/kQ;'x;- 5;') = lJ A(a;(2'fkQ;x1 - 5;) + 8;) \ni=O i=O \n\nNestas f\u00f3rmulas, a 1 \u00e9 o tamanho do suporte de r' em rela\u00e7\u00e3o ao suporte de r\" \nna dire\u00e7\u00e3o i, e (31 = (2ifkQ;' v[ - \u00edi;') onde v' \u00e9 o v\u00e9rtice central do suporte de r'. \n\n\n\n4,2. O produto escalar de fun\u00e7\u00f5es tenda 34 \n\nPortanto, a parcela do produto escalar (T1, r') correspondente a C' \u00e9 a integral \n\nk-1 k-1 \n\nA(2'ikQ;x,- \u00e1;) A(a,(21/kQ;x,- o;)+ 31)dxk-l,,, dx 0 (4.8) \ni=O \n\nonde xi e s\u00e3o respectivamente as posi\u00e7\u00f5es de C' mais pr\u00f3xima e mais distante \nda origem ao longo do eixo i, Uma vez que cada fator da produt\u00f3ria depende de \numa \u00fanica coordenada x1, podemos separar as integrais, ou seja, usar a identidade \n\nE' i:! f(x)g(y)dydx = (Ef f(x)dx) (l~f g(y)dy) \ne reordenar a express\u00e3o ( 4.8) como segue: \n\n( 4.9) \n\nPara simplificar, fazemos as seguintes mudan\u00e7as de vari\u00e1veis \n\n2ifkQt \u00f3'' u1- = -x-- . I I I portanto (4.10) \n\ne transformamos a equa\u00e7\u00e3o (4.9) em \n\nk-1 uf \n\nIJ(2i/kQ;)- 11o' A(u1)A(cqu; + p;)du; \ni=O ui \n\nSe C' for uma c\u00e9lula inferior de T 1 na dire\u00e7\u00e3o i, isto \u00e9, se ao longo do eixo i a c\u00e9lula \nC' estiver entre o v\u00e9rtice central v' e a origem, os limites de integra\u00e7\u00e3o [uf, u{J \nnesta dire\u00e7\u00e3o ser\u00e3o [-L O] e A(u,) ser\u00e1 1 + u,. Por outro lado, se C' for superior \nna dire\u00e7\u00e3o i, isto \u00e9, se v' estiver entre C' e a origem nesta dire\u00e7\u00e3o, estes limites \nde integra\u00e7\u00e3o ser\u00e3o [0, 1] e A(u;) ser\u00e1 1- u;. Analogamente, se C\" for uma c\u00e9lula \ninferior de T 11 na dire\u00e7\u00e3o i, ent\u00e3o A(aiui+/3,) = l+o:;ui+/3,; caso contr\u00e1rio, temos \nque A(aiui + p;) = 1- a;u;- ,81. Portanto, a integral no fator i da produt\u00f3ria \npode ser desenvolvida de quatro meneiras: \n\n\" C' e C\" inferiores, \n\nl o ( a B\u00b7 1) (1 +u)(1 +au + B)du = _ _:. + ~ +-&lt;t tt ,! l 6 2 2 -1 ( 4.11) \n\n\n\n4.3. Produto escalar de fun\u00e7\u00f5es gerais \n\ne C' inferior e C\" superior~ \n\n(1 + u)(l- Oi u - 31du = ' ~ ~ ~ ' !; z \n\ne C' superior e cn inferior) \n\n[(1-\ne C' e C\" superiores, \n\n1' (l u;)(l- Oi; ui- 8i)du; \n4.3 \n\n--+ \n6 2 \n\n8 \n+ ' ' -\n\n5 2 \n\ngerms \n\n35 \n\n1 \n\n1 \n\n2 \n\n(4.14) \n\nPara calcular um elemento do vetor b do sistema ( 4.5) precisamos calcular a \nintegral fn u pdx onde u \u00e9 uma fun\u00e7\u00e3o arbitr\u00e1ria. Normalmente esta integral n\u00e3o \npossui uma f\u00f3rmula expl\u00edcita. Portanto, devemos usar um m\u00e9todo de integra\u00e7\u00e3o \nnum\u00e9rica para calcular uma aproxima\u00e7\u00e3o da mesma. \n\n4.3.1 Quadratura de Gauss \n\nUma boa escolha neste sentido \u00e9 a quadratura de Gauss, que em uma dimens\u00e3o \u00e9 \n\na aproxima\u00e7\u00e3o \n\n1~\n1 \n\nj(t)dt o:e ~ Cjj(tj) (4.15) \n\npara certos pontos tj E [ -1, + 1] e certos coeficientes cj. Os pontos tj s\u00e3o as ra\u00edzes \nde algum polin\u00f4mio de grau n + 1 de uma fam\u00edlia H de polin\u00f4mios ortogonais no \nintervalo [ -1, + 1], e os coeficientes Cj s\u00e3o \n\n+1 \n\ncj =f lj(x)dx, \n-1 \n\nonde 10 , ... , ln s\u00e3o os polin\u00f4mios de Lagrange sobre esses pontos [Pis80]. Esco-\n\nlhendo para H os polin\u00f4mios de Legendre, podemos usar valores j\u00e1 tabelados de \nCj e tj\u00b7 Quanto maior o n, melhor ser\u00e1 a precis\u00e3o do resultado. Em particular, \nse f for um polin\u00f4mio de grau 2n + L o resultado da integra\u00e7\u00e3o \u00e9 exato. \n\n\n\n4,3, Produto escalar de fun\u00e7\u00f4es gerais 36 \n\nOs pontos e coeficientes da f\u00f3rmula de quadratura de Gauss-Legendre s\u00e3o \ntabelados para o intervalo de integra\u00e7\u00e3o [-1 1 1]. Para calcular a integral num \nintervalo gen\u00e9rico b], \n\n1&amp; f(x)dx \nprecisamos fazer a substitui\u00e7\u00e3o de vari\u00e1vel \n\nb-a b+a \nX= --t+--\n\n2 2 \nde modo que se x = a, t = ex= b, t =+L Temos ent\u00e3o \n\nt 1' b - a b - a b + a la f(x)dx = -l ~ J(-\n2\n-t + - 2-)dt \n\ne portanto a f\u00f3rmula ( 4,15) fica \n\nb-a~ \nf(x )dx = -\n\n2\n- L-\n\nJ=\u00fc \n\nPara n = 10, usamos os seguintes valores de tj e C1: \n\ntj cj \n\n-0,973906528517172 0,066671344308688 \n-0,865063366688985 0,149451349150581 \n-0,679409568299024 \n\nI \n0,219086362515982 \n\n-0,433395394129247 1 0,269266719309996 \n-0,148874338981631 0,295524224714753 \n0,148874338981631 0,295524224 714 753 \n0,433395394129247 0,269266719309996 \n0,679409568299024 0,219086362515982 \n0,865063366688985 0,149451349150581 \n0,973906528517172 0,066671344308688 \n\nTabela 4,1: Valores de tJ e Cj, para n = 10, \n\n4.3.2 Integra\u00e7\u00e3o em k vari\u00e1veis \n\n(4,16) \n\nSe f \u00e9 uma fun\u00e7\u00e3o de k vari\u00e1veis, e fl \u00e9 uma caixa com proje\u00e7\u00f5es [-1, +1] em \ncada eixo i, ent\u00e3o a f\u00f3rmula de quadratura de Gauss fica \n\n( 4.17) \n\n\n\n4.4. Exemplos usando grades regulares 37 \n\nOu seja, a fun\u00e7\u00e3o f \u00e9 calculada numa grade com ( n + 1 )k pontos cujas co-\nordenadas s\u00e3o todas as combina\u00e7\u00f5es , tj,, . .. , dos pontos t1o \nda f\u00f3rmula 15); e os valores obtidos s\u00e3o somados com pesos correspondentes \nc]O' cj;' ... ' CJk-'. Quando o dom\u00ednio Q \u00e9 uma caixa geraL com proje\u00e7\u00e3o bj \nem cada eixo i, a f\u00f3rmula (4.17) deve ser ajustada conforme a f\u00f3rmula (4.16). \n\nA integral J\" u cp onde cp(x) \u00e9 uma fun\u00e7\u00e3o da base e u(x) \u00e9 uma fun\u00e7\u00e3o geraL \npode ser ent\u00e3o aproximada aplicando-se a quadratura de Gauss \u00e0 fun\u00e7\u00e3o f = \nu x :p. No caso particular em que cp \u00e9 uma tenda r, \u00e9 prefer\u00edvel calcular a integral \nseparadamente sobre cada uma das c\u00e9lulas do suporte de r(x). \n\nPara testar a qualidade dos espa\u00e7os de splines di\u00e1dicos E 1 [ G] como espa\u00e7os apro-\nximantes, aplicamos o m\u00e9todo dos m\u00ednimos quadrados para as fun\u00e7\u00f5es da tabela \n4.2 usando v\u00e1rias grades regulares G. Uma vez que todas as fun\u00e7\u00f5es do espa\u00e7o \nE1 [G] s\u00e3o nulas na fronteira da c\u00e9lula raiz, escolhemos para teste fun\u00e7\u00f5es com esta \nmesma caracter\u00edstica. \n\nnome f\u00f3rmula \nsxsy \n\ngauss exp(-((x- 0,5) 2 + (-/2y- 0,5) 2 )/0,005) i \ntendaR A(2x- 1)A(2-/2y- 1) \\ \n\nTabela 4.2: Fun\u00e7\u00f5es para testes do m\u00e9todo de m\u00ednimos quadrados. \n\nUtilizamos as bases de tendas maximais (Bmax) e minimais (Bmin) obtidas a \npartir dos n\u00edveis 6, 8 e 10 da grade di\u00e1dica bidimensional infinita. Para avaliarmos \nnumericamente cada aproxima\u00e7\u00e3o, calculamos a dist\u00e2ncia li u - u'\\\\ pela f\u00f3rmula \n(4.1) entre as fun\u00e7\u00f5es originais e as fun\u00e7\u00f5es aproximadas. Neste c\u00e1lculo, a integral \n(4.1) foi obtida por quadratura de Gauss (se\u00e7\u00e3o 4.3.1) aplicada separadamente \npara cada c\u00e9lula da grade G. Os resultados destes c\u00e1lculos s\u00e3o mostrados na \ntabela 4.3. Esta tabela serve tanto para a base Bmax quanto para a base Bmin, \npois os resultados obtidos foram praticamente id\u00eanticos para ambas as bases. \n\n\n\n4.4. Exemplos usando grades regulares \n\nn\u00edvel 6 s 1 10 \n,\\ 0,1531 o,o765 1 o,o3ss \n\n\\ sxsy 1\n1 \n\n0,01468220 o,oo3479\u00fc7 I o,ooos5685 \ngauss I 0,01386992 0,00297978 I o,oo068360 \n\n1 tendaR I 6,3x 10 17 6,8x10 17 I 6,0xl0 17 \n\nTabela 4.3: Dist\u00e2ncias li u - u' li cacu\u00edadas para cada base de \naproxima\u00e7\u00e3o. O par\u00e2metro .\\ \u00e9 o di\u00e2metro das c\u00e9lulas da grade. \n\n38 \n\nAs figuras 4.3 a 4.5 ilustram estas fun\u00e7\u00f5es, suas aproxima\u00e7\u00f5es nas tr\u00eas grades \ne os respectivos res\u00edduos u - u\u2022. Cada fun\u00e7\u00e3o f est\u00e1 representada em curvas de \nn\u00edvel. O par\u00e2metro 61 \u00e9 o espa\u00e7amento entre os n\u00edveis, sendo o primeiro n\u00edvel \n(~) aJ/2. O par\u00e2metro 62 \u00e9 o \u00faltimo n\u00edvel tra\u00e7ado. A regi\u00e3o entre os n\u00edveis -5!/2 \ne n\u00e3o \u00e9 pintada; tons vermelhos indicam valores positivos e tons azuis \nnHlJC,am valores negativos. Os valores de o1 e 52 est\u00e3o indicados nas legendas de \ncada figura. Todos os gr\u00e1ficos de fun\u00e7\u00f5es em curvas de n\u00edvel no restante deste \ntrabalho devem ser interpretadas da mesma forma. \n\n\n\n4.4. Exemplos usando grades regulares \n\nn\u00edvel 6 \n\nu- u* \n\nn\u00edvel 10 u- u* \n-'T,-, ,----c :_:c\u00b7:-- : __ C:::J \n\nfc)i \n,_,_::,-&lt;: :.: \n\nH \n\n?::: '::.: ' \n-+-- : ,_ : --:, \n\nFigura 4.3: A fun\u00e7\u00e3o sxsy e suas aproxima\u00e7\u00f5es por m\u00ednimos quadrados \nnas bases Bmin de n\u00edveis 6, 8, e 10, tra\u00e7adas com :h = O, 08 e 62 = 1, 2. \nOs res\u00edduos u - u* foram tra\u00e7ados com o1 = O, 008 e 82 = O, 12. \n\n39 \n\n\n\n4.4. Exemplos usando grades regulares \n\nu = gauss \n\nn\u00edvel 6 u - u* \n\nn\u00edvel 8 u -u* \n\nn\u00edvel 10 u - u* \n.. ,., .... , T c\u00b7 '\u00b7- ... , .......... \nc ' .. \n\n' '\"'\"' \n\n\u2022 .., \u2022. , '''[C:: \u00b7\u00b7\u00b7\u00b7- :-: ... r. \u00b7' L\u2022:' \n\u2022.......... \n\nFigura 4.4: Fun\u00e7\u00e3o gauss e aproxima\u00e7\u00f5es nas bases Bmin de n\u00edveis 6, 8, e \n10, com o1 = O, 08 e o2 = 1, 2. Para os res\u00edduos u- u*, foram usados \n61 = O, 008 e o2 = O, 12. \n\n40 \n\n\n\n4.4. Exemplos usando grades regulares \n\nu = tendaR \n\nn\u00edvel 6 u - u* \n\nn\u00edvel 8 u- u* \n' --~---- \u00b7:_c\u00b7\u00b7--\n\n..... __ -\u00b7\u00b7,\u00b7\u00b7\u00b7-\u00b7 .. i : \n.. \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7- \u00b7\u00b7\u00b7\u00b7-\n\n' -\u00b7 \n[ t . --t:-:. - \u00b7- ---\n\ni \n.. ' - - . - -\n\n1-----\u00b7--;--- - - ' -- \u00b7-' ' - 1- i \n\n'r--T \n' ' \n\n. \n\nn\u00edvel 10 u - u* \n-, --- - ' ,,.. --- ... \n\nr ,_' \nr \u2022\u2022 --\n\n: \n\n' ' .- ' . ,_. _____ - ' ' -\nh \n\n,_ . -. ,_,_, '\u2022 r- -,--. \u00b7+ri\u00b7\u2022 ' - - c\u2022c+. \n---, \n\n_,_ \n\nFigura 4.5: Fun\u00e7\u00e3o tendaR e aproxima\u00e7\u00f5es nas bases Bmin de n\u00edveis 6, 8, \ne 10 com 81 = O, 08 e o2 = 1, 2. Os res\u00edduos u -- u* possuem 61 = O, 008 e \n02 =o, 12. \n\n41 \n\n\n\n4.5. Aproxima\u00e7\u00f5es com refinamento da grade 42 \n\nComo previsto, todas as aproxima\u00e7\u00f5es da fun\u00e7\u00e3o tendaR (que pertence ao \nespa\u00e7o E1 [G], apesar de n\u00e3o estar na base Bmin) s\u00e3o praticamente iguais \u00e0 fun\u00e7\u00e3o \noriginal; os res\u00edduos s\u00e3o desprez\u00edveis e refletem apenas erros de arredondamento. \nNo caso das fun\u00e7\u00f5es sxsy e gauss, o erro \u00e9 aproximadamente proporcional ao \nquadrado do di\u00e2metro \u00c0 das c\u00e9lulas, como esperado pela teoria para aproxima\u00e7\u00f5es \nde grau um. \n\n4.5 Aproxima\u00e7\u00f5es com refinamento da grade \n\nOs gr\u00e1ficos do res\u00edduo u- u' evidenciam que os erros de aproxima\u00e7\u00e3o normalmente \nconcentram-se onde as fun\u00e7\u00f5es originais possuem maior curvatura ao longo dos \neixos. Interessa portanto escolher uma grade irregular G mais refinada onde \u00e9 \nmais dif\u00edcil simular o comportamento de u usando tendas. Isto permite obter uma \naproxima\u00e7\u00e3o u\" bastante precisa, com uma base B de dimens\u00e3o muito menor. \n\nPara fins de teste, usamos grades constru\u00eddas pelo algoritmo recursivo 4.5.1 \n(Refina_Grade). Suas entradas s\u00e3o a fun\u00e7\u00e3o a a ser aproximada; a dimens\u00e3o k; o \n\u00edndice I e profundidade P de uma c\u00e9lula C; um par\u00e2metro lim; e a profundidade \nm\u00e1xima Pmax\u00b7 O algoritmo divide a c\u00e9lula C e suas descendentes at\u00e9 que o \nseguinte crit\u00e9rio de divis\u00e3o n\u00e3o seja mais satisfeito. Chamamos de canto inferior \no ponto r de C mais pr\u00f3ximo da origem e de canto superior o ponto s de C mais \ndistante da origem. A face inferior de C na dire\u00e7\u00e3o i \u00e9 o subconjunto dos pontos \nda face F( C) com coordenada r[i] no eixo i (com dimens\u00e3o k -1) e a face superior \nde C na dire\u00e7\u00e3o i \u00e9 a face an\u00e1loga. O crit\u00e9rio de divis\u00e3o consiste em verificar se a \ndiferen\u00e7a m\u00e1xima max_ var entre o valor de u no ponto central de C (linha 5) e as \ninterpola\u00e7\u00f5es dos valores de u nos pontos centrais das faces inferiores e superiores \nem cada dire\u00e7\u00e3o (linhas 6 a 19) \u00e9 maior do que o par\u00e3metro lim, respeitando o \nlimite de profundidade Pmax (linha 20). \n\nO tempo de execu\u00e7\u00e3o de Refina_Grade \u00e9 obviamente proporcional ao tamanho \nda \u00e1rvore constru\u00edda, que \u00e9 proporcional ao n\u00famero de c\u00e9lulas folha da mesma. \nNo pior caso, este algoritmo retoma uma grade G uniforme, onde todas as c\u00e9lulas \nfolha t\u00eam profundidade Pmax, com 2Pmox c\u00e9lulas folha, 2 x 2Pmox - 1 c\u00e9lulas no \ntotal (se\u00e7\u00e3o 3.6.4), com tempo de execu\u00e7\u00e3o da ordem de 8(2Pm\"\"). \n\n\n\n4.5. Aproxima\u00e7\u00f5es com refinamento da grade \n\nalgoritmo 4.5.1 Refina_Grade(u, k, I, P, lim, Pmax) \n\n1: C +- c\u00e9lula de \u00edndice I; \n2: ctr +- centro de (C); \n3: r +- canto inferior de (C); \n4: s +-canto superior de (C); \n5: max_var +-O; vaLctr +- u(ctr); \n6: for i : 1 -+ k do \n7: for j : 1 -+ k do \n8: if (j # i) then \n9 p'[j] +- ctr[j]; p\"[j] +- ctr[j]; \n\n10: else \n11: p'[i] +- r[i]; p\"[i] +- s[i]; \n12: end if \n13: end for \n14: vaLest +- + u(p\"))/2; \n15: 5 +- lvaLctr- vaLestl: \n16: if (o > max_ var) then \n17: max_var +- 5; \n18: end if \n19: end for \n20: if (max_var > lim) and (P &lt;Pmax) then \n21: D +- Refina_Grade( u, k, 21, P + 1, lim, Pmax); \n22: E+- Refina_ Grade( u, k, 21 + 1, P + 1, lim, Pmax); \n23: devolva uma \u00e1rvore G com sub-\u00e1rvores D e E; \n24: else \n25: devolva uma \u00e1rvore G com uma \u00fanica c\u00e9lula folha I; \n26: end if \n\n4.5.1 Exemplos usando grades refinadas \n\n43 \n\nAvaliamos a estrat\u00e9gia de refinamento local executando o algoritmo Refina_Grade \n(4.5.1) sobre a fun\u00e7\u00e3o gauss mostrada na tabela 4.2. Desta forma, encontramos \numa base Bmin irregular de tendas com profundidade m\u00e1xima 10, que utilizamos \npara encontrar uma nova aproxima\u00e7\u00e3o u' para a fun\u00e7\u00e3o gauss, tamb\u00e9m aplicando \na t\u00e9cnica de m\u00ednimos quadrados. \n\nNa figura 4.6 mostramos em curvas de n\u00edvel o resultado desta aproxima\u00e7\u00e3o, \njuntamente com as fun\u00e7\u00f5es u' obtidas atrav\u00e9s das bases Bmin regulares de n\u00edveis \n8 e 10, para fins de compara\u00e7\u00e3o. \n\n\n\n4.5. Aproxima\u00e7\u00f5es com refinamento da grade \n\nu = gauss \n\nn\u00edvel 8 u- u* \n\nu - u* \n\nn\u00edvel 10 u - u* \n--'- ' _,_ ' ,_,,,, \n\n' \n\n- -\n\n,_ \n\n-- llll '- Li:::_;_ \n' ----\n\n'---\n\nFigura 4.6: Fun\u00e7\u00e3o gauss e aproxima\u00e7\u00f5es nas bases Bmin regulares de \nn\u00edveis 8, 10 e em uma base Bmin irregular de n\u00edvel m\u00e1ximo 10, com \n51 =O, 08 e 52 = 1, 2. Os res\u00edduos u- u* possuem o1 =O, 008 e \n\u00f32 =o, 12. \n\n--\n\n-\n\n\n\n4.5. Aproxima\u00e7\u00f5es com refinamento da grade 45 \n\nAs dist\u00e2ncias !I u - u' jj e a dimens\u00e3o de cada base s\u00e3o dadas pela tabela 4.4 \nabaixo: \n\nI n\u00edvel 1 6 i 8 i m\u00e1ximo 10 lO \n961 dimens\u00e3o I 49 I 225 ' 389 \n\nI Jju- u'IJ i 0,01386992 [ 0,00297978 O 00069021 0,00068360 i \n\nTabela 4.4: Dimens\u00f5es das bases e dist\u00e2ncias Jlu- u'JI das \naproxima\u00e7\u00f5es. \n\nA tabela 4.4 e a figura 4.6 indicam que com o refinamento local obtivemos \numa aproxima\u00e7\u00e3o da fun\u00e7\u00e3o gauss quase t\u00e3o boa quanto a aproxima\u00e7\u00e3o realizada \natrav\u00e9s da base regular mais fina. Al\u00e9m disso, a base irregular possui dimens\u00e3o \npr\u00f3xima \u00e0 dimens\u00e3o da base regular de n\u00edvel 8, com bem menos tendas do que a \nbase regular de n\u00edvel 10. Isto confirma as vantagens do refinamento local neste \ntipo de aproxima\u00e7\u00e3o e a efic\u00e1cia do algoritmo Refina_ Grade. \n\n\n\n4.5. Aproxima\u00e7\u00f5es com refinamento da grade 46 \n\n\n\nCap\u00edtulo 5 \n\nSolu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais \nparciais lineares \n\nNeste cap\u00edtulo mostramos corno resolver equa\u00e7\u00f5es diferenciais parciais lineares \npelo m\u00e9todo de Galerkin, descrito num contexto geral. \n\n5.1 O m\u00e9todo dos res\u00edduos ponderados \n\nConsideremos urna equa\u00e7\u00e3o diferencial geral, \n\nL:(u)(x) =O xES1 (5.1) \n\nonde ,C \u00e9 um operador diferencial (possivelmente n\u00e3o linear), e u ( x) \u00e9 a fun\u00e7\u00e3o \nque queremos determinar, definida sobre um dom\u00ednio S1 de dimens\u00e3o k. Uma \nvez que em geral n\u00e3o existe uma express\u00e3o anal\u00edtica para u ( x), buscamos uma \naproxima\u00e7\u00e3o u'(x) dentro de um espa\u00e7o de fun\u00e7\u00f5es S' com dimens\u00e3o finita n- po-\nlin\u00f4mios, s\u00e9ries trigonom\u00e9tricas, etc. A fun\u00e7\u00e3o u'(x) \u00e9 portanto uma combina\u00e7\u00e3o \nlinear das fun\u00e7\u00f5es de uma base qualquer 'P = (<p 0 , ..\u2022 , 'Pn-r) de S': \n\nn-1 \n\nu*(x) =L ai'PJ(x) \nj=O \n\nDesta forma, para obtermos u'(x) ce u(x), basta encontrarmos os coeficientes \na 1, a2, ... , an mais adequados. \n\nIdealmente, dever\u00edamos procurar os coeficientes que minimizam a diferen\u00e7a \niiu(x)- u'(x)ll entre a solu\u00e7\u00e3o aproximada e a solu\u00e7\u00e3o exata. Entretanto, isto \n\n47 \n\n\n\n5.2. O m\u00e9todo de Galerkin 48 \n\nn\u00e3o \u00e9 pratic\u00e1vel em geraL No m\u00e9todo dos res\u00edduos ponderados, escolhemos os \ncoeficientes que minimizam o lado esquerdo da equa\u00e7\u00e3o diferencial (5.1). Embora \nn\u00e3o seja poss\u00edvel exigir que C(u')(x) seja zero para todo x, podemos exigir que \nele satisfa\u00e7a n equa\u00e7\u00f5es integrais da forma \n\nC(u*)(x)wi(x)dx =O i= O, ... , n- l \n\nonde cada wi \u00e9 uma fun\u00e7\u00e3o-peso arbitr\u00e1ria e dx = dxk-l ... dx 0 . \n\n5.2 O m\u00e9todo de Galerkin \n\nNo m\u00e9todo de Galerkin, as fun\u00e7\u00f5es de pondera\u00e7\u00e3o wi s\u00e3o as pr\u00f3prias fun\u00e7\u00f5es 'Pi \nda base de aproxima\u00e7\u00e3o. Portanto, as equa\u00e7\u00f5es ficam \n\nC(u*) \u00b7i= o) .. \u2022jn- 1 (5.2) \n\nque podem ser escritas como \n\n(C( u'), 'Pi) = O i= O, ... , n- 1 \n\nOu seja, no m\u00e9todo de Galerkin procuramos tornar o lado esquerdo de (5.1) \nortogonal \u00e0s fun\u00e7\u00f5es da base. Substituindo u'(x) por I:;j;;;~ aj'{Jj(x), podemos \nescrever a equa\u00e7\u00e3o (5.2) como r;(a) =O, onde a \u00e9 o vetor (a 1 , ... , an) e \n\nn-1 \n\nri( a)= 1 cri>j'fJj)(x)'Pi(x)dx \nn J=O \n\ni= O, ... , n- 1 (5.3) \n\n5.3 Equa\u00e7\u00f5es lineares \n\nNote que se C tem a forma C(u) = A(u)+g(x), onde A \u00e9 um operador diferencial \nlinear, esta express\u00e3o pode ser reescrita na forma \n\nri(a) = 1 (A(I: aJ'PJ)(x) + g(x)) 'Pi(x)dx = i= O, ... , n- 1 (5.4) \nn ;=O \n\nn-l \n\"L aj 1 A('PJ)(x)'Pi(x)dx + 1 g(x)'Pi(x)dx i= O, ... , n- 1 (5.5) \nj=O n n \n\nPortanto, as equa\u00e7\u00f5es ri (a) = O formam um sistema tamb\u00e9m linear de n equa\u00e7\u00f5es, \nnas vari\u00e1veis a 1 , ... , an, que pode ser resolvido diretamente. Neste caso, o m\u00e9todo \nde Galerkin geralmente \u00e9 bastante eficaz [Joh87]. \n\n\n\n5.3. Equa\u00e7\u00f5es lineares \n\n5.3.1 Reduzindo a ordem das derivadas \n\nQuando a equa\u00e7\u00e3o (3.2) possui alguma integral na forma \n\nr (v\u00b7 W)pdx \nlr.l \n\n49 \n\n(5.6) \n\nonde W \u00e9 uma f\u00f3rmula vetorial envolvendo derivadas e 'P\u00e9 uma fun\u00e7\u00e3o da base, po-\ndemos reduzir a ordem das derivadas utilizando o teorema da diverg\u00eancia [Lei94]. \nEste teorema afirma que \n\nv. (Wp) = w. (vp) +(v. W)p (5.7) \n\nportanto \n(v. W)p v. (Wp)- w. (vp) \n\nr (v. W)pdx = r v. (W p)dx- r W \u00b7 (vp)dx \nJn Jn ln \n\n(3.8) \n\nPelo teorema de Green [Lei94], o primeiro termo no lado direito da f\u00f3rmula (5.8) \npode ser reescrito como \n\nrv.(Wp)dx= r (WiD)\u00b7ads \nlo. lao. \n\nonde ()Q representa a fronteira da regi\u00e3o Q, a \u00e9 o vetor normal \u00e0 fronteira num \ndeterminado ponto, e ds \u00e9 um elemento infinit\u00e9simo dessa fronteira. Logo, a \nf\u00f3rmula (5.8) fica \n\nr (v\u00b7 W)pdx = r (Wp) \u00b7 ads- r W \u00b7 (v\\D)dx \nJn lan Jn \n\n(5.9) \n\nNo nosso caso, Q \u00e9 a c\u00e9lula ra\u00edz de uma grade di\u00e1dica e cp \u00e9 uma tenda, que \u00e9 zero \nna fronteira ()Q da mesma. Portanto a express\u00e3o (5.6) reduz-se a \n\nr iD(V \u00b7 W)dx =- r (Vp) \u00b7 !Vdx \nln Jn \n\n(5.10) \n\n\n\n5.3. Equa\u00e75es lineares 50 \n\n5.3.2 A equa\u00e7\u00e3o de Helmholtz \n\nComo exernp\u00edo consideremos a equa\u00e7\u00e3o de Helmholtz \n\n(5.11) \n\n\u00e9 o operador lapladano, b \u00e9 urna constante e f \u00e9 urna fun\u00e7\u00e3o de 11 e de \nx. Note que, quando f n\u00e3o depende da solu\u00e7\u00e3o 11, a equa\u00e7\u00e3o (5.11) \u00e9 linear. A \nequa\u00e7\u00e3o de Helmholtz \u00e9 muito usada em geod\u00eancia, meteorologia, etc. [Gorn99, \nVve93] \n\nSubstituindo u pela aproxima\u00e7\u00e3o u', e aplicando o m\u00e9todo de Galerkin (equa\u00e7\u00e3o \n(5.2)), obtemos \n\n('\\72 u' + bu')(x):p,(x)dx = f(u* x)cpi(x)dx i= O, .. , n- 1 (5.12) \n\nPara simplificar, omitiremos novamente o argumento nas integrais que se-\nguem. Escrevendo u* como a. combina\u00e7\u00e3o linear I:;,:~ airpJ e desenvolvendo o \nlado esquerdo da equa\u00e7\u00e3o (5.12), obtemos \n\nn-l n-1 \n\nL a, 1 ('\\l 2 cp,)tprdx + b L a, 1 'f'jridx \nJ=O n J=O n \n\n(5.13) \n\nReduzindo a ordem das derivadas, conforme a se\u00e7\u00e3o 5.3.1, decompomos o operador \nlaplaciano na expres\u00e3o (5.13) em termos de gradientes, na forma \n\nn-1 \n\nL aj 1 ('17 if'j) \u00b7 ('V 'Pr) + b( if!j'Pr)dx \nj=O Q \n\nde maneira que obtemos o sistema \n\ni= O, ... , n- 1 \n\n\n\n5.3. Equa\u00e7\u00f5es lineares 51 \n\nEm forma matricial, o sistema \u00e9 Ea g, onde a \u00e9 o vetor (coluna) dos coeficientes \ndeu~, E \u00e9 a matriz n x n tal que \n\n(vcc 1 \u00b7(V c;)'-'- b,1 cJcc ldx , T)J , Z I ,rJrl; \n\ne g \u00e9 o vetor (coluna) tal que g1 = fcpidx. \n\no produto escalar (v r', v r\") dos gradientes de duas tendas, assim como o produto \nescalar entre elas (se\u00e7\u00e3o 4.2), tamb\u00e9m pode ser decomposto na soma de integrais \n\nsobre as c\u00e9lulas da tenda de maior profundidade contidas no dom\u00ednio da tenda de \n\nmenor profundidade. Ou seja, \n\n(5.14) \n\nonde Cj \u00e9 uma c\u00e9lula do suporte D' da tenda r', o qual supomos ser menor do \nque o suporte D\" da tenda r\", e Cj E (D' n D\"). \n\nDesta forma, usamos a mesma t\u00e9cnica da se\u00e7\u00e3o ( 4.2) para calcularmos (VT', v r\"). \nA partir da defini\u00e7\u00e3o ( 3.1) de uma tenda, podemos escrever os gradientes V r' e \nv r\" como dois vetores de k elementos tais que \n\ne \n\nk-l \n\n(v r'),= (2ifkQ;) r(2i/kQ;xi- o;) I1 A(2iikQjx1 - oj) \nj=O,j:f;i \n\nk-1 \n\n(5.15) \n\n(VT\")i = (2ifkrJ;a,) f(ai(2ifkrJ;xi- o;)+ Pi) I1 A(aj(2jfkQjxj- \u00f3j) + PJ) \nj=O,j:f:-i \n\nonde r \u00e9 a derivada da fun\u00e7\u00e3o A (figura 5.1), definida por \n\n{ \n\n-1 \n\nf(x) = O \n+1 \n\nse0:<;x:S:1 \n\nse lxi > 1 \nse -l:S:x<O \n\n(5.16) \n\n(5. 17) \n\n\n\n5.3. Equa\u00e7\u00f5es lineares 52 \n\n1,0 1,0 \n\n0,0~0,0 0,0 0,0 \n( -1) (1) (\u00b71) (1) \n\n\u00b71,0 \n\nFigura 5.1: Fun\u00e7\u00f5es A (esquerda) e r (direita). \nO produto escalar (vr', vr\"), restrito a C', \u00e9 dado por \n\nxf xf k-l k-1 1 o ... r k-1 I:>i TI i\\(2jfkQjx;- oj)A(ai(2jfkQjx; oj) + ,Bi)dxk-1 ... dxo \nxg \"xk-1 i=D j=O,j:P,i \n\n(5.18) \n\ntal que \n\nJl.i = f(2'1\u2022Q;xi- 6,) (2ifkQ;) r(ai(2ifkQ;x,- \u00f3i) + Pi) (2iikQ;a;) \n\nonde os valores de xf, x{, a 1 e (31 s\u00e3o os mesmos da se\u00e7\u00e3o 4.2, usados na equa\u00e7\u00e3o \n(4.8). Desenvolvendo a equa\u00e7\u00e3o (5.18), obtemos \n\n(5.19) \n\nSeparando as integrais, e observando que p 1 \u00e9 constante dentro da c\u00e9lula C', \n\n~ Jl.i (E{ ldxi) fi (EJ A(zilkQjx;- oj)A(ai(2jfkQjx,- oj) + Pi)dx,) \nz=O x, J=\u00dc,Jr~ i \n\n(5.20) \n\nConsiderando que fx~{ ldx1 = x{- xf = (211\u2022Q;J- 1 , e realizando as mudan\u00e7as de \nvari\u00e1veis ( 4.10), obte'mos \n\nk-1 k-1 ~ \n\nI>i(2ifkQ;)-l TI (2JikQj)-l L' A(uJ)i\\(aiUJ + (J,)dui \ni=O j=O,j:;ii uj \n\n(5.21) \n\nl k-1 k-1 uf_ \n\nk 1 . I>i TI 1 'A(u,)i\\(aiu; + Pi)du1 (5.22) \nnj=O (2JfkQj) i=O j=O,J?'i uj \n\nf \n\nAs integrais J:J A(uJ)A(a(UJ + (31)du1 podem ser calculadas atrav\u00e9s das f\u00f3rmulas \nJ \n\n(4.11) a (4.14). \n\n\n\n5.4. Exemplo 53 \n\n5.4 Exemplo \n\nPara testar numericamente esta \nequa\u00e7\u00e3o de Helmholtz: \n\nresolvemos especificamente a seguinte \n\n+O, 5u = -911 2 +O, 5(sin(rrx) sin(2v'21ry)) \n\ncuja solu\u00e7\u00e3o exata \u00e9 a fun\u00e7\u00e3o \n\nu = sin( 1rx) sin(2Y21ry) \n\n(5.23) \n\n(5.24) \n\nUsamos 4 bases Bmin de aproxima\u00e7\u00e3o, extra\u00eddas das grades di\u00e1dicas uniformes de \nprofundidades 6, 8, 10, e de uma grade irregular de profundidade 10. Constru\u00edmos \na grade executando o algoritmo 4.5.1 (Refina_Grade) sobre a fun\u00e7\u00e3o \n(5.24), representada em curvas de n\u00edvel na figura 5.2. As solu\u00e7\u00f5es aproximadas e \no erro llu- u*ll de cada teste s\u00e3o mostrados na figura 5.3. \n\nFigura 5.2: Solu\u00e7\u00e3o exata da equa\u00e7\u00e3o (5.23) de Helmholtz, com \u00f31 = O, 1 \ne \u00d32 1,1. \n\n\n\n5.4. Exemplo \n\nn\u00edvel 6 u - u* \n\nn\u00edvel 8 u - u* \n\nn\u00edvel m\u00e1ximo 10 u - u* \n\nn\u00edvel 10 u - u* \n\nFigura 5.3: Solu\u00e7\u00e3o da equa\u00e7\u00e3o de Helmholtz usando bases minimais \ndefinidas sobre grades regulares de n\u00edveis 6, 8, 10 e uma grade irregular \nde profundidade m\u00e1xima 10, com&lt;h = O, 1 e 52 = 1, 1. Os res\u00edduos \nu - u* possuem 81 = O, 006 e 52 = O, 07. \n\n54 \n\n\n\n5.4. Exemplo 55 \n\nNa tabela 5.1 a seguir, est\u00e3o as dist\u00e2ncias !lu u'll, as dimens\u00f5es das bases \nutilizadas e os valores dos di\u00e2metros \u00c0 das menores c\u00e9lulas de cada grade. \n\nI n\u00edvel 6 8 I m\u00e1ximo 10 10 \nI \u00c0 ' 0,1531 0,0765 0,0383 I 0.0383 \nj dimens\u00e3o I 49 i 225 I 439 \u00b7 961 , \nI llu- u\"ll I 0,02192191 ! 0,00550957 I 0,00331064 I 0,00137926 1 \n\nTabela 5.1: Dimens\u00f5es das bases e dist\u00e2ncias llu- u'll das solu\u00e7\u00f5es \naproximadas de uma equa\u00e7\u00e3o de Helmholtz. \n\nAssim como nos exemplos anteriores, os erros de aproxima\u00e7\u00e3o s\u00e3o quase pro-\nporcionais a \u00c0 2 nas aproxima\u00e7\u00f5es pelas bases regulares de n\u00edveis 6, 8 e 10 (com \npropor\u00e7\u00f5es de aproximadamente 16: 4 : 1). Utilizando a base adaptativa, redu-\nzimos a dimens\u00e3o do espa\u00e7o de aproxima\u00e7\u00e3o para menos da metade da dimens\u00e3o \nda base regular de n\u00edvel lO (dimens\u00e3o 439 &lt;961/2), diminuindo portanto o custo \ncomputacionaL O erro relativo a esta base adaptativa, contudo, foi maior do que \no dobro do erro relativo \u00e0 mesma base regular para o caso estudado. \n\n\n\n5.4. Exemplo \n56 \n\n\n\nCap\u00edtulo 6 \n\nSolu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais \nlineares e dependentes do tempo \n\nEstenderemos agora a discuss\u00e3o do cap\u00edtulo anterior para abordarmos um caso \nparticular de equa\u00e7\u00e3o diferencial parcial, com a forma \n\nL(u)(x, t) =O xEfl (6.1) \n\nonde L \u00e9 novamente um operador diferencial, x \u00e9 um ponto do dom\u00ednio fl, com \ndimens\u00e3o k, e u(x, t) \u00e9 a fun\u00e7\u00e3o que queremos encontrar, vari\u00e1vel no espa\u00e7o (x) e \nno tempo (t). Poder\u00edamos simplesmente usar o m\u00e9todo de Galerkin mostrado na \nse\u00e7\u00e3o 5.2 e resolver a equa\u00e7\u00e3o (6.1) tratando o tempo te as outras x; dimens\u00f5es da \nmesma forma. Entretanto, para utilizarmos tendas como base de aproxima\u00e7\u00e3o, \nter\u00edamos que construir urna grade di\u00e1dica G' com dimens\u00e3o k + 1, na qual os \nrefinamentos no tempo estariam atrelados a refinamentos no espa\u00e7o e vice-versa, o \nque pode ser altamente indesej\u00e1vel considerando que estas grandezas n\u00e3o possuem \nurna rela\u00e7\u00e3o direta. \n\nNestas situa\u00e7\u00f5es, \u00e9 comumente utilizada uma solu\u00e7\u00e3o alternativa em que o \nm\u00e9todo de Galerkin \u00e9 aplicado apenas nas dimens\u00f5es espaciais (x), e o m\u00e9todo de \nintegra\u00e7\u00e3o de Euler [PFTV86] \u00e9 usado na dire\u00e7\u00e3o temporaL Mais precisamente, \npara cada instante t, usamos o m\u00e9todo de Galerkin para calcular a derivada tem-\nporal ~;. Calculamos ent\u00e3o a fun\u00e7\u00e3o u em um instante posterior t + b.t como \n\n( \n&amp; ) (t) \n\nu<t+~t) +- u<') + ;: x b.t (6.2) \n\nNa verdade, trabalhamos com uma aproxima\u00e7\u00e3o u\u2022 deu, u\u2022 = 2::7:o' a,cp, onde as \n\n57 \n\n\n\n6.1 A difus\u00e3o do calor 58 \n\nfun\u00e7\u00f5es 'Pi n\u00e3o variam com o tempo t. Portanto precisamos calcular coeficientes \nb b . ou b - c o,.-., n-1 ta1s que Ot = zt.Pii e entao ,_azer \n\nX \u00d3t (6.3) \n\n6.1 A difus\u00e3o calor \n\nPara avaliar os espa\u00e7os de splines di\u00e1dicos E1 [G] neste tipo de aplica\u00e7\u00e3o, realiza-\nmos testes com a equa\u00e7\u00e3o de difus\u00e3o do calor em meio isotr\u00f3pico. O fen\u00f4meno \nda transfer\u00eancia de calor \u00e9 amplamente citado no estudo de equa\u00e7\u00f5es diferenciais \nparciais porque serve de modelo para outros fen\u00f4menos de difus\u00e3o [Men 77, Twi84, \nVic81]. A difus\u00e3o do calor em meio isotr\u00f3pico \u00e9 descrita pela seguinte equa\u00e7\u00e3o: \n\nonde T(x, t) \u00e9 a temperatura em um ponto x = (x 0, ... , Xk-:) de um dom\u00ednio \\1 \nk-dimensional, no instante t e K ( x) \u00e9 a fun\u00e7\u00e3o de condutividade t\u00e9rmica em x. \nEsta express\u00e3o indica que quando h\u00e1 uma distribui\u00e7\u00e3o de temperatura irregular \nem um corpo ou superf\u00edcie, ent\u00e3o ocorre transfer\u00eancia de calor dos pontos de \nmaior temperatura para os pontos de menor temperatura, at\u00e9 que o corpo alcance \ntemperatura constante. \n\nEsta equa\u00e7\u00e3o \u00e9 linear na solu\u00e7\u00e3o T(x, t). Se o meio for homog\u00eaneo- isto \u00e9, a \nfun\u00e7\u00e3o K(x) \u00e9 constante em [l-e a distribui\u00e7\u00e3o do calor no instante t =O for um \nimpulso de Dirac [Bra78] centrado no ponto x 0 , ent\u00e3o a solu\u00e7\u00e3o anal\u00edtica [Sew88] \nda equa\u00e7\u00e3o (6.4) \u00e9 \n\ne h \nT(x) = 4r.Kt' \n\nh= _I:(x; -xf)2 \n4Kt \n\nEsta fun\u00e7\u00e3o \u00e9 uma gaussiana sim\u00e9trica com centro em ( xg, ... , x%_ 1). \n\n(6.5) \n\nNa solu\u00e7\u00e3o num\u00e9rica, come\u00e7amos aplicando a condi\u00e7\u00e3o de Galerkin (se\u00e7\u00e3o 5.2) \n\u00e0 equa\u00e7\u00e3o (6.4) apenas no dom\u00ednio espacial 11, obtendo \n\ni= O, .. . ,n- 1 \n\nou seja \n\ni= O, ... ,n- 1 (6.6) \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 59 \n\nonde dx = dxk-r ... dx 0 . Substituindo T por 2::;7;;:5 a1r.pj e ffJ; por E;;;:J bjr.pj, \nreescrevemos a equa\u00e7\u00e3o (6.6) para cada i como \n\nn-1 n-l \n\nL bj 1 'P1'Pidx = K L a1 ('V 2 r.p1)r.pidx \nj;:;;;O n j:O \n\n(6 7) \n\nReduzindo a ordem das derivadas no lado direito da equa\u00e7\u00e3o (6.7) atrav\u00e9s dos \nteoremas de Green e da diverg\u00eancia (se\u00e7\u00e3o 5.3.1), obtemos \n\nn-1 \n\n([)\u00b7wdx = -K\"' a\u00b7 f(vw 1. ('V0)dx \n, 1 , z L 1 Jr: r]J , z \n\nJ=O n \n(6.8) \n\nou seja, a equa\u00e7\u00e3o (6.6) corresponde a um sistema com representa\u00e7\u00e3o matricial \nEb = c, no qual E \u00e9 a matriz n x n com Eij = (rpi, r.p1), e c \u00e9 o vetor (coluna) \ntal que e; = K I:;j;;:~ aj (Yrpi, vrp,). Supondo que os coeficientes aj em um dado \ninstant.e sejam conhecidos, resolvendo o sistema encontramos os coeficientes b; \nnes.te mesmo instante. Com estes valores, calculamos os coeficientes a(t+At) em \nfun\u00e7\u00e3o dos coeficientes a(t) atrav\u00e9s da f\u00f3rmula (6.3) da integra\u00e7\u00e3o de Euler. \n\n6.2 Exemplo de simula\u00e7\u00e3o \n\nNos testes num\u00e9ricos, simulamos o processo descrito pela equa\u00e7\u00e3o (6.4) no inter-\nvalo de t 0 = O, 0004s a tf = O, 006s, com f:o.t = 0.000007s, usando como vetor \ninicial a os coeficientes da aproxima\u00e7\u00e3o por m\u00ednimos quadrados na base r.p Bmin \n(se\u00e7\u00e3o 4.1) da solu\u00e7\u00e3o exata (6.5), para o instante inicial (t = t0 ). Compara-\nmos o resultado final da integra\u00e7\u00e3o T'f(x) = T'(x, tf) com a aproxima\u00e7\u00e3o Tf(x) \nda solu\u00e7\u00e3o exata T(x, tf) (6.5) no instante final (t = tf). Desta forma, o erro \nIITf- T'fll reflete apenas os erros de integra\u00e7\u00e3o no tempo, e n\u00e3o o erro (ine-\nvit\u00e1vel) da aproxima\u00e7\u00e3o da solu\u00e7\u00e3o Tf no espa\u00e7o E1 [G]. \n\nEmpregamos as mesmas bases regulares usadas nos experimentos anteriores, \ncom tendas de profundidades 6, 8 e 10- Utilizamos tamb\u00e9m uma base irregular, \ncontendo tendas de profundidade m\u00e1xima 10, sendo que todas as 4 bases citadas \ns\u00e3o minimais. A base irregular foi obtida atrav\u00e9s do algoritmo 4.5.1, Refina_ Grade, \naplicado \u00e0 solu\u00e7\u00e3o final T(x, tf). \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 60 \n\nNas figuras 6.1 a 6.4 exibimos 10 est\u00e1gios de simula\u00e7\u00e3o para cada base, desde \na temperatura no instante inicial (T'(x, t 0 )) at\u00e9 o resultado de \u00ednt.egra\u00e7:\u00e3o \n(T\u2022f). Na \u00faltima linha de cada sequ\u00eanc\u00eda mostramos tamb\u00e9m a solu\u00e7\u00e3o (Tf) e o \nerro (Tf -r f). \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 61 \n\nt =O, 00045s, 51 = 14,5 t = O, 00049s, 51 = 13,8 \n\nt =O, 0005ls, J, = 13,6 t =O, 00108s, J 1 = 8, O t =O, 00178s, J, = 4, 9 \n\nt =O, 00248s, J, = 3, 4 t = O, 00318s, 51 = 2, 6 t =o, 004588, J, = 1, 8 \n\nFigura 6.1: Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de \nprofundidade 6. A \u00faltima linha mostra o resultado final da integra\u00e7\u00e3o \n(T*f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata \ncorrespondente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens \nt\u00eam par\u00e2metro li2 = 188, O. \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 62 \n\nt =O, 00040s, J, = 23, 5 t = O, 00045s, J 1 = 20, O t =O, 00049s, J1 = 18,1 \n\nt =O, 00051s, J 1 = 17, 5 t =O, 00108s, J1 = 7, 5 t=0,00178s,J1 =4,4 \n\nt =O, 00248s, 51 = 3, 2 t = O, 00318s, 51 = 2, 5 t =O, 00457s, \u00f31 = 1, 7 \n- ----- ~- - - . \u00b7\u00b7\u2022\u00b7\u00b7\u00b7\u00b7\u00b7 ...... ,., '.\u00b7\u00b7\u00b7 , .. , \n\nT \n..... \n\n... ' I \n..\u2022. \n\n\u00b7\u00b7~ \n\n, ... \\\u2022 ,,f&lt;~ \n. , .. \n\n. .L. L . I .. L ' ..\u2022... L. \n\n(T*f), 51 = 1,3 solu\u00e7\u00e3o \"exata\" (Tf), 01 = 1, 3 erro (Tf - T*f), 51 = O, 1 \n\n' i i i ... \n\n'... i (:i ',!;i; ( \n\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7i~\u00b7\u00b7 \n\ni i \\ \\(0 \n\n..... . ..... \n\nFigura 6.2: Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de \nprofundidade 8. A \u00faltima linha mostra o resultado final da integra\u00e7\u00e3o \n(T*f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata \ncorrespondente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens \nt\u00eam par\u00e2metro ii2 = 188, O. \n\ni \n. \n\n'\u00b7\u00b7\u00b7 !\u00b7\u00b7 ... \nf~ \n\ni\u00b7 ..... \n\n.. \n\ni \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 63 \n\nt =O, 00040s, J, = 23, 5 t = O, 00045s, 81 = 18,3 t = O, 00049s, 51 = 16,5 \n\nt =O, 00051s, /h = 16, O t = 0,00108s, 51 = 7,3 t = 0,00178s, J, = 4,5 \n\nt = O. 00248s, o1 = 3, 2 \n; ,_; . ;;:::.:. \n\nt = 0,00318s, 51 = 2,5 t = O, 00458s. o, = 1, 7 \n\u2022 ;:c:\u2022 \n\n.. \"' ; ;,;\u00b7 \u2022 '!; \u2022\u2022\u2022\u2022. , :tr: \n\n=\u00b7-\u00b7 \n; . \n\n-\u00b7 \u00b7\u00b7_ ; . ::..\u00e9 .. \n\n;c:; \u00b7\u00b7\u00b7=\u00b7 \n\n... ; . \n\n(T''), o1 = 1, 3 solu\u00e7\u00e3o \"exata\" (Tf), 51 = 1, 3 erro (Ti- T'f). 81 =O, 1 \n\n;:; \u00b7\u00b7:; - \u00b7;; ;,:;; \n\n~f'~'. . :;';;-\ni :\u20221\u2022 \n. -\n\n.CTT ,\u00b7 \u00b7 .. \u00b7.:.c\u2022: \u00b7\"?~ '/, ,,,. '; l'T'l \n'.:0\u00b7\u00b7\u00b7\u00b7 . ; \u2022:: \n~c; . ;:; :. ,. ''\"\"':,:c: \n\n.. . \u2022:::-. , . . ,-;\u00b7., : .. ,. .: \u00b7l;1rl '' \n. \n\nFigura 6.3: Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base regular de \nprofundidade 10. A \u00faltima linha mostra o resultado final da integra\u00e7\u00e3o \n(T'f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o exata \ncorrespondente (Tf), e a diferen\u00e7a entre estas duas. Todas as imagens \nt\u00eam par\u00e2metro Oz = 188, O. \n\n~~~\u00b7i . ;. ~ti \n.. ,,, \n\n! ;\u00b7 ~ \u00b7\u00b7\u00b7! .;;; \n;:\u2022;;;.t. ; .\u2022 ;\u00b7 \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 64 \n\nt =O, 00040s, J, = 23, 5 t =O, 00045s, o1 = 18,3 t =O, 00049s, J, = 16,5 \n-~- --\u00b7 -' ------\n\nt =O, 0005ls, 51 = 16, O t =O, 00108s, J, = 7, 3 t = O, 00178s, J, = 4, 5 \n\nt = 0,00248s, 51 =3,2 t = O, 00318s, li1 = 2, 5 t = 0,00458s, J, = 1, 7 \n\nFigura 6.4: Simula\u00e7\u00e3o da difus\u00e3o do calor com uma base irregular de \nprofundidade m\u00e1xima 10. A \u00faltima linha mostra o resultado final da \nintegra\u00e7\u00e3o (T*f), a aproxima\u00e7\u00e3o por m\u00ednimos quadrados da solu\u00e7\u00e3o \nexata correspondente (Tf), e a diferen\u00e7a entre estas duas. Todas as \nimagens t\u00eam par\u00e2metro 62 = 188, O. \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 65 \n\nNa tabela 6.1 a seguir mostramos as dist\u00e2ncias IIT'- T''ll, as dimens\u00f5es das \nbases e o di\u00e2metro \u00c0 das menores c\u00e9lulas de cada grade. \n\nTabela 6.1: Dimens\u00f5es das bases e dist\u00e2ncias - T'f li entre os \nresultados finais de quatro simula\u00e7\u00f5es de um processo de difus\u00e3o. \n\nDe acordo com as dist\u00e2ncias !lu- u'll (tabela 6.1), o ganho de precis\u00e3o devido \nao refinamento das grades na integra\u00e7\u00e3o no tempo foi um pouco menor do que \no ganho de precis\u00e3o obtido com este refinamento nos exemplos de integra\u00e7\u00e3o \nespacial (se\u00e7\u00e3o 5.4). na simula\u00e7\u00e3o realizada com a grade de \nprofundidade m\u00e1xima 10, obtivemos um resultado t\u00e3o preciso quanto o resultado \nobtido por interm\u00e9dio da grade regular mais fina, de n\u00edvel lO, com uma quantidade \nsignificativamente menor de elementos na base. Neste sentido a integra\u00e7\u00e3o no \ntempo com refinamento local mostrou-se bastante vantajosa. \n\n\n\n6.2. Exemplo de simula\u00e7\u00e3o 66 \n\n\n\nCap\u00edtulo 7 \n\nAs equa\u00e7\u00f5es de escoamento \n\nA partir deste cap\u00edtulo nos voltamos especificamente para o problema do escoa-\nmento bif\u00e1sico \u00f3leo/\u00e1gua em meios porosos. Come\u00e7amos revisando o sistema de \nequa\u00e7\u00f5es diferenciais n\u00e3o linear e dependente do tempo que descreve este processo \nf\u00edsico [AS79, desde uma abordagem geral at\u00e9 nosso caso particular, que \ndepois ser\u00e1 discretizado e modelado por fun\u00e7\u00f5es tenda. \n\n7.1 Modelagem matem\u00e1tica \n\nO escoamento de petr\u00f3leo em meios porosos pode ser descrito por um conjunto \nde equa\u00e7\u00f5es diferenciais parciais n\u00e3o lineares. As equa\u00e7\u00f5es refletem as leis de \nconserva\u00e7\u00e3o de massa, viscosidade e press\u00e3o. Para obter as equa\u00e7\u00f5es consideradas, \ntomamos como base um elemento infinitesimal de volume com dimens\u00e3o dx, dy e \ndz, contendo rocha e fluidos, como ilustrado na figura 7.L \n\nFigura 7.1: Elemento infinitesimal dx x dy x dz \n\n67 \n\n\n\n7.1. Modelagem matem\u00e1tica 68 \n\nA lei da conserva\u00e7\u00e3o de massa diz que, num determinado intervalo de tempo \ndt, \n\nonde: \n\nm, - m, \u00e9 a diferen\u00e7a entre a massa que entra e a massa que sai atrav\u00e9s de todas \nas faces do elemento; \n\nmp \u00e9 a massa que entra ou sa\u00ed do elemento atrav\u00e9s dos po\u00e7os produtores ou \ninjetores; \n\nma \u00e9 o incremento na massa de fluido presente no volume. \n\nDefinimos a velocidade de escoamento Vx, v, da seguinte forma: Vx \u00e9 o \nvolume fluido dV que atravessa um elemento infinitesimal de \u00e1rea d\"4 perpen-\ndicular ao eixo x, num intervalo de tempo dt, dividido por estes dois, \n\ndVx \nVx = ---\n\ndtdAx \n\ne igualmente para os demais eixos \n\ndv.\u00b7\u00b7 \nV \n\n- y \n\"-dtdA' y \n\ne \ndVz \n\nVz = dtdA, \n\nO vetor v= (vx, vy, v,) \u00e9 a velocidade do escoamento. \nPortanto, se considerarmos apenas as faces perpendiculares ao eixo x, a parcela \n\ncorrespondente da diferen\u00e7a m, - m, \u00e9 dada por \n\nonde p \u00e9 a densidade. Se considerarmos o fluxo nas dire\u00e7\u00f5es x, y e z, temos \n\nEm forma vetorial, usando o operador V = ( ;x, ;. , /iz) podemos escrever \nm,- m, = -v.(pv)dxdydzdt \n\nPor outro lado, a massa dos po\u00e7os pode ser escrita como \n\nmP = pQBdt \n\n\n\nTl. Modelagem matem\u00e1tica 69 \n\nonde Q \u00e9 a vaz\u00e3o (volume por unidade de tempo) medida na superf\u00edcie, e B \u00e9 o \nfator volume de forma\u00e7\u00e3o, que representa a rela\u00e7\u00e3o entre o volume do \u00edluido no \nreservat\u00f3rio e seu volume em condi\u00e7\u00f5es padr\u00f5es. Finalmente, a varia\u00e7\u00e3o na massa \nacumulada \u00e9 dada por \n\nma= :t (,Pp)dxdydzdt \n\nonde q, \u00e9 a porosidade da rocha. A porosidade 6 indica a fra\u00e7\u00e3o do que \nn\u00e3o est\u00e1 ocupada pela rocha, mas pelo \u00edluido. \n\nAssim, a equa\u00e7\u00e3o (7.1) assume a forma \n\n-v.(pv)dxdydzdt = :t (\u00f3p)dxdydzdt- pQBdt (7.2) \n\n7.1 A lei de Darcy \n\nA velocidade Vx do escoamento, por sua vez, \u00e9 dada pela f\u00f3rmula emp\u00edrica conhe-\ncida como Lei de Darcy. Para meios isotr\u00f3picos, \n\nVz =- K (f}p- pgx) V =- K (iJp- pg) Vz =- K (~p- pgz) \n~ iJx y ~ oy y ~ dz \n\nonde K \u00e9 uma propriedade do meio chamada permeabilidade, ~ \u00e9 a viscosidade \ndo fluido, e gx \u00e9 a componente do vetor gravidade na dire\u00e7\u00e3o do eixo x (que n\u00e3o \n\u00e9 necessariamente zero, porque o eixo z n\u00e3o \u00e9 necessariamente vertical). O fator \n~- pgx \u00e9 denominado diferencial do potencial, e \u00e9 a for\u00e7a que obriga as part\u00edculas \ndo fluido a se moverem. Em forma vetorial \n\nK \nv=-- (vp- pg) \n\n~ \n(7.3) \n\nNo caso de meios n\u00e3o isotr\u00f3picos, o fator K deve ser substitu\u00eddo por um tensor, \nrepresent\u00e1vel por uma matriz \n\n[ \n\nkx kxy kxz l \nK = kyx ky kyz \n\nkxx kzy kz J \nFrequentemente as dire\u00e7\u00f5es principais do tensor coincidem com os eixos de coor-\ndenadas. Nestes casos K tem a forma \n\n[ \n\nkx O O ] \nK = O ky O \n\no o k, \nChamamos K de tensor de permeabilidade absoluta. \n\n\n\n7.2. Escoamento bif\u00e1sico \u00f3leoj\u00e1gua 70 \n\n7.2 Escoamento bif\u00e1sico \u00f3leo/ \u00e1gua \n\nSatura\u00e7\u00f5es relativas \n\nAs leis de escoamento exigem algumas adapta\u00e7\u00f5es quando descrevem o fluxo de \ndois ou mais fluidos imisc\u00edveis, chamados fases. Nesta situa\u00e7\u00e3o, utilizamos o con-\nceito de satura\u00e7\u00e3o relativa, no qual o volume de escoamento \u00e9 compartilhado entre \nestes fluidos. As satura\u00e7\u00f5es s\u00e3o expressas como fra\u00e7\u00f5es do volume de poros, ou \nseja, do volume total menos o volume ocupado pelas rochas. Consequentemente, \nn\u00e3o podem assumir valores negativos nem superiores a 1, e sua soma \u00e9 sempre L \nConsiderando duas fases apenas, digamos \u00f3leo (o) e \u00e1gua (a), temos portanto a \nequa\u00e7\u00e3o \n\n(7.4) \n\nonde So \u00e9 a satura\u00e7\u00e3o de \u00f3leo e Sa \u00e9 a satura\u00e7\u00e3o de \u00e1gua. \nObserva-se que o escoamento de uma fase \u00e9 dificultado pelas outras, mais do \n\nque seria causado apenas pela redu\u00e7\u00e3o do volume de poros. Ou seja, cada fase \natrapalha o escoamento das outras de maneira que o fluxo multif\u00e1sico total \u00e9 \nsempre mais lento do que o mesmo fluxo com apenas uma de suas fases. Portanto \nnas equa\u00e7\u00f5es a permeabilidade K deve ser multiplicada por um fator k1, chamado \npermeabilidade relativa, que expressa essa redu\u00e7\u00e3o. O valor de k1 \u00e9 pr\u00f3prio de cada \nfase. A soma das permeabilidades relativas \u00e9 sempre menor ou igual a L Onde \numa fase est\u00e1 sozinha ( S1 = 1) a permeabilidade relativa k1 ser\u00e1 1, mas cada k1 \npode ser maior que o S1 correspondente. \n\n7.2.2 Press\u00f5es capilares \n\nAs press\u00f5es de cada fase tamb\u00e9m possuem diferen\u00e7as, porque normalmente algu-\nmas delas aderem \u00e0s rochas mais facilmente e exercem uma for\u00e7a de compress\u00e3o \nsobre as demais, que precisam compens\u00e1-la para manterem o equil\u00edbrio_ Portanto \nem vez de uma \u00fanica press\u00e3o p, devemos considerar uma press\u00e3o p1 diferente para \ncada fase l. \n\nEsta press\u00e3o adicional \u00e9 chamada press\u00e3o capilar. Quando o meio possui \napenas d nas fases, a fase m que adere mais facilmente \u00e0 rocha \u00e9 dita molhante \n(ou molhada) e a outra fase n \u00e9 dita n\u00e3o molhante. Nesse caso a press\u00e3o de \ncapilaridade \u00e9 definida por \n\n\n\n7.2. Escoamento bif\u00e1sico \u00f3leo/\u00e1gua 71 \n\nonde Pcnm \u00e9 uma fun\u00e7\u00e3o da satura\u00e7\u00e3o destas fases, Sn e Sm. Em um sistema \ncontendo apenas \u00e1gua e \u00f3leo, normalmente a \u00e1gua \u00e9 a fase molhante e o \u00f3leo \u00e9 a \nfase n\u00e3o molhante, e portanto escrevemos a press\u00e3o de capilaridade Pwa do \u00f3leo \nsobre a \u00e1gua como \n\n.5) \n\n7.2 geral \n\nLevando em conta estas caracter\u00edsticas, podemos re-escrever a rela\u00e7\u00e3o (7.2) para \numa fase l de um fluxo multif\u00e1sico n\u00e3o misc\u00edvel como \n\n- PtK-- -- - PtYx dydzdxdt + 8 [ kt (8p1 )] \n8x f11B1 8x \n\n(7.6) \n\n8 r b )l -\n8 \n\nlp1K -B\u00b7 \n8 \n\n- p1gy 1 dzdxdydt + \ny J.ll i y -\n\n~ [p,K kB, - PtYz) l dxdydzdt = \nOZ Jll i j \n\n8 ( S1dJ) at PIE, dxdydzdt- p1Q1dt \n\nEscrevendo-a na forma de divergente, \n\n(7.7) \n\nonde q1 \u00e9 a taxa de inje\u00e7\u00e3o (volum\u00e9trica), que representa o volume de fluido \nintroduzido num dado volume, proveniente de fontes externas ao sistema (no caso, \npo\u00e7os de inje\u00e7\u00e3o e extra\u00e7\u00e3o), por unidade de tempo. Quanto q1 assume valores \nnegativos, determina uma taxa de extra\u00e7\u00e3o. A rela\u00e7\u00e3o entre a vaz\u00e3o Q1 e a taxa \nde inje\u00e7\u00e3o q1 \u00e9 expressa por \n\nQl \nq1 = -;dx-d7y'-d,--z \n\nO termo k1 depende da satura\u00e7\u00e3o da fase l e os termos lll, B 1 e p1 dependem \nda press\u00e3o e temperatura da fase l, logo n\u00e3o podem ser retirados das derivadas da \nequa\u00e7\u00e3o (7.7). Al\u00e9m disso, os termos K e&lt;f.> dependem da posi\u00e7\u00e3o no reservat\u00f3rio. \nEstas depend\u00eancias constituem propriedades de estado dos fluidos, da rocha ou \npropriedades rocha-fluido, e s\u00e3o respons\u00e1veis pela n\u00e3o linearidade acentuada do \nsistema final. \n\n\n\n7.2. Escoamento bif\u00e1sico \u00f3leoj\u00e1gua 72 \n\n\n\nCap\u00edtulo 8 \n\nDiscretiza\u00e7\u00e3o das equa\u00e7\u00f5es \n\nEste cap\u00edtulo mostra a discretiza\u00e7\u00e3o matem\u00e1tica das equa\u00e7\u00f5es de escoamento vi-\nsando a aplica\u00e7\u00e3o do m\u00e9todo de Galerkin com as bases de fun\u00e7\u00f5es tenda. Al\u00e9m \ndisso, explica em detalhes a integra\u00e7\u00e3o no tempo e no espa\u00e7o destas equa\u00e7\u00f5es, \nutilizando tanto grades di\u00e1dicas est\u00e1ticas quanto din\u00e2micas. \n\n8.1 Discretiza\u00e7\u00e3o das equa\u00e7\u00f5es de escoamento \n\nNeste trabalho utilizamos o modelo f\u00edsico conhecido na ind\u00fastria como Black-Oil, \nrestrito a duas fases apenas- \u00e1gua (l 'a') e \u00f3leo (l = 'o'), com press\u00e3o de ca-\npilaridade nula (p0 = p0 ). Neste modelo, as duas fases l\u00edquidas s\u00e3o consideradas \nimisc\u00edveis. Uma vez que as varia\u00e7\u00f5es de press\u00e3o de ponto a ponto s\u00e3o pequenas \ncomparadas com a press\u00e3o m\u00e9dia no reservat\u00f3rio, \u00e9 conveniente trabalhar ape-\nnas com a diferen\u00e7a p(x, y, z, t) p0 (x, y, z, t)- p = Pa(x, y, z, t)- p, onde p\u00e9 \numa press\u00e3o t\u00edpica constante no espa\u00e7o e no tempo, pr\u00f3xima da press\u00e3o m\u00e9dia. \nPodemos portanto resolver a equa\u00e7\u00e3o (7.7) encontrando as fun\u00e7\u00f5es \n\np(x, y, z, t) e Sz(x, y, z, t) \n\nque a satisfazem, dadas as demais fun\u00e7\u00f5es e par\u00e2metros (p, k, Jl, B,&lt;f;, q, etc). \n\n8.1.1 Discretiza\u00e7\u00e3o das vari\u00e1veis \n\nAs fun\u00e7\u00f5es p e 5 1 ser\u00e3o aproximadas por combina\u00e7\u00f5es lineares \n\nn-1 n-l \n\np'(x, y, z, t) =L a1(t)cpJ(x, y, z) e Sz'(x, y, z, t) = L(b1) 1(t)cpJ(x, y, z) \nj=O j=O \n\n73 \n\n\n\n8.1. Discret\u00edza\u00e7\u00e3o das equa\u00e7\u00f5es de escoamento 74 \n\nonde cada cp;(x, y, z) \u00e9 uma fun\u00e7\u00e3o de base do espa\u00e7o de aproxima\u00e7\u00e3o, que depende \napenas da posi\u00e7\u00e3o (x, y, z), e os coeficientes aj(t) e (b1);(t) variam com o tempo. \nA solu\u00e7\u00e3o ser\u00e1 calculada apenas para valores discretos de tempo t. \n\n8.1 Crit\u00e9rio de \n\nA discretiza\u00e7\u00e3o das equa\u00e7\u00f5es de escoamento (7.7) \u00e9 feita pelo m\u00e9todo de Galerkin \n(se\u00e7\u00e3o 5.2), aplicado \u00e0s coordenadas espaciais para um instante t fixo, como no \ncap\u00edtulo 6. Lembramos que este m\u00e9todo exige que o res\u00edduo das equa\u00e7\u00f5es diferen-\ncias (7.7) seja ortogonal \u00e0s fun\u00e7\u00f5es da base. Obtemos ent\u00e3o para cada fase l as \nequa\u00e7\u00f5es \n\nl ( ~ ( s\u00b7.) ) 7 o 1 cp . -v\u00b7 n,-- p,-- _,_ p,q, \\Didv =o . \" &amp;t B, 'o, ... ,n-1 \nonde dV = dxdydz, o s\u00edmbolo'-' indica o produto escalar no lll:.3 e ~V1 \u00e9 o campo \nvetorial \n\nW 1 p1K kBz (\"Vp' pzg) \nf.Ll I \n\nOu seja, \n\n' o, ... ,n-1 (8:1) \n\nObserve que, de modo geral, o lado esquerdo da equa\u00e7\u00e3o (8.1) mede o desloca-\nmento dos fluidos, e o lado direito mede a varia\u00e7\u00e3o local das satura\u00e7\u00f5es com o \ntempo. \n\n8.1.3 Termo do fluxo \n\nDesenvolveremos primeiro o lado esquerdo da igualdade ( 8.1) acima. Aplicando \na redu\u00e7\u00e3o de derivadas descrita na se\u00e7\u00e3o 5.3.1, reescrevemos esta f\u00f3rmula como \n\nExpandindo o termo W 1, obtemos \n\n-i (\"Vcp,) \u00b7 W,dV \n\n\n\n8.2. Forma matricial das equa\u00e7\u00f5es 75 \n\n(8.2) \n\nExpandindo agora o lado direito da igualdade (8.1), obtemos \n\n(8.3) \n\nPara simplificar estas equa\u00e7\u00f5es, vamos supor que as varia\u00e7\u00f5es de press\u00e3o dentro \ndo reservat\u00f3rio t\u00eam efeito desprez\u00edvel sobre a densidade dos fluidos e sobre a \nporosidade da rocha. Portanto podemos considerar \n\n~ (p'rjJ) =o \nat B, (8.4) \n\nComo as fun\u00e7\u00f5es 'P n\u00e3o dependem do tempo t, a f\u00f3rmula (8.3) fica \n\n(8.5) \n\n8.2 Forma matricial das equa\u00e7\u00f5es \n\nA f\u00f3rmula (8.2) do lado esquerdo da equa\u00e7\u00e3o (8.1), na forma matricial, pode ser \nescrita como E1a + fz, onde a \u00e9 o vetor (coluna) dos coeficientes da press\u00e3o p; E1 \n\u00e9 a matriz n x n definida por \n\ni,j =O, ... , n 1 (8.6) \n\n\n\n8.8. Integra\u00e7\u00e3o no tempo 76 \n\ne j 1 \u00e9 o vetor (coluna) definido por \n\n(fi),= r (vcp,) \u00b7 (p,K kB, )(p,g)d\\7 \nJo fti 1 \n\ni= O,. ,n -1 (8.7) \n\nA f\u00f3rmula (8.5) do lado direito, por sua vez, torna-se G,b; + onde b; \u00e9 o vetor \n(coluna) das derivadas dos coeficientes (b1)J da satura\u00e7\u00e3o S1, (b;)i = e(~),; G1 \u00e9 a \nmatriz n x n definida por \n\ne h1 \u00e9 o vetor (coluna) definido por \n\n(h,),= - r p,q,cp,d\\7 ), \n\ni,j=O, ... ,n-1 \n\ni= O, ... , n- 1 \n\nAs equa\u00e7\u00f5es (8.1), portanto, podem ser escritas como \n\n+ !t = +h, \n\n(8.8) \n\n(8.9) \n\n(8.10) \n\nColocaremos agora a satura\u00e7\u00e3o do \u00f3leo em fun\u00e7\u00e3o da satura\u00e7\u00e3o da \u00e1gua, usando \na identidade So + Sa = L Sejam c, ... , Cn tais que L CJ'PJ (x) = l para todo x em \nrt De So = l- Sa, conclu\u00edmos que (bo)j = Cj- (ba)j e portanto (b~); = -(b~);. \nPodemos ent\u00e3o escrever as equa\u00e7\u00f5es de fluxo destas duas fases como o sistema \nfinal \n\n(8.11) \n\nEste sistema possui 2n equa\u00e7\u00f5es, sendo n equa\u00e7\u00f5es para cada fase, e 2n vari\u00e1veis, \nque s\u00e3o os vetores a e b~. \n\n8.3 Integra\u00e7\u00e3o no tempo \n\nA simula\u00e7\u00e3o do escoamento de petr\u00f3leo consiste em resolver o sistema (8.11) \npara cada instante t fixo. Com isso obtemos os coeficientes das press\u00f5es aj e as \nderivadas temporais (b~)j da satura\u00e7\u00e3o da \u00e1gua. Usamos ent\u00e3o as derivadas (b~)j \npara calcular o estado do reservat\u00f3rio no instante seguinte, depois de um certo \nintervalo de tempo L':.t, como no cap\u00edtulo 6. Mais precisamente, as satura\u00e7\u00f5es para \no pr\u00f3ximo instante t s\u00e3o recalculadas pelo m\u00e9todo de integra\u00e7\u00e3o de Euler, \n\nj = 0, . .. ,n -1 (8.12) \n\nFinalmente avan\u00e7amos para o pr\u00f3ximo instante ( t +- t+L':.t) e repetimos o processo \ntodo. \n\n\n\n8.3. Integra\u00e7\u00e3o no tempo 77 \n\n8.3.1 Dados da simula\u00e7\u00e3o \n\nNo in\u00edcio do processo (t = t 0 ) fornecemos ao simulador a press\u00e3o tipica j5 (cons-\ntante ao longo da simula\u00e7\u00e3o) e a distribui\u00e7\u00e3o iniciai da satura\u00e7\u00e3o da \u00e1gua Sa. \ndescrita pelo vetor de coeficientes b~o). Supomos tamb\u00e9m que as taxas de inje\u00e7\u00e3o \n(as distribui\u00e7\u00f5es q1) s\u00e3o conhecidas em cada instante t. A evolu\u00e7\u00e3o do estado do re-\nservat\u00f3rio ocorre devido \u00e0 vaz\u00e3o dos po\u00e7os (q1 f 0), gerando diferen\u00e7as de press\u00e3o \nque por sua vez causam movimento do fluido, ou seja, varia\u00e7\u00e3o nas satura\u00e7\u00f5es ao \nlongo do tempo. \n\n8.3.2 C\u00e1lculo das press\u00f5es e fluxos \n\nNote que o sistema (8.11) n\u00e3o \u00e9 linear, pois tanto as matrizes E1 e G1 quanto os \nvetores h, e f, dependem dos coeficientes a1 (eles dependem tamb\u00e9m dos coefici-\nentes mas estes s\u00e3o conhecidos num dado instante Portanto a solu\u00e7\u00e3o do \nsistema \u00e9 determinada atrav\u00e9s do m\u00e9todo iterativo de Newton [PFTV86]. Usamos \ncomo aproxima\u00e7\u00f5es iniciais para os coeficientes da press\u00e3o os mesmos coeficientes \ndo instante anterior: \n\nj =O, ...\u2022 n- 1 \n\nA cada itera\u00e7\u00e3o do m\u00e9todo de Newton, recalculamos as matrizes E1 e G1 e os \nvetores h1 e / 1 usando os valores mais recentes de a, e os valores de ba (que s\u00e3o \nfixos para cada t). Em seguida resolvemos o sistema (8.11) supondo que essas \nmatrizes e vetores s\u00e3o independentes de a. \n\nEfetuamos v\u00e1rias destas itera\u00e7\u00f5es at\u00e9 o vetor a convergir. \nNote que a suposi\u00e7\u00e3o de que os fluidos s\u00e3o incompress\u00edveis (8.4) implica que a \n\npress\u00e3o Pl n\u00e3o tem 'mem\u00f3ria', isto \u00e9, ela depende apenas dao satura\u00e7\u00f5es e taxas \nde inje\u00e7\u00e3o nos po\u00e7os q1 no instante t, e n\u00e3o da press\u00e3o nos instantes anteriores. \n\n8.3.3 C\u00e1lculo das taxas de inje\u00e7\u00e3o \n\nAs fun\u00e7\u00f5es q1 deveriam ser zero em todo o reservat\u00f3rio, exceto nas vizinhan\u00e7as \nimediatas dos po\u00e7os. Na nossa formula\u00e7\u00e3o, entretanto, estas fun\u00e7\u00f5es s\u00e3o apro-\nximadas por combina\u00e7\u00f5es q1 = L: e11 cpi de tendas da base. Tamb\u00e9m adotamos \n\n\n\n8.4. Adapta\u00e7\u00e3o din\u00e2mica da grade 78 \n\nsempre a base Bmin, colocando os po\u00e7os sobre v\u00e9rtices completos da grade, de \nmaneira que nas combina\u00e7\u00f5es cada po\u00e7o \u00e9 representado por uma \u00fanica tenda 'Pi. \n\nA taxa de inje\u00e7\u00e3o qa normalmente \u00e9 diferente de zero apenas na vizinhan\u00e7a dos \npo\u00e7os onde ocorre inje\u00e7\u00e3o de \u00e1gua. Nestes pontos qa \u00e9 positivo. Entretanto, q0 \npode assumir valores negativos em algum po\u00e7o de extra\u00e7\u00e3o se a satura\u00e7\u00e3o de \u00e1gua \nnesse ponto for positiva. A vaz\u00e3o q0 , por outro lado, em geral nunca \u00e9 positiva \nporque n\u00e3o h\u00e1 inje\u00e7\u00e3o de \u00f3leo, e assume valores negativos somente nos po\u00e7os de \nextra\u00e7\u00e3o. \n\nNa pr\u00e1tica s\u00e3o dadas apenas as vaz\u00f5es totais Q11 em cada po\u00e7o, em fun\u00e7\u00e3o do \ntempo. Se a vaz\u00e3o da fase l no po\u00e7o j \u00e9 representada na taxa q, pelo termo eli'Pi, \nent\u00e3o devemos ter \n\nQ11 = h e1,<p,dV \nNa verdade para po\u00e7os de Qaj \u00e9 dado e Q01 \u00e9 sempre zero. Para \n\npo\u00e7os extra\u00e7\u00e3o, conhecemos apenas a soma Q1 = Qaj + Q 0 ; (vaz\u00e3o total de \nfluido bombeado). A propor\u00e7\u00e3o de \u00e1gua e \u00f3leo no fluido obtido depende de suas \nsatura\u00e7\u00f5es e mobilidades relativas das duas fases. Portanto, recalculamos as vaz\u00f5es \nem cada po\u00e7o de extra\u00e7\u00e3o j a cada instante de tempo usando a seguinte rela\u00e7\u00e3o: \n\nonde \n\nQoj Qaj \n\nmoj maj \n\nmlj = 1-'::!_<p,dV \nn p,B, \n\ne 'Pi \u00e9 a tenda que representa o po\u00e7o j [MD90j. \n\n8.4 Adapta\u00e7\u00e3o din\u00e2mica da grade \n\nO processo descrito na se\u00e7\u00e3o 8.3 sup\u00f5e que a grade G \u00e9 fixa durante toda a si-\nmula\u00e7\u00e3o. Para realizar o processo iterativo de integra\u00e7\u00e3o com uma grade vari\u00e1vel, \n\u00e9 necess\u00e1rio acrescentar alguns passos adicionais entre um instante e outro de \nsimula\u00e7\u00e3o. \n\nAp\u00f3s calcularmos a satura\u00e7\u00e3o (ba)(t+\"t) pela equa\u00e7\u00e3o (8.12), e fazer t = t+L'l.t, \nprocuramos uma nova grade di\u00e1dica G', que seja mais adequada a representar o \nnovo estado do reservat\u00f3rio. De posse de G', calculamos uma base B' para o espa\u00e7o \nde spl\u00ednes E1 [G'] correspondente, usando os algoritmos da se\u00e7\u00e3o 3.6 (Gera_Bmax \nou Gera.J3min). \n\n\n\n8.4. .4dapta\u00e7\u00e3o din\u00e2mica da grade 79 \n\n8.4.1 A grade inicial Gini \n\nExistem diversos crit\u00e9rios que podemos usar para escolher a nova grade G'. Em \nnossa abordagem; a grade G' \u00e9 sempre um refinamento de uma grade inicial Gini\u00b7 \n\nA grade Gini, por sua vez, \u00e9 gerada no come\u00e7o da simula\u00e7\u00e3o. Ela possui um \nrefinamento m\u00e1ximo dado P max na vizinhan\u00e7a dos po\u00e7os e na fronteira do reser-\nva\u2022t\u00f3r\u00b7io, pois estas s\u00e3o regi\u00f5es cr\u00edticas que n\u00e3o variam com o tempo. O tamanho \ndas c\u00e9lulas de G;ni aumenta gradualmente com a dist\u00e2ncia a estas regi\u00f5es. Supo-\nmos que na grade Gini as propriedades petrof\u00edsicas est\u00e3o representadas com um \ngrau suficiente de detalhamento, o que garante que elas ser\u00e3o tamb\u00e9m adequada-\nmente representadas em qualquer refinamento G' da mesma. \n\n8.4.2 Escolha de uma nova grade \n\nEscolhemos a nova grade G' executando o algoritmo (4.5.1) sobre a \nsatura\u00e7\u00e3o da \u00e1gua (S~ = E7~~(ba)j\\Oj), com a profundidade m\u00e1xima dada Pmax, \nem cada c\u00e9lula da grade fixa Gini\u00b7 \n\n8.4.3 Mudan\u00e7a de base \n\nCada vez que a grade G' muda, calculamos os coeficientes (ba)i da satura\u00e7\u00e3o da \n\u00e1gua S~(t+\u00ea.tJ e aJ da press\u00e3o p*(t+t:.t) na nova base B' atrav\u00e9s de aproxima\u00e7\u00f5es \npor m\u00ednimos quadrados (se\u00e7\u00e3o 4.1) destas fun\u00e7\u00f5es. Em particular, quando a nova \ngrade G' \u00e9 um refinamento da grade anterior G (ou seja, nenhuma c\u00e9lula de G foi \nreagrupada em G') ent\u00e3o estas aproxima\u00e7\u00f5es s\u00e3o iguais \u00e0s fun\u00e7\u00f5es originais. \n\nNo calculo das taxas de inje\u00e7\u00e3o q1 =E eli\\Oi na nova base, temos que encontrar \npara cada po\u00e7o j do reservat\u00f3rio o \u00edndice i da tenda :p; de B' cujo centro \u00e9 esse \npo\u00e7o. Vale notar que estas tendas sempre existem e t\u00eam o mesmo suporte, pois \nG' e G;ni t\u00eam profundidade igual a Pmax em volta de cada po\u00e7o e portanto todos \nos po\u00e7os s\u00e3o v\u00e9rtices completos de G;ni e G'. \n\n8.4.4 Estrat\u00e9gia adaptativa \n\nCom objetivo de manter a precis\u00e3o dos dados, trabalhamos na verdade com duas \nmalhas G' e G\"- A malha grossa G' \u00e9 obtida pelo algoritmo Refina_Grade como \ndescrito na se\u00e7\u00e3o 8.4.2. A malha fina G\" \u00e9 um refinamento de G', onde cada \numa de suas c\u00e9lulas folha \u00e9 dividida em at\u00e9 k n\u00edveis adicionais, sem exceder a \nprofundidade m\u00e1xima Pmax\u00b7 Este refinamento excedente da malha fina (sup\u00e9rfulo \n\n\n\n8. 5. C\u00e1lculo das matrizes e vetores do sistema 80 \n\nem algumas regi\u00f5es do reservat\u00f3rio) serve para manter a fidelidade do processo \ndin\u00e2mico. \n\nNa vers\u00e3o atual do nosso simulador, a grade grossa G' \u00e9 usada durante um \nfixo de tempo Ao final desse intervalo, a grade fina G\" \u00e9 cons-\n\ntru\u00edda. A grade fina G\" \u00e9 usada durante um intervalo fixo de tempo !::,.t !in\u00b7 Ap\u00f3s \no t\u00e9rmino de !::,.t f in, recalculamos a grade grossa G'. \n\nUma abordagem mais correta seria efetuar a simula\u00e7\u00e3o com as duas grades \nG' e , e comparar os resultados, procurando manter o refinamento m\u00ednimo que \nproduz uma resposta semelhante nas duas. \n\n8.5 C\u00e1lculo das matrizes e vetores do sistema \n\nVamos detalhar agora o c\u00e1lculo das matrizes \n(8.6) a (8.9). \n\nG; e dos vetores / 1 e h1 - equa\u00e7\u00f5es \n\nObserve que as integrais que aparecem nas f\u00f3rmulas das matrizes E1 e G1, \nembora estejam definidas em todo o dom\u00ednio fl, podem ser calculadas apenas na \ninterse\u00e7\u00e3o flij do suporte das tendas&lt;p; e '{j, porque fora desta regi\u00e3o o resultado \nda integra\u00e7\u00e3o ser\u00e1 sempre zero. O mesmo vale para as integrais presentes nos \nvetores ft e h~, que podem ser calculadas apenas no suporte fl, das tendas 'Pi\u00b7 \n\n8.5.1 Decomposi\u00e7\u00e3o em c\u00e9lulas \n\nNos dois casos, a regi\u00e3o de integra\u00e7\u00e3o consiste de zero ou mais c\u00e9lulas inteiras do \nn\u00edvel P = max{P(<p;),P(<pj)}. Podemos portanto decompor estas integrais em \nsomat\u00f3rias de integrais parciais, sobre cada uma das c\u00e9lulas do n\u00edvel P, obtendo \n\nonde D;j \u00e9 o conjunto de c\u00e9lulas do n\u00edvel P que comp\u00f5em fl,j, ou \n\nL f(r)<p;(r)dr = I; 1 f(r)<p;(r)dr \nn~ CEDi C \n\nonde D, \u00e9 o conjunto de c\u00e9lulas do n\u00edvel P que comp\u00f5em fli\u00b7 \n\n\n\n8.5. C\u00e1lculo das matrizes e vetores do sistema 81 \n\n8.5.2 Determina\u00e7\u00e3o dos termos constantes \n\nAl\u00e9m disso, nas integrais vamos supor que as propriedades p, k, 11, o e o \ntensor K s\u00e3o praticamente constantes no interior de cada c\u00e9lula C pertencente \naos conjunto Dij (regi\u00e3o rti1) ou (regi\u00e3o rli), respectivamente. Assin1: podemos \nfazer as seguintes simplifica\u00e7\u00f5es \n\ntal que r \u00e9 o ponto central de C, e \n\np1(r)K(r)kr(r) \n11t{r)Br(r) \n\n1(\\7\u00b7 \u00b7). ( K}5_!_)( )dV~ '\\:\"\" p,(r)2K(r)kr(r) Jrv\u00b7c\u00b7. )dV , 'f!, Pr B Pl9 - L,. ( )B ( ) \"'' g n f-tl 1 CED~ J.LI r l r c \nA permeabilidade K \u00e9 portanto considerada um escalar, e n\u00e3o um tensor. \ncando o mesmo princ\u00edpio \u00e0 matriz G1: temos \n\nNo caso do vetor hh substituindo a ta.xa q1 pela combina\u00e7\u00e3o linear L e1;'P;, po-\ndemos escrever \n\nSe tomarmos apenas a tenda 'P; cujo suporte possui interse\u00e7\u00e3o n\u00e3o nula com o \nsuporte de cp1, ent\u00e3o chegamos a \n\nAssim, \u00e9 poss\u00edvel calcular as matrizes E1, G1 e os vetores f 1 e h1 integrando somente \ntendas e gradientes de tendas (sendo a acelera\u00e7\u00e3o da gravidade g invari\u00e1vel no \ndom\u00ednio) e multiplicando os resultados pelos valores das propriedades tomados em \npontos espec\u00edficos do dom\u00ednio de integra\u00e7\u00e3o. Contudo, para um mesmo instante \nt, recalculamos estas matrizes e vetores a cada itera\u00e7\u00e3o na solu\u00e7\u00e3o de (8.11), pois \nas propriedades p, 11 e B dependem das press\u00f5es e variam conforme as mudan\u00e7as \nno vetor a. \n\n\n\n8.5. C\u00e1lculo das matrizes e vetores do sistema 82 \n\n\n\nCap\u00edtulo 9 \n\nO simulador Sim\u00f3leo \n\nDescrevemos neste cap\u00edtulo os m\u00f3dulos que comp\u00f5em o simulador de escoamento \nde petr\u00f3leo que desenvolvemos neste projeto, chamado Sim\u00f3leo, e alguns experi-\nmentos que realizamos para test\u00e1-lo. \n\n9.1 O Sim\u00f3leo \n\n9.1.1 Funcionalidades \n\nAs principais caracter\u00edsticas do Sim\u00f3leo s\u00e3o: \n\n\u2022 Modularidade: Oferece conjuntos independentes de bibliotecas de suporte \npara (1) constru\u00e7\u00e3o de grades di\u00e1dicas, (2) determina\u00e7\u00e3o das bases Bmax \nou Bmin de splines, (3) aproxima\u00e7\u00e3o usando bases de splines e (4) visua-\nliza\u00e7\u00e3o dos resultados. Cada uma destas bibliotecas pode ser substitu\u00edda \ncom relativamente pouco impacto; \n\ne Grades adaptativas: Implementa a discretiza\u00e7\u00e3o e integra\u00e7\u00e3o das equa\u00e7\u00f5es \nde escoamento (cap\u00edtulo 8), com grade est\u00e1tica ou adaptativa; \n\ne Dimens\u00e3o vari\u00e1vel: O programa pode ser usado sobre dom\u00ednios com L 2 ou \n3 dimens\u00f5es. As bibliotecas de grades di\u00e1dicas e determina\u00e7\u00e3o de bases de \nsplines t\u00eam esta mesma flexibilidade; \n\ne Visualiza\u00e7\u00e3o gr\u00e1fica off-line de resultados (no momento restrita a repre-\nsenta\u00e7\u00f5es em 1 ou 2 dimens\u00f5es)_ \n\n83 \n\n\n\n9.1. O Sim\u00f3leo 84 \n\n9.1.2 Estrutura \n\nO Sim\u00f3leo consiste de um programa integrador propriamente dito, e v\u00e1rios pro-\ngramas auxiliares para gera\u00e7\u00e3o de grades, bases, etc. Suas bibliotecas e programas \nforam criados em linguagem C padr\u00e3o sobre plataforma Unix. Conceitualmente, \nestes programas podem ser divididos e reagrupados num conjunto de m\u00f3dulos \nfuncionais com interfaces relativamente restritas e abstratas. Estes m\u00f3dulos s\u00e3o: \n\no SPL: gera\u00e7\u00e3o e manipula\u00e7\u00e3o de grades di\u00e1dicas, splines di\u00e1dicos e respec-\ntivas bases; \n\n\" EQS: discretiza\u00e7\u00e3o e integra\u00e7\u00e3o das equa\u00e7\u00f5es de escoamento; \n\no LIN: \u00e1lgebra de matrizes esparsas e resolu\u00e7\u00e3o de sistemas lineares; \n\no VIS: visualiza\u00e7\u00e3o de grades e resultados. \n\nou, graficamente: \n\nDadooda \n\n! Simula\u00e7\u00e3o \n\nO m\u00f3dulo SPL \n\ni:L \n':I . ' \n\nSPl \n\nEQS \n\n! \n\n' \nUN \n\nVIS \nh_ \n\n' : ArquiVos de : i \n\n~VIsualiza\u00e7\u00e3o j ! \n\nFigura 9.1: M\u00f3dulos do programa Sim\u00f3leo. \n\nO m\u00f3dulo SPL \u00e9 respons\u00e1vel pelo gerenciamento das grades e splines di\u00e1dicos. \nEstes splines s\u00e3o formados por bases de tendas e combina\u00e7\u00f5es lineares destas \nbases. As grades di\u00e1dicas s\u00e3o armazenadas como \u00e1rvores bin\u00e1rias onde cada n\u00f3 \nguarda um \u00edndice, dado por uma vari\u00e1vel inteira. Cada tenda \u00e9 representada pelo \n\u00edndice e profundidade de sua c\u00e9lnla superior, tamb\u00e9m inteiros. Uma base \u00e9 um \n\n\n\n9.1. O Sim\u00f3leo 85 \n\nvetor destas estruturas. Um spline di\u00e1dico gen\u00e9rico, por sua vez, \u00e9 codificado como \num vetor de coeficientes em ponto flutuante, referente a uma base especificada em \nseparado. \n\nOs algoritmos Interpola (3.5.1 ), Gera_Bmax/Gera_Bmin (3.6.1) e Refina_Grade \n(4.5.1) fazem parte do m\u00f3dulo SPL. Al\u00e9m disso, os procedimentos oferecidos \npor este m\u00f3dulo tamb\u00e9m incluem a manipula\u00e7\u00e3o das grades (inser\u00e7\u00e3o, remo\u00e7\u00e3o, \nbusca), os produtos escalares entre tendas (se\u00e7\u00e3o 4.2) e entre o gradiente de tendas \n(se\u00e7\u00e3o \n\nO m\u00f3dulo EQS \n\nEst\u00e3o reunidas no m\u00f3dulo EQS as bibliotecas de discretiza\u00e7\u00e3o e integra\u00e7\u00e3o (cap\u00edtulo \n8) das equa\u00e7\u00f5es de escoamento multif\u00e1sico \u00f3leo/ \u00e1gua (cap\u00edtulo 7). Estas bi-\nbliotecas utilizam as estruturas definidas no m\u00f3dulo para representar os \nreservat\u00f3rios e suas propriedades f\u00edsicas. Cada reservat\u00f3rio \u00e9 constru\u00eddo como \numa grade di\u00e1dica, refinada conforme a posi\u00e7\u00e3o de seus po\u00e7os. sua geometria e \ngrau de detalhamento requerido. Suas propriedades mais importantes (satura\u00e7\u00f5es, \npress\u00f5es e taxas de fi uxo) s\u00e3o guardadas como combina\u00e7\u00f5es lineares de tendas, e as \ndemais (permeabilidades, viscosidades, etc) s\u00e3o codificadas como procedimentos. \n\nPara realizar as integra\u00e7\u00f5es no espa\u00e7o, os programas do m\u00f3dulo EQS montam \nsistemas lineares atrav\u00e9s do m\u00e9todo iterativo de Newton que s\u00e3o resolvidos por . \nrotinas providas pelo m\u00f3dulo LIN. Todas as propriedades petrof\u00edsicas podem ser \nvisualizadas por m\u00e9todos fornecidos pelo m\u00f3dulo VIS. \n\nO m\u00f3dulo VIS \n\nO m\u00f3dulo de visualiza\u00e7\u00e3o VIS inclui rotinas para plotar qualquer fun\u00e7\u00e3o do sis-\ntema. As imagens geradas por este m\u00f3dulo podem ser gr\u00e1ficos unidimensionais \nou curvas de n\u00edvel bidimensionais. Os gr\u00e1ficos unidimensionais servem para mos-\ntrar tanto fun\u00e7\u00f5es de dom\u00ednio com uma dimens\u00e3o quanto cortes de fun\u00e7\u00f5es k-\ndimensionais entre dois pontos especificados. \n\nO m\u00f3dulo LIN \n\nO m\u00f3dulo LIN consiste de rotinas para resolu\u00e7\u00e3o de sistemas lineares. Na im-\nplementa\u00e7\u00e3o atual, usamos apenas algoritmos simples baseados em elimina\u00e7\u00e3o de \nGauss e fatora\u00e7\u00e3o de Cholesky [PFTV86]. \n\n\n\n9.2. Testes de simula\u00e7\u00e3o 86 \n\nVale observar que as matrizes de produtos escalares de elementos finitos s\u00e3o \nesparsas. Portanto, para a efici\u00eancia do simulador, \u00e9 indispens\u00e1vel utilizar algo-\nritmos espec\u00edficos para matrizes esparsas. Esta modifica\u00e7\u00e3o deveria ser objeto de \ntrabalho futuro. \n\n9.2 Testes de \n\nRealizamos alguns experimentos com o objetivo de avaliar os efeitos dos refina-\nmentos di\u00e1dicos est\u00e1tico e din\u00e2mico nas simula\u00e7\u00f5es. Para isso simulamos em \nduas dimens\u00f5es um mesmo reservat\u00f3rio fict\u00edcio utilizando tr\u00eas grades regulares, \nde n\u00edveis 6, 8 e 10, e uma grade irregular adaptativa din\u00e2mica com profundidade \nm\u00e1xima 10 (Pmax = 10), obtida segundo o m\u00e9todo descrito na se\u00e7\u00e3o 8.4. Todos os \nexperimentos foram conduzidos em um computador contendo dois processadores \nA'v!D Athlon funcionando a uma frequ\u00eancia de com 2G de m<em\u00f3ria, \nr\u00edgido SCSI com 40G e sistema operacional UNIX (Linux). \n\n9.2.1 Dados de simula\u00e7\u00e3o \n\nOs testes s\u00e3o baseados no modelo popular de cinco po\u00e7os [PGOO]. Usamos um \nreservat\u00f3rio fict\u00edcio medindo 3, O km x 3, O f v'2 km de \u00e1rea, com 1 m de espessura, \nplano e sem nenhuma inclina\u00e7\u00e3o (gx = gy = O). H\u00e1 um po\u00e7o de inje\u00e7\u00e3o no centro \ndo dom\u00ednio, no ponto(*, ~v'2). e quatro po\u00e7os de extra\u00e7\u00e3o equidistantes do po\u00e7o \nde inje\u00e7\u00e3o nos pontos -(f IT;v'2), (t, ;iv'2), (~, \n\n1\n3\n6\nv'2) e (%. \n\n1\n3\n6\nv'2); todas as \n\ncoordenadas em quil\u00f4metros. Veja a figura 9.2. \n\n111111 111111 \n\nFigura 9.2: Disposi\u00e7\u00e3o dos cinco po\u00e7os no teste com o Sim\u00f3leo. \n\nEm todos os testes, o reservat\u00f3rio no in\u00edcio possui satura\u00e7\u00e3o da \u00e1gua uniforme \nSa = O, L A press\u00e3o t\u00edpica usada \u00e9 p = 15000 kPa. O po\u00e7o de inje\u00e7\u00e3o possui \numa vaz\u00e3o de \u00e1gua constante Q 691m3 /dia, e cada po\u00e7o de extra\u00e7\u00e3o tem uma \n\n\n\n9.2. Testes de simula\u00e7\u00e3o 87 \n\nvaz\u00e3o total (\u00e1gua+ \u00f3leo) Q = 172, 75m3/dia. As permeabilidades relativas k~, \nviscosidades Jlt, e fatores volume de forma\u00e7\u00e3o B1 das duas fases s\u00e3o dadas pelas \nequa\u00e7\u00f5es: \n\nka = s~ \n\nJla =O, 004 \n\nBa = 1 \n\nko = (1- Sa) 2 \n\nf.to = -2, 6 X 10-9 X (p + p) + \u00dc, 1 \nBa = 2, 3 X 10-8 X (p + p) + 1 \n\nsendo que a press\u00e3o \u00e9 medida em Pa e a viscosidade em Pa x s- 1 Consideramos \nas densidades constantes, com Pa = 1000 kg/m3 e p0 = 887 kgjm3 . \n\nA porosidade&lt;P tem valor unit\u00e1rio em todo o dom\u00ednio, com exce\u00e7\u00e3o da regi\u00e3o \nlimitada por uma margem de 150m a partir da fronteira. Nesta regi\u00e3o&lt;P decai \nde um para zero, proporcionalmente \u00e0 dist\u00e2ncia da fronteira. A permeabilidade \nabsoluta K, que juntamente com a porosidade depende apenas da posi\u00e7\u00e3o espacial, \n\u00e9 dada por K 5 X w- 10&lt;/J (em m 2 ). \n\nAs simula\u00e7\u00f5es englobam os primeiros dois anos e cinco meses (888 dias) de \nfuncionamento do reservat\u00f3rio. Usamos um passo de tempo fixo de 6.t = 4 dias. \nNa simula\u00e7\u00e3o com adapta\u00e7\u00e3o din\u00e2mica da grade adotamos os intervalos 6.t9 , 0 , = \n20 dias para a grade grossa G' e 6.tfin = 20 dias para a grade fina G\". \n\n9.2.2 Resultados \n\nA figura 9.3 mostra a satura\u00e7\u00e3o da \u00e1gua Sa em 5 est\u00e1gios de simula\u00e7\u00e3o, desde o \ndia 8 at\u00e9 o dia 888, envolvendo as tr\u00eas grades regulares (n\u00edveis 6, 8 e 10) usadas \nnos testes. Na figura 9.4 est\u00e3o representadas as mesmas fun\u00e7\u00f5es da figura 9.3, mas \nna forma de gr\u00e1ficos unidimensionais da satura\u00e7\u00e3o da \u00e1gua entre o po\u00e7o injetor \ne algum dos po\u00e7os de extra\u00e7\u00e3o (por simetria, a figura vale para todos eles). As \nfiguras 9.5 e 9.6 mostram a press\u00e3o p de forma an\u00e1loga \u00e0s figuras 9.3 e 9.4. \n\nAs figuras 9.7 a 9.10 seguem o mesmo esquema das figuras 9.3 a 9.6, subs-\ntituindo contudo os resultados obtidos atrav\u00e9s da grade regular de n\u00edvel 6 pelos \nresultados provenientes da simula\u00e7\u00e3o com refinamento adaptativo e grade de pro-\nfundidade m\u00e1xima 10. \n\n\n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 6, t = 8 dias n\u00edvel 8, t = 8 dias n\u00edvel 10, t = 8 dias \n\nn\u00edvel 6, t = 168 dias n\u00edvel 8, t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 6, t = 328 dias n\u00edvel 8, t = 328 dias n\u00edvel 10, t = 328 dias \n\nn\u00edvel 6, t = 488 dias n\u00edvel 8, t = 488 dias n\u00edvel 10, t = 488 dias \n\nn\u00edvel 6, t = 888 dias n\u00edvel 8, t = 888 dias n\u00edvel 10, t = 888 dias \n\nFigura 9.3: Satura\u00e7\u00e3o da \u00e1gua Sa em 5 est\u00e1gios de simula\u00e7\u00e3o utilizando \nas grades regulares de n\u00edveis 6, 8 e 10. Todos os gr\u00e1ficos possuem \n51 = O, 08 e 62 = 1, O. \n\n88 \n\n\n\n; \n\nI \n\n9.2. Testes de simula\u00e7\u00e3o 89 \n\nn\u00edvel 6, t = 8 dias n\u00edvel 8, t = 8 dias n\u00edvel 10. t = 8 dias \n\n\\ \n\nn\u00edvel 6, t = 168 dias n\u00edvel 8, t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 6. t = 328 dias n\u00edvel 8. t = 328 dias n\u00edvel 10. t = 328 dias \n\nn\u00edvel 6, t = 488 dias n\u00edvel 8, t = 488 dias n\u00edvel 10. t = 488 dias \n\nI \nn\u00edvel 6, t = 888 dias n\u00edvel lO. t = 888 dias n\u00edvel 8, t = 888 dias \n\nr---\u00b7 \n\nc--~ ~~-~----\\'----! \nI . \ni \n\nFigura 9.4: Perfis da satura\u00e7\u00e3o da \u00e1gua Sa sobre tr\u00eas grades regulares. \nTodos os gr\u00e1ficos possuem valor m\u00ednimo -1 e m\u00e1ximo 1 na escala \nverticaL A escala horizontal vai do po\u00e7o injetor central at\u00e9 um po\u00e7o de \nextra\u00e7\u00e3o (1,2 km). \n\n\n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 8, t = 8 dias n\u00edvel 10, t = 8 dias \n\nn\u00edvel 8, t = 168 dias \n\nn\u00edvel 6, t = 488 dias \n\nn\u00edvel 6, t = 888 dias n\u00edvel 8, t = 888 dias n\u00edvel 10, t = 888 dias \n\nFigura 9.5: Press\u00e3o p em 5 est\u00e1gios de simula\u00e7\u00e3o utilizando as grades \nregulares de n\u00edveis 6, 8 e 10, com 51 = 20000 e 52 = 400000. A press\u00e3o \u00e9 \npositiva (acima de p) em volta do po\u00e7o de inje\u00e7\u00e3o, e negativa nos po\u00e7os \nde extra\u00e7\u00e3o. \n\n90 \n\n\n\ni \n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 6, t = 8 dias n\u00edvel 8, t = 8 dias n\u00edvel 10, t = 8 dias \n\nn\u00edvel 6, t = 168 dias n\u00edvel 8. t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 6. t = 328 dias n\u00edvel 8. t = 328 dias n\u00edvel 10, t = 328 dias \n\nn\u00edvel 6, t = 488 dias n\u00edvel 8, t = 488 dias n\u00edvel 10, t = 488 dias \n\nn\u00edvel 6, t = 888 dias n\u00edvel 8, t = 888 dias n\u00edvel 10, t = 888 dias \n\u00b7\u00b7\u00b7-~~--~\u00b7\u00b7\u00b7-~ c-_ \n\nI -===J \n\nl -- \u00b7~\u00b7 .. --\u00b7' \nFigura 9.6: Perfis da press\u00e3o p sobre tres grades regulares. A escala \nvertical varia de -400000 Pa a 400000 Pa. A escala horizontal vai do \npo\u00e7o injetor central at\u00e9 um po\u00e7o de extra\u00e7\u00e3o (1,2 km). \n\n91 \n\n\n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 8, t = 8 dias n\u00edvel m\u00e1ximo 10, t = 8 dias n\u00edvel 10, t = 8 dias \n\nn\u00edvel 8, t = 168 dias n\u00edvel m\u00e1ximo 10, t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 8, t = 328 dias n\u00edvel m\u00e1ximo 10, t = 328 dias n\u00edvel 10, t = 328 dias \n\nn\u00edvel 8, t = 488 dias \n\nn\u00edvel 8, t = 888 dias n\u00edvel m\u00e1ximo 10, t = 888 dias n\u00edvel 10, t = 888 dias \n\nFigura 9.7: Satura\u00e7\u00e3o da \u00e1gua Sa sobre grades regulares de n\u00edveis 8, 10 e \numa grade adaptativa din\u00e2mica de n\u00edvel m\u00e1ximo 10. Todos os gr\u00e1ficos \npossuem th =O, 08 e 82 = 1, O. \n\n92 \n\n\n\n9.2. Testes de simula\u00e7\u00e3o 93 \n\nn\u00edvel 8, t = 8 dias n\u00edvel m\u00e1ximo 10, t = 8 dias n\u00edvel lO, t = 8 dias \n\nn\u00edvel 8, t = 168 dias n\u00edvel m\u00e1ximo 10, t = 168 dias n\u00edvel 10. t = 168 dias \n\nn\u00edvel 8, t = 328 dias n\u00edvel m\u00e1ximo 10, t = 328 dias n\u00edvel 10, t = 328 dias \n\nn\u00edvel 8, t = 488 dias n\u00edvel m\u00e1ximo 10. t = 488 dias n\u00edvel lO, t = 488 dias \n\n' \n\nn\u00edvel 8, t = 888 dias n\u00edvel m\u00e1ximo 10. t = 888 dias n\u00edvel 10, t = 888 dias \n---\n\n~~ I~ . ! \n----~-\\__ I --~_j \n\nI \nL~---~-------\n\nFigura 9.8: Perfis da satura\u00e7\u00e3o da \u00e1gua Sa sobre duas grades regulares e \numa grade refinada adaptativamente, com valor m\u00ednimo -1 e m\u00e1ximo 1 \nna escala vertical. A escala horizontal vai do po\u00e7o injetor central at\u00e9 um \npo\u00e7o de extra\u00e7\u00e3o (1,2 km). \n\n\n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 8, t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 10, t = 328 dias \n\nn\u00edvel 8, t = 488 dias n\u00edvel 10, t = 488 dias \n\nn\u00edvel 8, t = 888 dias \n\nFigura 9.9: Press\u00e3o p utilizando grades regulares de n\u00edveis 8, 10, e uma \ngrade com refinamento local din\u00e2mico. Gr\u00e1ficos tra\u00e7ados com \n81 = 20000 e 82 = 400000. \n\n94 \n\n\n\n! \n\n9.2. Testes de simula\u00e7\u00e3o \n\nn\u00edvel 8, t = 8 dias n\u00edvel m\u00e1ximo 10, t = 8 dias n\u00edvel 10, t = 8 dias \n\nn\u00edvel 8, t = 168 dias n\u00edvel m\u00e1ximo 10, t = 168 dias n\u00edvel 10, t = 168 dias \n\nn\u00edvel 8, t = 328 dias n\u00edvel m\u00e1ximo 10, t = 328 dias n\u00edvel 10, t = 328 dias \n\nn\u00edvel 8, t = 488 dias n\u00edvel m\u00e1ximo 10. t = 488 dias n\u00edvel 10, t = 488 dias \n\n! \n\nn\u00edvel 8, t = 888 dias n\u00edvel m\u00e1ximo 10. t = 888 dias n\u00edvel 10. t = 888 dias \nI \n\nFigura 9.10: Perfis da press\u00e3o p sobre duas grades regulares e uma grade \ncom refinamento local gerada dinamicamente. A escala vertical tem \nvalor m\u00ednimo de -400000 Pa e m\u00e1ximo de 400000 Pa. A escala \nhorizontal vai do po\u00e7o injetor central at\u00e9 um po\u00e7o de extra\u00e7\u00e3o (1,2 km). \n\n95 \n\n. \n\n\n\n9.2. Testes de simula\u00e7\u00e3o 96 \n\n9.2.3 Evolu\u00e7\u00e3o da press\u00e3o m\u00e9dia \n\nNo gr\u00e1fico 9.11 mostramos a press\u00e3o m\u00e9dia do reservat\u00f3rio durante as simula\u00e7\u00f5es. \n\n\u00e1' 13040 \n\n130451~~~~~~~~~~~~~~~~~~ .:r: 13035 ...... 13030 :\u00e3 \u2022!);! 13025 E 13020 ,g 13015 \n~ 130\"10 \n\n\u00e3. 13005 t=================;:j 13000 \n<o '?J<o ...,r:o<o ~'O \"'>'1-<o ~\u00c7)<o t.<o<o&lt;:oro<o '\u00f3t;.'b '\\'1-<o&lt;or:::.'b&lt;o<o<c \n\ntempo [dias] \n\n~adaptativa- n\u00edvel m\u00e2ximo 1 O ---e- regular- n\u00edvel 6 \n-a- regular- nive! 8 -f::- regular- n\u00edve11D \n\nFigura 9.11: Press\u00e3o m\u00e9dia do reservat\u00f3rio (em kPa) por tempo (em \ndias), nas simula\u00e7\u00f5es com grades regulares de n\u00edveis 6, 8, 10 e com a \ngrade adaptativa de profundidade m\u00e1xima 10. \n\n9.2.4 Produ\u00e7\u00e3o de \u00f3leo e \u00e1gua \n\nA figura 9.12 mostra a produ\u00e7\u00e3o total de \u00f3leo e \u00e1gua nos po\u00e7os de extra\u00e7\u00e3o. \nObserve que com a grade regular de n\u00edvel 6, os po\u00e7os come\u00e7am a produzir \u00e1gua \nmais cedo, porque a frente de satura\u00e7\u00e3o desta fase \u00e9 mais gradual (figura 9.4) e a \n\u00e1rea efetiva de cada po\u00e7o \u00e9 maior. \n\n,. 30 \n\n\u2022 125 \n~ 20 \n\n:; 15 \n\n010 \n\ni \n\u2022 o \n\nI \nI ~ \n\nf \ni \n\nI \ni \n\n/ \n\n'O q,'t> ,_~<:>'<> 4:-'0 \":;\"'\"\" -,.<::>'1:> lj<,'b\"':> \":Jr;,'b vt\"\"' '\\'1-'b 'bo:;:,'b 'b<o'b \ntempo (dias) \n\n'b 'b'b '\"''b '\"\u00cd!''\u00f5 \"'\"'\"b ._.r::,\"b \"''b'/) \":!..,'b&lt;o.,.,\"b .-,_'1.,'1:> 'b<::J\"b 'bq,'b \ntempo{dias) \n\n~ adap!atiV<>- n\u00edvel m\u00e1>imo 10 -B- regular- n\u00edveiS \n\n-e- regular- n\u00edveiS -er- regular- nivel10 \n~adaptativa- n\u00edvei m\u00e1ximo 10 -e-regular-n\u00edveiS \n\n--e--- regular- nivel8 -k-- regular- nivel1 O \n\nFigura 9.12: Taxas de produ\u00e7\u00e3o de \u00f3leo (esquerda) e \u00e1gua (direita) em \nm 3 /dia, nas simula\u00e7\u00f5es com grades regulares e com a grade refinada \ndinamicamente. \n\n; \n\n' \n\n\n\n9.2. Testes de simula\u00e7\u00e3o \n\n9.2.5 Tempo de simula\u00e7\u00e3o \n\nA tabela 9.1 mostra o tempo total de cada simula\u00e7\u00e3o, em minutos. \n\nTabela 9.1: Tempo total em minutos das simula\u00e7\u00f5es com as grades \nregulares e com a grade adaptativa. \n\n97 \n\nNo teste com a grade adaptativa din\u00e2mica, devido ao tamanho limitado do re-\nservat\u00f3rio, n\u00e3o houve \"engrossamento\" da grade em nenhum est\u00e1gio de simula\u00e7\u00e3o; \nou seja, a cada itera\u00e7\u00e3o a grade era igual \u00e0 anterior, ou mais refinada. Esta n\u00e3o \n\u00e9 uma limita\u00e7\u00e3o do programa, mas apenas dos testes realizados. \n\nAn\u00e1lise dos resultados \n\nAnalisando os gr\u00e1ficos apresentados podemos concluir que o refinamento da grade \ndi\u00e1d\u00edca gera uma melhora substancial na qualidade das simula\u00e7\u00f5es at\u00e9 o n\u00edvel \n10. A figura 9.4, em particular, mostra que a frente de satura\u00e7\u00e3o da \u00e1gna fica \nbem abrupta \u00e0 medida que a resolu\u00e7\u00e3o da grade aumenta. Este fato tamb\u00e9m \u00e9 \ndemonstrado pelos gr\u00e1ficos de produ\u00e7\u00e3o mostrados na figura 9.12. O tempo total \nde simula\u00e7\u00e3o (tabela 9.1) aumentou bastante com o uso de grades mais finas. \n\nPor outro lado, nos testes com refinamento adaptativo, obtivemos um resultado \npraticamente igual ao da simula\u00e7\u00e3o com a grade regular de n\u00edvel 10, por\u00e9m com \naproximadamente 63% do tempo correspondente de execu\u00e7\u00e3o. \n\n\n\n9.2. Testes de simula\u00e7\u00e3o 98 \n\n\n\nCap\u00edtulo 10 \n\nConclus\u00f5es e trabalhos futuros \n\nNeste cap\u00edtulo relacionamos as principais conclus\u00f5es deste trabalho, e sugerimos \ndire\u00e7\u00f5es para pesquisas futuras. \n\n10.1 Conclus\u00f5es \n\n10.1.1 Simplicidade de grades e bases di\u00e1dicas \n\nConforme exposto nos cap\u00edtulos 2 e 3, verificamos que as grades di\u00e1dicas em \nqualquer dimens\u00e3o podem ser criadas e manipuladas com facilidade. A estrutura \nregular das malhas permite uma representa\u00e7\u00e3o muito simples, baseada em \u00e1rvores \nbin\u00e1rias. Cada c\u00e9lula pode ser convenientemente especificada por um \u00edndice inteiro \nque determina completamente sua posi\u00e7\u00e3o, profundidade e geometria. Isto nos \npermite construir algoritmos simples e eficientes para determinar as bases padr\u00f5es \nBmax e Bmrn de elementos finitos (fun\u00e7\u00f5es tenda) do espa\u00e7o E1[G] associado a uma \ndada grade G. A estrutura regular das grades tamb\u00e9m nos permite pr\u00e9-calcular \nos produtos escalares envolvendo estas fun\u00e7\u00f5es. \n\n10.1.2 Aproxima\u00e7\u00e3o com splines di\u00e1dicos \n\nAtrav\u00e9s de testes num\u00e9ricos (cap\u00edtulos 4, 5 e 6) constatamos que os espa\u00e7os E1 [G] \ns\u00e3o bastante eficazes na aproxima\u00e7\u00e3o de fun\u00e7\u00f5es e solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais. \n\n99 \n\n\n\n10.2. Propostas futuras 100 \n\n10.1.3 Grades adaptativas \n\nPor meio de testes conclu\u00edmos tamb\u00e9m que o refinamento adaptativo da grade \nmelhora a precis\u00e3o dos resu\u00edtados sem aumentar exageradamente a dimens\u00e3o dos \nespa\u00e7os de aproxima\u00e7\u00e3o, reduzindo portanto o tempo de execu\u00e7\u00e3o dos experimen-\ntos. \n\nNa simula\u00e7\u00e3o do escoamento mult\u00edf\u00e1sico de petr\u00f3leo (cap\u00edtulo 9), compro-\nvamos as vantagens do refinamento din\u00e2mico adaptativo da grade di\u00e1dica. No \nteste realizado com este recurso, obtivemos dados com precis\u00e3o equivalente aos \nda simula\u00e7\u00e3o feita com a grade regular mais fina, consumindo aproximadamente \nmetade do tempo de execu\u00e7\u00e3o gasto. Este resultado foi considerado bastante sa-\ntisfat\u00f3rio, tendo em vista o custo adicional do refinamento din\u00e2mico, que envolve \na gera\u00e7\u00e3o de novas grades e mudan\u00e7a de base das fun\u00e7\u00f5es aproximadas. \n\n10.2 Propostas futuras \n\n10.2.1 Splines de graus mais elevados \n\nUma sugest\u00e3o clara para trabalhos futuros \u00e9 pesquisar os espa\u00e7os de splines \ndi\u00e1dicos com graus e ordens de continuidade superiores \u00e0s dos espa\u00e7o E1 [G}. \nNestes espa\u00e7os (E2 [G], E3 [GJ, etc) \u00e9 prov\u00e1vel que a rela\u00e7\u00e3o entre a qualidade \ndas aproxima\u00e7\u00f5es e a necessidade de refinamento di\u00e1dico seja melhor do que em \nE1 [G]. Entretanto, precisar\u00edamos avaliar se este ganho compensaria o custo de \ntrabalharmos com fun\u00e7\u00f5es de base mais complexas. \n\n10.2.2 Escolha da base \n\nOutra op\u00e7\u00e3o de trabalho futuro \u00e9 realizar um estudo comparativo mais detalhado \nentre as bases padr\u00f5es Bmax e Bmin. O primeiro passo neste ser: \na velocidade de converg\u00eancia da solu\u00e7\u00e3o iterativa de equa\u00e7\u00f5es c:' \nlineares usando estas duas bases. Devido ao seu car\u00e1ter multiescilh \nque a base Bmax apresente converg\u00eancia mais r\u00e1pida. \n\n10.2.3 Passo de tempo adaptativo \n\nverificar \n\nNa solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais lineares dependentes do tempo, com a t\u00e9cnica \ndescrita no cap\u00edtulo 6, \u00e9 de grande import\u00e2ncia que possamos determinar valores \n\n\n\n10.2. Propostas futuras l\u00fcl \n\napropriados do passo de tempo \u00ea.t usado na integra\u00e7\u00e3o de Euler. Simula\u00e7\u00f5es \ncom valores muito grandes de !:::..t geram resultados imprecisos ou dh\u00b7ergentes: \nao passo que valores muito pequenos de t::.t ocasionam atrasos desnecess\u00e1rios de \nprocessamento. Al\u00e9m disso, uma boa op\u00e7\u00e3o \u00e9 ter um passo de tempo vari\u00e1vel de \nacordo com a estrutura da grade G e o resultado das integra\u00e7\u00f5es espaciais . \n\n.4 Novas estrat\u00e9gias para integra\u00e7\u00e3o no tempo \n\nUm ponto interessante seria pesquisar estrat\u00e9gias mais sofisticadas de refinamento \nlocal din\u00e2mico, para serem aplicadas na solu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais depen-\ndentes do tempo (cap\u00edtulo 6). A princ\u00edpio, isto englobaria a cria\u00e7\u00e3o de novos \nalgoritmos para a obten\u00e7\u00e3o de grades adaptativas, em substitui\u00e7\u00e3o ao procedi-\nmento Refina_Grade (4.5.1), e m\u00e9todos mais eficientes para fazer a mudan\u00e7a de \nbase das fun\u00e7\u00f5es aproximadas. \n\n10.2.5 Sugest\u00f5es para o Sim\u00f3leo \n\nEntre os pr\u00f3ximos testes com o programa Sim\u00f3leo, devem ser inclu\u00eddas simula\u00e7\u00f5es \nde reservat\u00f3rios com varia\u00e7\u00f5es na escala vertical (dom\u00ednio tridimensional) e em \nregi\u00f5es inclinadas (gx i O ou gy i O). Para visualizar o resultado destes testes, \nentretanto, novas rotinas deveriam ser incorporadas ao m\u00f3dulo VIS (se\u00e7\u00e3o 9.1.2) \npara cria\u00e7\u00e3o de gr\u00e1ficos 3D. \n\nCom rela\u00e7\u00e3o aos sistemas num\u00e9ricos, \u00e9 preciso adicionar ao m\u00f3dulo LIN (se\u00e7\u00e3o \n9.1.2) rotinas com m\u00e9todos iterativos para solu\u00e7\u00e3o de matrizes grandes de sistemas \nlineares, bem como matrizes esparsas destes sistemas. Tamb\u00e9m deve ser realizado \num estudo detalhado para tratar os problemas de instabilidade num\u00e9rica do mo-\ndelo discreto adotado (cap\u00edtulo 8), especialmente considerando as diferen\u00e7as de \nescala das propriedades petrof\u00edsicas e malhas di\u00e1dicas. \n\nPor fim, deveria ser adicionada ao simulador a fase g\u00e1s, tamb\u00e9m presente no \nmodelo f\u00edsico Black- Oil. \n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas \n\n[AS79} K Azize A. Settari. Petroleum Reservoir Simulation. Applied Science, \n1979. \n\n[ATL91] H. S. Al-Towailib e J. S. L in. The application of local grid refinement \nto simulate a large hydrocarbon reservoir as an alternative to a two-\nmodel approach. Em SPE l1Jiddle East Oil Show, Bahrain, number \npaper SPE 21392, Novembro 1991. \n\n[BBB87} H. Bartels, J. C. Beatty, e B. A. Barsky. An Introduction to Spli-\nnes for Use in Computer Graphics and Geometria Modeling. Morgan \nKanfmann, 1987. \n\n[BQDY89] S. Bu-Qing e L. Ding-Yuan. Computational Geometry Curve and Sur-\nface Modeling. Academic Press, 1989. \n\n[Bra78} \n\n[Cri77] \n\n[dCS98] \n\n[Duc96] \n\n[GE97] \n\nR. N. BracewelL The Fourier Transform and Its Applications. \nMcGraw-Hill, 1978. \n\nH. B. Crichlow. Modem Reservoir Engineering- A Simulation Appro-\nach. Prentice-Hall, 1977. \n\nC. de C. Santos. Modelo para an\u00e1lise de deslocamento misc\u00edvel no meio \nporoso usando a teoria dos canais de fluxo. Disserta\u00e7\u00e3o de Mestrado, \nUNICAMP - Universidade Estadual de Campinas, Brasil, 1998. \n\nM. A. Duchaineau. Dyadic Splines. Tese de Doutorado, University of \nCalifornia, Davis, 1996. \n\nE. N. Gourley e T. Ertekin. Application of a local grid refinement \ntechnique to model impermeable barriers in reservoir simulation. Em \n1997 SPE Eastem Regional Meeting, Laxington, KY, number paper \nSPE 39216, Outubro 1997. \n\n102 \n\n\n\nREFER\u00caNCIAS BIBLIOGRl\u00cd.FICA.S 103 \n\n[Gom99] A. Gomide. Splines Polinomiais N\u00e3o Homog\u00eaneos na Esfera. Tese de \nDoutorado, UNICAMP - Universidade Estadual de Campinas, BrasiL \n1999. \n\n[Gue98] \n\n[HS99] \n\n[Joh87] \n\n[Lei94] \n\n[MD90] \n\n[Men77] \n\n[Mor85] \n\nS. S. Guedes. Uma abordagem multiescala na simula\u00e7\u00e3o num\u00e9rica de \nreservat\u00f3rios. Tese de Doutorado, UNICAMP- Universidade Estadual \nde Brasil, 1998. \n\nZ. E. Heinemann, G. Gerken, e G. V. Hantelmann. Using local gr\u00edd \nrefinement in a multiple-application reservoir simulator. Em Reservoir \nSimulation Symposium, San Francisco, C A, number paper SPE 12255, \nNovembro 1983. \n\nG. R. Hjaltason e H. Samet. Improved bulk-loading algorithms for \nquadtrees. Em 7th International ACM Workshop on Advances in Ge-\nographic lnformation Systems, Kansas City, MO, number paper \n20740, Novembro 1999. \n\nC. Johnson. Numerical Solution of Partia/ Differential Equations by \nthe Finite Element Method. Cambridge University Press, 1987. \n\nL. Leithold. O C\u00e1lculo com Geometria Anal\u00edtica. Editora Harbra, \n1994. \n\nC. ?v!attax e R. L. Dalton. Reservoir Simulation AIME. Society of \nPetroleum Engineers, 1990. \n\nG. P. Menzala. Introdu\u00e7\u00e3o \u00e0s Equa\u00e7\u00f5es Diferenciais Parciais. IMPA, \n1977. \n\nM. E. Mortenson. Geometric Modeling. John Wiley and Sons, 1985. \n\n[NLP+9o] E. C. Nacul, C. Leprete, O. A. Jr. Pedrosa, P. Girard, e K. Aziz. Effici-\nent use of domain decomposition and local grid refinement in reservoir \nsimulations. Em 65th Annual Techn\u00edcal Conference and Exhibition of \nthe Society of Petroleum Engineers, New Orleans, LA, number paper \nSPE 20740, Setembro 1990. \n\n[PFTV86] W. H. Press, B. P. Flannery, S. A. Teukolsky, e W. T. Vetterling. \nNumerical Rec\u00edpes: The Art of Scientific Computing. Cambridge Uni-\nversity Press, 1986. \n\n\n\nREFER\u00caNCIAS BIBLIOGRl\u00cd.FICAS 104 \n\n[PGOO] \n\n[Pis80] \n\n[Ris02] \n\n[Sew88] \n\n[Str88] \n\n[Twi84] \n\n[Vic81] \n\n[Vve93] \n\n[Was87] \n\nK Pruess e J. Garcia. A systematic approach to local grid refinement \nin geothermal reservoir simulation. Em Proceedings World Geothermal \nCongress 2000, Kyushu - Tohoku, Jap\u00e3o, Maio 2000. \n\nN. Piskunov. Differential and Integral Calculas. Mir Publishers, 1980. \n\nV. F. Risso. Simula\u00e7\u00e3o num\u00e9rica de fluxo em regi\u00f5es de reservat\u00f3rios \nde petr\u00f3leo com refinamento local e fronteiras abertas. Disserta\u00e7\u00e3o de \nMestrado, - Universidade Estadual de Campinas, BrasiL \n2002. \n\nG. SewelL The Numerical Solution of Ordinary and Partia! Differential \nEquations. Academic Press, 1988. \n\nT. D. Streltsova. Well Testing in Heterogeneous Formations. Exxon, \n1988. \n\nE. H. TwizelL Computational Methods for Partia/ Differential Equa-\ntions. Ellis Horwood Limited, 1984. \n\nR Vichnevetsky. Computational Methods for Partia! Differential \nEquations. Prentice-Hall, 1981. \n\nD. Vvedensky. Partial Differential Equations with Mathematica. \nAddison-Wesley, 1993. \n\nM. L Wasserman. Local grid refinement for three-dimensional si-\nmulators. Em Ninth SPE Symposium on Reservoir Simulation, San \nAntonio, Texas, number paper SPE 16013, Fevereiro 1987."}]}}}