<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">                      
    <meta name="viewport" content="width=device-width"> 
    <title>Buscador Rainbows</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <h1>Rainbow</h1>
    <form>
      <label for="busca">Buscar:</label>
      <input type="text" class="busca-class" id="search" name="busca">
      <button id="btn-search" type="button" onclick="enviar()">Pesquisar</button>
        
      <table id="tabela-resultados">
        <thead>
          <tr>
            <th>ID</th>
            <th>FILENAME</th>
          </tr>
        </thead>
        <tbody id="corpo-tabela"></tbody>
      </table>
      
      
      
      <script>
        function preencherTabela(resultados) {
            var linhas = "";
            resultados.forEach(function (doc) {
                linhas += "<tr><td>" + doc._id + "</td><td>" + doc._source.filename + "</td></tr>";
            });
            $("#corpo-tabela").html(linhas);
        }

        function enviar() {
            const termoDeBusca = document.getElementById("search").value;
            console.log(termoDeBusca);

            axios.get("/buscar", {
                params: {
                    termo: termoDeBusca
                }
            })
            .then(function(response) {
                console.log("sucesso da requisição Axios");
                console.log(response.data);
                preencherTabela(response.data);
            })
            .catch(function(error) {
                console.log("erro da requisição Axios");
                console.error(error);
            });

            console.log("depois da requisição Axios");
        }

      </script>

    </form>
  </body>
</html>